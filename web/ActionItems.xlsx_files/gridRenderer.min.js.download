var gridRenderer=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=36)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=r(1),i=r(2),l=r(10),a=r(3),u=r(4),d=r(5);function s(e,t,r){if(null==e)throw Error(r+".verifyArgumentNotNull: "+t+" cannot be null or undefined")}function c(e,t,r,n,o){for(var i=t,l=t+r-1;i<=l;){var a=i+(l-i>>1),u=o(e instanceof Array?e[a]:e.item(a),n);if(0===u)return a;u<0?i=a+1:l=a-1}return~i}function g(e,t){return e.Row===t.Row&&e.Col===t.Col?0:e.Row>t.Row||e.Row===t.Row&&e.Col>t.Col?1:-1}function f(e,t,r){var n=e?t.FontName:l.DefaultFontName;return h(t.Bold||!1,t.Italic||!1)+" "+(r?r+"pt":t&&t.Size?t.Size+"pt":l.DefaultFontSizePt+"pt")+" "+n}function h(e,t){return e&&t?"bold italic":e?"bold":t?"italic":"normal"}function m(e){s(e,"model","initCellLookup"),s(e.Cells,"model.Cells","initCellLookup");for(var t={},r=0;r<e.Cells.length;r++){var n=e.Cells[r];if(n)if(t[i.cellLookupKey(n.Row,n.Col)]=n,n.Merge)for(var o=0;o<=n.Merge.Rows;o++)for(var l=0;l<=n.Merge.Columns;l++)t[i.cellLookupKey(n.Row+o,n.Col+l)]=n;else t[i.cellLookupKey(n.Row,n.Col)]=n}return t}function C(e,t,r){return s(r,"model","initCellLookup"),r.CellLookup||(r.CellLookup=m(r)),r.CellLookup[i.cellLookupKey(e,t)]}function p(e,t){return s(e,"cell","getCellStyle"),s(t.Styles,"Styles","getCellStyle"),e.CachedStyle||(e.CachedStyle=n.getReferencedObjectById(e.StyleID,t.Styles)),e.CachedStyle}function y(e,t){return i.isRenderFlagEnabled(o.RenderFlags.ShrinkToFit,t)&&e.CachedStyle.ShrinkToFit&&!e.WrapText}function F(e,t){if(y(e,t))return e.ShrunkSize}function v(e,t){return t&&!d.isNullOrUndefined(e)}t.verifyArgumentNotNull=s,t.numbersComparer=function(e,t){return e-t},t.binarySearch=c,t.cellsPositionComparer=g,t.getDefaultCell=function(e,t,r,i){void 0===r&&(r=void 0),void 0===i&&(i=void 0);var l=r?n.getReferencedObjectById(o.UniqueStyleID.Default,r):void 0;return{Col:t,CachedStyle:l,CachedFont:i&&l?n.getReferencedObjectById(l.FontID,i):void 0,HorizontalAlignmentSet:!1,Ifmt:0,Row:e,StyleID:o.UniqueStyleID.Default,BorderStyleID:o.UniqueStyleID.DefaultBorder,Text:"",ValueType:o.CellValueType.None,CachedDrawingLayout:{UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}}}},t.getFontCssStringFromCell=function(e,t){return f(i.isRenderFlagEnabled(o.RenderFlags.FontName,e),t.CachedFont,F(t,e))},t.getFontCssStringFromFont=f,t.getCellFontWeightStyle=h,t.throwError=function(e,t){throw Error(t+": "+e)},t.getLinePixelTranslation=function(e){return e/2},t.isCellAdjacentToMergedCell=function(e,t,r){s(r,"model","isCellAdjacentToMergedCell");for(var n=function(e,t,r){return[C(e-1,t,r),C(e+1,t,r),C(e,t-1,r),C(e,t+1,r)]}(e,t,r),o=0;o<n.length;o++)if(n[o]&&n[o].Merge)return!0;return!1},t.initCellLookup=m,t.getCell=C,t.getColumnWidth=function(e,t){if(s(t,"model","getColumnWidth"),s(t.ColumnWidths,"ColumnWidths","getColumnWidth"),e>t.ColumnWidths.length-1||e<0)throw Error("getColumnWidth: column width requested for a cell which is not in range of the model");return t.ColumnWidths[e]},t.getCellStyle=p,t.getCellFont=function(e,t){if(s(e,"cell","getCellFont"),s(t.Styles,"Styles","getCellFont"),s(t.Fonts,"Fonts","getCellFont"),!e.CachedFont){var r=p(e,t);e.CachedFont=n.getReferencedObjectById(r.FontID,t.Fonts)}return e.CachedFont},t.getCellPositionInArray=function(e,t){var r=c(t,0,t.length,e,g);return r<0&&(r=~r),r},t.cellHasShrinkToFit=y,t.getShrunkFontSize=F,t.getTextRunText=function(e,t,r){var n=t[e].StartIndex,o=r.length;return e<t.length-1&&(o=t[e+1].StartIndex),r.substring(n,o)},t.getActualFontSize=function(e,t){return y(e,t)?e.ShrunkSize:e.CachedFont.Size},t.setCellCachedDisplayText=function(e,t){e.CachedDisplayText=t,e.CachedDrawingLayout.CellTextLayout.Width=void 0},t.getWorkbookBackgroundColor=function(e,t,r){return d.isNullOrUndefined(e)?v(t,r)?t:u.DefaultBackgroundColor:a.rgbToColorHex(e.BackgroundColor)},t.hasWorkbookBackgroundColor=v,t.isHighContrastMode=function(e){return!d.isNullOrUndefined(e.highContrastScheme)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.ReversedVertical=2]="ReversedVertical",e[e.ReversedHorizontal=3]="ReversedHorizontal",e[e.DiagonalUp=4]="DiagonalUp",e[e.DiagonalDown=5]="DiagonalDown",e[e.ReversedDiagonalUp=6]="ReversedDiagonalUp",e[e.ReversedDiagonalDown=7]="ReversedDiagonalDown",e[e.TopLeftCorner=8]="TopLeftCorner",e[e.TopRightCorner=9]="TopRightCorner",e[e.BottomLeftCorner=10]="BottomLeftCorner",e[e.BottomRightCorner=11]="BottomRightCorner",e[e.Center=12]="Center"}(t.GradientShadingStyle||(t.GradientShadingStyle={})),function(e){e[e.Solid=0]="Solid",e[e.Gradient=1]="Gradient"}(t.BackgroundFillType||(t.BackgroundFillType={})),function(e){e[e.Context=0]="Context",e[e.LeftToRight=1]="LeftToRight",e[e.RightToLeft=2]="RightToLeft"}(t.ReadingOrderType||(t.ReadingOrderType={})),function(e){e[e.Automatic=0]="Automatic",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify",e[e.CenterAcrossSelection=6]="CenterAcrossSelection",e[e.Distributed=7]="Distributed",e[e.JustifyDistributed=8]="JustifyDistributed"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Justify=3]="Justify",e[e.Distributed=4]="Distributed"}(t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.DefaultBorder=0]="DefaultBorder",e[e.Default=-1]="Default",e[e.Hyperlink=-2]="Hyperlink",e[e.FormulaError=-3]="FormulaError"}(t.UniqueStyleID||(t.UniqueStyleID={})),function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Error=4]="Error"}(t.CellValueType||(t.CellValueType={})),function(e){e[e.Value=0]="Value",e[e.Formula=1]="Formula",e[e.ArrayFormula=2]="ArrayFormula"}(t.CellFormulaType||(t.CellFormulaType={})),function(e){e[e.None=0]="None",e[e.Filtered=1]="Filtered",e[e.SortedAsc=2]="SortedAsc",e[e.SortedDesc=3]="SortedDesc",e[e.SortedTop=4]="SortedTop",e[e.SortedBottom=5]="SortedBottom",e[e.BothAsc=6]="BothAsc",e[e.BothDesc=7]="BothDesc",e[e.BothTop=8]="BothTop",e[e.BothBottom=9]="BothBottom",e[e.Sorted=10]="Sorted",e[e.Both=11]="Both"}(t.AutoFilterType||(t.AutoFilterType={})),function(e){e[e.None=0]="None",e[e.CData=1]="CData"}(t.CellsEncoding||(t.CellsEncoding={})),function(e){e[e.None=0]="None",e[e.Underline=4]="Underline",e[e.Strikethrough=16]="Strikethrough",e[e.LargeBlocks=32]="LargeBlocks",e[e.GradientFill=64]="GradientFill",e[e.OnePixelGridLines=512]="OnePixelGridLines",e[e.RichTextFormat=1024]="RichTextFormat",e[e.MeasureTextRefactor=2048]="MeasureTextRefactor",e[e.AdvancedTextMetrics=8192]="AdvancedTextMetrics",e[e.ShrinkToFit=16384]="ShrinkToFit",e[e.FontName=65536]="FontName",e[e.NumFmtAccountingAndCustom=262144]="NumFmtAccountingAndCustom",e[e.NumFmtAndWrapText=524288]="NumFmtAndWrapText",e[e.FormulaType=1048576]="FormulaType",e[e.ThaiLineBreaking=2097152]="ThaiLineBreaking",e[e.CFIcons=4194304]="CFIcons",e[e.GridLineColor=8388608]="GridLineColor",e[e.WorkbookBackgroundColor=16777216]="WorkbookBackgroundColor"}(t.RenderFlags||(t.RenderFlags={})),function(e){e[e.None=0]="None",e[e.Flyout=1]="Flyout",e[e.Toggle=2]="Toggle",e[e.Button=3]="Button"}(t.MenuItemType||(t.MenuItemType={})),function(e){e[e.None=0]="None",e[e.Thin=1]="Thin",e[e.Medium=2]="Medium",e[e.Dashed=3]="Dashed",e[e.Dotted=4]="Dotted",e[e.Thick=5]="Thick",e[e.Double=6]="Double",e[e.Hair=7]="Hair",e[e.MediumDashed=8]="MediumDashed",e[e.DashDot=9]="DashDot",e[e.MediumDashDot=10]="MediumDashDot",e[e.DashDotDot=11]="DashDotDot",e[e.MediumDashDotDot=12]="MediumDashDotDot",e[e.SlantDashDot=13]="SlantDashDot"}(t.BorderLineType||(t.BorderLineType={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Diagonal=4]="Diagonal",e[e.Vertical=5]="Vertical",e[e.Horizontal=6]="Horizontal",e[e.BorderMax=7]="BorderMax"}(t.BorderPositionType||(t.BorderPositionType={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SingleAccounting=3]="SingleAccounting",e[e.DoubleAccounting=4]="DoubleAccounting"}(t.FontUnderline||(t.FontUnderline={})),function(e){e[e.None=0]="None",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(t.FontVerticalAlignment||(t.FontVerticalAlignment={})),function(e){e[e.None=0]="None",e[e.Expanded=1]="Expanded",e[e.Collapsed=2]="Collapsed"}(t.OutlineState||(t.OutlineState={})),function(e){e[e.None=0]="None",e[e.CustomSort=1]="CustomSort",e[e.Filter=2]="Filter",e[e.SheetViewDefault=3]="SheetViewDefault",e[e.SheetViewTemp=4]="SheetViewTemp",e[e.SheetViewSwitch=5]="SheetViewSwitch",e[e.SheetViewMoreViews=6]="SheetViewMoreViews",e[e.SheetViewCreate=7]="SheetViewCreate",e[e.SheetViewOptions=8]="SheetViewOptions",e[e.GenericScript=9]="GenericScript",e[e.ClearFilter=10]="ClearFilter",e[e.ShowRichFieldsList=11]="ShowRichFieldsList",e[e.ShowPivotFilter=12]="ShowPivotFilter",e[e.SortByValue=13]="SortByValue",e[e.SortAscending=14]="SortAscending",e[e.SortDescending=15]="SortDescending",e[e.FieldListToReportFilter=16]="FieldListToReportFilter",e[e.FieldListToRowLabels=17]="FieldListToRowLabels",e[e.FieldListToColumnLabels=18]="FieldListToColumnLabels",e[e.FieldListToValues=19]="FieldListToValues",e[e.FieldListAddAsSlicer=20]="FieldListAddAsSlicer",e[e.RemoveFilter=21]="RemoveFilter",e[e.FilterType=22]="FilterType",e[e.FilterPivot=23]="FilterPivot",e[e.FilterSubMenu=24]="FilterSubMenu",e[e.FieldSubMenu=25]="FieldSubMenu",e[e.SheetViewSubMenu=26]="SheetViewSubMenu",e[e.GenericSortAscending=27]="GenericSortAscending",e[e.GenericSortDescending=28]="GenericSortDescending",e[e.RemovePivotFilter=29]="RemovePivotFilter"}(t.MenuEntryIdentifier||(t.MenuEntryIdentifier={})),function(e){e[e.None=0]="None",e[e.AmbiguousLinkedEntity=1]="AmbiguousLinkedEntity",e[e.ConnectedLinkedEntityBlocked=2]="ConnectedLinkedEntityBlocked",e[e.ConnectedLinkedEntityNotBlocked=3]="ConnectedLinkedEntityNotBlocked",e[e.DisconnectedLinkedEntity=4]="DisconnectedLinkedEntity",e[e.RichError=5]="RichError",e[e.ImageUrl=6]="ImageUrl",e[e.OtherRichValue=7]="OtherRichValue"}(t.RichValueCellType||(t.RichValueCellType={})),function(e){e[e.ThreeArrowsColored=0]="ThreeArrowsColored",e[e.ThreeArrowsGray=1]="ThreeArrowsGray",e[e.ThreeFlags=2]="ThreeFlags",e[e.ThreeTrafficLightsUnrimmed=3]="ThreeTrafficLightsUnrimmed",e[e.ThreeTrafficLightsRimmed=4]="ThreeTrafficLightsRimmed",e[e.ThreeSigns=5]="ThreeSigns",e[e.ThreeSymbolsCircled=6]="ThreeSymbolsCircled",e[e.ThreeSymbolsUncircled=7]="ThreeSymbolsUncircled",e[e.FourArrowsColored=8]="FourArrowsColored",e[e.FourArrowsGray=9]="FourArrowsGray",e[e.RedToBlack=10]="RedToBlack",e[e.FourRatings=11]="FourRatings",e[e.FourTrafficLights=12]="FourTrafficLights",e[e.FiveArrowsColored=13]="FiveArrowsColored",e[e.FiveArrowsGray=14]="FiveArrowsGray",e[e.FiveRatings=15]="FiveRatings",e[e.FiveQuarters=16]="FiveQuarters",e[e.ThreeStarts=17]="ThreeStarts",e[e.ThreeTriangles=18]="ThreeTriangles",e[e.FiveBoxes=19]="FiveBoxes"}(t.CFIconSet||(t.CFIconSet={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=r(1),i=r(5),l=r(41);function a(e,t){return 0!=(e&t.RenderFlags)}function u(e,t){return!!d(e)&&(a(o.RenderFlags.NumFmtAccountingAndCustom,t)&&e.Ifmt>=l.NumFmtAccountingStartIndex&&""!==e.Text)}function d(e){return e.ValueType===o.CellValueType.Number}t.cellLookupKey=function(e,t){return t+"_"+e},t.getReferencedObjectToCache=function(e,t){if(!i.isNullOrUndefined(e)&&!i.isNullOrUndefined(t))return n.getReferencedObjectById(e,t)},t.isRenderFlagEnabled=a,t.doesNumFmtOverrideText=function(e,t){return!!d(e)&&(a(o.RenderFlags.NumFmtAndWrapText,t)&&""!==e.WrapText&&""!==e.Text||u(e,t))},t.isAccAndCustomNumFmtApplicable=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),o=r(5);function i(e,t,r,n,o){e.beginPath(),e.rect(t,r,n,o),e.stroke(),e.clip()}function l(e,t,r,n){return!(t<r||n<e)}t.getDefaultBorderLineWidth=function(e){if(o.isNullOrUndefined(void 0))return Math.max(Math.round(e),1)},t.rgbToColorHex=function(e){for(var t=Number(e).toString(16);t.length<6;)t="0"+t;return"#"+t},t.getColWidthFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getColWidthFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getRowHeightFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getRowHeightFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getBlockDimensionsAdjustedForDrawing=function(e,t){return Math.round(e*t)},t.isSafari=function(){if(window&&window.navigator){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1},t.getTextDrawingMaxWidth=function(e,t,r){return e-n.GridLineWidthPx-t-r},t.getContainerClipMaskWidth=function(e){return e-n.GridLineWidthPx},t.drawClipRect=i,t.applyClipping=function(e,t){t&&(e.save(),e.strokeStyle="transparent",i(e,t.x,t.y,t.width,t.height))},t.restoreClipping=function(e,t){t&&e.restore()},t.drawLine=function(e,t,r,n,o){e.moveTo(t,r),e.lineTo(n,o)},t.hexToRgb=function(e){var t="#"===e[0]?e.substr(1):e,r=parseInt(t,16);return{Red:r>>16&255,Green:r>>8&255,Blue:255&r}},t.cellIntersectsRenderingRegion=function(e,t){var r=e.Row,n=e.Row,o=e.Col,i=e.Col;e.Merge?(n+=e.Merge.Rows,i+=e.Merge.Columns,e.Merge.SpansBlocks&&(e.Merge.OriginDeltaX&&(o=0),e.Merge.OriginDeltaY&&(r=0))):e.Spill&&(o-=e.Spill.SpanToStart,i+=e.Spill.SpanToEnd);var a=l(o,i,t.startColumn,t.endColumn),u=l(r,n,t.startRow,t.endRow);return a&&u},t.shouldRenderGridLines=function(e,t){return e||!t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.DefaultGridlineColor="#d4d4d4",t.MinimalDprForGridlinesRendering=.4,t.InCellHorizontalPaddingPx=2,t.InCellEndOfTextHorizontalPaddingPx=2,t.InCellBottomAndCenterVerticalPaddingPx=1,t.InCellIndentPaddingPx=9,t.InCellDoubleBorderVerticalPaddingPx=-1,t.TextLineHeightPx=20,t.GridLineWidthPx=1,t.DefaultBackgroundColor="#ffffff",t.DefaultCellFontColor="#000000",t.EmptyLine={text:"",width:0,underlineWidth:0},t.RightHorizontalAlignmentItalicExtraPadding=3,t.Whitespace=" ",t.HardBreak="\n",t.HardBreakCRLF="\r\n",t.ThinBorderWeight=1,t.MediumBorderWeight=2,t.DefaultDash=[],t.ColoredGridLineDash=[1,1],t.DottedLineDash=[2,2],t.DashedLineDash=[6,2],t.DashedDotLineDash=[9,3,3,3],t.DashedDotDotLineDash=[9,3,3,3,3,3],t.MediumDashedLineDash=[9,3],t.MediumDotDashedLineDash=[9,3,3,3],t.UnderlineLineWidth=1,t.UnderlineMarginFromTextBaseline=1,t.SkeletonColor="#E4E4E4",t.FontHeightToBaselineGapRatio=.22;var o={Red:255,Green:0,Blue:0};t.FormulaErrorBackgroundColor="#FFFFFF",t.FormulaErrorFontColor="#000000",t.FormulaErrorBorderStyle={Borders:[{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Top,Color:o,Weight:2},{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Bottom,Color:o,Weight:2},{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Left,Color:o,Weight:2},{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Right,Color:o,Weight:2}],ID:n.UniqueStyleID.FormulaError,RefCount:0}},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!p(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(a(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,l=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),u=n[r];r<i;u=n[++r])m(u)||!v(u)?l+=" "+u:l+=" "+a(u);return l},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var i,l={};function a(e,r){var n={seen:[],stylize:d};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),h(r)?n.showHidden=r:r&&t._extend(n,r),y(n.showHidden)&&(n.showHidden=!1),y(n.depth)&&(n.depth=2),y(n.colors)&&(n.colors=!1),y(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),s(n,e,n.depth)}function u(e,t){var r=a.styles[t];return r?"["+a.colors[r][0]+"m"+e+"["+a.colors[r][1]+"m":e}function d(e,t){return e}function s(e,r,n){if(e.customInspect&&r&&R(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return p(o)||(o=s(e,o,n)),o}var i=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(p(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(C(t))return e.stylize(""+t,"number");if(h(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,r);if(i)return i;var l=Object.keys(r),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(l);if(e.showHidden&&(l=Object.getOwnPropertyNames(r)),S(r)&&(l.indexOf("message")>=0||l.indexOf("description")>=0))return c(r);if(0===l.length){if(R(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(F(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(w(r))return e.stylize(Date.prototype.toString.call(r),"date");if(S(r))return c(r)}var d,v="",T=!1,x=["{","}"];(f(r)&&(T=!0,x=["[","]"]),R(r))&&(v=" [Function"+(r.name?": "+r.name:"")+"]");return F(r)&&(v=" "+RegExp.prototype.toString.call(r)),w(r)&&(v=" "+Date.prototype.toUTCString.call(r)),S(r)&&(v=" "+c(r)),0!==l.length||T&&0!=r.length?n<0?F(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),d=T?function(e,t,r,n,o){for(var i=[],l=0,a=t.length;l<a;++l)b(t,String(l))?i.push(g(e,t,r,n,String(l),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(g(e,t,r,n,o,!0))})),i}(e,r,n,a,l):l.map((function(t){return g(e,r,n,a,t,T)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(d,v,x)):x[0]+v+x[1]}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function g(e,t,r,n,o,i){var l,a,u;if((u=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),b(n,o)||(l="["+o+"]"),a||(e.seen.indexOf(u.value)<0?(a=m(r)?s(e,u.value,null):s(e,u.value,r-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),y(l)){if(i&&o.match(/^\d+$/))return a;(l=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(l=l.substr(1,l.length-2),l=e.stylize(l,"name")):(l=l.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),l=e.stylize(l,"string"))}return l+": "+a}function f(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function C(e){return"number"==typeof e}function p(e){return"string"==typeof e}function y(e){return void 0===e}function F(e){return v(e)&&"[object RegExp]"===T(e)}function v(e){return"object"==typeof e&&null!==e}function w(e){return v(e)&&"[object Date]"===T(e)}function S(e){return v(e)&&("[object Error]"===T(e)||e instanceof Error)}function R(e){return"function"==typeof e}function T(e){return Object.prototype.toString.call(e)}function x(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(y(i)&&(i=Object({NODE_ENV:"production"}).NODE_DEBUG||""),r=r.toUpperCase(),!l[r])if(new RegExp("\\b"+r+"\\b","i").test(i)){var n=e.pid;l[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else l[r]=function(){};return l[r]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=h,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=C,t.isString=p,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=F,t.isObject=v,t.isDate=w,t.isError=S,t.isFunction=R,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(39);var B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function D(){var e=new Date,t=[x(e.getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":");return[e.getDate(),B[e.getMonth()],t].join(" ")}function b(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",D(),t.format.apply(t,arguments))},t.inherits=r(40),t._extend=function(e,t){if(!t||!v(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var N="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(N&&e[N]){var t;if("function"!=typeof(t=e[N]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,N,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),N&&Object.defineProperty(t,N,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=N,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,l=function(){return o.apply(i,arguments)};t.apply(this,r).then((function(t){e.nextTick(l,null,t)}),(function(t){e.nextTick(A,t,l)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(38))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(17),o=r(1),i=r(2),l=r(4),a=r(10),u=r(5),d=r(0),s=r(19),c=r(28),g=r(29),f=r(9),h=r(20),m=r(13),C=!0,p={},y={};function F(e,t,r){if(!t)return 0;if(r&&C){var n=t.trim(),o=e.measureText(n);if(!u.isNullOrUndefined(o.actualBoundingBoxLeft)&&!u.isNullOrUndefined(o.actualBoundingBoxRight)){var i=Math.abs(o.actualBoundingBoxRight)+Math.abs(o.actualBoundingBoxLeft),l=t.length-n.length,a=0;if(l>0)a=l*e.measureText(" ").width;return i+a}C=!1}return function(e,t){return e.measureText(t).width}(e,t)}function v(e){return e*l.InCellIndentPaddingPx}function w(e,t,r,n,i,l){var a=v(n),u=g.CalibriRegularPadding;switch(t){case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return a+c.approximateValue(e,u)+l;case o.HorizontalAlignment.Right:return r&&(u=g.CalibriItalicPadding),a+c.approximateValue(e,u);case o.HorizontalAlignment.Center:return i?c.approximateValue(e,u):0;default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+t)}}function S(e,t,r){if(r){var n=e+"pt "+t;return s.getCachedFontMetrics(n,t,e).height}return m.pointsToPixels(e)}function R(e,t,r){var n=r?a.LineHeightUsingDivFontFactor:a.LineHeightFontFactor,o=S(e,t,r);return Math.ceil(o*n)}function T(e,t,r,n,o){void 0===r&&(r=1);var i=t*r;return n?e+i-Math.round(t*a.LineLeading)+o:e+i}function x(e,t,r,n){if(r){var o=Math.round(t*a.LineLeading*1.5)-l.InCellBottomAndCenterVerticalPaddingPx-n;return e-Math.max(o,1)}return e-l.InCellBottomAndCenterVerticalPaddingPx}function B(e,t,r,n,o,i){return e-(t+l.GridLineWidthPx-r*n-(o?Math.round(r*(a.LineLeading/2)):0))/2-r/2+i}function D(e,t,r){r.CachedDrawingLayout||(r.CachedDrawingLayout={CellTextLayout:{}});var n=r.TextRuns&&i.isRenderFlagEnabled(o.RenderFlags.RichTextFormat,t);if(r.CachedDrawingLayout.CellTextLayout.Width){if(n&&!r.CachedDrawingLayout.TextRunDrawingInformation)throw"getTextWidthInternal: TextRunsDrawingData is supposed to be defined";return{width:r.CachedDrawingLayout.CellTextLayout.Width,textRunsDrawingInformation:r.CachedDrawingLayout.TextRunDrawingInformation}}var l=i.isRenderFlagEnabled(o.RenderFlags.AdvancedTextMetrics,t),a=i.isRenderFlagEnabled(o.RenderFlags.NumFmtAccountingAndCustom,t)?r.CachedDisplayText:r.Text;if(n){var u=N(r),d=b(e,r.TextRuns,t.Fonts,r.Text,u);return{width:d.totalWidth,textRunsDrawingInformation:d.textRunsDrawingInformation}}return{width:F(e,a,l)}}function b(e,t,r,o,i){var l=e.textAlign;e.textAlign="left";var a=0,u=[],s=t;void 0!==i&&i.HasBidi&&(s=h.prepareTextRunsForBidiLayout(t,o));for(var c=0;c<s.length;c++){var g=s[c],m={FontID:g.FontID,StartIndex:g.StartIndex},C=d.getTextRunText(c,s,o),p=f.getReferencedObjectById(g.FontID,r),y=d.getFontCssStringFromFont(!0,p,void 0);e.font=y;var v=F(e,C,!0);m.WidthPx=v,m.Text=C,m.FontCss=y,m.Strikethrough=p.StrikeThrough,m.Underline=p.Underline,u[c]=n.__assign(n.__assign({},m),g),a+=v}return e.textAlign=l,{totalWidth:a,textRunsDrawingInformation:u}}function N(e){d.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getBidiContext");var t=e.CachedDrawingLayout.BidiContext;if(t)return t;var r=h.analyzeBidiText(e.Text,e.CachedStyle.ReadingOrder);return e.CachedDrawingLayout.BidiContext=r,r}function A(e,t){var r;if(i.isRenderFlagEnabled(o.RenderFlags.CFIcons,e)&&(null===(r=t.CondFormat)||void 0===r?void 0:r.Icon)){var n=d.getActualFontSize(t,e);return m.getIconSize(n,1)+m.getIconHorizontalPadding(n,1)}return 0}function I(e,t,r){var n=e.CachedStyle.Indentation||0,o=d.getActualFontSize(e,t),i=!u.isNullOrUndefined(e.WrapText)||d.cellHasShrinkToFit(e,t);return w(o,e.CachedStyle.HorizontalAlignment,e.CachedFont.Italic,n,i,r)}t.measureTextWidth=F,t.getIndentationPaddingPx=v,t.getCellTextHorizontalPaddingWithIcons=function(e,t){return I(e,t,A(t,e))},t.getCellTextHorizontalPaddingNoIcons=function(e,t){return I(e,t,0)},t.getHorizontalPadding=w,t.getFontHeight=S,t.getFontLineHeight=R,t.getTextVerticalPosition=function(e,t,r,n,i,a,u,d,s,c,g){var f=s?l.InCellDoubleBorderVerticalPaddingPx:0,h=function(e,t,r){if(r!==o.VerticalAlignment.Bottom)return 0;switch(e){case"Book Antiqua":return t<10?-2:t<20?-1:0;case"Cambria":return t<12?-2:t<17?-1:0;case"Century":return t<10?-2:t<16?-1:0;case"Comic Sans MS":return t<9?-3:t<14?-2:t<20?-1:0;case"Constantia":return t<10?-2:t<22?-1:0;case"Georgia":return t<11?-2:t<=16?-1:0;case"Trebuchet MS":return t<11?-3:t<17?-1:0;default:return 0}}(c,g,r);switch(r){case o.VerticalAlignment.Bottom:return x(t,n,d,h)+f;case o.VerticalAlignment.Top:return T(e,n,a,d,h);case o.VerticalAlignment.Center:case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return d||u?l.InCellBottomAndCenterVerticalPaddingPx+B(t,i,n,a,d,h):e+i/2+l.InCellBottomAndCenterVerticalPaddingPx;default:throw Error("getTextVerticalPosition: unsupported verticalAlignment: "+r)}},t.getLastRowBaselineOffsetYTop=T,t.getLastRowBaselineOffsetYBottom=x,t.getLastRowBaselineOffsetYCenter=B,t.getTextDecorationLineWidth=function(e){return c.approximateValue(e,g.CalibriTextDecorationLineWidth)},t.getTextHeight=function(e,t,r,n){if(d.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getOrMeasureCellPaddingPx"),d.verifyArgumentNotNull(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getOrMeasureCellPaddingPx"),void 0!==e.CachedDrawingLayout.CellTextLayout.Height)return e.CachedDrawingLayout.CellTextLayout.Height;var o=S(t,r,n);return e.CachedDrawingLayout.CellTextLayout.Height=o,o},t.getTextWidth=function(e,t,r){var n=D(e,t,r),l=n.width,a=n.textRunsDrawingInformation;return r.CachedDrawingLayout.CellTextLayout.Width=l,i.isRenderFlagEnabled(o.RenderFlags.RichTextFormat,t)&&(r.CachedDrawingLayout.TextRunDrawingInformation=a),l},t.getTextWidthNoCaching=function(e,t,r){return D(e,t,r).width},t.measureTextRunsWidth=b,t.getBidiContext=N,t.getTextLineHeight=function(e,t){d.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getTextLineHeight"),d.verifyArgumentNotNull(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getTextLineHeight"),d.verifyArgumentNotNull(e.CachedFont,"CachedFont","getTextLineHeight");var r,n=e.TextRuns&&i.isRenderFlagEnabled(o.RenderFlags.RichTextFormat,t);if(void 0!==e.CachedDrawingLayout.CellTextLayout.LineHeight)return e.CachedDrawingLayout.CellTextLayout.LineHeight;n&&(r=function(e,t){for(var r,n=0;n<t.TextRuns.length;n++){var o=t.TextRuns[n],i=f.getReferencedObjectById(o.FontID,e.Fonts);(!r||r.Size<i.Size)&&(r=i)}if(!r)throw"getLargestFont: Largest fonts is supposed to be defined";return r}(t,e));var l=R(n?r.Size:d.getActualFontSize(e,t),n?r.FontName:e.CachedFont.FontName,i.isRenderFlagEnabled(o.RenderFlags.FontName,t));return e.CachedDrawingLayout.CellTextLayout.LineHeight=l,l},t.getNumFmtSeparatorWidth=function(e,t,r){var n,o;d.verifyArgumentNotNull(null===(n=r.NumFmt)||void 0===n?void 0:n.Separator,"separator","getNumFmtSeparatorWidth");var i=null===(o=r.NumFmt)||void 0===o?void 0:o.Separator,l=d.getFontCssStringFromCell(t,r)+i;if(u.isNullOrUndefined(p[l])){var a=F(e,i,!1);return p[l]=a,a}return p[l]},t.getNumFmtHashesWidth=function(e,t,r){d.verifyArgumentNotNull(r,"cell","getNumFmtSeparatorWidth");var n=d.getFontCssStringFromCell(t,r);if(u.isNullOrUndefined(y[n])){var l=F(e,"#",i.isRenderFlagEnabled(o.RenderFlags.AdvancedTextMetrics,t));return y[n]=l,l}return y[n]},t.getTextIconPadding=A},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(3),i=r(4),l=r(5),a=r(6);function u(e,t,r){if(n.verifyArgumentNotNull(t,"cell","getCellWidth"),n.verifyArgumentNotNull(e,"model","getCellWidth"),n.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge){if(t.Merge.SpansBlocks&&!r)return t.Merge.Width;n.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth");var o=t.Col+t.Merge.Columns,i=e.ColumnOffsets[t.Col];return e.ColumnOffsets[o]+e.ColumnWidths[o]-i}return e.ColumnWidths[t.Col]}function d(e,t,r){if(n.verifyArgumentNotNull(t,"cell","getCellHeight"),n.verifyArgumentNotNull(e,"model","getCellHeight"),n.verifyArgumentNotNull(e.RowHeights,"model.RowHeights","getCellHeight"),t.Merge){if(t.Merge.SpansBlocks&&!r)return t.Merge.Height;n.verifyArgumentNotNull(e.RowOffsets,"model.RowOffsets","getCellHeight");var o=t.Row+t.Merge.Rows,i=e.RowOffsets[t.Row];return e.RowOffsets[o]+e.RowHeights[o]-i}return e.RowHeights[t.Row]}function s(e,t,r){var n=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(n-=t.Merge.OriginDeltaX),e.IsRtl?r-n-u(e,t,!1)+i.GridLineWidthPx:n}function c(e,t){var r=e.RowOffsets[t.Row];return t.Merge&&t.Merge.SpansBlocks&&(r-=t.Merge.OriginDeltaY),r}function g(e,t){if(n.verifyArgumentNotNull(e,"model","getCellWidthAdjustedForDrawing"),n.verifyArgumentNotNull(e.ColOffsetsAdjustedForDrawing,"model.ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),n.verifyArgumentNotNull(t,"cell","getCellWidthAdjustedForDrawing"),t.Merge){if(t.Merge.SpansBlocks)return t.Merge.WidthAdjustedForDrawing;var r=t.Col+t.Merge.Columns,i=e.ColOffsetsAdjustedForDrawing[t.Col];return e.ColOffsetsAdjustedForDrawing[r+1]-i}return o.getColWidthFromOffsets(t.Col,e.ColOffsetsAdjustedForDrawing)}function f(e,t){if(n.verifyArgumentNotNull(e,"model","getCellHeightAdjustedForDrawing"),n.verifyArgumentNotNull(e.RowOffsetsAdjustedForDrawing,"model.RowOffsetsAdjustedForDrawing","getCellHeightAdjustedForDrawing"),n.verifyArgumentNotNull(t,"cell","getCellHeightAdjustedForDrawing"),t.Merge){if(t.Merge.SpansBlocks)return t.Merge.HeightAdjustedForDrawing;var r=t.Row+t.Merge.Rows,i=e.RowOffsetsAdjustedForDrawing[t.Row];return e.RowOffsetsAdjustedForDrawing[r+1]-i}return o.getRowHeightFromOffsets(t.Row,e.RowOffsetsAdjustedForDrawing)}function h(e,t,r){var n=t.Col,o=0;return t.Merge&&(e.IsRtl&&!r&&(n+=t.Merge.Columns),t.Merge.SpansBlocks&&(o=t.Merge.OriginDeltaXAdjustedForDrawing)),!e.IsRtl||r?e.ColOffsetsAdjustedForDrawing[n]-o:m(e,t)-g(e,t)+i.GridLineWidthPx}function m(e,t){var r=e.ColOffsetsAdjustedForDrawing,n=r.length-1,o=t.Col;if(!e.IsRtl)return h(e,t,!1)+g(e,t)-i.GridLineWidthPx;var l=t.Merge&&t.Merge.SpansBlocks?t.Merge.OriginDeltaXAdjustedForDrawing:0;return r[n]+l-r[o]}function C(e,t){var r=0;return t.Merge&&t.Merge.SpansBlocks&&(r=t.Merge.OriginDeltaYAdjustedForDrawing),e.RowOffsetsAdjustedForDrawing[t.Row]-r}t.getCellWidth=u,t.getCellHeight=d,t.getCellLeft=s,t.getCellRight=function(e,t,r){var n=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(n-=t.Merge.OriginDeltaX),e.IsRtl?r-n:n+u(e,t,!1)-i.GridLineWidthPx},t.getCellTextCenterX=function(e,t){var r=a.getTextIconPadding(e,t),n=e.IsRtl?i.GridLineWidthPx:0;return s(e,t,e.BlockWidth)+r+(u(e,t,!1)-r)/2-n},t.getCellBottom=function(e,t){return c(e,t)+d(e,t,!1)},t.getCellTop=c,t.getCellCenterY=function(e,t){return c(e,t)+d(e,t,!1)/2-i.GridLineWidthPx/2},t.getCellWidthAdjustedForDrawing=g,t.getCellHeightAdjustedForDrawing=f,t.getCellLeftAdjustedForDrawing=h,t.getCellRightAdjustedForDrawing=m,t.getCellBottomAdjustedForDrawing=function(e,t){return C(e,t)+f(e,t)},t.getCellCenterYAdjustedForDrawing=function(e,t){return C(e,t)+f(e,t)/2},t.getCellTopAdjustedForDrawing=C,t.isCellSpansMultipleRowsOrBlocks=function(e){return!l.isNullOrUndefined(e.Merge)&&(e.Merge.Rows>0||!0===e.Merge.SpansBlocks)}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ColoredArrowUp=0]="ColoredArrowUp",e[e.ColoredArrowUpRight=1]="ColoredArrowUpRight",e[e.ColoredArrowRight=2]="ColoredArrowRight",e[e.ColoredArrowDownRight=3]="ColoredArrowDownRight",e[e.ColoredArrowDown=4]="ColoredArrowDown",e[e.TriangleHigh=5]="TriangleHigh",e[e.TriangleMedium=6]="TriangleMedium",e[e.TriangleLow=7]="TriangleLow",e[e.GrayArrowUp=8]="GrayArrowUp",e[e.GrayArrowUpRight=9]="GrayArrowUpRight",e[e.GrayArrowRight=10]="GrayArrowRight",e[e.GrayArrowDownRight=11]="GrayArrowDownRight",e[e.GrayArrowDown=12]="GrayArrowDown",e[e.CircleHigh=13]="CircleHigh",e[e.CircleMedium=14]="CircleMedium",e[e.CircleLow=15]="CircleLow",e[e.SignMedium=16]="SignMedium",e[e.SignLow=17]="SignLow",e[e.FourCircleHigh=18]="FourCircleHigh",e[e.FourCircleMedium1=19]="FourCircleMedium1",e[e.FourCircleMedium2=20]="FourCircleMedium2",e[e.FourCircleLow=21]="FourCircleLow",e[e.TrafficHigh=22]="TrafficHigh",e[e.TrafficMedium=23]="TrafficMedium",e[e.TrafficLow=24]="TrafficLow",e[e.CircleSymbolHigh=25]="CircleSymbolHigh",e[e.CircleSymbolMedium=26]="CircleSymbolMedium",e[e.CircleSymbolLow=27]="CircleSymbolLow",e[e.FlagHigh=28]="FlagHigh",e[e.FlagMedium=29]="FlagMedium",e[e.FlagLow=30]="FlagLow",e[e.SymbolHigh=31]="SymbolHigh",e[e.SymbolMedium=32]="SymbolMedium",e[e.SymbolLow=33]="SymbolLow",e[e.StarHigh=34]="StarHigh",e[e.StarMedium=35]="StarMedium",e[e.StarLow=36]="StarLow",e[e.CircleFilled=37]="CircleFilled",e[e.Circle75=38]="Circle75",e[e.CircleHalf=39]="CircleHalf",e[e.Circle25=40]="Circle25",e[e.CircleEmpty=41]="CircleEmpty",e[e.QuadrantFull=42]="QuadrantFull",e[e.Quadrant75=43]="Quadrant75",e[e.QuadrantHalf=44]="QuadrantHalf",e[e.Quadrant25=45]="Quadrant25",e[e.QuadrantEmpty=46]="QuadrantEmpty",e[e.SignalBarEmpty=47]="SignalBarEmpty",e[e.SignalBarLow=48]="SignalBarLow",e[e.SignalBarMedium1=49]="SignalBarMedium1",e[e.SignalBarMedium2=50]="SignalBarMedium2",e[e.SignalBarHigh=51]="SignalBarHigh"}(n=t.CFIconImage||(t.CFIconImage={})),t.IconImageLookup=[[n.ColoredArrowDown,n.ColoredArrowRight,n.ColoredArrowUp],[n.GrayArrowDown,n.GrayArrowRight,n.GrayArrowUp],[n.FlagLow,n.FlagMedium,n.FlagHigh],[n.CircleLow,n.CircleMedium,n.CircleHigh],[n.TrafficLow,n.TrafficMedium,n.TrafficHigh],[n.SignLow,n.SignMedium,n.CircleHigh],[n.CircleSymbolLow,n.CircleSymbolMedium,n.CircleSymbolHigh],[n.SymbolLow,n.SymbolMedium,n.SymbolHigh],[n.ColoredArrowDown,n.ColoredArrowDownRight,n.ColoredArrowUpRight,n.ColoredArrowUp],[n.GrayArrowDown,n.GrayArrowDownRight,n.GrayArrowUpRight,n.GrayArrowUp],[n.FourCircleLow,n.FourCircleMedium1,n.FourCircleMedium2,n.FourCircleHigh],[n.SignalBarLow,n.SignalBarMedium1,n.SignalBarMedium2,n.SignalBarHigh],[n.FourCircleLow,n.CircleLow,n.CircleMedium,n.CircleHigh],[n.ColoredArrowDown,n.ColoredArrowDownRight,n.ColoredArrowRight,n.ColoredArrowUpRight,n.ColoredArrowUp],[n.GrayArrowDown,n.GrayArrowDownRight,n.GrayArrowRight,n.GrayArrowUpRight,n.GrayArrowUp],[n.SignalBarEmpty,n.SignalBarLow,n.SignalBarMedium1,n.SignalBarMedium2,n.SignalBarHigh],[n.CircleEmpty,n.Circle25,n.CircleHalf,n.Circle75,n.CircleFilled],[n.StarLow,n.StarMedium,n.StarHigh],[n.TriangleLow,n.TriangleMedium,n.TriangleHigh],[n.QuadrantEmpty,n.Quadrant25,n.QuadrantHalf,n.Quadrant75,n.QuadrantFull]],t.IconOutlineWidthPx=1,t.CirclePaddingFromBoundariesPx=2,t.FlagPoleWidth=1,t.MinimalIconPadding=3},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.getReferencedObjectById=function(e,t){var r;switch(e){case n.UniqueStyleID.Default:case n.UniqueStyleID.Hyperlink:r=t[t.length+e];break;default:r=t[e]}if(null===r)throw Error("RefObject is null");if(r.ID!==e)throw Error("RefIDs are not sorted as expected");return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MinAllowedFontSize=1,t.MaxAllowedFontSize=409,t.DefaultFontSizePt=11,t.DefaultFontName="Calibri",t.PointToPixelRatio=4/3,t.LineHeightFontFactor=1.28,t.LineLeading=.06,t.LineHeightUsingDivFontFactor=1+t.LineLeading,t.knownFontNamesLowerCase=["angsananew","arial","arialblack","batang","bookantiqua","browallianew","calibri","cambria","candara","century","comicsansms","consolas","constantia","corbel","cordianew","dilleniaupc","courier","couriernew","dotum","fangsong","garamond","georgia","gulim","gungsuh","kaiti","jasmineupc","malgungothic","mangal","meiryo","microsoftjhengHei","microsoftyahei","mingliu","mingliuhkscs","msgothic","msmincho","mspgothic","mspmincho","pmingliu","pmingliuextb","simhei","simsun","simsunextb","sourcesanspro","tahoma","thsarabunpsk","times","timesnewroman","trebuchetms","verdana","yugothic","yumincho"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(9),l=r(2),a=r(6),u=r(20),d=r(14),s=r(3),c=r(7),g=r(19);function f(e,t){return e>=t.StartIndex&&e<t.EndIndex}function h(e,t){for(var r=0;r<t.length;r++){if(f(e,t[r]))return r}throw Error("Failed to find text run index for textOffsetIndex: "+e)}function m(e,t,r){var n=i.getReferencedObjectById(e.FontID,t);e.ShrunkSize=n.Size*r,e.FontCss=function(e,t){return o.getFontCssStringFromFont(!0,e,t)}(n,e.ShrunkSize),e.WidthPx=e.WidthPx*r}function C(e,t,r){for(var o=0,l=t,a=t;a<e.length;a++){var u=e[a];if(u.Underline===n.FontUnderline.None)break;var d=i.getReferencedObjectById(u.FontID,r);o=Math.max(o,u.ShrunkSize||d.Size),l=a}return{maxFontSize:o,sequenceEndRunIndex:l}}t.fillRichTextFormat=function(e,t,r,f,h,p,y,F){o.verifyArgumentNotNull(f,"cell","fillRichTextFormat"),o.verifyArgumentNotNull(r,"model","fillRichTextFormat"),o.verifyArgumentNotNull(h,"formattedText","fillRichTextFormat");var v=h.TextRuns,w=h.Fonts,S=function(e,t,r,o,d,g){var f=a.getBidiContext(r),h=function(e,t,r,n){var o=a.getTextWidth(e,t,r),l=t.Fonts,u=r.CachedDrawingLayout.TextRunDrawingInformation;if(!u||!n)throw"Unexpected: cachedCellRuns and runs are supposed to be defined";for(var d=0,s=l[0],c=0;c<u.length;c++){var g=u[c],f=i.getReferencedObjectById(g.FontID,l);d=Math.max(d,f.Size),s.Size<d&&(s=f)}return{totalWidth:o,largestFont:s,preparedRuns:u}}(e,t,r,o),p=h.totalWidth,y=h.largestFont,F=h.preparedRuns;f.HasRtl&&u.reorderTextRunsForBidiDrawing(F,d,f);r.CachedStyle.ShrinkToFit&&(p=function(e,t,r,n,o){var l=c.getCellWidth(e,t,!1),u=t.CachedStyle.Indentation||0,d=a.getHorizontalPadding(i.getReferencedObjectById(r[0].FontID,n).Size,t.CachedStyle.HorizontalAlignment,t.CachedFont.Italic,u,!0,0),g=s.getTextDrawingMaxWidth(l,d,a.getTextIconPadding(e,t));if(o<g)return o;for(var f=g/(o+d),h=0,C=0;C<r.length;C++){var p=r[C];m(p,n,f),h+=p.WidthPx}return h}(t,r,F,g,p));l.isRenderFlagEnabled(n.RenderFlags.Underline,t)&&function(e,t){var r=0;for(;r<e.length;){if(e[r].Underline===n.FontUnderline.None)r++;else for(var o=C(e,r,t),i=o.maxFontSize,l=o.sequenceEndRunIndex,u=a.getTextDecorationLineWidth(i);r<=l;r++)e[r].UnderlineWidth=u}}(F,g);return{totalWidth:p,largestFont:y,preparedRuns:F}}(e,r,f,v,h.Text,w),R=S.totalWidth,T=S.largestFont,x=S.preparedRuns,B=o.getCellStyle(f,r);o.verifyArgumentNotNull(B,"cellStyle","fillRichTextFormat"),function(e,t,r,l,u,s,c,f,h,m,C,p,y){var F=e.textAlign,v=e.textBaseline,w=function(e,t,r){var o=0;switch(t){case n.HorizontalAlignment.Left:o=e;break;case n.HorizontalAlignment.Right:o=e-r;break;case n.HorizontalAlignment.Center:o=e-r/2;break;default:throw Error("unexpected context alignment "+t)}return o}(f,l,s),S=function(e,t,r,i){var l=t.CachedStyle.VerticalAlignment,u=a.getFontLineHeight(e.Size,e.FontName,i),d=g.getCachedFontMetrics(o.getFontCssStringFromFont(i,e,void 0),e.FontName,e.Size).baseline;o.verifyArgumentNotNull(d,"textBaselineAdjustY","adjustYForVerticalAlignment");var s=r-d;if(l===n.VerticalAlignment.Center)return s+(u-d)/2;return s}(c,u,h,p);e.textAlign="left",e.textBaseline="alphabetic";for(var R=0;R<m.length;R++){var T=m[R],x=i.getReferencedObjectById(T.FontID,C);e.font=T.FontCss,e.fillStyle=x.Color,e.fillText(T.Text,w,S),(T.Underline!==n.FontUnderline.None||T.Strikethrough)&&d.cacheTextDecorationLayout(t,u,{textPositionX:w,textPositionY:S,textWidth:T.WidthPx,dpr:r,clipRect:y},x,T.UnderlineWidth),w+=T.WidthPx}e.textAlign=F,e.textBaseline=v}(e,r,t,B.HorizontalAlignment,f,R,T,p,y,x,w,l.isRenderFlagEnabled(n.RenderFlags.FontName,r),F)},t.substringFormattedText=function(e,t,r){o.verifyArgumentNotNull(e.Text,"formattedText.Text","substringFormattedText");var n=e.Text.substring(t,r);if(0===n.length)return{Text:n,Fonts:e.Fonts,TextRuns:[]};var i=e.TextRuns;if(o.verifyArgumentNotNull(i,"formattedText.runs","substringFormattedText"),0===i.length)throw Error("Invalid param: formattedText runs.length === 0");!function(e,t){for(var r=0;r<e.length;r++){var n=e[r],o=r<e.length-1?e[r+1].StartIndex:t.Text.length;n.EndIndex=o}}(i,e);var l=h(t,i),a=r&&r<e.Text.length?h(r,i):i.length-1,u=[];u.push({StartIndex:0,FontID:i[l].FontID});for(var d=l+1;d<=a;d++){var s=i[d],c=s.StartIndex-t;u.push({StartIndex:c,FontID:s.FontID})}return{Text:n,Fonts:e.Fonts,TextRuns:u}},t.measureFormattedTextWidth=function(e,t){return a.measureTextRunsWidth(e,t.TextRuns,t.Fonts,t.Text).totalWidth}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircleLowInnerColor="#FF9198",t.CircleLowOuterColor="#D42314",t.CircleMediumInnerColor="#F8DB8F",t.CircleMediumOuterColor="#DE6C00",t.CircleHighInnerColor="#A1DDAA",t.CircleHighOuterColor="#309048",t.CircleFilledInnerColor="#797774",t.CircleFilledOuterColor="#3A3A38",t.CircleEmptyInnerColor="#FAFAFA",t.CircleEmptyOuterColor="#3A3A38",t.FourCircleMedium2InnerColor="#D492D8",t.FourCircleMedium2OuterColor="#922E9B",t.FourCircleMedium1InnerColor="#C8C6C4",t.FourCircleMedium1OuterColor="#3A3A38",t.FourCircleLowOuterColor="#3A3A38",t.FourCircleHighInnerColor="#FF9198",t.FourCircleHighOuterColor="#D42314",t.TrafficHighRimmedRectColor="#3A3A38",t.SignalBarEmptyColor="#FAFAFA",t.SignalBarFilledColor="#83BEEC",t.SignalBarOutlineColor="#3A3A38",t.QuadrantBoxesEmptyColor="#FAFAFA",t.QuadrantBoxesFilledColor="#83BEEC",t.QuadrantBoxesOutlineColor="#3A3A38",t.FlagStickColor="#3A3A38",t.FlagLowOuterColor="#D42314",t.FlagLowInnerColor="#FF9198",t.FlagMediumOuterColor="#DE6C00",t.FlagMediumInnerColor="#F8DB8F",t.FlagHighOuterColor="#309048",t.FlagHighInnerColor="#A1DDAA"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(28),o=r(29),i=r(10);t.getIconSize=function(e,t){return Math.floor(n.approximateValue(e,o.FontSizeToIconSize)*t)},t.getIconHorizontalPadding=function(e,t){return Math.floor(n.approximateValue(e,o.IconHorizontalPadding)*t)},t.pointsToPixels=function(e){return Math.round(e*i.PointToPixelRatio)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(4),i=r(0),l=r(2),a=r(3),u=r(6),d=r(7),s=r(13);function c(e,t,r,o,l){if(i.verifyArgumentNotNull(t,"cell","CacheUnderlineLayout"),i.verifyArgumentNotNull(t.CachedFont,"cell.CachedFont","CacheUnderlineLayout"),i.verifyArgumentNotNull(t.CachedStyle,"cell.CachedStyle","CacheUnderlineLayout"),i.verifyArgumentNotNull(t.CachedDrawingLayout,"cell.CachedDrawingLayout","CacheUnderlineLayout"),o.Underline!==n.FontUnderline.None){var a={underline:o.Underline},u=g(e,t,r,a,o,!1,l),d=t.CachedDrawingLayout.UnderlineRuns;if(u&&d.push(u),f(a)){var s=g(e,t,r,{underline:a.underline===n.FontUnderline.DoubleAccounting?n.FontUnderline.SingleAccounting:n.FontUnderline.Single},o,!0,l);s&&d.push(s)}}if(o.StrikeThrough){var c=g(e,t,r,{strikethrough:!0},o,!1,l);if(c)t.CachedDrawingLayout.StrikethroughRuns.push(c)}}function g(e,t,r,l,a,c,g){var m=r.dpr,C=r.clipRect,p=t.TextRuns?a.Size:i.getActualFontSize(t,e),y=function(e,t,r,o,l,a){var c,g,f,h,m=r.dpr,C=r.textPositionX,p=r.textWidth,y=t.CachedStyle.HorizontalAlignment;if(o.underline===n.FontUnderline.SingleAccounting||o.underline===n.FontUnderline.DoubleAccounting){var F=u.getCellTextHorizontalPaddingWithIcons(t,e);g=d.getCellLeft(e,t,e.BlockWidth)+F,f=d.getCellRight(e,t,e.BlockWidth)-F}else{var v=!!t.TextRuns;c=function(e,t,r,o){var i,l;switch(o?n.HorizontalAlignment.Left:e){case n.HorizontalAlignment.Automatic:case n.HorizontalAlignment.Left:i=t,l=t+r;break;case n.HorizontalAlignment.Right:i=t-r,l=t;break;case n.HorizontalAlignment.Center:i=t-r/2,l=t+r/2;break;default:i=t,l=t+r}return{startX:i,endX:l}}(y,C,p,v),g=c.startX,f=c.endX}h=o.strikethrough?function(e,t,r){var o,l=t.textPositionY;i.verifyArgumentNotNull(e.CachedFont,"cell.CachedFont","calculateStrikethroughY");var a=null===(o=e.CachedStyle)||void 0===o?void 0:o.VerticalAlignment,u=s.pointsToPixels(r)/(e.TextRuns?4:2);switch(a){case n.VerticalAlignment.Center:return l;case n.VerticalAlignment.Bottom:case n.VerticalAlignment.Top:return l-u;default:throw Error("calculateUnderlinePosition: Vertical alignment type not supported!")}}(t,r,l):function(e,t,r,o){var l,a=t.textPositionY;i.verifyArgumentNotNull(e.CachedFont,"cell.CachedFont","calculateUnderlineY");var d=null===(l=e.CachedStyle)||void 0===l?void 0:l.VerticalAlignment,c=null!=o?o:u.getTextDecorationLineWidth(r),g=e.TextRuns?-c:2*c;switch(d){case n.VerticalAlignment.Bottom:case n.VerticalAlignment.Top:return a-g;case n.VerticalAlignment.Center:return a+s.pointsToPixels(r)/2-g;default:throw Error("calculateUnderlinePosition: Vertical alignment type not supported!")}}(t,r,l,a);return g=Math.round(g*m),f=Math.round(f*m),h=Math.round(h*m),{startX:g,endX:f,Y:h}}(e,t,r,l,p,g),F=y.startX,v=y.endX,w=y.Y,S=function(e,t,r){var n=(null!=r?r:u.getTextDecorationLineWidth(t))*e;return Math.max(Math.floor(n),1)}(m,p,g),R=Math.round(o.UnderlineMarginFromTextBaseline*S);(f(l)&&(w+=R),c)&&(w=w-2*S+R);if(!function(e,t,r,n,o,i,l){var a=r.dpr,u=r.clipRect,s=o+n,c=d.getCellTopAdjustedForDrawing(e,t),g=d.getCellBottomAdjustedForDrawing(e,t),f=u?(u.x+u.width)*a:0,h=u?u.x*a:0,m=!1,C=!1;var p=o>=g&&s>=g;u&&(C=i<=h&&l<=h,m=i>=f&&l>=f);return o<=c&&s<=c||p||m||C}(e,t,r,S,w,F,v)){if(C){var T=h(F,v,x=Math.round(C.x*m),Math.round(C.width*m)+x);F=T.start,v=T.end}if(function(e,t,r,n){var i=n+r,l=d.getCellTopAdjustedForDrawing(e,t)+o.GridLineWidthPx,a=d.getCellBottomAdjustedForDrawing(e,t)-o.GridLineWidthPx;return n<=l||i>=a}(e,t,S,w)){var x,B=h(w,w+S,x=d.getCellTopAdjustedForDrawing(e,t),d.getCellBottomAdjustedForDrawing(e,t)-o.GridLineWidthPx);w=B.start,S=B.end-w}return{StartX:F,EndX:v,Y:w,LineWidth:S,Color:a.Color}}}function f(e){return e.underline===n.FontUnderline.Double||e.underline===n.FontUnderline.DoubleAccounting}function h(e,t,r,n){var o=Math.min(e,t),i=Math.max(e,t),l=Math.min(r,n),a=Math.max(r,n);return{start:Math.max(o,l),end:Math.min(i,a)}}function m(e,t){if(0!==t.LineWidth){var r=t.Y+i.getLinePixelTranslation(t.LineWidth);!function(e,t,r,n){e.moveTo(t,n),e.lineTo(r,n)}(e,t.StartX,t.EndX,r)}}t.measureAndCacheTextDecorationLayout=function(e,t,r,o){var i=l.isRenderFlagEnabled(n.RenderFlags.Underline,t)&&r.CachedFont.Underline,a=l.isRenderFlagEnabled(n.RenderFlags.Strikethrough,t)&&r.CachedFont.StrikeThrough;(i||a)&&(o.textWidth=u.getTextWidth(e,t,r),c(t,r,o,r.CachedFont))},t.cacheTextDecorationLayout=c,t.drawTextDecoration=function(e,t,r){if(l.isRenderFlagEnabled(n.RenderFlags.Underline,t)||l.isRenderFlagEnabled(n.RenderFlags.Strikethrough,t)){var o,u;i.verifyArgumentNotNull(t.Cells,"model.cells","drawTextDecoration"),e.beginPath();for(var d=l.isRenderFlagEnabled(n.RenderFlags.LargeBlocks,t),s=r.highContrastScheme?a.rgbToColorHex(r.highContrastScheme.TextColor):void 0,c=0;c<t.Cells.length;c++){var g=t.Cells[c];if((!d||a.cellIntersectsRenderingRegion(g,r.renderingRegion))&&(i.verifyArgumentNotNull(g.CachedFont,"cell.CachedFont","drawTextDecoration"),g.CachedFont.StrikeThrough||g.CachedFont.Underline||g.TextRuns)){i.verifyArgumentNotNull(g.CachedDrawingLayout,"cell.CachedDrawingLayout","drawTextDecoration");for(var f=0,h=[g.CachedDrawingLayout.UnderlineRuns,g.CachedDrawingLayout.StrikethroughRuns];f<h.length;f++){var C=h[f];if(C&&C.length>0){if(!o||!u){var p=C[0];o=F=null!=s?s:p.Color,u=p.LineWidth,e.strokeStyle=F,e.lineWidth=p.LineWidth}for(var y=0;y<C.length;y++){var F,v=C[y],w=o!==(F=null!=s?s:v.Color),S=u!==v.LineWidth;(w||S)&&(o=F,u=v.LineWidth,e.stroke(),e.strokeStyle=F,e.lineWidth=v.LineWidth,e.beginPath()),m(e,v)}}}}}e.stroke()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(5),l=r(4),a=r(0),u=r(21),d=r(2),s=r(31),c=r(7),g={},f={};function h(e){a.verifyArgumentNotNull(e,"model","validateModel"),a.verifyArgumentNotNull(e.Cells,"model.Cells","validateModel"),a.verifyArgumentNotNull(e.RowOffsets,"model.RowOffsets","validateModel"),a.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","validateModel"),a.verifyArgumentNotNull(e.RowHeights,"model.RowHeights","validateModel"),a.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","validateModel")}function m(e,t){return{BorderLineStyle:n.BorderLineType.Thin,Color:t,Weight:l.ThinBorderWeight,BorderPosition:e}}function C(e,t,r,n,o,i){var l=F(e,t,r.BorderPosition,n),a=x(r);a in i||(o.push(r),i[a]=[]),i[a].push(l)}function p(e,t,r,n,o){var i=[],a="",d=l.ThinBorderWeight;!function(e){e.strokeStyle="#000000",e.setLineDash([]),e.lineWidth=l.ThinBorderWeight}(e),e.beginPath();for(var s=0;s<t.length;s++){var c=t[s],g=o||T(c.Color),f=B(c.BorderLineStyle),h=d!==c.Weight*n,m=a!==g,C=!u.areArraysEqual(i,f,[]).isEqual;(h||m||C)&&(e.stroke(),e.beginPath(),h&&(d=c.Weight*n,e.lineWidth=d),m&&(a=g,e.strokeStyle=g),C&&(e.setLineDash(f),i=f));for(var p=r[x(c)],F=0;F<p.length;F++){var v=p[F];y(e,c.Weight,v,n)}}e.stroke()}function y(e,t,r,n){!function(e){return e.Y1===e.Y2}(r)?o.drawLine(e,R(r.X1,t,n),r.Y1-n,R(r.X2,t,n),r.Y2):o.drawLine(e,r.X1-n,R(r.Y1,t,n),r.X2,R(r.Y2,t,n))}function F(e,t,r,o){if(!e.IsRtl)return v(r,{X:c.getCellLeftAdjustedForDrawing(e,t,!1),Y:c.getCellTopAdjustedForDrawing(e,t)},{X:c.getCellRightAdjustedForDrawing(e,t)+o,Y:c.getCellBottomAdjustedForDrawing(e,t)});var i=v(r,{X:c.getCellRightAdjustedForDrawing(e,t)+o,Y:c.getCellTopAdjustedForDrawing(e,t)},{X:c.getCellLeftAdjustedForDrawing(e,t,!1),Y:c.getCellBottomAdjustedForDrawing(e,t)});if(r===n.BorderPositionType.Top||r===n.BorderPositionType.Bottom){var l=i.X2;i.X2=i.X1,i.X1=l}return i}function v(e,t,r){switch(e){case n.BorderPositionType.Top:return{X1:t.X,Y1:t.Y,X2:r.X,Y2:t.Y};case n.BorderPositionType.Bottom:return{X1:t.X,Y1:r.Y,X2:r.X,Y2:r.Y};case n.BorderPositionType.Right:return{X1:r.X,Y1:t.Y,X2:r.X,Y2:r.Y};case n.BorderPositionType.Left:return{X1:t.X,Y1:t.Y,X2:t.X,Y2:r.Y};default:throw Error("borders::getLineCoordinates Encountered non default BorderPositionType value="+e)}}function w(e){switch(e){case n.BorderLineType.Thin:case n.BorderLineType.Medium:case n.BorderLineType.Hair:case n.BorderLineType.Thick:return!0;default:return!1}}function S(e,t,r){var o;return r.Row===t.RowNumbers.length-1||r.Col===t.ColumnNumbers.length-1||(r.Merge||a.isCellAdjacentToMergedCell(r.Row,r.Col,t)||(null===(o=r.FormulaInfo)||void 0===o?void 0:o.HasError)?b(e):e===n.BorderPositionType.Top||e===n.BorderPositionType.Left)}function R(e,t,r){var n=a.getLinePixelTranslation(r);return t===l.MediumBorderWeight&&r%2==1?e:e-n}function T(e){var t=e.Red+"_"+e.Green+"_"+e.Blue,r=g[t];return i.isNullOrUndefined(r)?(r="rgb("+e.Red+","+e.Green+","+e.Blue+")",g[t]=r,r):r}function x(e){return T(e.Color)+"-"+e.Weight+"-"+e.BorderLineStyle}function B(e){var t=f[e];if(!i.isNullOrUndefined(t))return t;switch(e){case n.BorderLineType.Dotted:t=l.DottedLineDash;break;case n.BorderLineType.DashDot:case n.BorderLineType.MediumDashDot:t=l.DashedDotLineDash;break;case n.BorderLineType.DashDotDot:case n.BorderLineType.MediumDashDotDot:t=l.DashedDotDotLineDash;break;case n.BorderLineType.MediumDashed:t=l.MediumDashedLineDash;break;case n.BorderLineType.SlantDashDot:case n.BorderLineType.Dashed:t=l.DashedLineDash;break;default:t=[]}return f[e]=t,t}function D(e){var t;return(null===(t=e.FormulaInfo)||void 0===t?void 0:t.HasError)?l.FormulaErrorBorderStyle:e.CachedBorderStyle}function b(e){return e<=n.BorderPositionType.Right}t.clearGridLinesForBorder=function(e,t,r){if(t.ShowGridLines&&o.shouldRenderGridLines(a.isHighContrastMode(r),a.hasWorkbookBackgroundColor(t.BackgroundColor,d.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)))){h(t),s.setContextForClearingGridLine(e,r,t.BackgroundColor,d.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t));var i=t.Cells,u=d.isRenderFlagEnabled(n.RenderFlags.LargeBlocks,t);e.beginPath();for(var c=0;c<i.length;c++){var g=i[c],f=D(g);if((!u||o.cellIntersectsRenderingRegion(g,r.renderingRegion))&&(f&&f.Borders&&0!==f.Borders.length&&!g.CachedStyle.BackgroundColor))for(var m=f.Borders,C=0;C<m.length;C++){var p=m[C];p.BorderLineStyle!==n.BorderLineType.None&&(w(p.BorderLineStyle)||S(p.BorderPosition,t,g)&&y(e,l.ThinBorderWeight,F(t,g,p.BorderPosition,l.GridLineWidthPx),l.GridLineWidthPx))}}e.stroke()}},t.drawBorders=function(e,t,r){h(t);var i,l,u=o.getDefaultBorderLineWidth(r.devicePixelRatio),s=a.getWorkbookBackgroundColor(r.highContrastScheme,t.BackgroundColor,d.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)),c=function(e,t,r,i){for(var l={},a=[],u=[],s={},c=e.Cells,g=d.isRenderFlagEnabled(n.RenderFlags.LargeBlocks,e),f=0;f<c.length;f++){var h=c[f],p=D(h);if((!g||o.cellIntersectsRenderingRegion(h,i.renderingRegion))&&(p&&p.Borders&&0!==p.Borders.length))for(var y=p.Borders,F=0;F<y.length;F++){var v=y[F];if(v.BorderLineStyle!==n.BorderLineType.None&&S(v.BorderPosition,e,h)){if(v.BorderLineStyle===n.BorderLineType.Double){var w=h.CachedStyle.BackgroundColor?o.hexToRgb(h.CachedStyle.BackgroundColor):r,R=m(v.BorderPosition,w);C(e,h,R,t,u,s)}C(e,h,v,t,a,l)}}}return{distinctBorderTypes:a,borderTypeToLineMap:l,distinctClearingDoubleBorderTypes:u,clearingDoubleBordersToLineMap:s}}(t,u,o.hexToRgb(s),r);r.highContrastScheme?(l=o.rgbToColorHex(r.highContrastScheme.TextColor),i=o.rgbToColorHex(r.highContrastScheme.BackgroundColor),p(e,c.distinctBorderTypes,c.borderTypeToLineMap,u,l),p(e,c.distinctClearingDoubleBorderTypes,c.clearingDoubleBordersToLineMap,u,i)):(p(e,c.distinctBorderTypes,c.borderTypeToLineMap,u,void 0),p(e,c.distinctClearingDoubleBorderTypes,c.clearingDoubleBordersToLineMap,u,void 0))},t.getBorderPriorityByLineStyle=function(e){switch(e){case n.BorderLineType.Thick:return 1;case n.BorderLineType.Medium:return 2;case n.BorderLineType.MediumDashed:return 3;case n.BorderLineType.MediumDashDot:return 4;case n.BorderLineType.Thin:return 5;case n.BorderLineType.Dashed:return 6;case n.BorderLineType.Dotted:return 7;case n.BorderLineType.DashDot:return 9;case n.BorderLineType.DashDotDot:return 10;case n.BorderLineType.Hair:return 11;case n.BorderLineType.Double:default:return 12}},t.cellHasBottomDoubleBorder=function(e,t){a.verifyArgumentNotNull(e,"cell","cellHasBottomDoubleBorder");var r=a.getCell(e.Row+1,e.Col,t);if(i.isNullOrUndefined(r)||i.isNullOrUndefined(r.CachedBorderStyle)||i.isNullOrUndefined(r.CachedBorderStyle.Borders))return!1;for(var o=r.CachedBorderStyle.Borders,l=0;l<o.length;l++){var u=o[l];if(u.BorderPosition===n.BorderPositionType.Top&&u.BorderLineStyle===n.BorderLineType.Double)return!0}return!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8);t.drawRectangleIcon=function(e,t,r,i){n.verifyArgumentNotNull(e,"ctx","drawRectangleIcon"),n.verifyArgumentNotNull(t,"model","drawRectangleIcon"),n.verifyArgumentNotNull(r,"cell","drawRectangleIcon"),n.verifyArgumentNotNull(i,"drawingContext","drawRectangleIcon");var l=i.innerColor,a=i.outerColor,u=i.left,d=i.bottom,s=i.height,c=i.width;(function(e,t,r,n,o,i){e.strokeStyle=i,e.beginPath(),e.rect(t,r,n,o),e.stroke()})(e,u+.5,d-s-.5,c,s,a),l&&function(e,t,r,n,o,i){e.fillStyle=i,e.beginPath(),e.fillRect(t,r,n,o),e.fill()}(e,u+o.IconOutlineWidthPx,d-s,c-o.IconOutlineWidthPx,s-o.IconOutlineWidthPx,l)}},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return l})),r.d(t,"__decorate",(function(){return a})),r.d(t,"__param",(function(){return u})),r.d(t,"__metadata",(function(){return d})),r.d(t,"__awaiter",(function(){return s})),r.d(t,"__generator",(function(){return c})),r.d(t,"__exportStar",(function(){return g})),r.d(t,"__values",(function(){return f})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return m})),r.d(t,"__spreadArrays",(function(){return C})),r.d(t,"__await",(function(){return p})),r.d(t,"__asyncGenerator",(function(){return y})),r.d(t,"__asyncDelegator",(function(){return F})),r.d(t,"__asyncValues",(function(){return v})),r.d(t,"__makeTemplateObject",(function(){return w})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return R})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function l(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function a(e,t,r,n){var o,i=arguments.length,l=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(i<3?o(l):i>3?o(t,r,l):o(t,r))||l);return i>3&&l&&Object.defineProperty(t,r,l),l}function u(e,t){return function(r,n){t(r,n,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function s(e,t,r,n){return new(r||(r=Promise))((function(o,i){function l(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,a)}u((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,o,i,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,n=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(o=l.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function g(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)l.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return l}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],l=0,a=i.length;l<a;l++,o++)n[o]=i[l];return n}function p(e){return this instanceof p?(this.v=e,this):new p(e)}function y(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},l("next"),l("throw"),l("return"),n[Symbol.asyncIterator]=function(){return this},n;function l(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=o[e](t)).value instanceof p?Promise.resolve(r.value.v).then(u,d):s(i[0][2],r)}catch(e){s(i[0][3],e)}var r}function u(e){a("next",e)}function d(e){a("throw",e)}function s(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function F(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:p(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=f(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function R(e){return e&&e.__esModule?e:{default:e}}function T(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function x(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[],o=l()?window.performance:void 0,i=void 0;function l(){if(i)return i;i=!1,window.performance&&"function"==typeof window.performance.now&&(i=!0);try{window.performance.now()}catch(e){i=!1}return i}t.verifyPerformanceNowSupported=l,t.createRenderResult=function(e,t){return{succeeded:e,message:t,performance:n}},t.clearPerformanceMetrics=function(){n=[]},t.trackDuration=function(e,t,r){var i=o?o.now():-1;if(t(),o){var l=o.now()-i;r?n[e]+=l:n[e]=l}},function(e){e[e.DrawGridlinesDurationMs=0]="DrawGridlinesDurationMs",e[e.DrawTextDurationMs=1]="DrawTextDurationMs",e[e.ClearDurationMs=2]="ClearDurationMs",e[e.RenderBlockInternalDurationMs=3]="RenderBlockInternalDurationMs",e[e.ModelPreparationsMs=4]="ModelPreparationsMs",e[e.ClearRectDurationMs=5]="ClearRectDurationMs",e[e.FillRectDurationMs=6]="FillRectDurationMs",e[e.GetContextDurationMs=7]="GetContextDurationMs",e[e.DrawSpillCellsDurationMs=8]="DrawSpillCellsDurationMs",e[e.DrawBackgroundFillMs=9]="DrawBackgroundFillMs",e[e.ClearGridlinesMs=10]="ClearGridlinesMs",e[e.ClearGridlinesForBorderMs=11]="ClearGridlinesForBorderMs",e[e.ClearGridLinesForSpannedCellsMs=12]="ClearGridLinesForSpannedCellsMs",e[e.DrawBordersMs=13]="DrawBordersMs",e[e.DrawTextDecoration=14]="DrawTextDecoration",e[e.GetFontMetrics=15]="GetFontMetrics",e[e.DrawCFIconsMs=16]="DrawCFIconsMs"}(t.RenderPerformanceMetric||(t.RenderPerformanceMetric={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(18),o=r(10),i=document.createElement("div"),l=document.createElement("img");i.innerText=".",i.style.visibility="hidden",i.appendChild(l),document.body.appendChild(i);var a={"11pt Calibri":{height:18,baseline:4}};function u(e){var t=-1,r=-1,o=l;return i.style.font=e,i.style.font=e,o.style.verticalAlign="baseline",n.trackDuration(n.RenderPerformanceMetric.GetFontMetrics,(function(){t=i.clientHeight,r=function(e){var t=i.getBoundingClientRect().bottom,r=e.getBoundingClientRect().bottom;return t-r}(o)}),!0),{height:t,baseline:r}}t.getCachedFontMetrics=function(e,t,r){var n=a[e];if(n)return n;var l=u(e);if(0===l.height){var d="Custom Font";o.knownFontNamesLowerCase.includes(t.replace(/\s/g,"").toLowerCase())&&(d=t);var s=null!==i.parentNode?"Has Parent":"Parent is null",c="none"===window.getComputedStyle(i).getPropertyValue("display");document.body.appendChild(i);var g=u(e),f="none"===window.getComputedStyle(i).getPropertyValue("display");if(0!==g.height)return a[e]=g,g;throw Error("fontMetricsDivHeight == 0. font name: "+d+", font size: "+r+". fontMetricsDiv "+s+". fontMetricsDivDisplayIsNone: "+c+". After another appendChild: fontMetricsDivHeight2: "+g.height+" (getFontMetricsDivHeight), fontMetricsDivDisplayIsNone: "+f+" (getComputedStyle)")}return a[e]=l,a[e]},t.recalculateFontHeights=function(){for(var e=Object.getOwnPropertyNames(a),t=0;t<e.length;t++){var r=e[t];a[r]=u(r)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0);function i(e,t){var r=[u(e,0)];if(1===t.length)return r;for(var n=void 0,o=0;o<t.length;o++){if(d(t[o])){l(o,n)&&r.push(u(e,o));var i=o+1;a(i,t.length)&&r.push(u(e,i)),n=o}}return r}function l(e,t){return e>0&&!(e-1===t)}function a(e,t){return e<t}function u(e,t){return{FontID:e.FontID,StartIndex:e.StartIndex+t}}function d(e){return" "===e||'"'===e||"'"===e||"."===e||"?"===e||":"===e||";"===e||"-"===e||","===e||"!"===e||"("===e||")"===e}function s(e){var t=e.charCodeAt(0);return t>=1424&&t<=1535||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=64336&&t<=65023||t>=65136&&t<=65279||t>=1984&&t<=1792||t>=1792&&t<=1871||t>=1920&&t<=1983||t>=11568&&t<=11647}t.analyzeBidiText=function(e,t){for(var r=!1,o=!1,i=0;i<e.length;i++){if(s(e[i])?r=!0:o=!0,o&&r)break}return{HasLtr:o,HasRtl:r,HasBidi:o&&r,BaseDir:function(e,t){switch(t){case n.ReadingOrderType.LeftToRight:return"ltr";case n.ReadingOrderType.RightToLeft:return"rtl";case n.ReadingOrderType.Context:return s(e[0])?"rtl":"ltr"}}(e,t)}},t.prepareTextRunsForBidiLayout=function(e,t){for(var r=[],n=0;n<e.length;n++){var l=i(e[n],o.getTextRunText(n,e,t));r.push.apply(r,l)}return r},t.reorderTextRunsForBidiDrawing=function(e,t,r){if(!r.HasRtl||r.HasLtr){var n=document.createElement("div");n.style.visibility="hidden",n.style.direction=r.BaseDir,n.style.position="absolute";for(var i=0;i<e.length;i++){var l=o.getTextRunText(i,e,t),a=document.createElement("span");a.innerText=l,a.setAttribute("rid",i.toString()),n.appendChild(a)}document.body.appendChild(n);for(var u=0;u<n.children.length;u++){var d=n.children[u],s=d.getAttribute("rid");if(!s)throw Error("reorderTextRunsForBidiDrawing: runIndexAttr is undefined");var c=d.getBoundingClientRect().left;e[i=parseInt(s,10)].OffsetX=c}e.sort((function(e,t){return e.OffsetX-t.OffsetX})),document.body.removeChild(n)}else e.reverse()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(30),i=r(2),l=o.comparisonIgnoreLists.GridBlockModel.concat(["Cells"]),a=o.comparisonIgnoreLists.Cell,u=a.concat(["Text"]),d=o.comparisonIgnoreLists.CellStyle.concat(o.comparisonIgnoreLists.ReferencedObject);function s(e,t,r,n){e.CachedStyle=i.getReferencedObjectToCache(e.StyleID,r.Styles),t.CachedStyle=i.getReferencedObjectToCache(t.StyleID,n.Styles),e.CachedBorderStyle=i.getReferencedObjectToCache(e.BorderStyleID,r.BorderStyles),t.CachedBorderStyle=i.getReferencedObjectToCache(t.BorderStyleID,n.BorderStyles),e.CachedFont=i.getReferencedObjectToCache(e.CachedStyle.FontID,r.Fonts),t.CachedFont=i.getReferencedObjectToCache(t.CachedStyle.FontID,n.Fonts);var o=g(e,t,function(e){return e?u:a}(i.isAccAndCustomNumFmtApplicable(e,r)&&i.isAccAndCustomNumFmtApplicable(t,n)));return o.isEqual||(o.message+="\nareCellsEqual: cell1.Row = "+e.Row+", cell1.Col = "+e.Col+", cell2.Row = "+t.Row+", cell2.Col = "+t.Col),o}function c(e,t,r){if(e===t)return{isEqual:!0};if(void 0===e&&void 0===t)return{isEqual:!0};if(void 0===e||void 0===t)return void 0===e?{isEqual:!1,message:"areArraysEqual: the first array is undefined."}:{isEqual:!1,message:"areArraysEqual: the second array is undefined."};if(e.length!==t.length)return{isEqual:!1,message:"areArraysEqual: arrays length are different. length1: "+e.length+", length2: "+t.length};for(var n=0;n<e.length;n++){var o=g(e[n],t[n],r);if(!o.isEqual)return o.message+="\nareArraysEqual: array objects are different. index: "+n,o}return{isEqual:!0}}function g(e,t,r){if(e===t)return{isEqual:!0};if(n.isNullOrUndefined(e)&&n.isNullOrUndefined(t))return{isEqual:!0};if(null==e||null==t)return{isEqual:!1,message:"areObjectsEqual: one object is null, o1 = "+!e+", o2 = "+!t};if(e!=e)return{isEqual:t!=t,message:"areObjectsEqual: NaN comparison"};var o=function(e,t){if(!e||!t)return e||t;var r=t.filter((function(t){return-1===e.indexOf(t)}));return e.concat(r)}(f(e,r),f(t,r));if(0===o.length)return{isEqual:e===t,message:"areObjectsEqual: simple object comparison"};for(var i=0;i<o.length;i++){var l=o[i],a=e[l],u=t[l],d=typeof a,s=typeof u;if(!n.isNullOrUndefined(a)||!n.isNullOrUndefined(u)){if(d!==s){if(h(a)&&h(u))continue;return{isEqual:!1,message:"areObjectsEqual: object types are different. propName = "+l+" type1 = "+d+", type2 = "+s}}switch(d){case"undefined":case"boolean":case"string":case"number":if(a!==u)return{isEqual:!1,message:"areObjectsEqual: simple types comparison, propertyName = "+l};break;case"object":if(a instanceof Array){if(!(u instanceof Array))return{isEqual:!1,message:"areObjectsEqual: array 2 is not an array, propertyName = "+l};if(!(C=c(a,u,m(l))).isEqual)return C.message+="\nareObjectsEqual: arrays mismatch, propertyName = "+l,C}else{var C;if(!(C=g(a,u,m(l))).isEqual)return C.message+="\nareObjectsEqual: objects mismatch, propertyName = "+l,C}break;default:return{isEqual:!1,message:"areObjectsEqual: unexpected type: "+d+", propertyName = "+l}}}}return{isEqual:!0}}function f(e,t){if("object"!=typeof e)return[];var r=Object.getOwnPropertyNames(e);return t?r.filter((function(e){return-1===t.indexOf(e)})):r}function h(e){return null==e||""===e}function m(e){var t=o.propertyToClassMap[e];if(t){for(var r=[],n=0;n<t.length;n++)r=r.concat(o.comparisonIgnoreLists[t[n]]);return r}}t.areGridBlockModelsEqual=function(e,t){var r=g(e,t,l);return r.isEqual&&(r=function(e,t,r,n){if(e===t)return{isEqual:!0};if(e.length!==t.length)return{isEqual:!1,message:"areModelCellsEqual: Cells arrays length are different. length1: "+e.length+", length2: "+t.length};if(!r||!n)return{isEqual:!1,message:"areModelCellsEqual: one or more model is null: model1: "+!r+", model2: "+!n};for(var o=0;o<e.length;o++){var i=e[o],l=t[o],a=s(i,l,r,n);if(!a.isEqual)return a}return{isEqual:!0}}(e.Cells,t.Cells,e,t)),r},t.areCellsEqual=s,t.areStylesEqual=function(e,t){return g(e,t,d)},t.areArraysEqual=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(18),o=r(21),i=r(34),l=r(6),a=r(54),u=function(){function e(){}return e.lookupPerfMetricName=function(e){return n.RenderPerformanceMetric[e]},e.measureTextWidth=function(t,r,n){var o=e.canvasInstance().getContext("2d");if(!o)throw Error("calculateTextWidth: ctx is undefined");return o.font=r,l.measureTextWidth(o,t,n)},e.compareGridBlockModels=function(e,t){return o.areGridBlockModelsEqual(e,t)},e.serializeCell=function(e,t){return i.serializeCell(e,t)},e.registerActionOnFontLoad=function(e,t,r){a.registerActionOnFontLoadIfRequired(e,t,r)},e.canvasInstance=function(){return e.canvas||(e.canvas=document.createElement("canvas")),e.canvas},e}();t.GridBlockRendererGlobals=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(17);n.__exportStar(r(37),t),n.__exportStar(r(25),t),n.__exportStar(r(24),t),n.__exportStar(r(22),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(25),o=r(62),i=r(0),l=function(){function e(){}return e.prototype.getModelAccessor=function(e){return i.verifyArgumentNotNull(e,"model","GridBlockRendererFactory.getModelAccessor"),new o.GridBlockModelAccessor(e)},e.prototype.getGridBlockRenderer=function(){return new n.GridBlockRenderer},e}();t.GridBlockRendererFactory=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(26),i=r(42),l=r(43),a=r(18),u=r(44),d=r(45),s=r(9),c=r(3),g=r(51),f=r(0),h=r(5),m=r(2),C=r(15),p=r(31),y=r(33),F=r(14),v=r(55),w=r(10),S=r(56),R=function(){function e(){}return e.prototype.renderBlock=function(e,t,r){var n=this;if(a.clearPerformanceMetrics(),!e)return a.createRenderResult(!1,"renderBlock:: canvas is undefined");if(!t)return a.createRenderResult(!1,"renderBlock:: model is undefined");if(!r)return a.createRenderResult(!1,"renderBlock:: context is undefined");if(!u.isCanvasElement(e))return a.createRenderResult(!1,"renderBlock:: canvas is not HTMLCanvasElement");var o,i=null;return a.trackDuration(a.RenderPerformanceMetric.GetContextDurationMs,(function(){i=e.getContext("2d",{alpha:!r.subPixelRenderingEnabled})})),i?(a.trackDuration(a.RenderPerformanceMetric.ModelPreparationsMs,(function(){n.initializeCachedObjects(t),n.createOffsetsForDrawing(t,r.devicePixelRatio),n.updateCellsBeforeDrawing(i,t,r.devicePixelRatio)})),a.trackDuration(a.RenderPerformanceMetric.RenderBlockInternalDurationMs,(function(){o=n.renderBlockInternal(e,i,t,r)})),t.IsDirty=!1,o):a.createRenderResult(!1,"renderBlock:: ctx is undefined")},e.prototype.renderBlockInternal=function(t,r,u,s){try{var c=s.devicePixelRatio,f=0,h=0,y=r.canvas.width;if(m.isRenderFlagEnabled(n.RenderFlags.LargeBlocks,u)){this.validateRenderingRegion(s.renderingRegion,u),y=Math.round(u.BlockWidth*c);var v=s.renderingRegion;h=-1*v.startOffsetY*c,f=this.getDrawingOffsetXForRenderingRegion(u,v)*c}return e.clearCanvas(r,u,t.width,t.height,s),e.setTransform(r,1,u.IsRtl,f,h,y),a.trackDuration(a.RenderPerformanceMetric.DrawGridlinesDurationMs,(function(){return o.drawGridLines(r,u,s)})),a.trackDuration(a.RenderPerformanceMetric.ClearGridlinesMs,(function(){a.trackDuration(a.RenderPerformanceMetric.ClearGridLinesForSpannedCellsMs,(function(){p.clearGridLinesForSpannedCells(r,u,s)}))})),e.setTransform(r,1,!1,f,h,y),a.trackDuration(a.RenderPerformanceMetric.DrawBackgroundFillMs,(function(){return g.drawBackgroundFill(r,u,s)})),m.isRenderFlagEnabled(n.RenderFlags.CFIcons,u)&&a.trackDuration(a.RenderPerformanceMetric.DrawCFIconsMs,(function(){return S.drawConditionalFormattingIcons(r,u,s)})),a.trackDuration(a.RenderPerformanceMetric.ClearGridlinesForBorderMs,(function(){C.clearGridLinesForBorder(r,u,s)})),a.trackDuration(a.RenderPerformanceMetric.DrawBordersMs,(function(){return C.drawBorders(r,u,s)})),s.debugMode&&l.addWatermark(r,c),e.setTransform(r,c,!1,f,h,y),a.trackDuration(a.RenderPerformanceMetric.DrawTextDurationMs,(function(){return d.drawCellsText(r,u,s)})),e.setTransform(r,1,!1,f,h,y),s.skeletonMode&&i.drawSkeleton(r,u,s),a.trackDuration(a.RenderPerformanceMetric.DrawTextDecoration,(function(){return F.drawTextDecoration(r,u,s)})),a.createRenderResult(!0,"finished rendering.")}catch(e){return a.createRenderResult(!1,"exception caught in renderBlockInternal: message: "+e.message+" name: "+e.name+" stack: "+e.stack+" error: "+e)}},e.clearCanvas=function(e,t,r,o,i){i.subPixelRenderingEnabled||f.hasWorkbookBackgroundColor(t.BackgroundColor,m.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t))?a.trackDuration(a.RenderPerformanceMetric.FillRectDurationMs,(function(){e.fillStyle=f.getWorkbookBackgroundColor(i.highContrastScheme,t.BackgroundColor,m.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)),e.fillRect(0,0,r,o)})):a.trackDuration(a.RenderPerformanceMetric.ClearRectDurationMs,(function(){e.clearRect(0,0,r,o)}))},e.setTransform=function(e,t,r,n,o,i){r?e.setTransform(-t,0,0,t,i+n,o):e.setTransform(t,0,0,t,n,o)},e.prototype.initializeCachedObjects=function(e){f.verifyArgumentNotNull(e.Cells,"cells","GridBlockRenderer.cacheRefObjects"),f.verifyArgumentNotNull(e.Styles,"styles","GridBlockRenderer.cacheRefObjects"),f.verifyArgumentNotNull(e.Fonts,"fonts","GridBlockRenderer.cacheRefObjects");for(var t=!h.isNullOrUndefined(e.BorderStyles),r=0;r<e.Cells.length;r++){var n=e.Cells[r];n.CachedStyle=s.getReferencedObjectById(n.StyleID,e.Styles),t&&!h.isNullOrUndefined(n.BorderStyleID)&&(n.CachedBorderStyle=s.getReferencedObjectById(n.BorderStyleID,e.BorderStyles)),n.CachedFont=s.getReferencedObjectById(n.CachedStyle.FontID,e.Fonts),n.CachedDrawingLayout={UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}}}},e.prototype.updateCellsBeforeDrawing=function(e,t,r){var o=t.Cells;f.verifyArgumentNotNull(o,"cells","GridBlockRenderer.updateCellsBeforeDrawing");for(var i=0;i<o.length;i++){var l=o[i],a=l.CachedFont.Italic,u=l.CachedFont.FontName!==w.DefaultFontName,d=l.TextRuns&&m.isRenderFlagEnabled(n.RenderFlags.RichTextFormat,t),s=l.CachedFont.Underline!==n.FontUnderline.None&&m.isRenderFlagEnabled(n.RenderFlags.Underline,t)||l.CachedFont.StrikeThrough&&m.isRenderFlagEnabled(n.RenderFlags.Strikethrough,t);l.Text&&m.isRenderFlagEnabled(n.RenderFlags.NumFmtAccountingAndCustom,t)&&(l.CachedDisplayText=l.Text),m.isRenderFlagEnabled(n.RenderFlags.MeasureTextRefactor,t)?(l.Text&&f.cellHasShrinkToFit(l,t)&&v.updateCellShrinkToFit(e,t,l),(a||u||s||d)&&y.updateCellSpill(e,t,l)):((a||u||s||d)&&y.updateCellSpill(e,t,l),l.Text&&f.cellHasShrinkToFit(l,t)&&v.updateCellShrinkToFit(e,t,l)),l.Merge&&this.updateCellMergeInformation(t,l,r)}},e.prototype.createOffsetsForDrawing=function(e,t){var r=e.RowHeights,n=e.ColumnWidths,o=e.RowOffsets,i=e.ColumnOffsets;f.verifyArgumentNotNull(r,"rowHeights","GridBlockRenderer.createOffsetsForDrawing"),f.verifyArgumentNotNull(n,"colWidths","GridBlockRenderer.createOffsetsForDrawing"),f.verifyArgumentNotNull(o,"rowOffsets","GridBlockRenderer.createOffsetsForDrawing"),f.verifyArgumentNotNull(i,"colOffsets","GridBlockRenderer.createOffsetsForDrawing"),e.RowOffsetsAdjustedForDrawing=[];for(var l=0;l<o.length;l++){var a=o[l];e.RowOffsetsAdjustedForDrawing.push(Math.round(a*t))}e.ColOffsetsAdjustedForDrawing=[];for(l=0;l<i.length;l++){a=i[l];e.ColOffsetsAdjustedForDrawing.push(Math.round(a*t))}e.RowOffsetsAdjustedForDrawing.push(c.getBlockDimensionsAdjustedForDrawing(e.BlockHeight,t)),e.ColOffsetsAdjustedForDrawing.push(c.getBlockDimensionsAdjustedForDrawing(e.BlockWidth,t))},e.prototype.updateCellMergeInformation=function(e,t,r){var n=t.Merge;if(n.SpansBlocks){n.HeightAdjustedForDrawing=Math.round(n.Height*r),n.WidthAdjustedForDrawing=Math.round(n.Width*r),n.OriginDeltaXAdjustedForDrawing=Math.round(n.OriginDeltaX*r),n.OriginDeltaYAdjustedForDrawing=Math.round(n.OriginDeltaY*r);var o=e.RowOffsets[t.Row]-n.OriginDeltaY;n.SpansNextBlockVertically=o+n.Height>e.BlockHeight;var i=e.ColumnOffsets[t.Col]-n.OriginDeltaX;n.SpansNextBlockHorizontally=i+n.Width>e.BlockWidth}},e.prototype.getDrawingOffsetXForRenderingRegion=function(e,t){return e.IsRtl?t.endOffsetX-e.BlockWidth:-1*t.startOffsetX},e.prototype.validateRenderingRegion=function(e,t){f.verifyArgumentNotNull(e,"renderingRegion","validateRenderingRegion");var r=t.RowOffsets[e.startRow],n=t.RowOffsets[e.endRow]+t.RowHeights[e.endRow],o=t.ColumnOffsets[e.startColumn],i=t.ColumnOffsets[e.endColumn]+t.ColumnWidths[e.endColumn];if(r>e.startOffsetY||n<e.endOffsetY)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetY= "+e.startOffsetY+", endOffsetY = "+e.endOffsetY+", firstRowStartOffset= "+r+", lastRowEndOffset= "+n);if(o>e.startOffsetX||i<e.endOffsetX)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetX= "+e.startOffsetX+", endOffsetX = "+e.endOffsetX+", firstColumnStartOffset= "+o+", lastColumnEndOffset= "+i)},e}();t.GridBlockRenderer=R},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(4),i=r(3),l=r(0),a=r(2),u=r(5);function d(e,t,r){var n=Math.round(e*t)-o.GridLineWidthPx/2;if(r&&i.isSafari()){var l=window?window.devicePixelRatio:-1;2===l&&t===l/2&&(n-=1)}return n}function s(e,t,r,n){var o=e+t-r;return o=Math.min(o,n)}t.drawGridLines=function(e,t,r){if(!(t.RowOffsets&&t.ColumnOffsets&&t.RowHeights&&t.ColumnWidths))throw"drawGridLines:: one or more elements is null: RowOffset: "+!t.RowOffsets+", ColumnOffsets: "+!t.ColumnOffsets+", RowHeights: "+!t.RowHeights+", ColumnWidths: "+!t.ColumnWidths;if(t.RowOffsets.length!==t.RowHeights.length)throw"drawGridLines:: RowOffsets.length !== RowHeights.length";if(t.ColumnOffsets.length!==t.ColumnWidths.length)throw"drawGridLines:: ColumnOffsets.length !== ColumnWidths.length";if(t.ShowGridLines&&!(r.devicePixelRatio<o.MinimalDprForGridlinesRendering)&&i.shouldRenderGridLines(l.isHighContrastMode(r),l.hasWorkbookBackgroundColor(t.BackgroundColor,a.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)))){e.lineWidth=o.GridLineWidthPx,e.setLineDash(function(e){if(a.isRenderFlagEnabled(n.RenderFlags.GridLineColor,e)&&!u.isNullOrUndefined(e.GridLineColor))return o.ColoredGridLineDash;return o.DefaultDash}(t)),e.strokeStyle=function(e,t){if(!u.isNullOrUndefined(t.highContrastScheme))return""+i.rgbToColorHex(t.highContrastScheme.TextColor);if(a.isRenderFlagEnabled(n.RenderFlags.GridLineColor,e)&&!u.isNullOrUndefined(e.GridLineColor))return e.GridLineColor;return o.DefaultGridlineColor}(t,r);var c=l.getLinePixelTranslation(o.GridLineWidthPx),g=d(t.BlockWidth,r.devicePixelRatio,!1),f=d(t.BlockHeight,r.devicePixelRatio,!0),h=a.isRenderFlagEnabled(n.RenderFlags.LargeBlocks,t);e.beginPath(),function(e,t,r,n,o,l,a){for(var u=a?l.startRow:0,d=a?l.endRow:t.length-2,c=u;c<=d;c++){var g=s(t[c],i.getRowHeightFromOffsets(c,t),n,o);i.drawLine(e,0,g,r,g)}}(e,t.RowOffsetsAdjustedForDrawing,t.BlockWidth*r.devicePixelRatio,c,f,r.renderingRegion,h),function(e,t,r,n,o,l,a){for(var u=a?l.startColumn:0,d=a?l.endColumn:t.length-2,c=u;c<=d;c++){var g=s(t[c],i.getColWidthFromOffsets(c,t),n,o);i.drawLine(e,g,0,g,r)}}(e,t.ColOffsetsAdjustedForDrawing,t.BlockHeight*r.devicePixelRatio,c,g,r.renderingRegion,h),e.stroke()}},t.getMaxLineOffset=d,t.getAdjustedDrawingOffset=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),o=r(3),i=r(14);t.fillTextUnclipped=function(e,t,r,n,o,l,a,u){e.fillText(t,r,n,o),i.measureAndCacheTextDecorationLayout(e,a,l,{dpr:u,textPositionX:r,textPositionY:n})},t.fillTextClipped=function(e,t,r,l,a,u,d,s,c){o.applyClipping(e,a),c?n.fillRichTextFormat(e,s,d,u,c,r,l,a):(e.fillText(t,r,l),i.measureAndCacheTextDecorationLayout(e,d,u,{dpr:s,textPositionX:r,textPositionY:l,clipRect:a})),o.restoreClipping(e,a)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10);t.approximateValue=function(e,t){var r=Math.round(e);if(r<n.MinAllowedFontSize&&r>0&&(r=n.MinAllowedFontSize),r>n.MaxAllowedFontSize&&(r=n.MaxAllowedFontSize),r<0)throw Error("TextLayout.approximateValue: "+r+" in Excel must be between 1pt and 409pt");var o=t[r];if(o)return o;for(var i=r;i>n.MinAllowedFontSize&&!t[i];)i--;for(var l=r;l<n.MaxAllowedFontSize&&!t[l];)l++;return o=function(e,t,r,n,o){var i=(r-n)/(o-n)*(e-t);return Math.round(t+i)}(t[l],t[i],r,i,l),t[r]=o,o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalibriItalicPadding={1:1,2:1,3:1,4:1,5:2,6:3,7:3,8:4,9:4,10:5,11:5,12:6,13:5,14:7,16:8,18:9,20:11,22:11,24:11,26:13,28:13,36:17,48:23,72:35,100:49,150:74,200:97,300:145,409:194},t.CalibriRegularPadding={1:1,2:1,3:1,4:1,5:1,6:2,7:2,8:2,9:2,10:2,11:2,12:2,13:3,14:3,15:3,16:3,17:3,18:3,19:4,20:4,21:4,22:4,23:4,24:4,25:5,26:5,27:5,28:5,29:5,30:5,31:6,32:6,33:6,34:6,35:6,36:6,37:7,38:7,39:7,40:7,41:7,42:7,43:8,44:8,45:8,46:8,47:8,48:8,49:9,50:9,51:9,52:9,53:9,54:10,55:10,56:10,57:10,58:10,59:10,60:11,61:11,62:11,63:11,64:11,65:11,66:12,67:12,68:12,69:12,70:12,71:12,72:13,73:13,74:13,75:13,76:13,77:13,78:13,79:14,80:14,81:14,82:14,83:14,84:15,85:15,86:15,87:15,88:15,89:15,90:16,91:16,92:16,93:16,94:16,95:16,96:17,97:17,98:17,99:17,100:17,101:17,102:17,103:17,104:17,105:17,106:17,107:17,108:18,150:25,200:33,300:85,409:115},t.CalibriTextDecorationLineWidth={5:0,6:1,11:1,17:1,18:2,35:2,36:3,47:3,48:4,64:5,72:6,100:8,200:17,300:26,409:37},t.FontSizeToIconSize={1:3,3:5,4:6,5:8,8:12,10:12,11:16,12:16,14:20,16:22,18:22,20:26,22:26,24:28,26:32,28:34,36:42,48:57,72:85,100:118,200:234,300:351,400:468,409:478},t.IconHorizontalPadding={1:0,3:0,4:0,5:0,8:1,10:1,11:1,12:1,14:2,16:2,18:2,20:3,22:3,24:4,26:5,28:5,36:7,48:10,72:16,100:22,200:44,300:67,400:89,409:90}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.comparisonIgnoreLists={},t.comparisonIgnoreLists.GridBlockModel=["RowOutlines","ColumnOutlines","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlags","IsDirty","CellLookup","DirtyTimestamp","RowOffsetsAdjustedForDrawing","ColOffsetsAdjustedForDrawing"],t.comparisonIgnoreLists.Cell=["Formula","StyleID","Ifmt","BorderStyleID","HorizontalAlignmentSet","ShrunkSize","AutoFilter","PivotFilter","TextRuns","CommentID","RichValueType","ValueType","CachedDrawingLayout","CachedDisplayText","Value","UserInput","PhoneticInfo","OriginalText","ErrorTooltip"],t.comparisonIgnoreLists.ReferencedObject=["ID","RefCount"],t.comparisonIgnoreLists.CellStyle=["NamedStyleId","FontID","IsUnlocked","IsHidden"],t.comparisonIgnoreLists.FormulaInformation=["Formula","FormulaType"],t.comparisonIgnoreLists.MergeInformation=["WidthAdjustedForDrawing","HeightAdjustedForDrawing","OriginDeltaXAdjustedForDrawing","OriginDeltaYAdjustedForDrawing","SpansNextBlockVertically","SpansNextBlockHorizontally"],t.comparisonIgnoreLists.TextRun=["FontID"],t.propertyToClassMap={},t.propertyToClassMap.Cells=["Cell"],t.propertyToClassMap.Styles=["CellStyle","ReferencedObject"],t.propertyToClassMap.Fonts=["Font","ReferencedObject"],t.propertyToClassMap.BorderStyles=["BorderStyle","ReferencedObject"],t.propertyToClassMap.Spill=["SpillInformation"],t.propertyToClassMap.Merge=["MergeInformation"],t.propertyToClassMap.NumFmt=["NumberFormatInformation"],t.propertyToClassMap.WrapText=["WrapTextInformation"],t.propertyToClassMap.AutoFilter=["AutoFilter"],t.propertyToClassMap.PivotFilter=["PivotFilter"],t.propertyToClassMap.TextRuns=["TextRun"],t.propertyToClassMap.CondFormat=["ConditionalFormattingInformation"],t.propertyToClassMap.FormulaInfo=["FormulaInformation"],t.propertyToClassMap.CachedStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.CachedFont=["Font","ReferencedObject"],t.propertyToClassMap.CachedBorderStyle=["BorderStyle","ReferencedObject"],t.propertyToClassMap.Menu=["AutoFilterMenu"],t.propertyToClassMap.Icon=["ConditionalFormattingIcon"],t.propertyToClassMap.Sections=["MenuSection"],t.propertyToClassMap.MenuItems=["MenuItem"],t.propertyToClassMap.SubMenu=["AutoFilterMenu"],t.propertyToClassMap.Gradient=["GradientFill"],t.propertyToClassMap.Borders=["Border"],t.propertyToClassMap.Color=["RGBColor"],t.propertyToClassMap.Stops=["ColorStop"],t.UserContentList={},t.UserContentList.Cell=["Text","Formula","CachedDisplayText","Value","UserInput","OriginalText"],t.UserContentList.AutoFilter=["CommandData"],t.UserContentList.PivotFilter=["CommandData"],t.UserContentList.MenuItem=["CommandData","Label"],t.UserContentList.FormulaInformation=["Formula"],t.UserContentList.NumberFormatInformation=["Start","End","Separator"],t.UserContentList.Font=["FontName"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(3),l=r(26),a=r(2),u=r(5),d=r(7),s=r(4);function c(e,t,r,n){var i=o.getWorkbookBackgroundColor(t.highContrastScheme,r,n);e.strokeStyle=i,e.lineWidth=s.GridLineWidthPx,e.setLineDash(s.DefaultDash)}function g(e,t,r,n,o){var a=e.Col,u=e.Col,c=r.ColOffsetsAdjustedForDrawing;e.Merge?(u+=e.Merge.Columns,e.Merge.SpansNextBlockHorizontally&&(u=c.length-1)):e.Spill&&(a-=e.Spill.SpanToStart,u+=e.Spill.SpanToEnd),a=Math.max(0,a),u=Math.min(r.ColumnNumbers.length,u);for(var g=d.getCellHeightAdjustedForDrawing(r,e),f=d.getCellTopAdjustedForDrawing(r,e),h=g-s.GridLineWidthPx,m=a;m<u;m++){var C=l.getAdjustedDrawingOffset(c[m],i.getColWidthFromOffsets(m,c),n,o);i.drawLine(t,C,f,C,f+h)}}function f(e,t,r,n,o){var a=e.Row,u=e.Row+e.Merge.Rows,c=r.RowOffsetsAdjustedForDrawing;a=Math.max(0,a),u=Math.min(r.RowNumbers.length,u),e.Merge.SpansNextBlockVertically&&(u=c.length-1);for(var g=d.getCellLeftAdjustedForDrawing(r,e,r.IsRtl),f=d.getCellWidthAdjustedForDrawing(r,e)-s.GridLineWidthPx,h=a;h<u;h++){var m=l.getAdjustedDrawingOffset(c[h],i.getRowHeightFromOffsets(h,c),n,o);i.drawLine(t,g,m,g+f,m)}}t.clearGridLinesForSpannedCells=function(e,t,r){if(o.verifyArgumentNotNull(t,"model","clearGridLinesForText"),o.verifyArgumentNotNull(t.Cells,"model.Cells","clearGridLinesForText"),o.verifyArgumentNotNull(e,"ctx","clearGridLinesForText"),o.verifyArgumentNotNull(r,"context","clearGridLinesForText"),t.ShowGridLines&&i.shouldRenderGridLines(o.isHighContrastMode(r),o.hasWorkbookBackgroundColor(t.BackgroundColor,a.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)))){var h=t.Cells,m=a.isRenderFlagEnabled(n.RenderFlags.LargeBlocks,t),C=o.getLinePixelTranslation(s.GridLineWidthPx),p=l.getMaxLineOffset(t.BlockWidth,r.devicePixelRatio,!1),y=l.getMaxLineOffset(t.BlockHeight,r.devicePixelRatio,!0);c(e,r,t.BackgroundColor,a.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)),e.beginPath();for(var F=0;F<h.length;F++){var v=h[F],w=!u.isNullOrUndefined(v)&&!u.isNullOrUndefined(v.Spill),S=!u.isNullOrUndefined(v)&&!u.isNullOrUndefined(v.Merge)&&(u.isNullOrUndefined(v.CachedStyle.BackgroundColor)||!u.isNullOrUndefined(r.highContrastScheme));m&&!i.cellIntersectsRenderingRegion(v,r.renderingRegion)||(w||S)&&(g(v,e,t,C,p),S&&d.isCellSpansMultipleRowsOrBlocks(v)&&f(v,e,t,C,y))}e.stroke()}},t.setContextForClearingGridLine=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),l=r(6),a=r(5),u=r(20);function d(e,t,r,n){var o=l.getNumFmtHashesWidth(e,t,r),i=Math.floor(n/o),a="";return a+="#".repeat(i)}String.prototype.repeat||(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");var t=""+this,r=0;if(a.isNullOrUndefined(e)&&(r=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(r=Math.floor(e),0===t.length||0===r)return"";if(t.length*r>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var n=t.length*r;for(r=Math.floor(Math.log(r)/Math.log(2));r;)t+=t,r--;return t+=t.substring(0,n-t.length)}),t.updateNumberFormattingInformation=function(e,t,r,s){var c,g,f,h;o.verifyArgumentNotNull(r,"cell","updateNumberFormattingInformation"),o.verifyArgumentNotNull(r.CachedFont,"cell.CachedFont","updateNumberFormattingInformation"),o.verifyArgumentNotNull(t,"model","updateNumberFormattingInformation");var m=i.isRenderFlagEnabled(n.RenderFlags.AdvancedTextMetrics,t);if(r.NumFmt&&r.NumFmt.Separator){var C=void 0;!a.isNullOrUndefined(r.Text)&&a.isNullOrUndefined(null===(c=r.CachedStyle)||void 0===c?void 0:c.ReadingOrder)&&u.analyzeBidiText(r.Text,null===(g=r.CachedStyle)||void 0===g?void 0:g.ReadingOrder).HasRtl&&(C=e.direction,e.direction="rtl");var p=l.measureTextWidth(e,null===(f=r.NumFmt)||void 0===f?void 0:f.Start,m),y=l.measureTextWidth(e,null===(h=r.NumFmt)||void 0===h?void 0:h.End,m);if(p+y>s){var F=d(e,t,r,s);o.setCellCachedDisplayText(r,F)}else{var v=l.getNumFmtSeparatorWidth(e,t,r),w=Math.floor((s-p-y)/v);F=function(e,t){var r=t>0?t:0,n=e.Start||"";return n+=e.Separator.repeat(r),n+=e.End||""}(r.NumFmt,w);o.setCellCachedDisplayText(r,F)}C&&(e.direction=C)}else{if(l.getTextWidth(e,t,r)>s){F=d(e,t,r,s);o.setCellCachedDisplayText(r,F)}}},t.updateNumFmtFromCell=function(e){var t,r,n,i,l,u;if(o.verifyArgumentNotNull(e.Text,"cell.Text","updateNumFmt"),o.verifyArgumentNotNull(e.NumFmt,"cell.NumFmt","updateNumFmt"),!a.isNullOrUndefined(e.NumFmt.End)&&!a.isNullOrUndefined(e.NumFmt.Separator)){var d=function(e,t){for(var r=0,n=0;n<e.length&&e[n]===t;n++)r++;return r}(e.NumFmt.End,e.NumFmt.Separator),s=function(e,t){for(var r=0,n=e.length-1;n>0&&e[n]===t;n++)r++;return r}(e.NumFmt.End,e.NumFmt.Separator),c=function(e,t,r){var n=e.length-t,o=e.substring(0,n),i=o.lastIndexOf(r);if(-1===i)return o;return o.substr(i+1)}(e.Text,s,e.NumFmt.Separator);e.NumFmt.End=function(e,t,r,n){return t.repeat(r)+e+t.repeat(n)}(c,e.NumFmt.Separator,d,s),(null===(r=null===(t=e)||void 0===t?void 0:t.Text)||void 0===r?void 0:r.endsWith((null===(n=e.NumFmt)||void 0===n?void 0:n.Separator)+e.NumFmt.End))&&(null===(l=null===(i=e)||void 0===i?void 0:i.Text)||void 0===l?void 0:l.startsWith((null===(u=e.NumFmt)||void 0===u?void 0:u.Start)||""))||(e.NumFmt=void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(1),i=r(2),l=r(22),a=r(0),u=r(6);function d(e,t,r){if(a.verifyArgumentNotNull(r,"cell","spillCell.updateCellSpill"),a.verifyArgumentNotNull(t,"model","spillCell.updateCellSpill"),!(!r.Text||r.WrapText||r.Merge||a.cellHasShrinkToFit(r,t)||i.isRenderFlagEnabled(o.RenderFlags.NumFmtAccountingAndCustom,t)&&r.ValueType===o.CellValueType.Number)){i.isRenderFlagEnabled(o.RenderFlags.MeasureTextRefactor,t)&&(e.font=a.getFontCssStringFromCell(t,r));var d=i.isRenderFlagEnabled(o.RenderFlags.MeasureTextRefactor,t)?u.getTextWidth(e,t,r):l.GridBlockRendererGlobals.measureTextWidth(r.Text,a.getFontCssStringFromCell(t,r),i.isRenderFlagEnabled(o.RenderFlags.AdvancedTextMetrics,t)),c=s(r,t,d,n.End),h=c.spilledOverCellsCount,m=c.isSpillingOutsideOfBlock,C=s(r,t,d,n.Start),p=C.spilledOverCellsCount,y=C.isSpillingOutsideOfBlock,F=m||y;if(0!==h||0!==p){var v=g(r,t,n.Start),w=g(r,t,n.End),S=f(v,r,t,n.Start),R=f(w,r,t,n.End);r.Spill={SpanToStart:Math.min(p,S),SpanToEnd:Math.min(h,R),IsSpillBlocked:F||p>S||h>R}}else F&&(r.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0})}}function s(e,t,r,n){var i=e.Col,l=function(e,t,r,n){var i=a.getCellStyle(t,e);a.verifyArgumentNotNull(i,"cell.CachedStyle","spillCell.getNumberOfSpilledPixels");var l=i.HorizontalAlignment,d=a.getColumnWidth(t.Col,e),s=u.getCellTextHorizontalPaddingWithIcons(t,e)+r-d;if(s<=0)return 0;if(l===o.HorizontalAlignment.Center)return s/2;var c=e.IsRtl;if(!C(l,n,c))return 0;return s}(t,e,r,n),d=0,s=!1;if(0===l)return{spilledOverCellsCount:d,isSpillingOutsideOfBlock:s};var g=t.ColumnNumbers.length;for(i+=n;c(i,g)&&l>0;)d++,l-=a.getColumnWidth(i,t),i+=n;return{spilledOverCellsCount:d,isSpillingOutsideOfBlock:s=!c(i,g)&&l>0}}function c(e,t){return e>=0&&e<t}function g(e,t,r){for(var n=e.Row,o=e.Col+r;c(o,t.ColumnNumbers.length);){var i=a.getCell(n,o,t);if(i&&h(i))return i;o+=r}return null}function f(e,t,r,o){return e?Math.abs(e.Col-t.Col)-1:o===n.End?r.ColumnNumbers.length-t.Col:t.Col}function h(e){var t;return!(!e||!e.Text&&!(null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula))}function m(e,t,r,o,i){var l=f(t,r,o,i);if(t&&t.Spill){var u=a.getCellStyle(t,o);if(a.verifyArgumentNotNull(u,"blockingCellStyle","spillCell.updateClosestNonEmptyCell"),C(u.HorizontalAlignment,-i,o.IsRtl))if(r&&r.Text){var s=i===n.End?t.Spill.SpanToStart:t.Spill.SpanToEnd;t.Spill.IsSpillBlocked=l<=s,i===n.End?t.Spill.SpanToStart=Math.min(s,l):t.Spill.SpanToEnd=Math.min(s,l)}else d(e,o,r)}return l}function C(e,t,r){return e===o.HorizontalAlignment.Center||(t===n.Start?r?e===o.HorizontalAlignment.Left:e===o.HorizontalAlignment.Right:t===n.End&&(e===o.HorizontalAlignment.Automatic||(r?e===o.HorizontalAlignment.Right:e===o.HorizontalAlignment.Left)))}t.updateCellSpill=d,t.updateClosestNonEmptyCellsSpill=function(e,t,r){var o=g(t,r,n.Start),i=g(t,r,n.End);m(e,o,t,r,n.Start),m(e,i,t,r,n.End)},function(e){e[e.Start=-1]="Start",e[e.End=1]="End"}(n||(n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(30),o=r(53),i=r(2),l=n.UserContentList.Cell.concat(n.UserContentList.GridBlockModel).concat(n.UserContentList.CellStyle).concat(n.UserContentList.Font).concat(n.UserContentList.BorderStyle).concat(n.UserContentList.AutoFilter).concat(n.UserContentList.PivotFilter).concat(n.UserContentList.MenuItem).concat(n.UserContentList.FormulaInformation).concat(n.UserContentList.NumberFormatInformation);function a(e){return function(t,r){return r&&e&&e.indexOf(t)>-1?function(e){return e.toLowerCase().replace(o.DigitReplaceValue,o.CharacterReplaceValue).replace(o.Digit,o.DigitReplaceValue).replace(o.ValueAnnonymizerRegex,o.CharacterReplaceValue)}(r):r}}t.serializeCell=function(e,t){return e&&t?(e.CachedStyle=i.getReferencedObjectToCache(e.StyleID,t.Styles),e.CachedBorderStyle=i.getReferencedObjectToCache(e.BorderStyleID,t.BorderStyles),e.CachedFont=i.getReferencedObjectToCache(e.CachedStyle.FontID,t.Fonts),l?JSON.stringify(e,a(l)):JSON.stringify(e)):""},t.serializeModel=function(e){return e?l?JSON.stringify(e,a(l)):JSON.stringify(e):""}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(12);function l(e,t,r,n,o){e.fillStyle=o,e.beginPath(),e.arc(t,r,n,0,2*Math.PI),e.fill()}t.drawCircleIcon=function(e,t,r,a){n.verifyArgumentNotNull(e,"ctx","drawCircleIcon"),n.verifyArgumentNotNull(t,"model","drawCircleIcon"),n.verifyArgumentNotNull(r,"cell","drawCircleIcon"),n.verifyArgumentNotNull(a,"drawingContext","drawCircleIcon");var u=a.image,d=a.size,s=a.left,c=a.bottom,g=function(e){switch(e){case o.CFIconImage.CircleHigh:case o.CFIconImage.TrafficHigh:return i.CircleHighOuterColor;case o.CFIconImage.CircleMedium:case o.CFIconImage.TrafficMedium:return i.CircleMediumOuterColor;case o.CFIconImage.CircleLow:case o.CFIconImage.TrafficLow:return i.CircleLowOuterColor;case o.CFIconImage.CircleEmpty:return i.CircleEmptyOuterColor;case o.CFIconImage.CircleFilled:return i.CircleFilledOuterColor;case o.CFIconImage.FourCircleHigh:return i.FourCircleHighOuterColor;case o.CFIconImage.FourCircleLow:return i.FourCircleLowOuterColor;case o.CFIconImage.FourCircleMedium1:return i.FourCircleMedium1OuterColor;case o.CFIconImage.FourCircleMedium2:return i.FourCircleMedium2OuterColor;default:throw Error("getCircleOuterColor: unsupported image type = "+e)}}(u),f=d/2;if(!(f<=0)){var h=s+f,m=c-f;l(e,h,m,f,g);var C=function(e){switch(e){case o.CFIconImage.CircleHigh:case o.CFIconImage.TrafficHigh:return i.CircleHighInnerColor;case o.CFIconImage.CircleMedium:case o.CFIconImage.TrafficMedium:return i.CircleMediumInnerColor;case o.CFIconImage.CircleLow:case o.CFIconImage.TrafficLow:return i.CircleLowInnerColor;case o.CFIconImage.CircleEmpty:return i.CircleEmptyInnerColor;case o.CFIconImage.CircleFilled:return i.CircleFilledInnerColor;case o.CFIconImage.FourCircleHigh:return i.FourCircleHighInnerColor;case o.CFIconImage.FourCircleLow:return;case o.CFIconImage.FourCircleMedium1:return i.FourCircleMedium1InnerColor;case o.CFIconImage.FourCircleMedium2:return i.FourCircleMedium2InnerColor;default:throw Error("getCircleInnerColor: unsupported image type = "+e)}}(u);if(C){var p=f-o.IconOutlineWidthPx;if(p<=0)return;l(e,h,m,p,C)}}}},function(e,t,r){"use strict";r.r(t);var n=r(23);for(var o in n)"default"!==o&&function(e){r.d(t,e,(function(){return n[e]}))}(o)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(24);t.GridBlockRendererFactoryGlobal=new n.GridBlockRendererFactory},function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:l}catch(e){n=l}}();var u,d=[],s=!1,c=-1;function g(){s&&u&&(s=!1,u.length?d=u.concat(d):c=-1,d.length&&f())}function f(){if(!s){var e=a(g);s=!0;for(var t=d.length;t;){for(u=d,d=[];++c<t;)u&&u[c].run();c=-1,t=d.length}u=null,s=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===l||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new h(e,t)),1!==d.length||s||a(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumFmtAccountingStartIndex=32},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),o=r(3),i=r(0);function l(e,t,r,n,o){var i=Math.min(n/4,16),l=Math.min(o/4,8),a=t+n/2-i/2,u=r+o/2-l/2;e.fillRect(a,u,i,l)}t.drawSkeleton=function(e,t,r){if(i.verifyArgumentNotNull(e,"ctx","drawSkeleton"),i.verifyArgumentNotNull(t,"model","drawSkeleton"),i.verifyArgumentNotNull(r,"context","drawSkeleton"),i.verifyArgumentNotNull(t.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawSkeleton"),i.verifyArgumentNotNull(t.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawSkeleton"),i.verifyArgumentNotNull(t.RowHeights,"RowHeights","drawSkeleton"),i.verifyArgumentNotNull(t.ColumnWidths,"ColumnWidths","drawSkeleton"),!(r.devicePixelRatio<n.MinimalDprForGridlinesRendering)&&t.ShowGridLines){e.fillStyle=n.SkeletonColor;for(var a=t.ColOffsetsAdjustedForDrawing[t.ColOffsetsAdjustedForDrawing.length-1],u=0;u<t.RowOffsetsAdjustedForDrawing.length-1;u++)for(var d=t.RowOffsetsAdjustedForDrawing[u],s=o.getRowHeightFromOffsets(u,t.RowOffsetsAdjustedForDrawing),c=0;c<t.ColOffsetsAdjustedForDrawing.length-1;c++){l(e,t.IsRtl?a-t.ColOffsetsAdjustedForDrawing[c+1]:t.ColOffsetsAdjustedForDrawing[c],d,o.getColWidthFromOffsets(c,t.ColOffsetsAdjustedForDrawing),s)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addWatermark=function(e,t){e.beginPath(),e.strokeStyle="red",e.lineWidth=1,e.setLineDash([]);var r=1*t,n=5*t;e.rect(r,r,n,n),e.stroke()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCanvasElement=function(e){return e instanceof HTMLCanvasElement}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(27),l=r(4),a=r(46),u=r(0),d=r(47),s=r(2),c=r(6),g=r(7),f=r(32),h=r(15);function m(e,t,r,m,p,y,F,v){var w=r.CachedStyle.HorizontalAlignment,S=r.CachedStyle.VerticalAlignment,R=function(e,t,r){var o=c.getCellTextHorizontalPaddingWithIcons(t,e);switch(r){case n.HorizontalAlignment.Right:return g.getCellRight(e,t,e.BlockWidth)-o;case n.HorizontalAlignment.Center:return g.getCellTextCenterX(e,t);case n.HorizontalAlignment.Automatic:case n.HorizontalAlignment.Left:return g.getCellLeft(e,t,e.BlockWidth)+o;default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+r)}}(t,r,w),T=c.getTextLineHeight(r,t),x=s.isRenderFlagEnabled(n.RenderFlags.FontName,t),B=c.getTextVerticalPosition(g.getCellTop(t,r),g.getCellBottom(t,r),S,T,v,1,void 0,x,h.cellHasBottomDoubleBorder(r,t),r.CachedFont.FontName,r.CachedFont.Size);!function(e,t,r,o,i){var a=function(e){switch(e){case n.HorizontalAlignment.Right:return"right";case n.HorizontalAlignment.Center:return"center";case n.HorizontalAlignment.Automatic:case n.HorizontalAlignment.Left:return"left";default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+e)}}(r.CachedStyle.HorizontalAlignment);t.textAlign!==a&&(t.textAlign=a,e.textAlign=a);var d=function(e){switch(e){case n.VerticalAlignment.Bottom:case n.VerticalAlignment.Top:return"bottom";case n.VerticalAlignment.Center:case n.VerticalAlignment.Justify:case n.VerticalAlignment.Distributed:return"middle";default:throw Error("getTextBaseline: unsupported verticalAlignment: "+e)}}(r.CachedStyle.VerticalAlignment);d!==t.textBaseline&&(e.textBaseline=d,t.textBaseline=d);var s=u.getFontCssStringFromCell(o,r);t.fontProperties!==s&&(t.fontProperties=s,e.font=s);if(!i){var c=function(e){var t;if(null===(t=e.FormulaInfo)||void 0===t?void 0:t.HasError)return l.FormulaErrorFontColor;return e.CachedFont.Color}(r);t.fontColor!==c&&(t.fontColor=c,e.fillStyle=c)}var g=function(e,t){switch(e){case n.ReadingOrderType.RightToLeft:return"rtl";case n.ReadingOrderType.LeftToRight:return"ltr";case n.ReadingOrderType.Context:return C(t);default:throw Error("getCanvasDirection: unsupported readingOrder: "+e)}}(r.CachedStyle.ReadingOrder,o.IsRtl);g!==t.direction&&(t.direction=g,e.direction=g)}(e,m,r,t,p);var D=g.getCellWidth(t,r,!1),b=c.getTextIconPadding(t,r),N=o.getTextDrawingMaxWidth(D,c.getCellTextHorizontalPaddingNoIcons(r,t),b);if(s.doesNumFmtOverrideText(r,t)){var A=N;N<0&&(A=0),f.updateNumberFormattingInformation(e,t,r,A)}var I=function(e,t){var r=s.isRenderFlagEnabled(n.RenderFlags.NumFmtAccountingAndCustom,t)?e.CachedDisplayText:e.Text;if(!e.WrapText&&(-1!==r.indexOf(l.HardBreakCRLF)||-1!==r.indexOf(l.HardBreak)))return r.replace(/\r\n|\n/g,"");return r}(r,t),L=function(e,t,r){if(s.isRenderFlagEnabled(n.RenderFlags.RichTextFormat,r)&&t.TextRuns&&r.Fonts)return{Text:e,TextRuns:t.TextRuns,Fonts:r.Fonts};return}(I,r,t),O=s.isRenderFlagEnabled(n.RenderFlags.NumFmtAndWrapText,t)&&r.ValueType===n.CellValueType.Number;if(r.WrapText&&!O){var M=g.getCellBottom(t,r),k=g.getCellLeft(t,r,t.BlockWidth),P=o.getContainerClipMaskWidth(D),E=g.isCellSpansMultipleRowsOrBlocks(r);d.drawWrapText(e,t,r,M,I,R,N,k,P,F,v,E,c.getCellTextHorizontalPaddingNoIcons(r,t),c.getTextLineHeight(r,t),y,L)}else if(r.Merge)!function(e,t,r,n,l,a,u,d,s,f){if(r.Merge.Rows>0||n||c.getTextWidth(e,t,r)>=s){var h={x:g.getCellLeft(t,r,t.BlockWidth),y:g.getCellTop(t,r),width:o.getContainerClipMaskWidth(a),height:g.getCellHeight(t,r,!1)};i.fillTextClipped(e,l,u,d,h,r,t,f,n)}else i.fillTextUnclipped(e,l,u,d,s,r,t,f)}(e,t,r,L,I,D,R,B,N,y);else if(r.Spill)a.drawSpillCellText(e,t,r,I,R,B,F,v,y,L);else if(L){var W={x:g.getCellLeft(t,r,t.BlockWidth),y:g.getCellTop(t,r),width:o.getContainerClipMaskWidth(D),height:v};i.fillTextClipped(e,I,R,B,W,r,t,y,L)}else i.fillTextUnclipped(e,I,R,B,N,r,t,y)}function C(e){return e?"rtl":"ltr"}function p(e,t,r,n){return o.restoreClipping(r,n),y(e,t)}function y(e,t){return{fontColor:e?o.rgbToColorHex(e.TextColor):l.DefaultCellFontColor,fontProperties:"",direction:C(t),textBaseline:"bottom",textAlign:"start"}}t.drawCellsText=function(e,t,r){u.verifyArgumentNotNull(e,"ctx","drawCellsText"),u.verifyArgumentNotNull(t,"model","drawCellsText"),u.verifyArgumentNotNull(r,"context","drawCellsText"),u.verifyArgumentNotNull(t.RowOffsets,"model.RowOffsets","drawCellsText"),u.verifyArgumentNotNull(t.ColumnOffsets,"model.ColumnOffsets","drawCellsText"),u.verifyArgumentNotNull(t.RowHeights,"model.RowHeights","drawCellsText"),u.verifyArgumentNotNull(t.ColumnWidths,"model.ColumnWidths","drawCellsText"),u.verifyArgumentNotNull(t.Cells,"model.Cells","drawCellsText"),u.verifyArgumentNotNull(t.Styles,"model.Styles","drawCellsText");for(var i=t.Cells,a=t.BlockWidth,d=[],c=function(e,t,r){var o=y(t,r.IsRtl);e.direction=o.direction,e.fillStyle=o.fontColor,e.textBaseline="bottom",e.strokeStyle="transparent",s.isRenderFlagEnabled(n.RenderFlags.Underline,r)&&function(e){e.getLineDash()!==[]&&e.setLineDash([])}(e);return o}(e,r.highContrastScheme,t),f=s.isRenderFlagEnabled(n.RenderFlags.LargeBlocks,t),h=void 0,C=-1,F=0;F<i.length;F++){if((S=i[F])&&S.Text&&(!f||o.cellIntersectsRenderingRegion(S,r.renderingRegion))){var v=t.RowHeights[S.Row]-l.GridLineWidthPx,w=t.RowOffsets[S.Row];S.Row!==C&&(-1!==C&&(c=p(r.highContrastScheme,t.IsRtl,e,h)),h={x:0,y:w,width:a,height:v},o.applyClipping(e,h),C=S.Row),g.isCellSpansMultipleRowsOrBlocks(S)?d.push(S):m(e,t,S,c,r.highContrastScheme,r.devicePixelRatio,w,v)}}for(o.restoreClipping(e,h),c=y(r.highContrastScheme,t.IsRtl),F=0;F<d.length;F++){var S=d[F],R=g.getCellHeight(t,S,!1)-l.GridLineWidthPx,T=g.getCellTop(t,S);m(e,t,S,c,r.highContrastScheme,r.devicePixelRatio,T,R)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=r(27),i=r(0),l=r(6);function a(e,t){var r=t.ColumnOffsets[d(e)],n=function(e,t){return i.verifyArgumentNotNull(t.ColumnNumbers,"model.ColumnNumbers","spillCell.getSpillCellEndCol"),Math.min(t.ColumnNumbers.length-1,e.Col+e.Spill.SpanToEnd)}(e,t),o=t.ColumnOffsets[n];return t.ColumnWidths[n]+Math.abs(o-r)}function u(e,t){var r=t.ColumnOffsets[d(e)];return t.IsRtl?t.BlockWidth-a(e,t)-r+1:r}function d(e){return Math.max(0,e.Col-e.Spill.SpanToStart)}t.drawSpillCellText=function(e,t,r,d,s,c,g,f,h,m){i.verifyArgumentNotNull(r.Spill,"cell.Spill","spillCells.drawSpillCellText");var C=a(r,t);if(r.Spill.IsSpillBlocked||m){var p=n.getContainerClipMaskWidth(C),y={x:u(r,t),y:g,width:p,height:f};o.fillTextClipped(e,d,s,c,y,r,t,h,m)}else{var F=n.getTextDrawingMaxWidth(C,l.getCellTextHorizontalPaddingWithIcons(r,t),l.getTextIconPadding(t,r));o.fillTextUnclipped(e,d,s,c,F,r,t,h)}},t.getSpillCellWidth=a,t.getSpillCellStartOffset=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=r(48),i=r(1),l=r(2),a=r(6),u=r(14),d=r(11),s=r(15);function c(e,t,r,n,o,i,l,a,u,s,c){s?d.fillRichTextFormat(e,r,t,n,s,l,a,c):o?e.fillText(i,l,a):e.fillText(i,l,a,u)}t.drawWrapText=function(e,t,r,g,f,h,m,C,p,y,F,v,w,S,R,T){if(!(m<0)){var x=m-w,B=l.isRenderFlagEnabled(i.RenderFlags.ThaiLineBreaking,t)?r.WrapText:{},D=o.breakTextToLines(e,f,x,T,B),b=D.lines,N=r.CachedStyle.VerticalAlignment,A=D.requireClipping||v,I=void 0;A&&(I={x:C,y:y,width:p,height:F}),function(e,t){n.applyClipping(e,t)}(e,I);for(var L=l.isRenderFlagEnabled(i.RenderFlags.FontName,t),O=function(e,t,r){for(var n=[],o=0;o<t;o++)n.push(e-o*r);return n}(a.getTextVerticalPosition(y,g,N,S,F,b.length,r.WrapText,L,s.cellHasBottomDoubleBorder(r,t),r.CachedFont.FontName,r.CachedFont.Size),b.length,S),M=0;M<b.length;M++){var k=b[b.length-1-M],P=k.text,E=O[M];c(e,t,R,r,A,P,h,E,m,T?d.substringFormattedText(T,k.startIndex,k.endIndex):void 0,I),T||u.cacheTextDecorationLayout(t,r,{textPositionX:h,textPositionY:E,dpr:R,textWidth:k.underlineWidth,clipRect:I},r.CachedFont)}!function(e,t){n.restoreClipping(e,t)}(e,I)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(17),o=r(0),i=r(49),l=r(50),a=r(4),u=r(11),d=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;function s(e,t){if(e.curLineWidth+=t.width,e.curLineWidth>e.maxWidth){var r=t.width;e.textLines.push(x(e,r)),e.curLineStart=t.start,e.curLineWidth=t.width}e.lastFittingToken=t}function c(e,t,r,n,o){if(t.type!==i.BreakOpTokenType.Space){void 0!==e.lastFittingToken&&e.textLines.push(x(e));for(var a,d,s,c,g,f=o?u.substringFormattedText(o,t.start,t.start+t.len):void 0,m=l.breakWideWord(n,t.value,e.maxWidth,f),C=t.start,p=0;p<m.length-1;p++){var y=m[p],F={text:y.value,width:y.width,underlineWidth:y.width,startIndex:C,endIndex:C+y.value.length};C+=y.value.length,e.textLines.push(F),e.isSingleCharTooWide=w(F.width,F.text.length,e.maxWidth,e.isSingleCharTooWide)}e.lastFittingToken=(d=t,s=(a=m)[a.length-1],c=d.start+d.len-s.value.length,g=s.width,{start:c,len:s.value.length,value:s.value,type:i.BreakOpTokenType.Word,width:g}),e.curLineWidth=e.lastFittingToken.width,e.curLineStart=e.lastFittingToken.start}else h(e,t,r)}function g(e,t,r){void 0!==e.lastFittingToken&&e.textLines.push(x(e));var n=function(e){switch(e.type){case i.BreakOpTokenType.HardBreak:return e.len;case i.BreakOpTokenType.HardBreakCRLF:return e.len/2;default:throw"wrapText - this token should be hardBreak token"}}(t);0!==r&&r!==e.tokens.length-1&&n--;for(var o=0;o<n;o++)e.textLines.push(a.EmptyLine);e.curLineStart=t.start+t.len,e.curLineWidth=0,e.lastFittingToken=void 0}function f(e,t,r){if(R(t),1===t.len)return e.curLineWidth+=t.width,void(e.lastFittingToken=t);!function(e,t,r){if(v(e.tokens,r),!p(e,r))return!1;return r===e.tokens.length-1||e.curLineWidth+t.width>e.maxWidth||F(e,t,r)}(e,t,r)?e.curLineWidth+t.width>e.maxWidth||F(e,t,r)?h(e,t,r):(e.curLineWidth+=t.width,e.lastFittingToken=t):y(e,t)}function h(e,t,r){R(t);var n=t.width/t.len,o=e.maxWidth-e.curLineWidth;if(!(o<0)){var i=Math.floor(o/n);t.width=n*i,e.curLineWidth+=t.width,e.lastFittingToken=t,(C(e.tokens,r)||p(e,r))&&y(e,t)}}function m(e,t){if(v(e,t),!e[t])throw"wrapText - validateToken - tokens[index] is undefined"}function C(e,t){return v(e,t),m(e,t),0===t&&e[t].type===i.BreakOpTokenType.Space}function p(e,t){var r=e.tokens;return v(r,t),t>0&&r[t].type===i.BreakOpTokenType.Space&&T(r[t-1])&&void 0===e.lastFittingToken}function y(e,t){if(t.type!==i.BreakOpTokenType.Space)throw"wrapText - addEmptyLineToTextLines - wrong token type, this function should get only spaces token";var r=n.__assign({},a.EmptyLine);r.underlineWidth=t.width,e.textLines.push(r),e.curLineStart=t.start+t.len,e.curLineWidth=0,e.lastFittingToken=void 0}function F(e,t,r){if(R(t),r>=e.tokens.length-1)return!1;var n=e.tokens[r+1];return e.curLineWidth+t.width+n.width>e.maxWidth}function v(e,t){if(t<0||t>=e.length)throw"wrapText - invalid token index"}function w(e,t,r,n){if(n)return!0;if(e>r){if(1!==t)throw"wrapText - non single char line is too wide!";return!0}return n}function S(e,t){return e.width<t}function R(e){if(e.type!==i.BreakOpTokenType.Space)throw"wrapText - wrong token type, expected spaces token!"}function T(e){return e.type===i.BreakOpTokenType.HardBreak||e.type===i.BreakOpTokenType.HardBreakCRLF}function x(e,t){void 0===t&&(t=0),o.verifyArgumentNotNull(e.lastFittingToken,"lineBreakCtx.lastFittingToken","createCurrentFittingLine");var r=e.curLineWidth-t,n=r;e.lastFittingToken.type===i.BreakOpTokenType.Space&&(n-=e.lastFittingToken.width);var l=function(e){if(void 0===e.lastFittingToken)throw"wrapText -invalid lastFittingToken - no token was set";var t=e.lastFittingToken.start+e.lastFittingToken.len;return{text:e.text.substring(e.curLineStart,t).trimRight(),start:e.curLineStart,end:t}}(e);return{text:l.text,width:n,underlineWidth:r,startIndex:l.start,endIndex:l.end}}String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(d,"")}),t.breakTextToLines=function(e,t,r,n,l){if(o.verifyArgumentNotNull(e,"canvas2dCtx","breakTextToLines"),""===t)return{lines:[],requireClipping:!1};for(var a=i.tokenizeTextToWrap(e,t,n,l),u={text:t,tokens:a,maxWidth:r,isSingleCharTooWide:!1,textLines:[],curLineStart:0,curLineWidth:0,lastFittingToken:void 0},d=0;d<a.length;d++){var h=a[d];if(m(a,d),T(h))g(u,h,d);else if(S(h,r)){if(h.type===i.BreakOpTokenType.Space&&!C(a,d)){f(u,h,d);continue}s(u,h)}else c(u,h,d,e,n)}return void 0!==u.lastFittingToken&&function(e){e.textLines.push(x(e)),e.isSingleCharTooWide=w(e.lastFittingToken.width,e.lastFittingToken.len,e.maxWidth,e.isSingleCharTooWide)}(u),{lines:u.textLines,requireClipping:u.isSingleCharTooWide}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(4),i=r(11);!function(e){e[e.Space=0]="Space",e[e.Word=1]="Word",e[e.HardBreak=2]="HardBreak",e[e.HardBreakCRLF=3]="HardBreakCRLF"}(n=t.BreakOpTokenType||(t.BreakOpTokenType={}));var l="1".charCodeAt(0);function a(e){switch(e){case o.Whitespace:return n.Space;case o.HardBreak:return n.HardBreak;case o.HardBreakCRLF:return n.HardBreakCRLF}return n.Word}function u(e,t){return"\r"===e[t]&&t<e.length-1&&"\n"===e[t+1]?o.HardBreakCRLF:e[t]}function d(e,t){return t===n.HardBreakCRLF?e+2:e+1}function s(e,t,r){return!(!t||r!==n.Word||e>t.length-1)&&t.charCodeAt(e)===l}t.tokenizeTextToWrap=function(e,t,r,l){for(var c,g=[],f=0,h=-1,m=null===(c=l)||void 0===c?void 0:c.BreakOp;f<t.length;){for(var C=a(u(t,f)),p=d(f,C),y=u(t,p),F=a(y);p<t.length&&C===F&&!s(p,m,C);)F=a(y=u(t,p=d(p,C)));var v=p-f,w=t.substring(f,p),S=r?i.substringFormattedText(r,f,p):void 0,R=0;switch(C){case n.Space:S?R=i.measureFormattedTextWidth(e,S):(-1===h&&(h=e.measureText(o.Whitespace).width),R=h*w.length);break;case n.Word:R=S?i.measureFormattedTextWidth(e,S):e.measureText(w).width;break;case n.HardBreak:case n.HardBreakCRLF:break;default:throw"wrapText - textTokenizer - unexpected run type"}g.push({start:f,len:v,value:w,type:C,width:R}),f=p}return g}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(11),i=function(){function e(e,t,r,n){this.cachedWidth=-1,this.ctx=e,this.word=t,this.prefixLength=r,this.wordFormattedText=n}return Object.defineProperty(e.prototype,"width",{get:function(){if(-1===this.cachedWidth)if(this.wordFormattedText){if(!this.formattedValue)throw Error("expected formattedValue to be set");this.cachedWidth=o.measureFormattedTextWidth(this.ctx,this.formattedValue)}else this.cachedWidth=this.ctx.measureText(this.value).width;return this.cachedWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.cachedValue||(this.cachedValue=this.word.substring(0,this.prefixLength)),this.cachedValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedValue",{get:function(){return this.wordFormattedText&&(this.cachedFormattedValue=o.substringFormattedText(this.wordFormattedText,0,this.prefixLength)),this.cachedFormattedValue},enumerable:!0,configurable:!0}),e}(),l=function(){function e(e,t,r){this.cachedItems=[],this.ctx=e,this.word=t,this.formattedText=r}return e.prototype.item=function(e){var t=this.cachedItems[e];return t||(t=new i(this.ctx,this.word,e+1,this.formattedText),this.cachedItems[e]=t),t},e}();function a(e,t,r,i){if(0!==t.length){var a=new l(e,t,i),u={width:r,value:"IGNORED"},d=n.binarySearch(a,0,t.length,u,(function(e,t){return e.width-t.width}));d<0&&0!==(d=~d)&&(d-=1);var s=a.item(d);return{width:s.width,value:s.value,remaining:t.substring(s.value.length),formattedRemaining:i?o.substringFormattedText(i,s.value.length):void 0}}}t.breakWideWord=function(e,t,r,n){for(var o=[],i=a(e,t,r,n);i;)o.push({value:i.value,width:i.width}),i=a(e,i.remaining,r,i.formattedRemaining);return o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(1),i=r(3),l=r(7),a=r(2),u=r(0),d=r(5),s=r(4),c=r(52);function g(e,t,r,o,i){var a=function(e,t){var r=l.getCellLeftAdjustedForDrawing(e,t,!1)-s.GridLineWidthPx,n=l.getCellTopAdjustedForDrawing(e,t)-s.GridLineWidthPx,o=l.getCellWidthAdjustedForDrawing(e,t)+s.GridLineWidthPx,i=l.getCellHeightAdjustedForDrawing(e,t)+s.GridLineWidthPx;return{x:r,y:n,width:o,height:i}}(t,r);if(o===n.Gradient)return c.fillCellWithGradientBackground(e,r.CachedStyle.Gradient,a,i);var u=function(e,t){if(t===n.FormulaParseError)return s.FormulaErrorBackgroundColor;return e.CachedStyle.BackgroundColor}(r,o);return i!==u&&(e.fillStyle=u),e.fillRect(a.x,a.y,a.width,a.height),u}function f(e,t,r){var n=l.getCellLeftAdjustedForDrawing(t,r,!1)-s.GridLineWidthPx,o=l.getCellTopAdjustedForDrawing(t,r)-s.GridLineWidthPx,i=l.getCellWidthAdjustedForDrawing(t,r)+s.GridLineWidthPx,a=l.getCellHeightAdjustedForDrawing(t,r)+s.GridLineWidthPx;e.fillRect(n,o,i,a)}function h(e){var t;return(null===(t=e.FormulaInfo)||void 0===t?void 0:t.HasError)?s.FormulaErrorBackgroundColor:e.CachedStyle.BackgroundColor}function m(e,t){var r;return(null===(r=t.FormulaInfo)||void 0===r?void 0:r.HasError)?n.FormulaParseError:a.isRenderFlagEnabled(o.RenderFlags.GradientFill,e)&&!d.isNullOrUndefined(t.CachedStyle.Gradient)?n.Gradient:d.isNullOrUndefined(t.CachedStyle.BackgroundColor)?n.None:n.Solid}t.drawBackgroundFill=function(e,t,r){if(u.verifyArgumentNotNull(t.RowOffsets,"model.RowOffsets","drawBackgroundFill"),u.verifyArgumentNotNull(t.ColumnOffsets,"model.ColumnOffsets","drawBackgroundFill"),u.verifyArgumentNotNull(t.RowHeights,"model.RowHeights","drawBackgroundFill"),u.verifyArgumentNotNull(t.ColumnWidths,"model.ColumnWidths","drawBackgroundFill"),u.verifyArgumentNotNull(t.Cells,"model.Cells","drawBackgroundFill"),u.verifyArgumentNotNull(t.Styles,"model.Styles","drawBackgroundFill"),!r.highContrastScheme)if(a.isRenderFlagEnabled(o.RenderFlags.GradientFill,t)){for(var d=t.Cells,s=void 0,c=[],C=a.isRenderFlagEnabled(o.RenderFlags.LargeBlocks,t),p=0;p<d.length;p++){(F=m(t,y=d[p]))!==n.None&&(C&&!i.cellIntersectsRenderingRegion(y,r.renderingRegion)||(l.isCellSpansMultipleRowsOrBlocks(y)?c.push([y,F]):s=g(e,t,y,F,s)))}for(p=0;p<c.length;p++){var y,F,v=c[p];s=g(e,t,y=v[0],F=v[1],s)}}else!function(e,t,r){for(var n,u=t.Cells,d=[],s=a.isRenderFlagEnabled(o.RenderFlags.LargeBlocks,t),c=0;c<u.length;c++){var g=u[c];(m=h(g))&&(s&&!i.cellIntersectsRenderingRegion(g,r.renderingRegion)||(l.isCellSpansMultipleRowsOrBlocks(g)&&m?d.push(g):(n!==m&&(e.fillStyle=m,n=m),f(e,t,g))))}for(c=0;c<d.length;c++){var m=h(g=d[c]);n!==m&&(e.fillStyle=m,n=m),f(e,t,g)}}(e,t,r)},function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.FormulaParseError=2]="FormulaParseError",e[e.Gradient=3]="Gradient"}(n||(n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0);function i(e,t,r,i){o.verifyArgumentNotNull(r,"cell.CachedStyle.Gradient.Stops","createGradientFill");for(var l=function(e,t){var r=t.x,o=t.y,i=t.width,l=t.height;switch(e){case n.GradientShadingStyle.Vertical:case n.GradientShadingStyle.Center:case n.GradientShadingStyle.TopRightCorner:return{x0:r,y0:0,x1:r+i,y1:0};case n.GradientShadingStyle.ReversedVertical:case n.GradientShadingStyle.TopLeftCorner:return{x0:r+i,y0:0,x1:r,y1:0};case n.GradientShadingStyle.Horizontal:case n.GradientShadingStyle.BottomRightCorner:case n.GradientShadingStyle.BottomLeftCorner:return{x0:0,y0:o,x1:0,y1:o+l};case n.GradientShadingStyle.ReversedHorizontal:return{x0:0,y0:o+l,x1:0,y1:o};case n.GradientShadingStyle.DiagonalUp:case n.GradientShadingStyle.DiagonalDown:case n.GradientShadingStyle.ReversedDiagonalUp:case n.GradientShadingStyle.ReversedDiagonalDown:return function(e,t){var r=t.width*t.width,o=t.height*t.height,i=r+o,l=t.x+t.width/2,a=t.y+t.height/2,u=t.width*o/i,d=r*t.height/i;switch(e){case n.GradientShadingStyle.DiagonalUp:break;case n.GradientShadingStyle.DiagonalDown:u=-u;break;case n.GradientShadingStyle.ReversedDiagonalUp:d=-d;break;case n.GradientShadingStyle.ReversedDiagonalDown:u=-u,d=-d;break;default:throw Error("getDiagonalGradientLine:: Gradient shading style is not diagonal.")}return{x0:l-u,y0:a-d,x1:l+u,y1:a+d}}(e,t);default:throw Error("getGradientLine:: Gradient not supported")}}(t,i),a=e.createLinearGradient(l.x0,l.y0,l.x1,l.y1),u=0;u<r.length;u++)a.addColorStop(r[u].Position,r[u].Color);return a}t.fillCellWithGradientBackground=function(e,t,r,o){var l=i(e,t.ShadingStyle,t.Stops,r);return l!==o&&(e.fillStyle=l),e.fillRect(r.x,r.y,r.width,r.height),function(e){switch(e){case n.GradientShadingStyle.TopLeftCorner:case n.GradientShadingStyle.TopRightCorner:case n.GradientShadingStyle.BottomLeftCorner:case n.GradientShadingStyle.BottomRightCorner:case n.GradientShadingStyle.Center:return!0;default:return!1}}(t.ShadingStyle)&&(l=e.fillStyle=i(e,function(e){switch(e){case n.GradientShadingStyle.TopLeftCorner:case n.GradientShadingStyle.TopRightCorner:return n.GradientShadingStyle.ReversedHorizontal;case n.GradientShadingStyle.BottomLeftCorner:return n.GradientShadingStyle.ReversedVertical;case n.GradientShadingStyle.BottomRightCorner:return n.GradientShadingStyle.Vertical;case n.GradientShadingStyle.Center:return n.GradientShadingStyle.Horizontal;default:throw Error("getSecondPassShadingStyle:: Gradient shading style does not have a second pass.")}}(t.ShadingStyle),t.Stops,r),function(e,t,r){var o=r.x,i=r.y,l=r.width,a=r.height;switch(e.beginPath(),e.moveTo(o,i),e.lineTo(o+l,i),t){case n.GradientShadingStyle.TopLeftCorner:case n.GradientShadingStyle.BottomRightCorner:e.lineTo(o+l,i+a);break;case n.GradientShadingStyle.TopRightCorner:case n.GradientShadingStyle.BottomLeftCorner:e.lineTo(o,i+a);break;case n.GradientShadingStyle.Center:e.lineTo(o,i+a),e.lineTo(o+l,i+a);break;default:throw Error("setSecondPassStencil:: Gradient shading style does not have a second pass.")}e.lineTo(o,i)}(e,t.ShadingStyle,r),e.fill()),l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CurrencySymbols="$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹",t.SetCellOfInterestSymbols='=\\[\\]\\./%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*'+t.CurrencySymbols,t.AllowedCharactersToLog=t.SetCellOfInterestSymbols+"\\sꃂ",t.DigitReplaceValue="d",t.DigitPattern="[0-9]",t.CharacterReplaceValue="w",t.ValueAnnonymizerRegex=new RegExp("[^"+t.AllowedCharactersToLog+t.DigitReplaceValue+"]","gm"),t.Digit=new RegExp(t.DigitPattern,"gm")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(19);!function(e){e[e.Pending=0]="Pending",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(n||(n={}));var i={};function l(e){var t="11pt "+e;return document.fonts.check(t)}t.registerActionOnFontLoadIfRequired=function(e,t,r){document.fonts&&function(e){var t=!1;if(!e.Fonts)return t;for(var r=0;r<e.Fonts.length;r++){var o=e.Fonts[r].FontName;i[o]?i[o]===n.Pending&&(t=!0):(t=!0,i[o]=n.Pending)}return t}(e)&&function(e,t,r){document.fonts.ready.then((function(){(function(e,t){if(!e.Fonts)return!1;for(var r=!1,o=0;o<e.Fonts.length;o++){var a=e.Fonts[o].FontName;i[a]!==n.Loaded&&(l(a)?(i[a]=n.Loaded,r=!0):(i[a]=n.Failed,t(a)))}return r})(e,r)&&(!function(e){e.IsDirty=!0}(e),o.recalculateFontHeights(),t())}))}(e,t,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(22),o=r(6),i=r(7),l=r(3),a=r(1),u=r(0),d=r(2);t.updateCellShrinkToFit=function(e,t,r){var s=u.getFontCssStringFromFont(d.isRenderFlagEnabled(a.RenderFlags.FontName,t),r.CachedFont,void 0);d.isRenderFlagEnabled(a.RenderFlags.MeasureTextRefactor,t)&&(e.font=s);var c,g=d.isRenderFlagEnabled(a.RenderFlags.MeasureTextRefactor,t)?o.getTextWidthNoCaching(e,t,r):n.GridBlockRendererGlobals.measureTextWidth(r.Text,s,d.isRenderFlagEnabled(a.RenderFlags.AdvancedTextMetrics,t)),f=i.getCellWidth(t,r,!1),h=r.CachedStyle.Indentation||0,m=r.CachedFont.Size;c=o.getHorizontalPadding(m,r.CachedStyle.HorizontalAlignment,r.CachedFont.Italic,h,!0,0);var C=l.getTextDrawingMaxWidth(f,c,0);r.ShrunkSize=function(e,t,r,n){if(e<t)return r;return r*(t/(e+n))}(g,C,m,c)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),l=r(3),a=r(8),u=r(7),d=r(35),s=r(4),c=r(57),g=r(58),f=r(13),h=r(59),m=r(60),C=r(61);function p(e,t,r,n){var i=function(e,t,r){var n=o.getActualFontSize(t,e),i=f.getIconSize(n,r),l=t.CondFormat.Icon,d=a.IconImageLookup[l.Set][l.Index],s=u.getCellLeftAdjustedForDrawing(e,t,!1)+f.getIconHorizontalPadding(n,r),c=g.getIconVerticalPosition(e,t,r,i,n);return{size:i,image:d,left:s,bottom:c}}(t,r,n),p=function(e,t,r){if(function(e,t,r){var n=u.getCellBottomAdjustedForDrawing(e,t)-s.GridLineWidthPx;if(r.bottom>=n)return!0;var o=u.getCellTopAdjustedForDrawing(e,t);if(r.bottom-r.size<=o)return!0;var i=u.getCellLeftAdjustedForDrawing(e,t,!1);if(r.left<=i)return!0;var l=u.getCellRightAdjustedForDrawing(e,t)-s.GridLineWidthPx;if(r.left+r.size>=l)return!0;return!1}(e,t,r))return{x:u.getCellLeftAdjustedForDrawing(e,t,!1),y:u.getCellTopAdjustedForDrawing(e,t),width:u.getCellWidthAdjustedForDrawing(e,t)-s.GridLineWidthPx,height:u.getCellHeightAdjustedForDrawing(e,t)-s.GridLineWidthPx};return}(t,r,i);switch(l.applyClipping(e,p),i.image){case a.CFIconImage.CircleLow:case a.CFIconImage.CircleMedium:case a.CFIconImage.CircleHigh:case a.CFIconImage.CircleEmpty:case a.CFIconImage.CircleFilled:case a.CFIconImage.FourCircleHigh:case a.CFIconImage.FourCircleLow:case a.CFIconImage.FourCircleMedium1:case a.CFIconImage.FourCircleMedium2:d.drawCircleIcon(e,t,r,i);break;case a.CFIconImage.TrafficHigh:case a.CFIconImage.TrafficMedium:case a.CFIconImage.TrafficLow:c.drawTrafficLightRimmed(e,t,r,i);break;case a.CFIconImage.SignalBarEmpty:case a.CFIconImage.SignalBarLow:case a.CFIconImage.SignalBarMedium1:case a.CFIconImage.SignalBarMedium2:case a.CFIconImage.SignalBarHigh:h.drawSignalBar(e,t,r,i);break;case a.CFIconImage.QuadrantEmpty:case a.CFIconImage.Quadrant25:case a.CFIconImage.QuadrantHalf:case a.CFIconImage.Quadrant75:case a.CFIconImage.QuadrantFull:m.drawQuadrantBoxes(e,t,r,i);break;case a.CFIconImage.FlagHigh:case a.CFIconImage.FlagMedium:case a.CFIconImage.FlagLow:C.drawFlag(e,t,r,i);break;default:throw Error("drawConditionalFormattingIcon: imageType: "+i.image+" not supported")}l.restoreClipping(e,p)}t.drawConditionalFormattingIcons=function(e,t,r){var a,u;o.verifyArgumentNotNull(e,"ctx","drawConditionalFormattingIcons"),o.verifyArgumentNotNull(t,"model","drawConditionalFormattingIcons"),o.verifyArgumentNotNull(r,"context","drawConditionalFormattingIcons");for(var d=t.Cells,s=i.isRenderFlagEnabled(n.RenderFlags.LargeBlocks,t),c=0;c<d.length;c++){var g=d[c];(null===(u=null===(a=g)||void 0===a?void 0:a.CondFormat)||void 0===u?void 0:u.Icon)&&(s&&!l.cellIntersectsRenderingRegion(g,r.renderingRegion)||p(e,t,g,r.devicePixelRatio))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(16),l=r(35),a=r(12);t.drawTrafficLightRimmed=function(e,t,r,u){n.verifyArgumentNotNull(e,"ctx","drawTrafficLightRimmed"),n.verifyArgumentNotNull(t,"model","drawTrafficLightRimmed"),n.verifyArgumentNotNull(r,"cell","drawTrafficLightRimmed"),n.verifyArgumentNotNull(u,"drawingContext","drawTrafficLightRimmed");var d=u.size,s={left:u.left,bottom:u.bottom,outerColor:a.TrafficHighRimmedRectColor,height:d,width:d,innerColor:void 0};i.drawRectangleIcon(e,t,r,s);var c=function(e){var t=e.image,r=e.size,n=e.left,i=e.bottom,l=r-2*o.CirclePaddingFromBoundariesPx,a=n+o.CirclePaddingFromBoundariesPx+.5,u=i-o.CirclePaddingFromBoundariesPx-.5;return{size:l,left:a,bottom:u,image:t}}(u);l.drawCircleIcon(e,t,r,c)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(6),l=r(7),a=r(15),u=r(13),d=r(8);function s(e,t,r,d,s,c){var g=function(e,t,r){return Math.round(i.getTextLineHeight(t,e)*r)}(e,t,r),f=o.isRenderFlagEnabled(n.RenderFlags.FontName,e),h=l.getCellHeightAdjustedForDrawing(e,t),m=i.getTextVerticalPosition(l.getCellTopAdjustedForDrawing(e,t),l.getCellBottomAdjustedForDrawing(e,t),s,g,h,1,void 0,f,a.cellHasBottomDoubleBorder(t,e),t.CachedFont.FontName,t.CachedFont.Size);return Math.floor(m-function(e,t,r){var n=u.pointsToPixels(t)*r/2,o=e/2;return Math.abs(n-o)}(d,c,r))}t.getIconVerticalPosition=function(e,t,r,o,i){var a=t.CachedStyle.VerticalAlignment;switch(a){case n.VerticalAlignment.Bottom:var u=l.getCellBottomAdjustedForDrawing(e,t),c=s(e,t,r,o,a,i);return Math.min(c,u-d.MinimalIconPadding);case n.VerticalAlignment.Top:var g=l.getCellTopAdjustedForDrawing(e,t),f=s(e,t,r,o,a,i);return Math.max(f,g+d.MinimalIconPadding+o);case n.VerticalAlignment.Center:case n.VerticalAlignment.Justify:case n.VerticalAlignment.Distributed:return Math.floor(l.getCellCenterYAdjustedForDrawing(e,t)+o/2);default:throw Error("getIconVerticalPosition: unsupported verticalAlignment: "+a)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(16),i=r(8),l=r(12);function a(e,t,r,n){var o=n.left,i=n.bottom;return{innerColor:t,outerColor:l.SignalBarOutlineColor,bottom:i,left:o+r*(e+1),height:r*(e+2),width:r}}t.drawSignalBar=function(e,t,r,u){n.verifyArgumentNotNull(e,"ctx","drawSignalBar"),n.verifyArgumentNotNull(t,"model","drawSignalBar"),n.verifyArgumentNotNull(r,"cell","drawSignalBar"),n.verifyArgumentNotNull(u,"drawingContext","drawSignalBar");for(var d=u.image,s=u.size,c=Math.floor(s/5),g=function(e){switch(e){case i.CFIconImage.SignalBarEmpty:return[l.SignalBarEmptyColor,l.SignalBarEmptyColor,l.SignalBarEmptyColor,l.SignalBarEmptyColor];case i.CFIconImage.SignalBarLow:return[l.SignalBarFilledColor,l.SignalBarEmptyColor,l.SignalBarEmptyColor,l.SignalBarEmptyColor];case i.CFIconImage.SignalBarMedium1:return[l.SignalBarFilledColor,l.SignalBarFilledColor,l.SignalBarEmptyColor,l.SignalBarEmptyColor];case i.CFIconImage.SignalBarMedium2:return[l.SignalBarFilledColor,l.SignalBarFilledColor,l.SignalBarFilledColor,l.SignalBarEmptyColor];case i.CFIconImage.SignalBarHigh:return[l.SignalBarFilledColor,l.SignalBarFilledColor,l.SignalBarFilledColor,l.SignalBarFilledColor];default:throw Error("getBarsColors: image: "+e+" not supported")}}(d),f=0;f<g.length;f++){var h=a(f,g[f],c,u);o.drawRectangleIcon(e,t,r,h)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(16),i=r(8),l=r(12);function a(e,t,r,n,o){var i=o.left,a=o.bottom;return{innerColor:r,outerColor:l.QuadrantBoxesOutlineColor,bottom:a-e*n,left:i+t*n,height:n,width:n}}t.drawQuadrantBoxes=function(e,t,r,u){n.verifyArgumentNotNull(e,"ctx","drawQuadrantBoxes"),n.verifyArgumentNotNull(t,"model","drawQuadrantBoxes"),n.verifyArgumentNotNull(r,"cell","drawQuadrantBoxes"),n.verifyArgumentNotNull(u,"drawingContext","drawQuadrantBoxes");for(var d=u.image,s=u.size,c=Math.floor(s/2),g=function(e){switch(e){case i.CFIconImage.QuadrantEmpty:return[[l.QuadrantBoxesEmptyColor,l.QuadrantBoxesEmptyColor],[l.QuadrantBoxesEmptyColor,l.QuadrantBoxesEmptyColor]];case i.CFIconImage.Quadrant25:return[[l.QuadrantBoxesFilledColor,l.QuadrantBoxesEmptyColor],[l.QuadrantBoxesEmptyColor,l.QuadrantBoxesEmptyColor]];case i.CFIconImage.QuadrantHalf:return[[l.QuadrantBoxesFilledColor,l.QuadrantBoxesFilledColor],[l.QuadrantBoxesEmptyColor,l.QuadrantBoxesEmptyColor]];case i.CFIconImage.Quadrant75:return[[l.QuadrantBoxesFilledColor,l.QuadrantBoxesFilledColor],[l.QuadrantBoxesFilledColor,l.QuadrantBoxesEmptyColor]];case i.CFIconImage.QuadrantFull:return[[l.QuadrantBoxesFilledColor,l.QuadrantBoxesFilledColor],[l.QuadrantBoxesFilledColor,l.QuadrantBoxesFilledColor]];default:throw Error("getBoxesColors: image: "+e+" not supported")}}(d),f=0;f<g.length;f++)for(var h=0;h<g.length;h++){var m=a(f,h,g[f][h],c,u);o.drawRectangleIcon(e,t,r,m)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(16),l=r(12),a=r(3),u=r(4);t.drawFlag=function(e,t,r,d){n.verifyArgumentNotNull(e,"ctx","drawFlags"),n.verifyArgumentNotNull(t,"model","drawFlags"),n.verifyArgumentNotNull(r,"cell","drawFlags"),n.verifyArgumentNotNull(d,"drawingContext","drawFlags");var s=d.image,c=d.size,g=d.left,f=d.bottom,h=Math.floor(c/2),m=Math.floor(c/3),C=function(e){switch(e){case o.CFIconImage.FlagHigh:return l.FlagHighInnerColor;case o.CFIconImage.FlagMedium:return l.FlagMediumInnerColor;case o.CFIconImage.FlagLow:return l.FlagLowInnerColor;default:throw Error("getFlagInnerColor: unsupported image type = "+e)}}(s),p=function(e){switch(e){case o.CFIconImage.FlagHigh:return l.FlagHighOuterColor;case o.CFIconImage.FlagMedium:return l.FlagMediumOuterColor;case o.CFIconImage.FlagLow:return l.FlagLowOuterColor;default:throw Error("getFlagOuterColor: unsupported image type = "+e)}}(s);!function(e,t,r,n,o,l,a,u,d){var s={left:n,bottom:o-l,outerColor:d,height:l,width:a,innerColor:u};i.drawRectangleIcon(e,t,r,s)}(e,t,r,g,f,h,m,C,p),function(e,t,r,n,o,l,a,u,d,s){var c=Math.floor(n/8),g={left:o+u,bottom:l-a+c,outerColor:s,height:a,width:u,innerColor:d};i.drawRectangleIcon(e,t,r,g)}(e,t,r,c,g,f,h,m,C,p),function(e,t,r,n){var i=n-.5,d=i-r,s=t+.5;e.lineWidth=o.FlagPoleWidth,e.setLineDash(u.DefaultDash),e.strokeStyle=l.FlagStickColor,e.beginPath(),a.drawLine(e,s,i,s,d),e.stroke()}(e,g,2*h,f)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(1),i=r(9),l=r(33),a=r(2),u=r(63),d=r(5),s=r(34),c=r(21),g=r(7),f=r(32),h=function(){function e(t){this.canvasInstance=null,e.verifyArgumentNotNull(t,"model","constructor"),this.model=t}return e.prototype.getOrCreateCanvasContext=function(){this.canvasInstance||(this.canvasInstance=document.createElement("canvas"));var e=this.canvasInstance.getContext("2d");if(!e)throw Error("GetOrCreateCanvasContext: ctx is undefined");return e},e.prototype.getCell=function(e,t){return n.getCell(e,t,this.model)},e.prototype.getOrCreateCell=function(t,r){var o=this.getCell(t,r);return o||(e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getOrCreateCell"),e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getOrCreateCell"),e.verifyArgumentNotNull(this.model.Styles,"Styles","getOrCreateCell"),(t<0||r<0||t>=this.model.RowNumbers.length||r>=this.model.ColumnNumbers.length)&&this.throwErrorWrapper("cell requested for a cell which is not in range of the model. rowIndex:  "+t+", RowNumbers.length: "+this.model.RowNumbers.length+",  colIndex:  "+r+", ColumnNumbers.length: "+this.model.ColumnNumbers.length,"getOrCreateCell"),n.getDefaultCell(t,r,this.model.Styles,this.model.Fonts))},e.prototype.getColumnWidth=function(e){return n.getColumnWidth(e,this.model)},e.prototype.getRowHeight=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowHeight"),e.verifyArgumentNotNull(this.model.RowHeights,"RowHeights","getRowHeight"),(t>this.model.RowHeights.length-1||t<0)&&this.throwErrorWrapper("row height requested for a cell which is not in range of the model","getRowHeight"),this.model.RowHeights[t]},e.prototype.getColumnOffset=function(t){return e.verifyArgumentNotNull(this.model,"model","getColumnOffset"),e.verifyArgumentNotNull(this.model.ColumnOffsets,"ColumnOffsets","getColumnOffset"),(t>this.model.ColumnOffsets.length-1||t<0)&&this.throwErrorWrapper("column offset requested for a cell which is not in range of the model","getColumnOffset"),this.model.ColumnOffsets[t]},e.prototype.getRowOffset=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowOffset"),e.verifyArgumentNotNull(this.model.RowOffsets,"RowOffsets","getRowOffset"),(t>this.model.RowOffsets.length-1||t<0)&&this.throwErrorWrapper("row offset requested for a cell which is not in range of the model","getRowOffset"),this.model.RowOffsets[t]},e.prototype.getRowNumber=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowNumber"),e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowNumber"),this.model.RowNumbers[t]},e.prototype.getColumnNumber=function(t){return e.verifyArgumentNotNull(this.model,"model","getColumnNumber"),e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnNumber"),this.model.ColumnNumbers[t]},e.prototype.getCellStyle=function(e){return n.getCellStyle(e,this.model)},e.prototype.getCellFont=function(e){return n.getCellFont(e,this.model)},e.prototype.getBorderStyle=function(t){return e.verifyArgumentNotNull(t,"cell","getBorderStyle"),e.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","getBorderStyle"),d.isNullOrUndefined(t.CachedBorderStyle)&&(t.CachedBorderStyle=i.getReferencedObjectById(t.BorderStyleID,this.model.BorderStyles)),t.CachedBorderStyle},e.prototype.removeBorder=function(t){e.verifyArgumentNotNull(t,"cell","removeBorder"),e.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","removeBorder"),t.BorderStyleID=o.UniqueStyleID.DefaultBorder,t.CachedBorderStyle=i.getReferencedObjectById(t.BorderStyleID,this.model.BorderStyles)},e.prototype.getNumberOfBlockColumns=function(){return this.model.ColumnNumbers.length},e.prototype.isRtl=function(){return this.model.IsRtl},e.prototype.replaceCellInModel=function(t,r){e.verifyArgumentNotNull(t,"cell","replaceCellInModel"),e.verifyArgumentNotNull(r,"immediateModel","replaceCellInModel"),e.verifyArgumentNotNull(r.Styles,"immediateModel!.Styles","replaceCellInModel");var o=r.Styles[0];e.verifyArgumentNotNull(o,"style","replaceCellInModel"),e.verifyArgumentNotNull(r.Fonts,"immediateModel!.Fonts","replaceCellInModel");var i=r.Fonts[0];e.verifyArgumentNotNull(i,"font","replaceCellInModel");var l=this.getLastFontID()+1;i.ID=l,this.model.Fonts.splice(l,0,i),o.FontID=l,t.CachedFont=i,i.RefCount=1;var u=this.getLastNonUniqueStyleID()+1;if(o.ID=u,this.model.Styles.splice(u,0,o),t.StyleID=u,t.CachedStyle=o,!d.isNullOrUndefined(r.BorderStyles)){var s=r.BorderStyles[0];!d.isNullOrUndefined(s)&&!d.isNullOrUndefined(s.Borders)&&s.Borders.length>0&&(s.RefCount=1,this.setBorders(t,s))}if(this.getCell(t.Row,t.Col)){var c=n.getCellPositionInArray(t,this.model.Cells);this.model.Cells[c]=t,this.model.CellLookup[a.cellLookupKey(t.Row,t.Col)]=t}else this.attachCellToModel(t);o.RefCount=1},e.prototype.attachCellToModel=function(t){if(e.verifyArgumentNotNull(t,"cell","attachCellToModel"),e.verifyArgumentNotNull(this.model.Cells,"this.model.Cells","attachCellToModel"),!this.getCell(t.Row,t.Col)){var r=n.getCellPositionInArray(t,this.model.Cells);this.model.Cells.splice(r,0,t),this.model.CellLookup[a.cellLookupKey(t.Row,t.Col)]=t;var o=this.getCellStyle(t);e.verifyArgumentNotNull(o,"style","attachCellToModel"),o.RefCount++;var i=this.getBorderStyle(t);e.verifyArgumentNotNull(i,"borderStyle","attachCellToModel"),i.RefCount++,t.CachedBorderStyle=i}},e.prototype.prepareCellStyleForEdit=function(t){e.verifyArgumentNotNull(t,"cell","prepareCellStyleForEdit");var r=this.getCellStyle(t);if(!this.isStyleUnique(r.ID)&&r.RefCount<=1)return!0;var n=this.getLastNonUniqueStyleID()+1,o=this.duplicateStyle(r,n,1);return r.RefCount=Math.max(0,r.RefCount-1),this.model.Styles.splice(n,0,o),t.CachedStyle=o,t.StyleID=n,!1},e.prototype.prepareFontForEdit=function(e){var t=this.getCellFont(e);this.prepareCellStyleForEdit(e)&&t.RefCount<=1||this.duplicateAndSetNewFontOnCell(t,e)},e.prototype.prepareBorderStyleForEdit=function(t){e.verifyArgumentNotNull(t,"cell","prepareBorderStyleForEdit");var r=this.getBorderStyle(t);if(!(r.ID!==o.UniqueStyleID.DefaultBorder&&r.RefCount<=1)){var n=this.duplicateBorderStyle(r,0,1);this.setBorders(t,n)}},e.prototype.cloneBorderStyle=function(t){e.verifyArgumentNotNull(t,"cell","cloneBorderStyle");var r=this.getBorderStyle(t);return this.duplicateBorderStyle(r,r.ID,1)},e.prototype.setBorders=function(t,r){e.verifyArgumentNotNull(t,"cell","setBorders"),e.verifyArgumentNotNull(r,"BorderStyle","setBorders");var n=this.getBorderStyle(t),o=this.getLastBorderStyleID()+1;r.ID=o,n.RefCount=Math.max(0,n.RefCount-1),this.model.BorderStyles.splice(o,0,r),t.BorderStyleID=o,t.CachedBorderStyle=r},e.prototype.getCellCssFont=function(e){return this.verifyCellStyleAndFont(e,"getCellCssFont"),n.getFontCssStringFromCell(this.model,e)},e.prototype.isDirty=function(){return!!this.model.IsDirty&&this.model.IsDirty},e.prototype.setDirty=function(){this.model.IsDirty||(this.model.DirtyTimestamp=Date.now()),this.model.IsDirty=!0},e.prototype.getCalcBlockModel=function(){var e=new u.CalcBlockModel,t=this.model.RowNumbers.slice(),r=this.model.ColumnNumbers.slice();e.addHeaders(t,r);for(var n=0;n<this.model.Cells.length;n++){var o=this.model.Cells[n],i=e.createCell(o);e.addCell(i)}return e},e.prototype.getDirtyTimestamp=function(){return this.model.DirtyTimestamp?this.model.DirtyTimestamp:-1},e.prototype.updateCellSpillInformation=function(e){if(this.verifyCellStyleAndFont(e,"updateCellSpillInformation"),!e.Merge){e.Spill=void 0;var t=null;a.isRenderFlagEnabled(o.RenderFlags.MeasureTextRefactor,this.model)&&(t=this.getOrCreateCanvasContext(),this.setContextCellFont(t,e)),l.updateCellSpill(t,this.model,e)}},e.prototype.updateClosestNonEmptyCellsSpillInformation=function(t){e.verifyArgumentNotNull(t,"cell","updateClosestNonEmptyCellsSpillInformation");var r=null;a.isRenderFlagEnabled(o.RenderFlags.MeasureTextRefactor,this.model)&&(r=this.getOrCreateCanvasContext(),this.setContextCellFont(r,t)),l.updateClosestNonEmptyCellsSpill(r,t,this.model)},e.prototype.getUserInput=function(t){return e.verifyArgumentNotNull(t,"cell","getUserInput"),t.UserInput},e.prototype.setUserInput=function(t,r){e.verifyArgumentNotNull(t,"cell","setUserInput"),e.verifyArgumentNotNull(r,"userInput","setUserInput"),t.UserInput=r},e.prototype.clearCellFormat=function(e){var t=i.getReferencedObjectById(o.UniqueStyleID.Default,this.model.Styles);e.StyleID=o.UniqueStyleID.Default,e.CachedStyle=t,e.CachedFont=i.getReferencedObjectById(t.FontID,this.model.Fonts),e.BorderStyleID=o.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=i.getReferencedObjectById(o.UniqueStyleID.DefaultBorder,this.model.BorderStyles)},e.prototype.getRowIndex=function(e){return n.verifyArgumentNotNull(this.model,"model","getRowIndex"),n.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowIndex"),n.binarySearch(this.model.RowNumbers,0,this.model.RowNumbers.length,e,n.numbersComparer)},e.prototype.getColumnIndex=function(e){return n.verifyArgumentNotNull(this.model,"model","getColumnIndex"),n.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnIndex"),n.binarySearch(this.model.ColumnNumbers,0,this.model.ColumnNumbers.length,e,n.numbersComparer)},e.prototype.getCellWidth=function(e){return n.verifyArgumentNotNull(this.model,"model","getCellWidth"),n.verifyArgumentNotNull(e,"cell","getCellWidth"),g.getCellWidth(this.model,e,!0)},e.prototype.getCellHeight=function(e){return n.verifyArgumentNotNull(this.model,"model","getCellHeight"),n.verifyArgumentNotNull(e,"cell","getCellHeight"),g.getCellHeight(this.model,e,!0)},e.prototype.getFormattedText=function(t){var r=this;e.verifyArgumentNotNull(t,"cell","getFormattedText"),e.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","getFormattedText");var n=new Set,o=[];if(t.TextRuns)t.TextRuns.forEach((function(e){n.add(e.FontID),o.push(r.duplicateTextRun(e))}));else{var i=t.CachedStyle?t.CachedStyle:this.getCellStyle(t),l={FontID:i.FontID,StartIndex:0};n.add(i.FontID),o.push(l)}var a=[];return n.forEach((function(e){if(e<r.model.Fonts.length){var t=r.model.Fonts[e];a[e]=r.duplicateFont(t,t.ID,t.RefCount)}else r.throwErrorWrapper("Font "+e+" does not exist","getFormattedText")})),{Text:t.Text||"",TextRuns:o,Fonts:a}},e.prototype.serializeCell=function(e){return s.serializeCell(e,this.model)},e.prototype.getOutlineState=function(e,t){var r=e?this.model.RowOutlines:this.model.ColumnOutlines;return r?r[t]:o.OutlineState.None},e.prototype.compareCells=function(e,t,r){return c.areCellsEqual(e,t,r,this.model)},e.prototype.updateNumFmt=function(t){e.verifyArgumentNotNull(t,"cell","updateNumFmt"),a.isAccAndCustomNumFmtApplicable(t,this.model)?f.updateNumFmtFromCell(t):t.NumFmt=void 0},e.prototype.isStyleUnique=function(e){return e===o.UniqueStyleID.Default||e===o.UniqueStyleID.Hyperlink},e.prototype.getLastNonUniqueStyleID=function(){return this.model.Styles.length-2-1},e.prototype.getLastFontID=function(){return this.model.Fonts.length-1},e.prototype.getLastBorderStyleID=function(){return this.model.BorderStyles.length-1},e.prototype.duplicateStyle=function(e,t,r){var n={BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment,ID:t,NamedStyleId:e.NamedStyleId,RefCount:r,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder,FontID:e.FontID,ShrinkToFit:e.ShrinkToFit};this.model.Fonts&&i.getReferencedObjectById(e.FontID,this.model.Fonts).RefCount++;return n},e.prototype.duplicateBorderStyle=function(e,t,r){for(var n=[],o=0;o<e.Borders.length;o++){var i=e.Borders[o],l={BorderLineStyle:i.BorderLineStyle,BorderPosition:i.BorderPosition,Weight:i.Weight,Color:{Red:i.Color.Red,Blue:i.Color.Blue,Green:i.Color.Green}};n.push(l)}return{Borders:n,ID:t,RefCount:r}},e.prototype.duplicateFont=function(e,t,r){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,ID:t,Italic:e.Italic,RefCount:r,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign}},e.prototype.duplicateTextRun=function(e){return{FontID:e.FontID,StartIndex:e.StartIndex}},e.prototype.duplicateAndSetNewFontOnCell=function(e,t){var r=this.model.Fonts.length,n=this.duplicateFont(e,r,1);e.RefCount=Math.max(0,e.RefCount-1),this.model.Fonts.splice(r,0,n),t.CachedFont=n,t.CachedStyle.FontID=r},e.prototype.throwErrorWrapper=function(e,t){n.throwError(e,"GridBlockModelAccessor."+t)},e.verifyArgumentNotNull=function(e,t,r){n.verifyArgumentNotNull(e,t,"GridBlockModelAccessor."+r)},e.prototype.verifyCellStyleAndFont=function(e,t){n.verifyArgumentNotNull(e,"cell",t),e.CachedStyle||n.getCellStyle(e,this.model),e.CachedFont||n.getCellFont(e,this.model)},e.prototype.setContextCellFont=function(e,t){e.font=n.getFontCssStringFromCell(this.model,t)},e}();t.GridBlockModelAccessor=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(5),i=r(1),l=function(){function e(){this.RowNumbers=[],this.ColumnNumbers=[],this.Cells={},this.index=-1,this.keys=null}return e.prototype.createCell=function(e){var t,r={col:e.Col,row:e.Row,text:e.Text,formula:null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula,value:e.Value,ifmt:e.Ifmt,formulaType:e.FormulaInfo?e.FormulaInfo.FormulaType:i.CellFormulaType.Value};return r.valueType=e.ValueType,r},e.prototype.addCell=function(e){if(-1!==this.index)throw"cannot add cell after iterating cells";this.Cells[n.cellLookupKey(e.row,e.col)]=e,this.keys=null},e.prototype.addHeaders=function(e,t){this.RowNumbers=e,this.ColumnNumbers=t},e.prototype.getRowNumbers=function(){return this.RowNumbers},e.prototype.getColumnNumbers=function(){return this.ColumnNumbers},e.prototype.getCell=function(e,t){return o.isNullOrUndefined(this.Cells)?null:this.Cells[n.cellLookupKey(e,t)]},e.prototype.reset=function(){this.index=0,o.isNullOrUndefined(this.keys)&&(this.keys=Object.keys(this.Cells))},e.prototype.getNextCell=function(){if(o.isNullOrUndefined(this.Cells)||o.isNullOrUndefined(this.keys))return null;if(-1===this.index)return null;if(this.index>=this.keys.length)return null;var e=this.Cells[this.keys[this.index]];return this.index++,e},e}();t.CalcBlockModel=l}]);
//# sourceMappingURL=gridRenderer.min.js.map