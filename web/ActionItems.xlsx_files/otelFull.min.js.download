var otelFull=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=40)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);t.AWTPropertyType=i.AWTPropertyType,t.AWTPiiKind=i.AWTPiiKind,t.AWTEventPriority=i.AWTEventPriority,t.AWTEventsDroppedReason=i.AWTEventsDroppedReason,t.AWTEventsRejectedReason=i.AWTEventsRejectedReason,t.AWTCustomerContentKind=i.AWTCustomerContentKind;var r=n(7);t.AWTUserIdType=r.AWTUserIdType,t.AWTSessionState=r.AWTSessionState;var o=n(16);t.AWT_BEST_EFFORT=o.AWT_BEST_EFFORT,t.AWT_NEAR_REAL_TIME=o.AWT_NEAR_REAL_TIME,t.AWT_REAL_TIME=o.AWT_REAL_TIME;var s=n(8);t.AWTEventProperties=s.default;var a=n(17);t.AWTLogger=a.default;var u=n(21);t.AWTLogManager=u.default;var c=n(39);t.AWTTransmissionManager=c.default;var l=n(19);t.AWTSerializer=l.default;var d=n(10);t.AWTSemanticContext=d.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_USGOV_DOD="https://pf.pipe.aria.microsoft.com/Collector/3.0",t.AWT_COLLECTOR_URL_USGOV_DOJ="https://tb.pipe.aria.microsoft.com/Collector/3.0"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(t.AWTPropertyType||(t.AWTPropertyType={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.AWTPiiKind||(t.AWTPiiKind={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(t.AWTCustomerContentKind||(t.AWTCustomerContentKind={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(t.AWTEventPriority||(t.AWTEventPriority={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull",e[e.MaxRetryLimit=4]="MaxRetryLimit"}(t.AWTEventsDroppedReason||(t.AWTEventsDroppedReason={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(t.AWTEventsRejectedReason||(t.AWTEventsRejectedReason={}))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),r=n(1),o=/[xy]/g;t.EventNameAndTypeRegex=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t.EventNameDotRegex=/\./g,t.PropertyNameRegex=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.StatsApiKey="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238";var s=null,a=null,u=null;function c(e){return"string"==typeof e}function l(e){return"number"==typeof e}function d(e){return"boolean"==typeof e}function f(e){return e instanceof Date}function p(e){return 1e4*(e+621355968e5)}function h(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function _(){return"object"==typeof self&&"ServiceWorkerGlobalScope"===self.constructor.name}function v(e){return e<10?"0"+e:e.toString()}function g(e){return null==e||""===e}t.numberToBondInt64=function(e){var t=new i.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(o,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.isString=c,t.isNumber=l,t.isBoolean=d,t.isDate=f,t.msToTicks=p,t.getTenantId=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""},t.isBeaconsSupported=function(){return null===s&&(s="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),s},t.isUint8ArrayAvailable=function(){return null===a&&(a="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}()&&!h()),a},t.isPriority=function(e){return!(!l(e)||!(e>=1&&e<=3||5===e))},t.sanitizeProperty=function(e,n){return!t.PropertyNameRegex.test(e)||g(n)?null:(g(n.value)&&(n={value:n,type:r.AWTPropertyType.Unspecified}),n.type=function(e,t){switch(t=function(e){if(l(e)&&e>=0&&e<=4)return!0;return!1}(t)?t:r.AWTPropertyType.Unspecified){case r.AWTPropertyType.Unspecified:return function(e){switch(typeof e){case"string":return r.AWTPropertyType.String;case"boolean":return r.AWTPropertyType.Boolean;case"number":return r.AWTPropertyType.Double;case"object":return f(e)?r.AWTPropertyType.Date:null}return null}(e);case r.AWTPropertyType.String:return c(e)?t:null;case r.AWTPropertyType.Boolean:return d(e)?t:null;case r.AWTPropertyType.Date:return f(e)&&NaN!==e.getTime()?t:null;case r.AWTPropertyType.Int64:return l(e)&&e%1==0?t:null;case r.AWTPropertyType.Double:return l(e)?t:null}return null}(n.value,n.type),n.type?(f(n.value)&&(n.value=p(n.value.getTime())),n.pii>0&&n.cc>0?null:n.pii?function(e){if(l(e)&&e>=0&&e<=13)return!0;return!1}(n.pii)?n:null:n.cc?function(e){if(l(e)&&e>=0&&e<=1)return!0;return!1}(n.cc)?n:null:n):null)},t.getISOString=function(e){return e.getUTCFullYear()+"-"+v(e.getUTCMonth()+1)+"-"+v(e.getUTCDate())+"T"+v(e.getUTCHours())+":"+v(e.getUTCMinutes())+":"+v(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"},t.useXDomainRequest=function(){if(null===u){var e=new XMLHttpRequest;u=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return u},t.useFetchRequest=function(){return h()||_()},t.isReactNative=h,t.isServiceWorkerGlobalScope=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),r=n(1),o=n(12),s=n(18),a=n(8),u=n(21),c=n(3),l=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout((function(){return e._batchAndSendEvents()}),t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new o.default(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),s.default.initialize((function(e,n){if(t._config.canSendStatEvent("awt_stats")){var i=new a.default("awt_stats");for(var o in i.setEventPriority(r.AWTEventPriority.High),i.setProperty("TenantId",n),e)e.hasOwnProperty(o)&&i.setProperty(o,e[o].toString());u.default.getLogger(c.StatsApiKey).logEvent(i)}}))},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(var n=2;n>=0;--n)if(e[t][n]<0){for(var i=n;i>=0;--i)e[t][i]=-1;break}for(n=2;n>0;--n)if(e[t][n]>0&&e[t][n-1]>0){var r=e[t][n-1]/e[t][n];e[t][n-1]=Math.ceil(r)*e[t][n]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===r.AWTEventPriority.Immediate_sync&&(e.priority=r.AWTEventPriority.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<t&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){s.default.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile=i.AWT_REAL_TIME,this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=r.AWTEventPriority.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=r.AWTEventPriority.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=r.AWTEventPriority.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles[i.AWT_REAL_TIME]=[4,2,1],this._profiles[i.AWT_NEAR_REAL_TIME]=[12,6,3],this._profiles[i.AWT_BEST_EFFORT]=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile=i.AWT_REAL_TIME,e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e){for(var t=this,n=function(n){i.listeners[n].eventsSent&&setTimeout((function(){return t.listeners[n].eventsSent(e)}),0)},i=this,r=0;r<this.listeners.length;++r)n(r)},e.eventsDropped=function(e,t){for(var n=this,i=function(i){r.listeners[i].eventsDropped&&setTimeout((function(){return n.listeners[i].eventsDropped(e,t)}),0)},r=this,o=0;o<this.listeners.length;++o)i(o)},e.eventsRetrying=function(e){for(var t=this,n=function(n){i.listeners[n].eventsRetrying&&setTimeout((function(){return t.listeners[n].eventsRetrying(e)}),0)},i=this,r=0;r<this.listeners.length;++r)n(r)},e.eventsRejected=function(e,t){for(var n=this,i=function(i){r.listeners[i].eventsRejected&&setTimeout((function(){return n.listeners[i].eventsRejected(e,t)}),0)},r=this,o=0;o<this.listeners.length;++o)i(o)},e.listeners=[],e}();t.default=i},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(t.AWTUserIdType||(t.AWTUserIdType={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(t.AWTSessionState||(t.AWTSessionState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(1),o=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,n){void 0===n&&(n=r.AWTPropertyType.Unspecified);var o={value:t,type:n,pii:r.AWTPiiKind.NotSet,cc:r.AWTCustomerContentKind.NotSet};null!==(o=i.sanitizeProperty(e,o))?this._event.properties[e]=o:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,n,o){void 0===o&&(o=r.AWTPropertyType.Unspecified);var s={value:t,type:o,pii:n,cc:r.AWTCustomerContentKind.NotSet};null!==(s=i.sanitizeProperty(e,s))?this._event.properties[e]=s:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,n,o){void 0===o&&(o=r.AWTPropertyType.Unspecified);var s={value:t,type:o,pii:r.AWTPiiKind.NotSet,cc:n};null!==(s=i.sanitizeProperty(e,s))?this._event.properties[e]=s:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.Int64=i;var r=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.UInt64=r;var o=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}();t.Number=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),r=n(1),o=n(7),s=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(i.default.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",e)},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,n){if(!isNaN(n)&&null!==n&&n>=0&&n<=12)this._addContext("UserInfo.IdType",n.toString());else{var i=void 0;switch(t){case r.AWTPiiKind.SipAddress:i=o.AWTUserIdType.SipAddress;break;case r.AWTPiiKind.PhoneNumber:i=o.AWTUserIdType.PhoneNumber;break;case r.AWTPiiKind.SmtpAddress:i=o.AWTUserIdType.EmailAddress;break;default:i=o.AWTUserIdType.Unknown}this._addContext("UserInfo.IdType",i.toString())}if(isNaN(t)||null===t||t===r.AWTPiiKind.NotSet||t>13)switch(n){case o.AWTUserIdType.Skype:t=r.AWTPiiKind.Identity;break;case o.AWTUserIdType.EmailAddress:t=r.AWTPiiKind.SmtpAddress;break;case o.AWTUserIdType.PhoneNumber:t=r.AWTPiiKind.PhoneNumber;break;case o.AWTUserIdType.SipAddress:t=r.AWTPiiKind.SipAddress;break;default:t=r.AWTPiiKind.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,n){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,n)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r="MicrosoftApplicationsTelemetryDeviceId",o="MicrosoftApplicationsTelemetryFirstLaunchTime",s="MSIE",a="Chrome",u="Firefox",c="Safari",l="Edge",d="Electron",f="SkypeShell",p="PhantomJS",h="Opera",_="Windows",v="Mac OS X",g="Windows Phone",y="Windows RT",m="iOS",T="Android",S="Linux",E="Chrome OS",b=/(windows|win32)/i,w=/ arm;/i,A=/windows\sphone\s\d+\.\d+/i,I=/(macintosh|mac os x)/i,C=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,P=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,O=/android/i,k=/CrOS/i,N={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},x=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,n){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),n||"undefined"==typeof navigator||(n=navigator.userAgent||""),this._autoCollectFromUserAgent(n),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(r),void this._deleteCookie(o);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(r),n=this._getData(o);t!==e&&(n=i.getISOString(new Date)),this._saveData(r,e),this._saveData(o,n),this._setFirstLaunchTime(n)}},e._autoCollectDeviceId=function(){var e=this._getData(r);e||(e=i.newGuid()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){"undefined"!=typeof document&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),"undefined"!=typeof navigator&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,i="+";n>0&&(i="-"),n=Math.abs(n),t=Math.abs(t),this._semanticContext.setUserTimeZone(i+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var n=this._getOsName(e);this._semanticContext.setDeviceOsName(n),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,n))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?h:this._userAgentContainsString(p,e)?p:this._userAgentContainsString(l,e)||this._userAgentContainsString("Edg",e)?l:this._userAgentContainsString(d,e)?d:this._userAgentContainsString(a,e)?a:this._userAgentContainsString("Trident",e)?s:this._userAgentContainsString(u,e)?u:this._userAgentContainsString(c,e)?c:this._userAgentContainsString(f,e)?f:"Unknown"},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=i.getISOString(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){if(t===s)return this._getIeVersion(e);if(t===l){var n=this._getOtherVersion(t,e);return"Unknown"===n?this._getOtherVersion("Edg",e):n}return this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(s+" ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e._getOtherVersion=function(e,t){e===c&&(e="Version");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n?n[1]:"Unknown"},e._getOsName=function(e){return e.match(A)?g:e.match(w)?y:e.match(C)?m:e.match(O)?T:e.match(P)?S:e.match(I)?v:e.match(b)?_:e.match(k)?E:"Unknown"},e._getOsVersion=function(e,t){return t===_?this._getGenericOsVersion(e,"Windows NT"):t===T?this._getGenericOsVersion(e,t):t===v?this._getMacOsxVersion(e):"Unknown"},e._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?N[n[1]]?N[n[1]]:n[1]:"Unknown"},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(v+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var i=this._getDelimiter(n);return i?n.split(i)[0]:n}}return"Unknown"},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var n=new Date;n.setTime(n.getTime()+31536e6);var i="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+i}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){for(var i=t[n],r=0;" "===i.charAt(r);)r++;if(0===(i=i.substring(r)).indexOf(e))return i.substring(e.length,i.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable="undefined"!=typeof document&&void 0!==document.cookie,e}();t.default=x},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(28),o=n(4),s=n(38),a=n(5),u=n(3),c=function(){function e(e,t,n,o){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[i.AWTEventPriority.High]=[],this._inboundQueues[i.AWTEventPriority.Normal]=[],this._inboundQueues[i.AWTEventPriority.Low]=[],this._addEmptyQueues(),this._batcher=new s.default(this._outboundQueue,500),this._httpManager=new r.default(this._outboundQueue,e,this,n,o)}return e.prototype.addEvent=function(e){u.isPriority(e.priority)||(e.priority=i.AWTEventPriority.Normal),e.priority===i.AWTEventPriority.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit||this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):a.default.eventsDropped([e],i.AWTEventsDroppedReason.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[i.AWTEventPriority.High][0].length>0||this._inboundQueues[i.AWTEventPriority.Normal][0].length>0||this._inboundQueues[i.AWTEventPriority.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.addEvent(e[t][n]):a.default.eventsDropped([e[t][n]],i.AWTEventsDroppedReason.MaxRetryLimit);o.default.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(i.AWTEventPriority.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout((function(){return t._uploadNow(e)}),0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this.shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[i.AWTEventPriority.High][0].length+this._inboundQueues[i.AWTEventPriority.Normal][0].length+this._inboundQueues[i.AWTEventPriority.Low][0].length,this._inboundQueues[i.AWTEventPriority.High][0]=[],this._inboundQueues[i.AWTEventPriority.Normal][0]=[],this._inboundQueues[i.AWTEventPriority.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[i.AWTEventPriority.High].shift(),this._inboundQueues[i.AWTEventPriority.Normal].shift(),this._inboundQueues[i.AWTEventPriority.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[i.AWTEventPriority.High].push([]),this._inboundQueues[i.AWTEventPriority.Normal].push([]),this._inboundQueues[i.AWTEventPriority.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=i.AWTEventPriority.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return a.default.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],i.AWTEventsDroppedReason.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=i.AWTEventPriority.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var n=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(n)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(i.AWTEventPriority.Low),this._checkOutboundQueueEmptyAndSent((function(){t._removeFirstQueues(),null!=e&&e(),t._uploadNowQueue.length>0?setTimeout((function(){return t._uploadNow(t._uploadNowQueue.shift())}),0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&o.default.scheduleTimer())}))},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250)},e}();t.default=c},,function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,r=n;return[r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AWT_REAL_TIME="REAL_TIME",t.AWT_NEAR_REAL_TIME="NEAR_REAL_TIME",t.AWT_BEST_EFFORT="BEST_EFFORT"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(7),o=n(8),s=n(3),a=n(18),u=n(5),c=n(4),l=n(22),d=n(20),f=n(10),p=n(11),h=function(){function e(e){this._apiKey=e,this._contextProperties=new o.default,this._semanticContext=new f.default(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,n){void 0===n&&(n=i.AWTPropertyType.Unspecified),this._contextProperties.setProperty(e,t,n)},e.prototype.setContextWithPii=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithPii(e,t,n,r)},e.prototype.setContextWithCustomerContent=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,n,r)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(l.default.loggingEnabled){this._apiKey||(this._apiKey=l.default.defaultTenantToken,this._createInitId());var n=!0;s.isString(t)?t={name:t}:t instanceof o.default&&(t=t.getEvent(),n=!1),a.default.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,n),this._contextProperties)}},e.prototype.logSession=function(t,n){if(l.default.sessionEnabled){var o={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(o,n),o.priority=i.AWTEventPriority.High,t===r.AWTSessionState.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=s.newGuid(),this.setContext("Session.Id",this._sessionId),o.properties["Session.State"]="Started"}else{if(t!==r.AWTSessionState.Ended)return;if(0===this._sessionStartTime)return;var a=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);o.properties["Session.Id"]=this._sessionId,o.properties["Session.State"]="Ended",o.properties["Session.Duration"]=a.toString(),o.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(a),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}o.properties["Session.FirstLaunchTime"]=p.default.firstLaunchTime,this.logEvent(o)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,n,r,o,s){if(t&&n){var a={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(a,s),a.properties["Failure.Signature"]=t,a.properties["Failure.Detail"]=n,r&&(a.properties["Failure.Category"]=r),o&&(a.properties["Failure.Id"]=o),a.priority=i.AWTEventPriority.High,this.logEvent(a)}},e.prototype.logPageView=function(t,n,i,r,o,s){if(t&&n){var a={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(a,s),a.properties["PageView.Id"]=t,a.properties["PageView.Name"]=n,i&&(a.properties["PageView.Category"]=i),r&&(a.properties["PageView.Uri"]=r),o&&(a.properties["PageView.ReferrerUri"]=o),this.logEvent(a)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=s.newGuid())},e._addPropertiesToEvent=function(e,t){if(t)for(var n in t instanceof o.default&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority),t.properties)t.properties.hasOwnProperty(n)&&(e.properties[n]=t.properties[n])},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&s.isString(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(s.EventNameDotRegex,"_"),e.type&&s.isString(e.type)?e.type=e.type.toLowerCase():e.type="custom",s.EventNameAndTypeRegex.test(e.name)&&s.EventNameAndTypeRegex.test(e.type)?((!s.isNumber(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,l.default.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion",d.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),s.isPriority(e.priority)||(e.priority=i.AWTEventPriority.Normal),this._sendEvent(e)):u.default.eventsRejected([e],i.AWTEventsRejectedReason.InvalidEvent)):u.default.eventsRejected([e],i.AWTEventsRejectedReason.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e.properties[n]||(e.properties[n]=t[n]))},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:i.AWTPiiKind.NotSet,type:i.AWTPropertyType.String}},e._sendEvent=function(e){c.default.sendEvent(e)},e._getInternalEvent=function(e,t,n){if(e.properties=e.properties||{},n)for(var i in e.properties)e.properties.hasOwnProperty(i)&&(e.properties[i]=s.sanitizeProperty(i,e.properties[i]),null===e.properties[i]&&delete e.properties[i]);var r=e;return r.id=s.newGuid(),r.apiKey=t,r},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(5),o=n(1),s=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,r.default.addNotificationListener({eventsSent:function(e){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,n){switch(n){case o.AWTEventsDroppedReason.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.MaxRetryLimit:t._addStat("d_retry_limit",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case o.AWTEventsDroppedReason.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,n){switch(n){case o.AWTEventsRejectedReason.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case o.AWTEventsRejectedReason.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout((function(){return t.flush()}),6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout((function(){return e.flush()}),6e4)}},e._addStat=function(e,t,n){if(this._isInitalized&&n!==i.StatsApiKey){var r=i.getTenantId(n);this._stats[r]||(this._stats[r]={}),this._stats[r][e]?this._stats[r][e]=this._stats[r][e]+t:this._stats[r][e]=t}},e._isInitalized=!1,e._stats={},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(29),r=n(1),o=n(5),s=n(3),a=function(){function e(){}return e.getPayloadBlob=function(e,t){var n,a=!1,u=new i.IO.MemoryStream,c=new i.CompactBinaryProtocolWriter(u);for(var l in c._WriteFieldBegin(i._BondDataType._BT_MAP,3,null),c._WriteMapContainerBegin(t,i._BondDataType._BT_STRING,i._BondDataType._BT_LIST),e)if(a)n||(n={}),n[l]=e[l],delete e[l];else if(e.hasOwnProperty(l)){c._WriteString(l);var d=e[l];c._WriteContainerBegin(1,i._BondDataType._BT_STRUCT),c._WriteFieldBegin(i._BondDataType._BT_STRING,2,null),c._WriteString("act_default_source"),c._WriteFieldBegin(i._BondDataType._BT_STRING,5,null),c._WriteString(s.newGuid()),c._WriteFieldBegin(i._BondDataType._BT_INT64,6,null),c._WriteInt64(s.numberToBondInt64(Date.now())),c._WriteFieldBegin(i._BondDataType._BT_LIST,8,null);var f=u._GetBuffer().length+1;c._WriteContainerBegin(e[l].length,i._BondDataType._BT_STRUCT);for(var p=u._GetBuffer().length-f,h=0;h<d.length;++h){var _=u._GetBuffer().length;if(this.writeEvent(d[h],c),u._GetBuffer().length-_>2936012)o.default.eventsRejected([d[h]],r.AWTEventsRejectedReason.SizeLimitExceeded),d.splice(h--,1),u._GetBuffer().splice(_),this._addNewDataPackageSize(d.length,u,p,f);else if(u._GetBuffer().length>2936012){u._GetBuffer().splice(_),n||(n={}),e[l]=d.splice(0,h),n[l]=d,this._addNewDataPackageSize(e[l].length,u,p,f),a=!0;break}}c._WriteStructEnd(!1)}return c._WriteStructEnd(!1),{payloadBlob:u._GetBuffer(),remainingRequest:n}},e._addNewDataPackageSize=function(e,t,n,r){for(var o=i._Encoding._Varint_GetBytes(i.Number._ToUInt32(e)),s=0;s<n;++s){if(!(s<o.length)){t._GetBuffer().slice(r+s,n-s);break}t._GetBuffer()[r+s]=o[s]}},e.writeEvent=function(e,t){t._WriteFieldBegin(i._BondDataType._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(i._BondDataType._BT_INT64,3,null),t._WriteInt64(s.numberToBondInt64(e.timestamp)),t._WriteFieldBegin(i._BondDataType._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(i._BondDataType._BT_STRING,6,null),t._WriteString(e.name);var n={},o=0,a={},u=0,c={},l=0,d={},f=0,p={},h=0,_={},v=0,g={},y=0;for(var m in e.properties){if(e.properties.hasOwnProperty(m))if((S=e.properties[m]).cc>0)g[m]=S,y++;else if(S.pii>0)_[m]=S,v++;else switch(S.type){case r.AWTPropertyType.String:n[m]=S.value,o++;break;case r.AWTPropertyType.Int64:a[m]=S.value,u++;break;case r.AWTPropertyType.Double:c[m]=S.value,l++;break;case r.AWTPropertyType.Boolean:d[m]=S.value,f++;break;case r.AWTPropertyType.Date:p[m]=S.value,h++}}if(o)for(var m in t._WriteFieldBegin(i._BondDataType._BT_MAP,13,null),t._WriteMapContainerBegin(o,i._BondDataType._BT_STRING,i._BondDataType._BT_STRING),n)if(n.hasOwnProperty(m)){var T=n[m];t._WriteString(m),t._WriteString(T.toString())}if(v)for(var m in t._WriteFieldBegin(i._BondDataType._BT_MAP,30,null),t._WriteMapContainerBegin(v,i._BondDataType._BT_STRING,i._BondDataType._BT_STRUCT),_)if(_.hasOwnProperty(m)){var S=_[m];t._WriteString(m),t._WriteFieldBegin(i._BondDataType._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(i._BondDataType._BT_INT32,2,null),t._WriteInt32(S.pii),t._WriteFieldBegin(i._BondDataType._BT_STRING,3,null),t._WriteString(S.value.toString()),t._WriteStructEnd(!1)}if(f)for(var m in t._WriteFieldBegin(i._BondDataType._BT_MAP,31,null),t._WriteMapContainerBegin(f,i._BondDataType._BT_STRING,i._BondDataType._BT_BOOL),d)if(d.hasOwnProperty(m)){T=d[m];t._WriteString(m),t._WriteBool(T)}if(h)for(var m in t._WriteFieldBegin(i._BondDataType._BT_MAP,32,null),t._WriteMapContainerBegin(h,i._BondDataType._BT_STRING,i._BondDataType._BT_INT64),p)if(p.hasOwnProperty(m)){T=p[m];t._WriteString(m),t._WriteInt64(s.numberToBondInt64(T))}if(u)for(var m in t._WriteFieldBegin(i._BondDataType._BT_MAP,33,null),t._WriteMapContainerBegin(u,i._BondDataType._BT_STRING,i._BondDataType._BT_INT64),a)if(a.hasOwnProperty(m)){T=a[m];t._WriteString(m),t._WriteInt64(s.numberToBondInt64(T))}if(l)for(var m in t._WriteFieldBegin(i._BondDataType._BT_MAP,34,null),t._WriteMapContainerBegin(l,i._BondDataType._BT_STRING,i._BondDataType._BT_DOUBLE),c)if(c.hasOwnProperty(m)){T=c[m];t._WriteString(m),t._WriteDouble(T)}if(y)for(var m in t._WriteFieldBegin(i._BondDataType._BT_MAP,36,null),t._WriteMapContainerBegin(y,i._BondDataType._BT_STRING,i._BondDataType._BT_STRUCT),g)if(g.hasOwnProperty(m)){S=g[m];t._WriteString(m),t._WriteFieldBegin(i._BondDataType._BT_INT32,1,null),t._WriteInt32(S.cc),t._WriteFieldBegin(i._BondDataType._BT_STRING,2,null),t._WriteString(S.value.toString()),t._WriteStructEnd(!1)}t._WriteStructEnd(!1)},e.base64Encode=function(e){return i._Encoding._Base64_GetString(e)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.8.6",t.FullVersionString="AWT-Web-JS-"+t.Version},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(7),o=n(22),s=n(17),a=n(4),u=n(5),c=n(11),l=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,o.default.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(o.default.sessionEnabled=!1),c.default.addPropertyStorageOverride(this._config.propertyStorageOverride),c.default.autoCollect(o.default.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),a.default.initialize(this._config),o.default.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(r.AWTSessionState.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return o.default.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&a.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(r.AWTSessionState.Ended),a.default.flushAndTeardown(),o.default.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&a.default.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&a.default.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&a.default.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&a.default.loadTransmitProfiles(e)},e.setContext=function(e,t,n){void 0===n&&(n=i.AWTPropertyType.Unspecified),o.default.logManagerContext.setProperty(e,t,n)},e.setContextWithPii=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithPii(e,t,n,r)},e.setContextWithCustomerContent=function(e,t,n,r){void 0===r&&(r=i.AWTPropertyType.Unspecified),o.default.logManagerContext.setPropertyWithCustomerContent(e,t,n,r)},e.getLogger=function(e){var t=e;return t&&t!==o.default.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new s.default(t)),this._loggers[t]},e.addNotificationListener=function(e){u.default.addNotificationListener(e)},e.removeNotificationListener=function(e){u.default.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),r=n(10),o=function(){function e(){}return e.logManagerContext=new i.default,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new r.default(!0,e.logManagerContext),e}();t.default=o},function(e,t,n){var i=n(26),r=n(27),o=r;o.v1=i,o.v4=r,e.exports=o},,,function(e,t,n){var i,r,o=n(14),s=n(15),a=0,u=0;e.exports=function(e,t,n){var c=t&&n||0,l=t||[],d=(e=e||{}).node||i,f=void 0!==e.clockseq?e.clockseq:r;if(null==d||null==f){var p=o();null==d&&(d=i=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=r=16383&(p[6]<<8|p[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),_=void 0!==e.nsecs?e.nsecs:u+1,v=h-a+(_-u)/1e4;if(v<0&&void 0===e.clockseq&&(f=f+1&16383),(v<0||h>a)&&void 0===e.nsecs&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=h,u=_,r=f;var g=(1e4*(268435455&(h+=122192928e5))+_)%4294967296;l[c++]=g>>>24&255,l[c++]=g>>>16&255,l[c++]=g>>>8&255,l[c++]=255&g;var y=h/4294967296*1e4&268435455;l[c++]=y>>>8&255,l[c++]=255&y,l[c++]=y>>>24&15|16,l[c++]=y>>>16&255,l[c++]=f>>>8|128,l[c++]=255&f;for(var m=0;m<6;++m)l[c+m]=d[m];return t||s(l)}},function(e,t,n){var i=n(14),r=n(15);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||r(s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(19),o=n(35),s=n(36),a=n(37),u=n(20),c=n(3),l=n(5),d=n(4),f=function(){function e(e,t,n,i,r){var o=this;this._requestQueue=e,this._queueManager=n,this._httpInterface=i,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+u.FullVersionString,this._killSwitch=new s.default,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new a.default(r),c.isUint8ArrayAvailable()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!c.isReactNative(),this._httpInterface={sendPOST:function(e,t,n,i,r,s){try{if(c.useFetchRequest())fetch(e,{body:t,method:"POST"}).then((function(e){var t={};e.headers&&e.headers.forEach((function(e,n){t[n]=e})),r(e.status,t)})).catch((function(e){i(0,{})}));else if(c.useXDomainRequest()){var a=new XDomainRequest;a.open("POST",e),a.onload=function(){r(200,null)},a.onerror=function(){i(400,null)},a.ontimeout=function(){n(500,null)},a.send(t)}else{var u=new XMLHttpRequest;u.open("POST",e,!s),u.onload=function(){r(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.onerror=function(){i(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.ontimeout=function(){n(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.send(t)}}catch(e){i(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&d.default.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=i.AWTEventPriority.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,o){var s=this;void 0===o&&(o=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var a=0,u="";for(var d in e)e.hasOwnProperty(d)&&(this._killSwitch.isTenantKilled(d)?(l.default.eventsRejected(e[d],i.AWTEventsRejectedReason.KillSwitch),delete e[d]):(u.length>0&&(u+=","),u+=d,a++));if(a>0){var f=r.default.getPayloadBlob(e,a);f.remainingRequest&&this._requestQueue.push(f.remainingRequest);var p=this._urlString+"&x-apikey="+u+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(p=p+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var h=void 0;for(var d in h=c.isUint8ArrayAvailable()?new Uint8Array(f.payloadBlob):r.default.base64Encode(f.payloadBlob),e)if(e.hasOwnProperty(d))for(var _=0;_<e[d].length;++_)e[d][_].sendAttempt>0?e[d][_].sendAttempt++:e[d][_].sendAttempt=1;if(this._useBeacons&&n&&c.isBeaconsSupported()&&navigator.sendBeacon(p,h))return;this._httpInterface.sendPOST(p,h,(function(i,r){s._retryRequestIfNeeded(i,r,e,a,u,t,n,o)}),(function(i,r){s._retryRequestIfNeeded(i,r,e,a,u,t,n,o)}),(function(i,r){s._retryRequestIfNeeded(i,r,e,a,u,t,n,o)}),n||o)}else n||this._handleRequestFinished(!1,{},n,o)}catch(e){this._handleRequestFinished(!1,{},n,o)}},e.prototype._retryRequestIfNeeded=function(e,t,n,r,s,a,u,c){var f=this,p=!0;if(void 0!==e){if(t){var h=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var _=0;_<h.length;++_)l.default.eventsRejected(n[h[_]],i.AWTEventsRejectedReason.KillSwitch),delete n[h[_]],r--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,n,u,c);(!o.default.shouldRetryForStatus(e)||r<=0)&&(p=!1)}if(p)if(c)this._activeConnections--,n[s][0].priority=i.AWTEventPriority.High,this._queueManager.addBackRequest(n);else if(a<1){for(var v in n)n.hasOwnProperty(v)&&l.default.eventsRetrying(n[v]);setTimeout((function(){return f._sendRequest(n,a+1,!1)}),o.default.getMillisToBackoffForRetry(a))}else this._activeConnections--,d.default.backOffTransmission(),this._queueManager.addBackRequest(n);else this._handleRequestFinished(!1,n,u,c)},e.prototype._handleRequestFinished=function(e,t,n,r){for(var o in e&&d.default.clearBackOff(),t)t.hasOwnProperty(o)&&(e?l.default.eventsSent(t[o]):l.default.eventsDropped(t[o],i.AWTEventsDroppedReason.NonRetryableStatus));this._activeConnections--,r||n||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var n=e.split("\n"),i=0;i<n.length;++i){var r=n[i].split(": ");t[r[0]]=r[1]}return t},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(30);t._BondDataType=i._BondDataType;var r=n(31);t._Encoding=r;var o=n(34);t.IO=o;var s=n(9);t.Int64=s.Int64,t.UInt64=s.UInt64,t.Number=s.Number;var a=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,n){this._WriteUInt8(t),this._WriteUInt8(n),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=r._Double_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,n){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=r._Zigzag_EncodeZigzag32(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(r._Zigzag_EncodeZigzag64(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=r._Utf8_GetBytes(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?i._BondDataType._BT_STOP_BASE:i._BondDataType._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=r._Varint_GetBytes(s.Number._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=r._Varint64_GetBytes(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(s.Number._ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(t._BondDataType||(t._BondDataType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),r=n(32),o=n(33);t._Utf8_GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t},t._Base64_GetString=function(e){for(var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[],r=e.length%3,o=0,s=e.length-r;o<s;o+=3){var a=(e[o]<<16)+(e[o+1]<<8)+e[o+2];i.push([n.charAt((t=a)>>18&63),n.charAt(t>>12&63),n.charAt(t>>6&63),n.charAt(63&t)].join(""))}switch(r){case 1:a=e[e.length-1];i.push(n.charAt(a>>2)),i.push(n.charAt(a<<4&63)),i.push("==");break;case 2:var u=(e[e.length-2]<<8)+e[e.length-1];i.push(n.charAt(u>>10)),i.push(n.charAt(u>>4&63)),i.push(n.charAt(u<<2&63)),i.push("=")}return i.join("")},t._Varint_GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},t._Varint64_GetBytes=function(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i},t._Double_GetBytes=function(e){if(o.BrowserChecker._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],i=0;i<8;++i)n.push(t.getUint8(i));return n}return r.FloatUtils._ConvertNumberToArray(e,!0)},t._Zigzag_EncodeZigzag32=function(e){return(e=i.Number._ToInt32(e))<<1^e>>31},t._Zigzag_EncodeZigzag64=function(e){var t=e.low,n=e.high,r=n<<1|t>>>31,o=t<<1;2147483648&n&&(r=~r,o=~o);var s=new i.UInt64("0");return s.low=o,s.high=r,s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,i=(1<<(t?11:8)-1)-1,r=1-i,o=i,s=e<0?1:0;e=Math.abs(e);for(var a=Math.floor(e),u=e-a,c=2*(i+2)+n,l=new Array(c),d=0;d<c;)l[d++]=0;for(d=i+2;d&&a;)l[--d]=a%2,a=Math.floor(a/2);for(d=i+1;d<c-1&&u>0;)(u*=2)>=1?(l[++d]=1,--u):l[++d]=0;for(var f=0;f<c&&!l[f];)f++;var p=i+1-f,h=f+n;if(l[h+1]){for(d=h;d>f&&(l[d]=1-l[d],!l);--d);d===f&&++p}if(p>o||a)return s?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(p<r)return t?this._doubleZero:this._floatZero;if(t){var _=0;for(d=0;d<20;++d)_=_<<1|l[++f];for(var v=0;d<52;++d)v=v<<1|l[++f];return[255&v,v>>8&255,v>>16&255,v>>>24,255&(_=s<<31|2147483647&(_|=p+i<<20)),_>>8&255,_>>16&255,_>>>24]}var g=0;for(d=0;d<23;++d)g=g<<1|l[++f];return[255&(g=s<<31|2147483647&(g|=p+i<<23)),g>>8&255,g>>16&255,g>>>24]},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}();t.FloatUtils=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();t.BrowserChecker=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),r=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(i.Number._ToByte(e))},e.prototype._Write=function(e,t,n){for(;n--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}();t.MemoryStream=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*n,Math.min(t,12e4)},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var i=1e3*parseInt(t,10),r=0;r<n.length;++r)this._killedTokenDictionary[n[r]]=Date.now()+i}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout((function(){return e._reset()}),6e4*this.clockSkewRefreshDurationInMins)},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===i.AWTEventPriority.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=function(){function e(){}return e.setEventsHandler=function(e){i.default.setEventsHandler(e)},e.getEventsHandler=function(){return i.default.getEventsHandler()},e.scheduleTimer=function(){i.default.scheduleTimer()},e}();t.default=r},function(e,t,n){"use strict";n.r(t);var i,r,o=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),s=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(i={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout"}(r||(r={}));!function(){function e(){}e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,n,i){return"tag_"+e.tagIntToString(t)+" ["+r[n]+"] "+i},e.prototype.sendTraceTag=function(t,n,r,o){var s=console.log;switch(r){case i.Error:s=console.error;break;case i.Warning:s=console.warn;break;case i.Info:s=console.info;break;case i.Verbose:s=console.debug;break;case i.Spam:default:s=console.log}try{s(e.getLogMessage(t,n,o))}catch(e){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw e}},e.prototype.shipAssertTag=function(t,n,i,r){console.assert(i,e.getLogMessage(t,n,r))},e.prototype.debugAssertTag=function(e,t,n,i){this.shipAssertTag(e,t,n,i)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789"}();var a,u=new(function(){function e(){this.externalLogger=new s}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,i){this.externalLogger.sendTraceTag(e,t,n,i)},e.prototype.debugAssertTag=function(e,t,n,i){this.externalLogger.debugAssertTag(e,t,n,i)},e.prototype.shipAssertTag=function(e,t,n,i){this.externalLogger.shipAssertTag(e,t,n,i)},e}());function c(e,t,n,i){var r=e.map((function(e){return function(e,t){var n={};n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category;var i=1e3*e.type+e.level;return n.D=i,n}(e,i)})),o=function(e,t,n,i){var r={};return r.T=e,r.L=t,r.S=n,r.I=i,r.V=1,r}(i,r,t,n);return JSON.stringify(o)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(a||(a={}));!function(){function e(t,n){var i=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){i.triggerUpload(!1,!1)},this.flush=function(){i.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return i.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,n){(window.clearTimeout(i.timeoutId),i.logCache.length>0)&&(i.uploadId+=1,function(e,t,n){if(""!==t){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",t,n),i.send(e))}}(c(i.logCache,i.userSessionId,i.uploadId,i.timestampBase),i.remoteUrlEndpoint,n),i.logCache=[],i.timestampBase=Date.now());t&&(i.timeoutId=window.setTimeout(i.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=n+"?usid="+t,window.setTimeout((function(){return i.triggerUpload(!0,!0)}),0)}e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===i.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]"}();i.Info;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function d(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var f=function(){return(f=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}d(t,e)}(s);var p,h,_,v,g,y,m,T=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),S=new T;function E(e,t,n){S.fireEvent({level:e,category:t,message:n})}function b(e,t,n){E(p.Error,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}function w(e,t){return{name:e,dataType:g.Boolean,value:t,classification:m.SystemMetadata}}function A(e,t){return{name:e,dataType:g.Int64,value:t,classification:m.SystemMetadata}}function I(e,t){return{name:e,dataType:g.Double,value:t,classification:m.SystemMetadata}}function C(e,t){return{name:e,dataType:g.String,value:t,classification:m.SystemMetadata}}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(p||(p={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(h||(h={})),function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(_||(_={})),function(e){var t={},n={},i={};function r(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");i=function e(t,n){if("object"!=typeof n)return n;for(var i=0,r=Object.keys(n);i<r.length;i++){var o=r[i];o in t&&(t[o],1)?t[o]=e(t[o],n[o]):t[o]=n[o]}return t}(i,e)}function o(e){if(t[e])return t[e];var n=a(e,_.Aria);return"string"==typeof n?(t[e]=n,n):void 0}function s(e){if(n[e])return n[e];var t=a(e,_.Nexus);return"number"==typeof t?(n[e]=t,t):void 0}function a(e,t){var n=e.split("."),r=i,o=void 0;if(r){for(var s=0;s<n.length-1;s++)r[n[s]]&&(r=r[n[s]],t===_.Aria&&"string"==typeof r.ariaTenantToken?o=r.ariaTenantToken:t===_.Nexus&&"number"==typeof r.nexusTenantToken&&(o=r.nexusTenantToken));return o}}e.setTenantToken=function(e,t,n){var i=e.split(".");if(i.length<2||"Office"!==i[0])E(p.Error,h.Core,(function(){return"Invalid namespace: "+e}));else{var o=Object.create(Object.prototype);t&&(o.ariaTenantToken=t),n&&(o.nexusTenantToken=n);var s,a=o;for(s=i.length-1;s>=0;--s){var u=Object.create(Object.prototype);u[i[s]]=a,a=u}r(a)}},e.setTenantTokens=r,e.getTenantTokens=function(e){var t=o(e),n=s(e);if(!n||!t)throw new Error("Could not find tenant token for "+e);return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=o,e.getNexusTenantToken=s,e.clear=function(){t={},n={},i={}}}(v||(v={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(g||(g={})),function(e){var t=/^[A-Z][a-zA-Z0-9]*$/,n=/^[a-zA-Z0-9_\.]*$/;function i(e){return void 0!==e&&n.test(e)}function r(e){if(!((t=e.name)&&i(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===g.Int64&&o(e.value)}function o(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var n=e.split("."),i=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(r=i,void 0!==r&&t.test(r));var r}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!i(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var n=0;n<e.dataFields.length;n++)r(e.dataFields[n])},e.validateInt=o}(y||(y={})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(m||(m={}));var P,O=function(){return(O=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},k=function(){function e(e,t,n){var i,r;this.onSendEvent=new T,this.persistentDataFields=[],this.config=n||{},e?(this.onSendEvent=e.onSendEvent,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=O(O({},e.getConfig()),this.config)):this.persistentDataFields.push(C("OTelJS.Version","3.1.42")),t&&(r=this.persistentDataFields).push.apply(r,t)}return e.prototype.sendTelemetryEvent=function(e){var t;try{if(0===this.onSendEvent.getListenerCount())return void E(p.Warning,h.Core,(function(){return"No telemetry sinks are attached."}));t=this.cloneEvent(e),this.processTelemetryEvent(t)}catch(e){return void b(h.Core,"SendTelemetryEvent",e)}try{this.onSendEvent.fireEvent(t)}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=v.getTenantTokens(e.eventName)),e.dataFields&&this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields),this.config.disableValidation||y.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,n){v.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){v.setTenantTokens(e)},e.prototype.cloneEvent=function(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t},e.prototype.getConfig=function(){return this.config},e}();!function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new i(t,++n)},e.getNextChild=function(e){return new i(e.getString(),++e.nextChild)};var i=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=i}(P||(P={}));var N=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))},x=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},D=function(){return 1e3*Date.now()};"object"==typeof window.performance&&"now"in window.performance&&(D=function(){return 1e3*Math.floor(window.performance.now())});var M,W,B,R,L,U,F,q,z,V=function(){function e(e,t,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=n?P.getNextChild(n._cv):P.getNext(),this._dataFields=[],this._success=void 0,this._startTime=D()}return e.createNew=function(t,n){return new e(t,n)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,n){this._result={code:e,type:t,tag:n}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&E(p.Warning,h.Core,(function(){return"Activity does not have success or result set"}));var e=D()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}E(p.Error,h.Core,(function(){return"Activity has already ended"}))},e.prototype.executeAsync=function(e){return N(this,void 0,void 0,(function(){var t=this;return x(this,(function(n){return[2,e(this).then((function(e){return t.endNow(),e})).catch((function(e){throw t.endNow(),e}))]}))}))},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(e){throw this.endNow(),e}},e.prototype.executeChildActivityAsync=function(e,t){return N(this,void 0,void 0,(function(){return x(this,(function(n){return[2,this.createChildActivity(e).executeAsync(t)]}))}))},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}();function Q(e,t,n){e.push(C("zC."+t,n))}(M||(M={})).getFields=function(e,t){var n=[];return n.push(A(e+".Code",t.code)),void 0!==t.type&&n.push(C(e+".Type",t.type)),void 0!==t.tag&&n.push(A(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(w(e+".IsExpected",t.isExpected)),Q(n,e,"Office.System.Result"),n},(B=W||(W={})).contractName="Office.System.Activity",B.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(C("Activity.CV",e.cV)),t.push(A("Activity.Duration",e.duration)),t.push(A("Activity.Count",e.count)),t.push(A("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(w("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,M.getFields("Activity.Result",e.result)),Q(t,"Activity",B.contractName),t},(R||(R={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(C(e+".Id",t.id)),void 0!==t.version&&n.push(C(e+".Version",t.version)),void 0!==t.sessionId&&n.push(C(e+".SessionId",t.sessionId)),Q(n,e,"Office.System.Host"),n},(L||(L={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(C(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(C(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(C(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(C(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(C(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(w(e+".IsAnonymous",t.isAnonymous)),Q(n,e,"Office.System.User"),n},(U||(U={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(C(e+".Id",t.id)),void 0!==t.version&&n.push(C(e+".Version",t.version)),void 0!==t.instanceId&&n.push(C(e+".InstanceId",t.instanceId)),void 0!==t.name&&n.push(C(e+".Name",t.name)),void 0!==t.marketplaceType&&n.push(C(e+".MarketplaceType",t.marketplaceType)),void 0!==t.sessionId&&n.push(C(e+".SessionId",t.sessionId)),void 0!==t.browserToken&&n.push(C(e+".BrowserToken",t.browserToken)),void 0!==t.osfRuntimeVersion&&n.push(C(e+".OsfRuntimeVersion",t.osfRuntimeVersion)),void 0!==t.officeJsVersion&&n.push(C(e+".OfficeJsVersion",t.officeJsVersion)),void 0!==t.hostJsVersion&&n.push(C(e+".HostJsVersion",t.hostJsVersion)),void 0!==t.assetId&&n.push(C(e+".AssetId",t.assetId)),void 0!==t.providerName&&n.push(C(e+".ProviderName",t.providerName)),void 0!==t.type&&n.push(C(e+".Type",t.type)),Q(n,e,"Office.System.SDX"),n},(F||(F={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(C(e+".Name",t.name)),void 0!==t.state&&n.push(C(e+".State",t.state)),Q(n,e,"Office.System.Funnel"),n},(q||(q={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(A(e+".Id",t.id)),void 0!==t.name&&n.push(C(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(C(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(C(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(C(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(A(e+".TimeOffsetMs",t.timeOffsetMs)),Q(n,e,"Office.System.UserAction"),n},function(e){e.getFields=function(e,t){var n=[];return n.push(C(e+".ErrorGroup",t.errorGroup)),n.push(A(e+".Tag",t.tag)),void 0!==t.code&&n.push(A(e+".Code",t.code)),void 0!==t.id&&n.push(A(e+".Id",t.id)),void 0!==t.count&&n.push(A(e+".Count",t.count)),Q(n,e,"Office.System.Error"),n}}(z||(z={}));var j,H=W,G=M,K=z,J=F,X=R,Z=U,Y=q,$=L;!function(e){!function(e){!function(e){e.Activity=H,e.Result=G,e.Error=K,e.Funnel=J,e.Host=X,e.SDX=Z,e.User=$,e.UserAction=Y}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(j||(j={}));var ee=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),te=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))},ne=function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ee(t,e),t.prototype.executeActivityAsync=function(e,t){return te(this,void 0,void 0,(function(){return ne(this,(function(n){return[2,this.createNewActivity(e).executeAsync(t)]}))}))},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return V.createNew(this,e)},t.prototype.sendActivity=function(e,t,n,i){return this.sendTelemetryEvent({eventName:e,eventContract:{name:j.Office.System.Activity.contractName,dataFields:j.Office.System.Activity.getFields(t)},dataFields:n,eventFlags:i})},t.prototype.sendError=function(e){var t=j.Office.System.Error.getFields("Error",e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t}(k),re=n(0),oe=n(1),se=/\./g,ae=0;function ue(e,t,n){t&&t.forEach((function(t){if(!t.classification||t.classification===m.SystemMetadata||t.classification===m.EssentialServiceMetadata){var i=["","",t.name],r=i[0],o=i[1],s=i[2],a=t.name.indexOf(".");a>0&&"zC"===t.name.substr(0,a)&&(r=t.name.substring(0,a+1),s=t.name.substring(a+1)),n&&(o="Data.");var u=r+o+s;e.properties[u]={value:t.value,type:ce(t.dataType)}}}))}function ce(e){switch(e){case g.String:case g.Guid:return oe.AWTPropertyType.String;case g.Boolean:return oe.AWTPropertyType.Boolean;case g.Int64:return oe.AWTPropertyType.Int64;case g.Double:return oe.AWTPropertyType.Double;default:throw new Error(e)}}var le,de,fe,pe,he=n(4),_e=n.n(he),ve=n(12),ge=n.n(ve);var ye={sendRequestWrapper:function(e,t,n,i){void 0===i&&(i=!1);var r=0;for(var o in e)e.hasOwnProperty(o)&&(r+=e[o].length);var s=performance.now();le(e,t,n,i),fe(performance.now()-s,r)},sendPostWrapper:function(e,t,n,i,r,o){de(e,t,n,i,r,o),pe(t.length)}};var me,Te,Se,Ee,be,we=!1;function Ae(e,t,n){var i;if(Ie(),!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Aria Tenant Token");i=function(e,t,n){var i,r,o={name:(i=e.eventName,i.toLowerCase().replace(se,"_")),properties:{}};return o.properties["Event.Sequence"]={value:++ae,type:oe.AWTPropertyType.Int64},o.properties["Event.Name"]=e.eventName,o.properties["Event.Source"]="OTelJS",r=n?new Date(n):new Date,o.properties["Event.Time"]={value:r,type:oe.AWTPropertyType.Date},e.eventContract&&(o.properties["Event.Contract"]=e.eventContract.name,ue(o,e.eventContract.dataFields,!1)),ue(o,t,!1),ue(o,e.dataFields,!0),o}(e,t,n),re.AWTLogManager.getLogger(e.telemetryProperties.ariaTenantToken).logEvent(i)}function Ie(e,t){var n;we||(re.AWTLogManager.initialize("cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521",e),t&&(!function(e){if(!e)return;var t=e/1e3,n=t/2,i=2*t,r={};r.OTelCustomTransmissionProfile=[i,t,n],re.AWTLogManager.loadTransmitProfiles(r),re.AWTLogManager.setTransmitProfile("OTelCustomTransmissionProfile")}(t.uploadFrequency),(n=t.notificationListener)&&re.AWTLogManager.addNotificationListener(n),function(e){if(!e)return;(function(e,t){var n=_e.a.getEventsHandler();if(!(n instanceof ge.a))return!1;var i=n._httpManager;if(!(i&&i._sendRequest&&i._httpInterface))return!1;le=i._sendRequest.bind(i),i._sendRequest=ye.sendRequestWrapper;var r=i._httpInterface;return de=r.sendPOST.bind(i),r.sendPOST=ye.sendPostWrapper,fe=e,pe=t,!0})(e.requestProcessingStats,e.networkStats)||E(p.Error,h.Sink,(function(){return"Failed to instrument Aria delivery task"}))}(t.stats),t.disableStatsTracking||re.AWTLogManager.addNotificationListener({eventsSent:function(e){E(p.Info,h.Transport,(function(){return"Successfully sent "+e.length+" event(s)"})),E(p.Verbose,h.Transport,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),e.length},eventsDropped:function(e,t){E(p.Error,h.Transport,(function(){return"Dropped "+e.length+" event(s) because "+t})),E(p.Verbose,h.Transport,(function(){return"Dropped event(s) details : "+JSON.stringify(e,null,2)})),e.length},eventsRejected:function(e,t){E(p.Error,h.Transport,(function(){return"Rejected "+e.length+" event(s) because "+t})),E(p.Verbose,h.Transport,(function(){return"Rejected event(s) details : "+JSON.stringify(e,null,2)})),e.length},eventsRetrying:function(e){E(p.Warning,h.Transport,(function(){return"Retrying "+e.length+" event(s)"})),E(p.Verbose,h.Transport,(function(){return"Retrying event(s) details : "+JSON.stringify(e,null,2)})),e.length}})),we=!0)}!function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(me||(me={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(Te||(Te={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(Se||(Se={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(Ee||(Ee={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(be||(be={}));var Ce,Pe=function(){function e(){this._fullEventsEnabled=!1}return e.prototype.processEvent=function(e){return this._fullEventsEnabled||!!e.eventFlags&&(e.eventFlags.diagnosticLevel===be.BasicEvent||e.eventFlags.diagnosticLevel===be.NecessaryServiceDataEvent||e.eventFlags.diagnosticLevel===be.AlwaysOnNecessaryServiceDataEvent)},e.prototype.setFullEventsEnabled=function(e){this._fullEventsEnabled=e},e}();!function(e){e[e.Aria=0]="Aria",e[e.AriaSE=1]="AriaSE"}(Ce||(Ce={}));var Oe,ke=function(){function e(t,n){if(void 0===t&&(t=[]),this._preprocessors=[],this.additionalDataFields=t,this._fullEventProcessor=new Pe,this.addPreprocessor(this._fullEventProcessor),void 0===e.ariaSinkType)e.ariaSinkType=this.getSinkType();else if(e.ariaSinkType!==this.getSinkType())throw new Error("Multiple Aria Configurations are not allowed");Ie(this.getAWTLogConfiguration(n),n)}return e.prototype.getSinkType=function(){return Ce.Aria},e.prototype.getAWTLogConfiguration=function(e){var t={disableCookiesUsage:!0,canSendStatEvent:function(){return!1}};return e&&(t.cacheMemorySizeLimitInNumberOfEvents=e.eventsLimitInMem,t.collectorUri=e.endpointUrl),t},e.prototype.sendTelemetryEvent=function(e,t){try{for(var n=0;n<this._preprocessors.length;n++)if(!this._preprocessors[n].processEvent(e))return;Ae(e,this.additionalDataFields,t)}catch(e){b(h.Sink,"AriaSink",e)}},e.prototype.getAdditionalDataFields=function(){return this.additionalDataFields},e.prototype.addPreprocessor=function(e){this._preprocessors.push(e)},e.prototype.setFullEventsEnabled=function(e){this._fullEventProcessor.setFullEventsEnabled(e)},e.prototype.flushAsync=function(e){re.AWTLogManager.flush(e)},e.prototype.shutdown=function(){re.AWTLogManager.flushAndTeardown()},e}();!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(Oe||(Oe={}));var Ne={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73};function xe(e){var t="undefined"!=typeof globalThis&&globalThis?globalThis:"undefined"!=typeof self&&self?self:"undefined"!=typeof window&&window?window:"undefined"!=typeof global&&global?global:null;return t&&t[e]?t[e]:"window"===e&&De()?window:null}function De(){return Boolean("object"==typeof window&&window)}function Me(){return De()?window:xe("window")}function We(){return Boolean("object"==typeof document&&document)?document:xe("document")}function Be(){return Boolean("object"==typeof navigator&&navigator)}function Re(){return Be()?navigator:xe("navigator")}function Le(){return Boolean("object"==typeof JSON&&JSON||null!==xe("JSON"))}function Ue(e,t){return typeof e===t}function Fe(e){return void 0===e||Ue(e,"undefined")}function qe(e){return Fe(e)||null===e}function ze(e,t){return e&&Object.prototype.hasOwnProperty.call(e,t)}function Ve(e){return Ue(e,"object")}function Qe(e){return Ue(e,"function")}function je(e,t,n,i){void 0===i&&(i=!1);var r=!1;if(!qe(e))try{qe(e.addEventListener)?qe(e.attachEvent)||(e.attachEvent("on"+t,n),r=!0):(e.addEventListener(t,n,i),r=!0)}catch(e){}return r}function He(e,t,n,i){if(void 0===i&&(i=!1),!qe(e))try{qe(e.removeEventListener)?qe(e.detachEvent)||e.detachEvent("on"+t,n):e.removeEventListener(t,n,i)}catch(e){}}var Ge=function(){function e(){}return e.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},e.isString=function(e){return Ue(e,"string")},e.isNumber=function(e){return Ue(e,"number")},e.isBoolean=function(e){return Ue(e,"boolean")},e.disableCookies=function(){e._canUseCookies=!1},e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Ke,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},e.toISOString=function(t){if(e.isDate(t)){var n=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},e.arrForEach=function(e,t,n){for(var i=e.length,r=0;r<i;++r)r in e&&t.call(n||e,e[r],r,e)},e.arrIndexOf=function(e,t,n){for(var i=e.length,r=n||0,o=Math.max(r>=0?r:i-Math.abs(r),0);o<i;o++)if(o in e&&e[o]===t)return o;return-1},e.arrMap=function(e,t,n){for(var i=e.length,r=n||e,o=new Array(i),s=0;s<i;s++)s in e&&(o[s]=t.call(r,e[s],e));return o},e.arrReduce=function(e,t,n){var i,r=e.length,o=0;if(arguments.length>=3)i=arguments[2];else{for(;o<r&&!(o in e);)o++;i=e[o++]}for(;o<r;)o in e&&(i=t(i,e[o],o,e)),o++;return i},e.objCreate=function(e){if(null==e)return{};if(!Ve(e)&&!Qe(e))throw new TypeError("Object prototype may only be an Object: "+e);function t(){}return t.prototype=e,new t},e.objKeys=function(e){var t=!{toString:null}.propertyIsEnumerable("toString");if(!(Qe(e)||Ve(e)&&null!==e))throw new TypeError("objKeys called on non-object");var n=[];for(var i in e)ze(e,i)&&n.push(i);if(t)for(var r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=r.length,s=0;s<o;s++)ze(e,r[s])&&n.push(r[s]);return n},e.objDefineAccessors=function(e,t,n,i){var r=Object.defineProperty;if(r)try{var o={enumerable:!0,configurable:!0};return n&&(o.get=n),i&&(o.set=i),r(e,t,o),!0}catch(e){}return!1},e.addEventHandler=function(e,t){var n=!1,i=Me();i&&(n=je(i,e,t),n=je(i.body,e,t)||n);var r=We();return r&&(n=Je.Attach(r,e,t)||n),n},e.isTypeof=Ue,e.isUndefined=Fe,e.isNullOrUndefined=qe,e.hasOwnProperty=ze,e.isFunction=Qe,e.isObject=Ve,e}(),Ke=/[xy]/g,Je=function(){function e(){}return e.Attach=je,e.AttachEvent=je,e.Detach=He,e.DetachEvent=He,e}(),Xe=function(){function e(t,n,i,r){void 0===i&&(i=!1),this.messageId=t,this.message=(i?e.AiUserActionablePrefix:e.AiNonUserActionablePrefix)+t;var o="";Le()&&(o=(Le()?JSON||xe("JSON"):null).stringify(r));var s=(n?" message:"+e.sanitizeDiagnosticText(n):"")+(r?" props:"+e.sanitizeDiagnosticText(o):"");this.message+=s}return e.sanitizeDiagnosticText=function(e){return e?'"'+e.replace(/\"/g,"")+'"':""},e.dataType="MessageData",e.AiNonUserActionablePrefix="AI (Internal): ",e.AiUserActionablePrefix="AI: ",e}(),Ze=function(){function e(e){this.queue=[],this.AIInternalMessagePrefix="AITR_",this._messageCount=0,this._messageLogged={},this.enableDebugExceptions=function(){return!1},this.consoleLoggingLevel=function(){return 0},this.telemetryLoggingLevel=function(){return 1},this.maxInternalMessageLimit=function(){return 25},Ge.isNullOrUndefined(e)||(Ge.isNullOrUndefined(e.loggingLevelConsole)||(this.consoleLoggingLevel=function(){return e.loggingLevelConsole}),Ge.isNullOrUndefined(e.loggingLevelTelemetry)||(this.telemetryLoggingLevel=function(){return e.loggingLevelTelemetry}),Ge.isNullOrUndefined(e.maxMessageLimit)||(this.maxInternalMessageLimit=function(){return e.maxMessageLimit}),Ge.isNullOrUndefined(e.enableDebugExceptions)||(this.enableDebugExceptions=function(){return e.enableDebugExceptions}))}return e.prototype.throwInternal=function(e,t,n,i,r){void 0===r&&(r=!1);var o=new Xe(t,n,r,i);if(this.enableDebugExceptions())throw o;if(!Ge.isUndefined(o)&&o&&!Ge.isUndefined(o.message)){if(r){var s=+o.messageId;!this._messageLogged[s]&&this.consoleLoggingLevel()>=Oe.WARNING&&(this.warnToConsole(o.message),this._messageLogged[s]=!0)}else this.consoleLoggingLevel()>=Oe.WARNING&&this.warnToConsole(o.message);this.logInternalMessage(e,o)}},e.prototype.warnToConsole=function(e){!Ge.isUndefined(console)&&console&&(Ge.isFunction(console.warn)?console.warn(e):Ge.isFunction(console.log)&&console.log(e))},e.prototype.resetInternalMessageCount=function(){this._messageCount=0,this._messageLogged={}},e.prototype.logInternalMessage=function(e,t){if(!this._areInternalMessagesThrottled()){var n=!0,i=this.AIInternalMessagePrefix+t.messageId;if(this._messageLogged[i]?n=!1:this._messageLogged[i]=!0,n&&(e<=this.telemetryLoggingLevel()&&(this.queue.push(t),this._messageCount++),this._messageCount===this.maxInternalMessageLimit())){var r="Internal events throttle limit per PageView reached for this app.",o=new Xe(Ne.MessageLimitPerPVExceeded,r,!1);this.queue.push(o),this.warnToConsole(r)}}},e.prototype._areInternalMessagesThrottled=function(){return this._messageCount>=this.maxInternalMessageLimit()},e}(),Ye=Ge.isFunction,$e=function(e,t){var n=this,i=null,r=Ye(e.processTelemetry),o=Ye(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return i},n.setNext=function(e){i=e},n.processTelemetry=function(s,a){if(a||(a=t),e&&r){n._hasRun=!0;try{a.setNext(i),o&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(s,a)}catch(t){var u=i&&i._hasRun;i&&u||a.diagLog().throwInternal(Oe.CRITICAL,Ne.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+t),i&&!u&&i.processTelemetry(s,a)}}else i&&(n._hasRun=!0,i.processTelemetry(s,a))}},et=Ge.isNullOrUndefined;function tt(e,t){var n=[];if(e&&e.length>0)for(var i=null,r=0;r<e.length;r++){var o=e[r];if(o&&Ge.isFunction(o.processTelemetry)){var s=new $e(o,t);n.push(s),i&&i.setNext(s),i=s}}return n.length>0?n[0]:null}var nt=function e(t,n,i,r){var o=this,s=null;null!==r&&(t&&Ge.isFunction(t.getPlugin)?s=function(e,t,n){var i=[],r=!n;if(e)for(;e;){var o=e.getPlugin();(r||o===n)&&(r=!0,i.push(o)),e=e.getNext()}return r||i.push(n),tt(i,t)}(t,o,r||t.getPlugin()):r?s=function(e,t,n){var i=e,r=!1;return n&&e&&(i=[],Ge.arrForEach(e,(function(e){(r||e===n)&&(r=!0,i.push(e))}))),n&&!r&&(i||(i=[]),i.push(n)),tt(i,t)}(t,o,r):Ge.isUndefined(r)&&(s=tt(t,o))),o.core=function(){return i},o.diagLog=function(){var e=(i||{}).logger;return e||(e=new Ze(n||{})),e},o.getCfg=function(){return n},o.getExtCfg=function(e,t){var i;if(void 0===t&&(t={}),n){var r=n.extensionConfig;r&&e&&(i=r[e])}return i||t},o.getConfig=function(e,t,i){var r;void 0===i&&(i=!1);var s=o.getExtCfg(e,null);return s&&!et(s[t])?r=s[t]:n&&!et(n[t])&&(r=n[t]),et(r)?i:r},o.hasNext=function(){return null!=s},o.getNext=function(){return s},o.setNext=function(e){s=e},o.processNext=function(e){var t=s;t&&(s=t.getNext(),t.processTelemetry(e,o))},o.createNew=function(t,r){return void 0===t&&(t=null),new e(t||s,n,i,r)}},it=Ge.isFunction,rt=function(){function e(){var e=this,t=!1,n=null,i=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){i=e},e.processNext=function(e,t){t?t.processNext(e):i&&it(i.processTelemetry)&&i.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var r=t;if(!r){var o=n||new nt(null,{},e.core);r=i&&i.getPlugin?o.createNew(null,i.getPlugin):o.createNew(null,i)}return r},e._baseTelInit=function(r,o,s,a){r&&(r.extensionConfig=r.extensionConfig||[]),!a&&o&&(a=o.getProcessTelContext().getNext());var u=i;i&&i.getPlugin&&(u=i.getPlugin()),e.core=o,n=new nt(a,r,o,u),t=!0}}return e.prototype.initialize=function(e,t,n,i){this._baseTelInit(e,t,n,i)},e}(),ot=Ge.isFunction;function st(e,t){for(var n=[],i=null,r=e.getNext();r;){var o=r.getPlugin();o&&(i&&ot(i.setNextPlugin)&&ot(o.processTelemetry)&&i.setNextPlugin(o),ot(o.isInitialized)&&o.isInitialized()||n.push(o),i=o,r=r.getNext())}Ge.arrForEach(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function at(e){return e.sort((function(e,t){var n=0,i=ot(t.processTelemetry);return ot(e.processTelemetry)?n=i?e.priority-t.priority:1:i&&(n=-1),n}))}var ut=Ge.arrForEach,ct=Ge.objDefineAccessors;function lt(e,t){t&&t.length>0&&(function(e){ut(e,(function(e){if(e.priority<500)throw Error("Channel has invalid priority"+e.identifier)}))}(t=t.sort((function(e,t){return e.priority-t.priority}))),e.push(t))}var dt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="ChannelControllerPlugin",t.priority=500,t}return d(t,e),t.prototype.processTelemetry=function(e,t){var n=this;this._channelQueue&&ut(this._channelQueue,(function(i){i.length>0&&n._getTelCtx(t).createNew(i).processNext(e)}))},t.prototype.getChannelControls=function(){return this._channelQueue},t.prototype.initialize=function(t,n,i){if(!this.isInitialized()){e.prototype.initialize.call(this,t,n,i),t.isCookieUseDisabled&&Ge.disableCookies();var r=this._channelQueue=function(e,t){var n=[];if(e&&ut(e,(function(e){return lt(n,e)})),t){var i=[];ut(t,(function(e){e.priority>500&&i.push(e)})),lt(n,i)}return n}((t||{}).channels,i);ut(r,(function(e){return st(new nt(e,t,n),i)}))}},t._staticInit=(ct(t.prototype,"ChannelControls",t.prototype.getChannelControls),void ct(t.prototype,"channelQueue",t.prototype.getChannelControls)),t}(rt),ft=Ge.arrForEach,pt=Ge.isNullOrUndefined,ht=function(){function e(){var e=!1;this._extensions=new Array,this._channelController=new dt,this.isInitialized=function(){return e},this._setInit=function(t){e=t},this._eventQueue=[]}return e.prototype.initialize=function(e,t,n,i){if(this.isInitialized())throw Error("Core should not be initialized more than once");if(!e||pt(e.instrumentationKey))throw Error("Please provide instrumentation key");this.config=e;var r=this._channelController;i||(i=Ge.objCreate({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){}})),this._notificationManager=i,e.extensions=pt(e.extensions)?[]:e.extensions,(e.extensionConfig=pt(e.extensionConfig)?{}:e.extensionConfig).NotificationManager=i,n||(n=Ge.objCreate({throwInternal:function(e,t,n,i,r){void 0===r&&(r=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}})),this.logger=n;var o=[];o.push.apply(o,t.concat(e.extensions)),o=at(o);var s=[],a=[],u={};if(ft(o,(function(e){if(pt(e)||pt(e.initialize))throw Error("Extensions must provide callback to initialize");var t=e.priority,i=e.identifier;e&&t&&(pt(u[t])?u[t]=i:n.warnToConsole("Two extensions have same priority #"+t+" - "+u[t]+", "+i)),!t||t<r.priority?s.push(e):a.push(e)})),o.push(r),s.push(r),o=at(o),this._extensions=o,st(new nt([r],e,this),o),st(new nt(s,e,this),o),this._extensions=s,0===this.getTransmissionControls().length)throw new Error("No channels available");this._setInit(!0)},e.prototype.getTransmissionControls=function(){return this._channelController.getChannelControls()},e.prototype.track=function(e){var t=this;e.iKey||(e.iKey=t.config.instrumentationKey),e.time||(e.time=Ge.toISOString(new Date)),pt(e.ver)&&(e.ver="4.0"),t.isInitialized()?(t._eventQueue.length>0&&(ft(t._eventQueue,(function(e){t.getProcessTelContext().processNext(e)})),t._eventQueue=[]),t.getProcessTelContext().processNext(e)):t._eventQueue.push(e)},e.prototype.getProcessTelContext=function(){var e=this._extensions,t=e;return e&&0!==e.length||(t=[this._channelController]),new nt(t,this.config,this)},e}(),_t=1,vt=2,gt=3,yt=4,mt=5,Tt=function(){function e(){this.listeners=[]}return e.prototype.addNotificationListener=function(e){this.listeners.push(e)},e.prototype.removeNotificationListener=function(e){for(var t=Ge.arrIndexOf(this.listeners,e);t>-1;)this.listeners.splice(t,1),t=Ge.arrIndexOf(this.listeners,e)},e.prototype.eventsSent=function(e){for(var t=this,n=function(n){i.listeners[n].eventsSent&&setTimeout((function(){return t.listeners[n].eventsSent(e)}),0)},i=this,r=0;r<this.listeners.length;++r)n(r)},e.prototype.eventsDiscarded=function(e,t){for(var n=this,i=function(i){r.listeners[i].eventsDiscarded&&setTimeout((function(){return n.listeners[i].eventsDiscarded(e,t)}),0)},r=this,o=0;o<this.listeners.length;++o)i(o)},e}(),St=function(e){function t(){return e.call(this)||this}return d(t,e),t.prototype.initialize=function(t,n){this._notificationManager=new Tt,this.logger=new Ze(t),this.config=t,e.prototype.initialize.call(this,t,n,this.logger,this._notificationManager)},t.prototype.getTransmissionControls=function(){return e.prototype.getTransmissionControls.call(this)},t.prototype.track=function(t){if(null===t)throw this._notifyInvalidEvent(t),Error("Invalid telemetry item");this._validateTelemetryItem(t),e.prototype.track.call(this,t)},t.prototype.addNotificationListener=function(e){this._notificationManager&&this._notificationManager.addNotificationListener(e)},t.prototype.removeNotificationListener=function(e){this._notificationManager&&this._notificationManager.removeNotificationListener(e)},t.prototype.pollInternalLogs=function(e){var t=this,n=this.config.diagnosticLogInterval;return n>0||(n=1e4),setInterval((function(){var n=t,i=n.logger?n.logger.queue:[];Ge.arrForEach(i,(function(t){var i={name:e||"InternalMessageId: "+t.messageId,iKey:n.config.instrumentationKey,time:Ge.toISOString(new Date),baseType:Xe.dataType,baseData:{message:t.message}};n.track(i)})),i.length=0}),n)},t.prototype._validateTelemetryItem=function(e){if(Ge.isNullOrUndefined(e.name))throw this._notifyInvalidEvent(e),Error("telemetry name required")},t.prototype._notifyInvalidEvent=function(e){this._notificationManager&&this._notificationManager.eventsDiscarded([e],vt)},t}(ht),Et=1,bt=2,wt=3,At={Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9},It=f({},Ne,{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517}),Ct=At,Pt=null;function Ot(e,t){return typeof e===t}function kt(e){return void 0===e||Ot(e,"undefined")}function Nt(e){return kt(e)||null===e}function xt(e){return!kt(e)}var Dt=null,Mt=Boolean(We())||Boolean(Be()&&Re().cookieEnabled),Wt=Ge.arrForEach,Bt=(Ge.arrIndexOf,Ge.arrMap,Ge.arrReduce,Ge.objKeys),Rt=(Ge.toISOString,Boolean(We())),Lt=Boolean(Me());function Ut(e){return!(Nt(e)||""===e)}function Ft(e){return Ot(e,"string")}function qt(e){return Ot(e,"number")}function zt(e){return Ot(e,"boolean")}function Vt(e,t,n){if(!Ft(e)||Nt(t)||""===t)return null;if(Ft(t)||qt(t)||zt(t)||jt(t))t={value:t};else if("object"!=typeof t||t.hasOwnProperty("value")){if(Nt(t.value)||""===t.value||!Ft(t.value)&&!qt(t.value)&&!zt(t.value)&&!jt(t.value))return null}else t={value:n?JSON.stringify(t):t};if(jt(t.value)&&!(t.value.length>0))return null;if(xt(t.kind)){if(jt(t.value)||!function(e){if(e&&qt(e)&&(e>=0&&e<=13||32===e))return!0;return!1}(t.kind))return null;t.value=t.value.toString()}return t}function Qt(){var e=Re();return!(!e||!e.product)&&"ReactNative"===e.product}function jt(e){return e instanceof Array}function Ht(e,t,n){var i=-1;return kt(e)?i:(t&&t>0&&(32===t?i=1<<13:t<=13&&(i=t<<5)),xt(n)&&function(e){if(qt(e)&&e>=0&&e<=9)return!0;return!1}(n)?(-1===i&&(i=0),i|n):(jt(e)&&(e=e[0]),-1!==i?i|function(e){if(kt(e))return-1;if(qt(e))return Ct.Double;if(Ft(e))return Ct.String;if(zt(e))return Ct.Bool;return-1}(e):qt(e)?Ct.Double:i))}function Gt(e,t,n){if(Mt){var i="",r=function(){if("object"==typeof location&&location)return location;return Yt("location")}();r&&"https:"===r.protocol&&(i=";secure",null===Pt&&(Pt=function(e){return!!Ft(e)&&(-1!==e.indexOf("CPU iPhone OS 12")||-1!==e.indexOf("iPad; CPU OS 12")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==e.indexOf("Version/")&&-1!==e.indexOf("Safari")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&(n="AppleWebKit/605.1.15 (KHTML, like Gecko)",i=(t=e).length,r=i-n.length,t.substring(r>=0?r:0,i)===n)||(-1!==e.indexOf("Chrome/5")||-1!==e.indexOf("Chrome/6")||(-1!==e.indexOf("UnrealEngine")&&-1===e.indexOf("Chrome")||(-1!==e.indexOf("UCBrowser/12")||-1!==e.indexOf("UCBrowser/11")))))));var t,n,i,r}((Re()||{}).userAgent)),Pt||(t+=";SameSite=None"));var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var s="; expires="+o.toUTCString(),a=We();a&&a.cookie&&(a.cookie=e+"="+t+s+"; path=/"+i)}}function Kt(){var e=Yt("performance");return e?e.now():(new Date).getTime()}Ge.objDefineAccessors;function Jt(e,t){var n=!1;if(Lt){var i=window;n=Zt.Attach(i,e,t),n=Zt.Attach(i.body,e,t)||n}return Rt&&(n=Zt.Attach(document,e,t)||n),n}function Xt(e,t,n,i){void 0===i&&(i=!1);var r=!1;if(!Nt(e))try{Nt(e.addEventListener)?Nt(e.attachEvent)||(e.attachEvent("on"+t,n),r=!0):(e.addEventListener(t,n,i),r=!0)}catch(e){}return r}var Zt=function(){function e(){}return e.Attach=Xt,e}();function Yt(e){var t="undefined"!=typeof globalThis&&globalThis?globalThis:"undefined"!=typeof self&&self?self:"undefined"!=typeof window&&window?window:"undefined"!=typeof global&&global?global:null;return t&&t[e]?t[e]:"window"===e&&De()?window:null}var $t,en,tn,nn,rn,on=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pluginVersionStringArr=[],t.pluginVersionString="",t}return d(t,e),t.prototype.initialize=function(t,n){if(t){t.endpointUrl||(t.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var i=t.propertyStorageOverride;if(i&&(!i.getProperty||!i.setProperty))throw"Invalid property storage override passed.";if(t.channels)for(var r=0;r<t.channels.length;r++)if(t.channels[r])for(var o=0;o<t.channels[r].length;o++){var s=t.channels[r][o];if(s.identifier&&s.version){var a=s.identifier+"="+s.version;this.pluginVersionStringArr.push(a)}}}if(this.getWParam=function(){return"undefined"!=typeof document?0:-1},n)for(r=0;r<n.length;r++){var u=n[r];if(u.identifier&&u.version){a=u.identifier+"="+u.version;this.pluginVersionStringArr.push(a)}}this.pluginVersionString=this.pluginVersionStringArr.join(";");try{e.prototype.initialize.call(this,t,n)}catch(e){this.logger.throwInternal(Oe.CRITICAL,It.ErrorProvidedChannels,"Channels must be provided through config.channels only")}this.pollInternalLogs("InternalLog")},t.prototype.track=function(t){var n,i=t;if(i){i.timings=i.timings||{},i.timings.trackStart=Kt(),(n=i.latency)&&qt(n)&&n>=1&&n<=3||(i.latency=Et);var r=i.ext=i.ext||{};r.sdk=r.sdk||{},r.sdk.ver="1DS-Web-JS-2.2.2";var o=i.baseData=i.baseData||{};o.properties||(o.properties={});var s=o.properties;s.version||(s.version=""),""!=this.pluginVersionString&&(s.version=this.pluginVersionString)}e.prototype.track.call(this,i)},t}(St),sn=function(){function e(){}return e.getPayloadBlob=function(e,t){var n="",i={};for(var r in e)if(e.hasOwnProperty(r))for(var o=0;o<e[r].length;++o){n&&(n+="\n");var s=n.length;if((n+=this.getEventBlob(e[r][o])).length-s>2e6&&(t&&t.eventsDiscarded([e[r][o]],gt),delete e[r][o],n=n.substring(0,s)),n.length>3984588){i={};var a=e[r];e[r]=a.splice(0,o),i[r]=a;break}}return{payloadBlob:n,remainingRequest:i}},e.getEventBlob=function(e){var t={};if(t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}(e.iKey),e.ext)for(var n in t.ext={},e.ext)if(e.ext.hasOwnProperty(n))for(var i in t.ext[n]={},e.ext[n])e.ext[n].hasOwnProperty(i)&&e.ext[n][i]&&(t.ext[n][i]=Vt(i,e.ext[n][i]).value);if(t.data={},t.data.baseData={},t.data.baseType=e.baseType,e.baseData)for(var n in e.baseData)if(e.baseData.hasOwnProperty(n)){var r=Vt(n,e.baseData[n]);this._addJSONProperty(t.data.baseData,n,r),this._addJSONPropertyMetaData(t.ext,"baseData."+n,r)}if(e.data)for(var n in e.data)if(e.data.hasOwnProperty(n)){r=Vt(n,e.data[n]);this._addJSONProperty(t.data,n,r),this._addJSONPropertyMetaData(t.ext,n,r)}return JSON.stringify(t)},e._addJSONProperty=function(e,t,n){if(n){for(var i=e,r=t.split("."),o=0;o<r.length-1;++o)i[r[o]]||(i[r[o]]={}),i=i[r[o]];i[r[r.length-1]]=n.value}},e._addJSONPropertyMetaData=function(e,t,n){if(n){var i=Ht(n.value,n.kind,n.propertyType);if(i>-1){var r=e;r.metadata||(r.metadata={f:{}}),r=r.metadata.f;for(var o=t.split("."),s=0;s<o.length-1;++s)r[o[s]]||(r[o[s]]={f:{}}),r=r[o[s]].f;jt(n.value)?r[o[o.length-1]]={a:{t:i}}:r[o[o.length-1]]={t:i}}}},e}(),an=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e&&429!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)},e}(),un=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var i=1e3*parseInt(t,10),r=0;r<n.length;++r)this._killedTokenDictionary[n[r]]=Date.now()+i}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){var t=this._killedTokenDictionary;return void 0!==t[e]&&t[e]>Date.now()||(delete t[e],!1)},e}(),cn=function(){function e(){this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._isFirstRequest=!0,this._clockSkewHeaderValue="use-collector-delta",this._clockSkewSet=!1}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e}(),ln=function(){function e(e){this._requestQueue=e,this._urlString="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version=1DS-Web-JS-2.2.2",this._killSwitch=new un,this._paused=!1,this._clockSkewManager=new cn,this._useBeacons=!1,this._activeConnections=0,this._customHttpInterface=!0,this._queryStringParameters=[]}return e.prototype.initialize=function(e,t,n,i){var r=this;this._urlString=e+this._urlString,this._core=t,this._postManager=n,this._httpInterface=i,this._httpInterface||(this._customHttpInterface=!1,this._useBeacons=!Qt(),this._httpInterface={sendPOST:function(e,t,n){if(function(){if(xt(XMLHttpRequest)){var e=new XMLHttpRequest;return Boolean(kt(e.withCredentials)&&xt(XDomainRequest))}}()){var i=new XDomainRequest;i.open("POST",e.urlString),i.onload=function(){t(200,{},i.responseText),r._handleCollectorResponse(i.responseText)},i.onerror=function(){t(400,{})},i.ontimeout=function(){t(500,{})},i.send(e.data)}else if(Qt())try{fetch(e.urlString,(s={body:e.data,method:"POST",credentials:"include"},s.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,s.headers=e.headers,s)).then((function(e){var n={},i="";e.headers&&e.headers.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){i=e})),t(e.status,n,i),r._handleCollectorResponse(i)})).catch((function(e){t(0,{})}))}catch(e){t(0,{})}else if("undefined"!=typeof XMLHttpRequest){var o=new XMLHttpRequest;o.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,o.withCredentials=!0,o.open("POST",e.urlString,!n),Wt(Bt(e.headers),(function(t){o.setRequestHeader(t,e.headers[t])})),o.onload=function(){t(o.status,r._convertAllHeadersToMap(o.getAllResponseHeaders()),o.responseText),r._handleCollectorResponse(o.responseText)},o.onerror=function(){t(o.status,r._convertAllHeadersToMap(o.getAllResponseHeaders()))},o.ontimeout=function(){t(o.status,r._convertAllHeadersToMap(o.getAllResponseHeaders()))},o.send(e.data)}var s}})},e.prototype.addQueryStringParameter=function(e,t){for(var n=0;n<this._queryStringParameters.length;n++)if(this._queryStringParameters[n].name===e)return void(this._queryStringParameters[n].value=t);this._queryStringParameters.push({name:e,value:t})},e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&this._postManager._scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e){this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,i){var r=this;if(void 0===i&&(i=!1),e){if(this._paused)return this._activeConnections--,void this._postManager._addBackRequest(e);var o=0,s="";for(var a in e)e.hasOwnProperty(a)&&(this._killSwitch.isTenantKilled(a)?(this._postManager._notificationManager&&this._postManager._notificationManager.eventsDiscarded(e[a],yt),delete e[a]):(s.length>0&&(s+=","),s+=a,o++));if(o>0){var u=Kt(),c=sn.getPayloadBlob(e,this._postManager._notificationManager),l=Kt();c.remainingRequest&&this._requestQueue.push(c.remainingRequest);var d=this._urlString+"&apikey="+s+"&upload-time="+Date.now().toString(),f=this._getMsfpc(e);Ut(f)&&(d=d+"&ext.intweb.msfpc="+f),this._clockSkewManager.shouldAddClockSkewHeaders()&&(d=d+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue()),this._core.getWParam&&(d=d+"&w="+this._core.getWParam());for(var p=0;p<this._queryStringParameters.length;p++)d=d+"&"+this._queryStringParameters[p].name+"="+this._queryStringParameters[p].value;var h=Kt();for(var a in e)if(e.hasOwnProperty(a))for(p=0;p<e[a].length;++p){var _=e[a][p];_.timings=_.timings||{},_.timings.sendEventStart=_.timings.sendEventStart||{},_.timings.serializationStart=_.timings.serializationStart||{},_.timings.serializationCompleted=_.timings.serializationCompleted||{},_.timings.sendEventStart[this._postManager.identifier]=h,_.timings.serializationStart[this._postManager.identifier]=u,_.timings.serializationCompleted[this._postManager.identifier]=l,_.sendAttempt>0?_.sendAttempt++:_.sendAttempt=1}if(!this._customHttpInterface&&this._useBeacons&&(null===Dt&&(Dt=Be()&&Boolean(Re().sendBeacon)),Dt)&&n)return void this._sendUsingBeacons(d,c.payloadBlob,e);if(this._httpInterface){var v={data:c.payloadBlob,urlString:d,headers:{}},g=function(a){r._httpInterface.sendPOST(a,(function(a,u){r._retryRequestIfNeeded(a,u,e,o,s,t,n,i)}),n||i)};this.sendHook?this.sendHook(v,g):g(v)}}else n||this._handleRequestFinished(null,{},n,i)}},e.prototype._sendUsingBeacons=function(e,t,n){if(navigator.sendBeacon(e,t))this._handleRequestFinished(!0,n,!0,!0);else for(var i in n)if(n.hasOwnProperty(i))for(var r=0;r<n[i].length;++r){if(!navigator.sendBeacon(e,sn.getEventBlob(n[i][r])))return;this._notifyEventCompleted(!0,[n[i][r]])}},e.prototype._addEventCompletedTimings=function(e){for(var t=Kt(),n=0;n<e.length;++n)e[n].timings=e[n].timings||{},e[n].timings.sendEventCompleted=e[n].timings.sendEventCompleted||{},e[n].timings.sendEventCompleted[this._postManager.identifier]=t},e.prototype._retryRequestIfNeeded=function(e,t,n,i,r,o,s,a){var u=this,c=!0;if(void 0!==e){if(t){var l=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var d=0;d<l.length;++d)this._postManager._notificationManager&&this._postManager._notificationManager.eventsDiscarded(n[l[d]],yt),delete n[l[d]],i--}else this._clockSkewManager.setClockSkew("");if(200===e)return void this._handleRequestFinished(!0,n,s,a);(!an.shouldRetryForStatus(e)||i<=0)&&(c=!1)}c?a?(this._activeConnections--,this._postManager._addBackRequest(n)):o<1?this._postManager._setTimeoutOverride((function(){return u._sendRequest(n,o+1,!1)}),an.getMillisToBackoffForRetry(o)):(this._activeConnections--,this._postManager._backOffTransmission(),this._postManager._addBackRequest(n)):this._handleRequestFinished(!1,n,s,a)},e.prototype._handleRequestFinished=function(e,t,n,i){for(var r in e&&this._postManager._clearBackOff(),t)t.hasOwnProperty(r)&&this._notifyEventCompleted(e,t[r],_t);this._activeConnections--,i||n||this.sendQueuedRequests()},e.prototype._notifyEventCompleted=function(e,t,n){this._addEventCompletedTimings(t),this._postManager._notificationManager&&(e?this._postManager._notificationManager.eventsSent(t):this._postManager._notificationManager.eventsDiscarded(t,n))},e.prototype._convertAllHeadersToMap=function(e){var t={};if(Ft(e))for(var n=e.split("\n"),i=0;i<n.length;++i){var r=n[i].split(": ");t[r[0]]=r[1]}return t},e.prototype._getMsfpc=function(e){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)if(e[t][n].ext&&e[t][n].ext.intweb&&Ut(e[t][n].ext.intweb.msfpc))return encodeURIComponent(e[t][n].ext.intweb.msfpc);return""},e.prototype._handleCollectorResponse=function(e){try{var t=JSON.parse(e);Ut(t.webResult)&&Ut(t.webResult.msfpc)&&Gt("MSFPC",t.webResult.msfpc,365)}catch(e){}},e}(),dn=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){var t=e.iKey;if(t){if(e.sync){var n={};return n[t]=[e],n}this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch();var i=this._currentBatch;void 0===i[t]&&(i[t]=[]),i[t].push(e),this._currentNumEventsInBatch++}return null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}(),fn=Lt?window:void 0,pn=function(e){function t(){var t=e.call(this)||this;return t.identifier="PostChannel",t.priority=1011,t.version="2.2.2",t._isTeardownCalled=!1,t._isCurrentlyFlushingNow=!1,t._flushQueue=[],t._databaseAdded=!1,t._paused=!1,t._queueSize=0,t._queueSizeLimit=1e4,t._profiles={},t._currentProfile="REAL_TIME",t._timeout=null,t._currentBackoffCount=0,t._timerCount=0,t._flushCallback=-1,t._flushOutboundQueue=[],t._outboundQueue=[],t._inboundQueues={},t._inboundQueues[wt]=[],t._inboundQueues[bt]=[],t._inboundQueues[Et]=[],t._initializeProfiles(),t._addEmptyQueues(),t._batcher=new dn(t._outboundQueue,500),t._syncFlushBatcher=new dn(t._flushOutboundQueue,500),t._httpManager=new ln(t._outboundQueue),t}return d(t,e),t.prototype.initialize=function(t,n,i){var r=this;e.prototype.initialize.call(this,t,n,i),this.setInitialized(!1);var o=this._getTelCtx();t.extensionConfig[this.identifier]=t.extensionConfig[this.identifier]||{},this._config=o.getExtCfg(this.identifier),this._setTimeoutOverride=this._config.setTimeoutOverride?this._config.setTimeoutOverride:setTimeout.bind(fn),this._clearTimeoutOverride=this._config.clearTimeoutOverride?this._config.clearTimeoutOverride:clearTimeout.bind(fn),this._config.eventsLimitInMem>0&&(this._queueSizeLimit=this._config.eventsLimitInMem),this._config.httpXHROverride&&this._config.httpXHROverride.sendPOST&&(this._xhrOverride=this._config.httpXHROverride),Ut(t.anonCookieName)&&this._httpManager.addQueryStringParameter("anoncknm",t.anonCookieName),this._httpManager.sendHook=this._config.payloadPreprocessor;var s,a,u=this._config.overrideEndpointUrl?this._config.overrideEndpointUrl:t.endpointUrl;this._notificationManager=t.extensionConfig.NotificationManager,this._httpManager.initialize(u,this.core,this,this._xhrOverride);for(var c=0;c<i.length;++c)i[c].identifier&&"LocalStorage"===i[c].identifier&&(this._databaseAdded=!0);a=Jt("beforeunload",s=function(){r.releaseAllQueuesUsingBeacons()}),a=Jt("unload",s)||a,a=Jt("pagehide",s)||a,this.setInitialized(!0)},t.prototype.processTelemetry=function(e,t){!function(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=Kt()}(e,this.identifier);var n=(t=this._getTelCtx(t)).getExtCfg(this.identifier),i=!1;Ge.isNullOrUndefined(this._config.disableTelemetry)&&(i=this._config.disableTelemetry),n&&Ge.isNullOrUndefined(n.disableTelemetry)&&(i=n.disableTelemetry);var r=e;if(!i&&!this._isTeardownCalled){if(this._config.overrideInstrumentationKey&&(r.iKey=this._config.overrideInstrumentationKey),n&&n.overrideInstrumentationKey&&(r.iKey=n.overrideInstrumentationKey),r.sendAttempt||(r.sendAttempt=0),r.latency||(r.latency=Et),r.ext&&r.ext.trace&&delete r.ext.trace,r.ext&&r.ext.user&&r.ext.user.id&&delete r.ext.user.id,r.sync)if(this._currentBackoffCount>0||this._paused)r.latency=wt,r.sync=!1;else if(this._httpManager)return void this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(r));this._queueSize<this._queueSizeLimit||this._dropEventWithLatencyOrLess(r.latency)?this._addEventToProperQueue(r):this._notificationManager&&this._notificationManager.eventsDiscarded([r],mt),this._scheduleTimer()}this.processNext(r,t)},t.prototype.teardown=function(){this.releaseAllQueuesUsingBeacons(),this._isTeardownCalled=!0},t.prototype.pause=function(){this._clearTimeout(),this._paused=!0,this._httpManager.pause(),this._databaseAdded&&(this._queueSize-=this._inboundQueues[wt][0].length+this._inboundQueues[bt][0].length+this._inboundQueues[Et][0].length,this._inboundQueues[wt][0]=[],this._inboundQueues[bt][0]=[],this._inboundQueues[Et][0]=[],this._httpManager.removeQueuedRequests())},t.prototype.resume=function(){this._paused=!1,this._httpManager.resume(),this._scheduleTimer()},t.prototype._loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(e[t].length<2)continue;if(e[t].splice(0,e[t].length-2),e[t][1]<0&&(e[t][0]=-1),e[t][1]>0&&e[t][0]>0){var n=e[t][0]/e[t][1];e[t][0]=Math.ceil(n)*e[t][1]}this._profiles[t]=e[t]}},t.prototype.flush=function(e,t){var n=this;if(void 0===e&&(e=!0),!this._paused)if(this._clearTimeout(),e)this._addEmptyQueues(),this._isCurrentlyFlushingNow?this._flushQueue.push(t):(this._isCurrentlyFlushingNow=!0,this._setTimeoutOverride((function(){return n._flushImpl(t)}),0));else{this._batchEvents(Et,this._syncFlushBatcher);for(var i=0;i<this._flushOutboundQueue.length;i++)this._httpManager.sendSynchronousRequest(this._flushOutboundQueue[i]);null!=t&&t()}},t.prototype.setMsaAuthTicket=function(e){this._httpManager.addQueryStringParameter("AuthMsaDeviceTicket",e)},t.prototype._setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this._clearTimeout(),this._currentProfile=e,this._scheduleTimer())},t.prototype._sendEventsForLatencyAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},t.prototype._hasEvents=function(){return(this._inboundQueues[wt][0].length>0||this._inboundQueues[bt][0].length>0||this._inboundQueues[Et][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},t.prototype._addBackRequest=function(e){if(!this._paused||!this._databaseAdded)for(var t in e)if(e.hasOwnProperty(t)){1===e[t].length&&e[t][0].sync&&(e[t][0].latency=wt,e[t][0].sync=!1);for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.processTelemetry(e[t][n]):this._notificationManager&&this._notificationManager.eventsDiscarded([e[t][n]],_t)}},t.prototype._scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][1];if(!this._timeout&&t>=0&&!this._paused)if(this._hasEvents()){0===t&&this._currentBackoffCount>0&&(t=1);var n=1e3;this._currentBackoffCount>0&&(n=an.getMillisToBackoffForRetry(this._currentBackoffCount-1)),this._timeout=this._setTimeoutOverride((function(){return e._batchAndSendEvents()}),t*n)}else this._timerCount=0},t.prototype._backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this._clearTimeout(),this._scheduleTimer())},t.prototype._clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this._clearTimeout(),this._scheduleTimer())},t.prototype._clearTimeout=function(){this._timeout&&(this._clearTimeoutOverride(this._timeout),this._timeout=null,this._timerCount=0)},t.prototype._batchAndSendEvents=function(){var e=wt;this._timerCount++,2===this._timerCount&&(e=Et,this._timerCount=0),this._sendEventsForLatencyAndAbove(e),this._timeout=null,this._scheduleTimer()},t.prototype.releaseAllQueuesUsingBeacons=function(){this._clearTimeout(),this._flushCallback>0&&this._clearTimeoutOverride(this._flushCallback),this._paused||this._databaseAdded||(this._mergeQueues(),this._batchEvents(Et),this._httpManager.teardown())},t.prototype._removeFirstQueues=function(){this._inboundQueues[wt].shift(),this._inboundQueues[bt].shift(),this._inboundQueues[Et].shift()},t.prototype._addEmptyQueues=function(){this._inboundQueues[wt].push([]),this._inboundQueues[bt].push([]),this._inboundQueues[Et].push([])},t.prototype._mergeQueues=function(){for(var e=Et;e<=wt;e++)for(var t=1;t<this._inboundQueues[e].length;t++)for(;this._inboundQueues[e][t].length>0;)this._inboundQueues[e][0].push(this._inboundQueues[e][t].pop())},t.prototype._addEventToProperQueue=function(e){this._paused&&this._databaseAdded||(this._queueSize++,this._inboundQueues[e.latency][this._inboundQueues[e.latency].length-1].push(e))},t.prototype._dropEventWithLatencyOrLess=function(e){for(var t=Et;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0){var n=this._inboundQueues[t][this._inboundQueues[t].length-1].splice(0,20);return this._notificationManager&&this._notificationManager.eventsDiscarded(n,mt),!0}t++}return!1},t.prototype._batchEvents=function(e,t){void 0===t&&(t=this._batcher);for(var n=wt;n>=e;){for(;this._inboundQueues[n][0].length>0;){var i=this._inboundQueues[n][0].pop();this._queueSize--,t.addEventToBatch(i)}n--}t.flushBatch()},t.prototype._flushImpl=function(e){var t=this;this._hasEvents()&&this._sendEventsForLatencyAndAbove(Et),this._checkOutboundQueueEmptyAndSent((function(){t._removeFirstQueues(),null!=e&&e(),t._flushQueue.length>0?t._flushCallback=t._setTimeoutOverride((function(){return t._flushImpl(t._flushQueue.shift())}),0):(t._isCurrentlyFlushingNow=!1,t._hasEvents()&&t._scheduleTimer())}))},t.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():this._flushCallback=this._setTimeoutOverride((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250)},t.prototype._resetTransmitProfiles=function(){this._clearTimeout(),this._initializeProfiles(),this._currentProfile="REAL_TIME",this._scheduleTimer()},t.prototype._initializeProfiles=function(){this._profiles={},this._profiles.REAL_TIME=[2,1],this._profiles.NEAR_REAL_TIME=[6,3],this._profiles.BEST_EFFORT=[18,9]},t}(rt);function hn(e,t,n,i){void 0===i&&(i=!1);var r=0;for(var o in e)e.hasOwnProperty(o)&&(r+=e[o].length);var s=performance.now();$t(e,t,n,i),nn(performance.now()-s,r)}function _n(e,t,n){en(e,t,n),rn(e.data.length)}function vn(e,t,n){tn(e,t,n),rn(t.length)}var gn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),yn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return gn(t,e),t.prototype.initialize=function(t,n){this._postChannel=new pn;var i=[];n&&(i=i.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=t.channelConfiguration?t.channelConfiguration:{};try{e.prototype.initialize.call(this,t,i)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.addInstrumentation=function(e){this._postChannel&&e&&(function(e,t,n){if(!e._httpManager)return!1;var i=e._httpManager;if(!(i&&i._httpInterface&&i._sendRequest&&i._sendUsingBeacons))return!1;$t=i._sendRequest.bind(i),i._sendRequest=hn;var r=i._httpInterface;return en=r.sendPOST.bind(i),r.sendPOST=_n,tn=i._sendUsingBeacons.bind(i),i._sendUsingBeacons=vn,nn=t,rn=n,!0}(this._postChannel,e.requestProcessingStats,e.networkStats)||E(p.Error,h.Sink,(function(){return"Failed to instrument 1DS delivery task"})))},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,i={};i.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(i),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.connectNotificationListener=function(e){e&&this.addNotificationListener(e)},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(on),mn=function(){function e(){this._fullEventsEnabled=!1}return e.prototype.processEvent=function(e){if(!this._fullEventsEnabled&&!e.eventFlags)throw new Error(e.eventName+" missing Event Flags");var t=this._fullEventsEnabled||!!e.eventFlags&&(e.eventFlags.diagnosticLevel===be.BasicEvent||e.eventFlags.diagnosticLevel===be.NecessaryServiceDataEvent||e.eventFlags.diagnosticLevel===be.AlwaysOnNecessaryServiceDataEvent);return t||E(p.Info,h.Sink,(function(){return"1DS Data Classification Failed to Send: "+e.eventName})),t},e.prototype.setFullEventsEnabled=function(e){this._fullEventsEnabled=e},e}(),Tn=function(){return(Tn=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Sn=0;function En(e,t,n){var i=bn(e.dataFields,!0);return i["Event.Sequence"]=++Sn,i["Event.Name"]=e.eventName,i["Event.Source"]="OTelJS",i["Event.Time"]=function(e){var t;t=e?new Date(e):new Date;return t}(n).toISOString(),t&&(i["Event.Id"]=t+"."+Sn),e.eventContract&&(i["Event.Contract"]=e.eventContract.name,i=Tn(Tn({},i),bn(e.eventContract.dataFields,!1))),i}function bn(e,t){var n={};return e&&e.forEach((function(e){if(!e.classification||e.classification===m.SystemMetadata||e.classification===m.EssentialServiceMetadata){var i,r;switch(i=t?"zC."===e.name.substr(0,3)?"zC.Data."+e.name.substr(3):"Data."+e.name:e.name,e.dataType){case g.Double:r=At.Double;break;case g.Int64:r=At.Int64;break;case g.Guid:r=At.Guid;break;case g.Boolean:case g.String:default:return void(n[i]=e.value)}var o={value:e.value,propertyType:r};n[i]=o}})),n}var wn,An=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),In=function(){return(In=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Cn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="PartAPlugin",t.priority=3,t._properties={},t}return An(t,e),t.prototype.initialize=function(t,n,i){e.prototype.initialize.call(this,t,n,i)},t.prototype.processTelemetry=function(e,t){e.data=In(In({},e.data),this._properties);var n=this._getTelCtx(t);this.processNext(e,n)},t.prototype.setProperties=function(e){this._properties=In(In({},this._properties),e)},t}(rt),Pn=n(23);(wn||(wn={})).newGuid=function(){return Object(Pn.v4)()};var On=function(){function e(e,t){this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this._persistentDataFields=[],this._preprocessors=[],this._partADataFieldsPlugin=new Cn,this.setPersistentDataFields(e),this._oneDSSinkSessionId=wn.newGuid(),this._epoch=(new Date).getTime().toString(),this._applicationInsights=new yn,this._applicationInsights.initialize({instrumentationKey:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",endpointUrl:t.endpointUrl,channelConfiguration:{eventsLimitInMem:t.eventsLimitInMem,httpXHROverride:t.httpXHROverride,setTimeoutOverride:t.setTimeoutOverride,clearTimeoutOverride:t.clearTimeoutOverride}},[this._partADataFieldsPlugin]),this._applicationInsights.setUploadFrequency(t.uploadFrequency),this._applicationInsights.connectNotificationListener(t.notificationListener),this._applicationInsights.addInstrumentation(t.stats),t.disableStatsTracking||this.hookUp1DSNotifications(this._applicationInsights),this._dataClassificationChecker=new mn,this.addPreprocessor(this._dataClassificationChecker)}return e.prototype.sendTelemetryEvent=function(e,t){try{for(var n=0;n<this._preprocessors.length;n++)if(!this._preprocessors[n].processEvent(e))return;this.sendEventInternal(e,t)}catch(e){b(h.Sink,"1DS Sink",e)}},e.prototype.getPersistentDataFields=function(){return this._persistentDataFields},e.prototype.setPersistentDataFields=function(e){this._partADataFieldsPlugin.setProperties(bn(e,!1)),this._persistentDataFields=e},e.prototype.addPreprocessor=function(e){this._preprocessors.push(e)},e.prototype.setFullEventsEnabled=function(e){this._dataClassificationChecker.setFullEventsEnabled(e)},e.prototype.sendEventInternal=function(e,t){if(this.eventsProcessed++,!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Aria Tenant Token");var n=En(e,this._oneDSSinkSessionId,t);this._applicationInsights.track({iKey:e.telemetryProperties.ariaTenantToken,name:e.eventName,data:n,time:(new Date).toISOString(),baseType:"EventData",ext:{sdk:{seq:n?n["Event.Sequence"]:1,epoch:this._epoch}}})},e.prototype.hookUp1DSNotifications=function(e){var t=this;e.addNotificationListener({eventsSent:function(e){E(p.Info,h.Transport,(function(){return"Successfully sent "+e.length+" event(s)"})),E(p.Verbose,h.Transport,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),t.eventsSent+=e.length},eventsDiscarded:function(e,n){E(p.Error,h.Transport,(function(){return"Discarded "+e.length+" event(s) because "+n})),E(p.Verbose,h.Transport,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),t.eventsDiscarded+=e.length}})},e.prototype.flush=function(e){this._applicationInsights.flush(e)},e.prototype.shutdown=function(){this._applicationInsights.shutdown()},e}();function kn(e){return{name:"App",contract:{name:"App",dataFields:[Ln("Name",e.name),Ln("Platform",e.platform),Ln("Version",e.version)]}}}function Nn(e){return{name:"Session",contract:{name:"Session",dataFields:[Ln("Id",e.sessionId),Ln("ABFlights",e.flightsImpressionId)]}}}function xn(e){return{name:"Release",contract:{name:"Release",dataFields:[Ln("AudienceGroup",e.audienceGroup)]}}}function Dn(e){return{name:"Browser",contract:{name:"Browser",dataFields:[Ln("Name",e.browserName),Ln("Version",e.browserVersion)]}}}function Mn(e){return{name:"Culture",contract:{name:"Culture",dataFields:[Ln("UiLanguage",e.appLanguage)]}}}function Wn(e){return{name:"User",contract:{name:"User",dataFields:[Ln("PrimaryIdentityHash",e.loggableUserId),Ln("PrimaryIdentitySpace",e.loggableUserIdSpace),Ln("TenantId",e.omsTenantId),Un("IsAnonymous",e.isAnonymousUser)]}}}function Bn(e){return{name:"WAC",contract:{name:"WAC",dataFields:[Ln("Host",e.host),Ln("ServerDocId",e.serverDocId),Ln("Datacenter",e.datacenter),Un("IsSynthetic",e.isSynthetic),Un("IsBusinessUser",e.isBusinessUser),Un("IsEdu",e.isEduUser),Ln("ApplicationMode",e.applicationMode),Ln("ApplicationModeExtended",e.applicationModeExtended),Ln("BrowserLanguage",e.browserLanguage),Ln("ContentLanguage",e.contentLanguage),Ln("OsVersion",e.osVersion),Ln("Ring",e.ring),Ln("UiHost",e.uiHost)]}}}var Rn;function Ln(e,t){return null==t?{name:e,string:""}:{name:e,string:t}}function Un(e,t){return null==t?{name:e,bool:!1}:{name:e,bool:t}}function Fn(e,t){var n=[];if(e)for(var i=0;i<e.length;i+=1)n.push.apply(n,qn(e[i],t));return n}function qn(e,t,n){if(!e.name)throw new Error("DataField is missing a name");var i=function(e){if(null!=e.string)return 2;if(null!=e.bool)return 1;if(null!=e.int64&&!isNaN(e.int64))return 3;if(null!=e.double&&!isNaN(e.double))return 4;if(null!=e.contract)return 6;if(null!=e.date&&!isNaN(e.date))return 5;return 0}(e),r=n?n+"."+e.name:e.name;switch(i){case 0:return[];case 1:return[w(r,e.bool)];case 2:return[C(r,e.string)];case 3:return[A(r,Math.floor(e.int64))];case 4:return[I(r,e.double)];case 5:return[C(r,new Date(e.date).toISOString())];case 6:return function(e,t,n){if(!t.name)throw new Error("Contract is missing a name");var i=[];if(t.dataFields)for(var r=0;r<t.dataFields.length;r+=1)i.push.apply(i,qn(t.dataFields[r],n,e));return i}(r,e.contract,t);default:throw new Error(i)}}!function(e){e[e.USGOV_DOD=0]="USGOV_DOD",e[e.USGOV_DOJ=1]="USGOV_DOJ",e[e.AUSTRALIA=2]="AUSTRALIA",e[e.EUROPE=3]="EUROPE",e[e.GERMANY=4]="GERMANY",e[e.JAPAN=5]="JAPAN",e[e.UNITED_STATES=6]="UNITED_STATES",e[e.PUBLIC=7]="PUBLIC"}(Rn||(Rn={}));var zn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Vn=function(){return(Vn=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Qn=function(e){function t(n,i,r){void 0===i&&(i=[]);if(void 0!==r&&void 0!==r.endpointUrl)throw new Error("Cannot override collector URI");return e.call(this,i,Vn(Vn({},r),{endpointUrl:t.getEndpointUrl(n)}))||this}return zn(t,e),t.prototype.getSinkType=function(){return Ce.AriaSE},t.getEndpointUrl=function(e){switch(e){case Rn.AUSTRALIA:return re.AWT_COLLECTOR_URL_AUSTRALIA;case Rn.EUROPE:return re.AWT_COLLECTOR_URL_EUROPE;case Rn.GERMANY:return re.AWT_COLLECTOR_URL_GERMANY;case Rn.JAPAN:return re.AWT_COLLECTOR_URL_JAPAN;case Rn.PUBLIC:return;case Rn.UNITED_STATES:return re.AWT_COLLECTOR_URL_UNITED_STATES;case Rn.USGOV_DOD:return re.AWT_COLLECTOR_URL_USGOV_DOD;case Rn.USGOV_DOJ:return re.AWT_COLLECTOR_URL_USGOV_DOJ}},t}(ke),jn=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i},Hn=function(){function e(e,t){this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this.TELEMETRY_THROTTLED_EVENT={eventName:"Office.Telemetry.OTelJS.EventThrottled",telemetryProperties:{ariaTenantToken:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",nexusTenantToken:1723}},this._sinkName=e,this._lastIntervalStart=Date.now(),this._sendEvent=Ae,this._maxNamedEventsPerSecond={},this._ariaSink=t}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[e.eventName]=this._singleEventInLastInterval[e.eventName]+1||1,e.eventName in this._maxNamedEventsPerSecond?this.applyThrottle(this._singleEventInLastInterval[e.eventName],this._maxNamedEventsPerSecond[e.eventName],"MaxNamedEventsPerSecond",e.eventName):this._maxSingleEventPerSecond&&this.applyThrottle(this._singleEventInLastInterval[e.eventName],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",e.eventName),this._maxTotalEventsPerSecond&&(this._totalEventsInLastInterval++,this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",e.eventName)),!0},e.prototype.applyThrottle=function(e,t,n,i){if(e>t){if(e===t+1){var r=[];void 0!==this._ariaSink&&void 0!==this._ariaSink.getAdditionalDataFields()&&(r=jn(this._ariaSink.getAdditionalDataFields())),r.push(C("SinkName",this._sinkName)),r.push(C("ThrottledEvent.Name",i)),r.push(A(n,t)),this._sendEvent(this.TELEMETRY_THROTTLED_EVENT,r)}throw new Error("Exceeded "+t+" "+n+": "+i+" ")}return!0},e}(),Gn=function(){function e(e){this.stats=void 0,this.taskStats=void 0,this.config=e,this.resetStats()}return e.prototype.resetStats=function(){this.stats={processed:0,sent:0,throttled:0,dropped:0,droppedDetails:{},eventsProcessingTime:0,taskExecutionTime:0,taskExecutionCount:0,bytesOverWire:0,eventSerializationTime:0,eventTransmissionTime:0},this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]}},e.prototype.logSessionStats=function(){this.computeSessionAverages(),u.sendTraceTag(this.config.tags.sessionStats,r.msoulscat_Wac_Telemetry,i.Info,JSON.stringify(this.stats))},e.prototype.computeSessionAverages=function(){this.stats.processed>0&&(this.stats.averageTimeCostPerEvent=+((this.stats.eventsProcessingTime+this.stats.taskExecutionTime)/this.stats.processed).toFixed(3),this.stats.averageProcessingTimeCostPerEvent=+(this.stats.eventsProcessingTime/this.stats.processed).toFixed(4),this.stats.averageTaskTimeCostPerEvent=+(this.stats.taskExecutionTime/this.stats.processed).toFixed(4),this.stats.averageNetworkCostPerEvent=+(this.stats.bytesOverWire/this.stats.processed).toFixed(0))},e.prototype.logAndClearTaskStats=function(){this.taskStats.taskExecutionTimes.length<=0||(u.sendTraceTag(this.config.tags.taskStats,r.msoulscat_Wac_Telemetry,i.Info,this.taskStats.taskExecutionTimes.join(",")),this.config.settings.reportTaskDetails&&u.sendTraceTag(this.config.tags.taskDetailsStats,r.msoulscat_Wac_Telemetry,i.Info,JSON.stringify(this.taskStats.taskExecutionTimesDetails)),this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]})},e.prototype.recordUploadTaskDuration=function(e,t,n,o){if(e>this.config.settings.durationThreshold&&u.sendTraceTag(this.config.tags.taskDurationThresholdExceeded,r.msoulscat_Wac_Telemetry,i.Info,"Task took "+e+" ms"),this.stats.taskExecutionTime+=e,t>0){var s=+e.toFixed(3);this.stats.taskExecutionCount+=1,this.taskStats.taskExecutionTimes.push(s),this.stats.eventSerializationTime+=n||0,this.stats.eventTransmissionTime+=o||0,this.taskStats.taskExecutionTimesDetails.push({x:Date.now(),e:t,c:s,s:n,t:o}),this.taskStats.taskExecutionTimes.length>=this.config.settings.taskDurationLogFrequency&&this.logAndClearTaskStats()}},e.prototype.checkAndLogPipelineHealth=function(){var e=Date.now()-this.config.sdkInitializationTime;this.stats.processed>0&&0===this.stats.sent&&(this.stats.dropped>0||e>this.config.settings.sessionDurationCutoff)&&u.sendTraceTag(this.config.tags.sdkHealth,r.msoulscat_Wac_Telemetry,i.Warning,"Telemetry pipeline might be malfunctioning: Processed="+this.stats.processed+", Sent="+this.stats.sent+", Dropped="+this.stats.dropped+", SessionDuration="+e+" ms")},e}();function Kn(e,t,n){var o=function(e){var t=Rn[e];t||(u.sendTraceTag(593597405,r.msoulscat_Wac_Telemetry,i.Error,"Unknown Aria endpoint "+e+" - defaulting to Public one"),t=Rn.PUBLIC);return t}(e.collectorEndpointEnum),s={notificationListener:new Zn(n),uploadFrequency:e.eventUploadFrequency,eventsLimitInMem:e.cacheMemorySizeLimitInNumberOfEvents,stats:{requestProcessingStats:function(e,t){n.recordUploadTaskDuration(e,t)},networkStats:function(e){n.stats.bytesOverWire+=e}},disableStatsTracking:!0};return new Qn(o,t,s)}function Jn(e){return new Hn("WACAriaSink",e)}var Xn,Zn=function(){function e(e){this.reporter=e}return e.prototype.eventsSent=function(e){this.reporter.stats.sent+=e.length},e.prototype.eventsDropped=function(e,t){var n=re.AWTEventsDroppedReason[t]||t.toString();this.reporter.stats.droppedDetails[n]=this.reporter.stats.droppedDetails[n]+e.length||e.length,this.reporter.stats.dropped+=e.length},e.prototype.eventsRejected=function(e,t){var n=re.AWTEventsRejectedReason[t]||t.toString();this.reporter.stats.droppedDetails[n]=this.reporter.stats.droppedDetails[n]+e.length||e.length,this.reporter.stats.dropped+=e.length},e.prototype.eventsRetrying=function(e){},e}(),Yn=function(){function e(e,t){this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._sinkName=e,this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={},this._oneDSSink=t}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[e.eventName]=this._singleEventInLastInterval[e.eventName]+1||1,e.eventName in this._maxNamedEventsPerSecond?t=this.applyThrottle(this._singleEventInLastInterval[e.eventName],this._maxNamedEventsPerSecond[e.eventName],"MaxNamedEventsPerSecond",e.eventName):this._maxSingleEventPerSecond&&(t=this.applyThrottle(this._singleEventInLastInterval[e.eventName],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",e.eventName)),this._maxTotalEventsPerSecond&&(this._totalEventsInLastInterval++,t&&(t=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",e.eventName))),t},e.prototype.applyThrottle=function(e,t,n,i){if(e>t){if(e===t+1){var r={eventName:"Office.Telemetry.OTelJS.EventThrottled",telemetryProperties:{ariaTenantToken:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",nexusTenantToken:1723},dataFields:[C("SinkName",this._sinkName),C("ThrottledEvent.Name",i),A(n,t)]};this._oneDSSink.sendEventInternal(r)}return E(p.Info,h.Sink,(function(){return"1DS Sink Event Throttle: Exceeded "+t+" "+n+": "+i})),!1}return!0},e}();!function(e){e.USGOV_DOD="https://pf.events.data.cloudapp.onecollector.akadns.net/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.cloudapp.onecollector.akadns.net/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/"}(Xn||(Xn={}));var $n;function ei(e,t,n){var o={endpointUrl:function(e){var t=Xn[e];t||(u.sendTraceTag(593597411,r.msoulscat_Wac_Telemetry,i.Error,"Unknown 1DS endpoint "+e+" - defaulting to Public one"),t=Xn.PUBLIC);return t}(e.collectorEndpointEnum),notificationListener:new ni(n),uploadFrequency:e.eventUploadFrequency,eventsLimitInMem:e.cacheMemorySizeLimitInNumberOfEvents,stats:{requestProcessingStats:function(e,t){n.recordUploadTaskDuration(e,t)},networkStats:function(e){n.stats.bytesOverWire+=e}},disableStatsTracking:!0};return new On(t||[],o)}function ti(e){return new Yn("WACAriaSink",e)}!function(e){e[e.Unknown=0]="Unknown",e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.InvalidEvent=2]="InvalidEvent",e[e.SizeLimitExceeded=3]="SizeLimitExceeded",e[e.KillSwitch=4]="KillSwitch",e[e.QueueFull=5]="QueueFull"}($n||($n={}));var ni=function(){function e(e){this.reporter=e}return e.prototype.eventsSent=function(e){this.reporter.stats.sent+=e.length},e.prototype.eventsDiscarded=function(e,t){var n=$n[t]||t.toString();this.reporter.stats.droppedDetails[n]=this.reporter.stats.droppedDetails[n]+e.length||e.length,this.reporter.stats.dropped+=e.length},e}();function ii(e){var t={alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.ariaAndOneDsTransportSettings,throttlingSettings:e.throttlingSettings,statsSettings:e.statsSettings};return e.useOneDsLogger?function(e){return new ri({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.transportSettings,throttlingSettings:e.throttlingSettings,stats:(t=e.statsSettings,n={settings:t,tags:{sessionStats:593597406,taskStats:593597407,taskDetailsStats:593597408,taskDurationThresholdExceeded:593597409,sdkHealth:593597410},sdkInitializationTime:Date.now()},new Gn(n)),createSinkFunc:ei,createThrottlerFunc:ti,collectorPingUrl:"https://browser.events.data.microsoft.com/ping"});var t,n}(t):function(e){return new ri({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.transportSettings,throttlingSettings:e.throttlingSettings,stats:(t=e.statsSettings,n={settings:t,tags:{sessionStats:593597400,taskStats:593597401,taskDetailsStats:593597402,taskDurationThresholdExceeded:593597403,sdkHealth:593597404},sdkInitializationTime:Date.now()},new Gn(n)),createSinkFunc:Kn,createThrottlerFunc:Jn,collectorPingUrl:"https://browser.pipe.aria.microsoft.com/ping"});var t,n}(t)}var ri=function(){function e(e){this._processedEvent=new o,this._throttledEvent=new o,this._logger=new ie(void 0,void 0,{disableValidation:!0}),this._enabled=e.transportSettings.enabled,this._throttlingEnabled=e.throttlingSettings.enabled,this._reporter=e.stats,this._collectorPingUrl=e.collectorPingUrl;var t,n=Fn((t=e.alwaysOnMetadata)?[kn,Nn,xn,Dn,Mn,Bn,Wn].map((function(e){return e(t)})):[],"AlwaysOnMetadata");this._sink=e.createSinkFunc(e.transportSettings,n,this._reporter),this._sink.setFullEventsEnabled(!0),this._eventThrottler=e.createThrottlerFunc(this._sink),function(e,t){if(e.setSingleEventThrottle(t.singleEventThrottlePerSec),e.setTotalEventThrottle(t.totalEventsThrottlePerSec),t.eventNamesToBeSuppressedCommaSeparated){t.eventNamesToBeSuppressedCommaSeparated.split(",").forEach((function(t){e.setNamedEventThrottle(t,0)}))}}(this._eventThrottler,e.throttlingSettings)}return e.prototype.pingCollectorPingUrl=function(){!function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!0),t.onreadystatechange=function(){4===t.readyState&&(200===t.status?t.responseText.toLowerCase().indexOf("ok")>-1?u.sendTraceTag(593597389,r.msoulscat_Wac_Telemetry,i.Info,"Collector ping 200 OK."):u.sendTraceTag(593597390,r.msoulscat_Wac_Telemetry,i.Warning,"Collector ping 200 OK but with invalid response."):u.sendTraceTag(593597391,r.msoulscat_Wac_Telemetry,i.Warning,"Collector ping returned with HTTP "+t.status.toString()))},t.send()}catch(e){u.sendTraceTag(593597392,r.msoulscat_Wac_Telemetry,i.Warning,"Collector ping failed with error: "+e.toString())}}(this._collectorPingUrl)},e.prototype.pingCollectorEndpoint=function(){},e.prototype.setTenantToken=function(e,t){t&&this._logger.setTenantToken(e,t,-1)},e.prototype.sendOtelTelemetryEvent=function(e,t){var n=!1,i=performance.now();this._logger.processTelemetryEvent(e),this._throttlingEnabled&&!this._eventThrottler.processEvent(e)&&(n=!0),this._enabled&&!n&&this._sink.sendTelemetryEvent(e,t),this._reporter.stats.eventsProcessingTime+=performance.now()-i,n?(this._reporter.stats.throttled+=1,this._throttledEvent.fireEvent(e)):(this._reporter.stats.processed+=1,this._processedEvent.fireEvent(e))},e.prototype.flush=function(e){this._sink instanceof ke?this._sink.flushAsync((function(){})):this._sink instanceof On&&this._sink.flush(e)},e.prototype.shutdown=function(){this._enabled&&this._sink.shutdown(),this._reporter.logSessionStats(),this._reporter.logAndClearTaskStats(),this._reporter.checkAndLogPipelineHealth()},e.prototype.getStats=function(){return this._reporter},e.prototype.onProcessedEvent=function(){return this._processedEvent},e.prototype.onThrottledEvent=function(){return this._throttledEvent},e}();var oi,si,ai=[{id:1,namespace:"Office.Online",ariaTenant:"79b56d2f6f2444f1a3d7f7c7f12bcc0c-f47f5fe6-ed89-42f6-8a43-cea0f5930b17-7407"},{id:2,namespace:"Office.Word.Online.Data",ariaTenant:"7e7959aac92e41d6892c69a87259ed58-de5c63ef-10f5-45e1-bef2-d23e9cac2fab-6830"},{id:3,namespace:"Office.Excel.Online.Data",ariaTenant:"011776870b754a649aedc9456ac07a97-6bd8247c-11d3-4599-b599-ec9ef6d401f6-6722"},{id:4,namespace:"Office.PowerPoint.Online.Data",ariaTenant:"35612b11d234460da5c673d7b172fd93-f8762c6b-96cb-4e60-87fa-015aac0c2ff1-7212"},{id:4,namespace:"Office.OneNote.Online.Data",ariaTenant:"86258c80efed47d9b34bf77fc663b381-af82a060-b49f-448b-baf0-956ba7709592-7634"},{id:5,namespace:"Office.Visio.Online.Data",ariaTenant:"77fd25a525d24b7f9b924307de0cc70f-5f2b6ec0-f1d2-40dd-b875-e6bd2849e1eb-7539"},{id:6,namespace:"Office.Word.Online",ariaTenant:"ff7e2f12a4be407096fc01eeb760eda3-eeeb63cf-35d9-4734-ab45-66a873412359-7045"},{id:7,namespace:"Office.Excel.Online",ariaTenant:"fad3bd1d8e4b4c06894bd7bac80e4f02-67df67b4-f1fd-4ecd-9d55-4d41540b1757-7724"},{id:8,namespace:"Office.PowerPoint.Online",ariaTenant:"b664cab4b3f24a739be75b93b026749e-65c206a3-a985-48b4-8b50-36c56c3ce309-7201"},{id:9,namespace:"Office.OneNote.Online",ariaTenant:"1705ef36a51840648341da866d62baf8-ddbcd60b-4ce4-48da-96be-ad5f28b48954-8035"},{id:10,namespace:"Office.Visio.Online",ariaTenant:"a9b6cb604fe942a89c8671aab85364f6-af0f81b1-c5ce-419a-82d5-af38c33ebea3-7250"},{id:11,namespace:"Office.Word.Online.Health",ariaTenant:"e064ef4d9cdb454d9eddb2f7f7a94c83-89a6d9df-7218-4efd-bcd4-16ea059deea2-7672"},{id:12,namespace:"Office.Excel.Online.Health",ariaTenant:"e76e8055912d482eb56ea5dad2fd5a97-5552f2bb-d1eb-4843-95d7-3019215328a0-6899"},{id:13,namespace:"Office.PowerPoint.Online.Health",ariaTenant:"706f939c0d24440ba8dfb0838ed33611-d60b1956-db23-4410-a59d-e7fa08d4217f-7388"},{id:14,namespace:"Office.OneNote.Online.Health",ariaTenant:"c6393e4ed4b94e3baf9a46aa6585dce0-c1b3b0c6-b44c-4121-8eae-311d31e67bb6-7176"},{id:15,namespace:"Office.Visio.Online.Health",ariaTenant:"c4999163c49d49c99a1649b404873d24-a62a394b-ad47-45f0-92fa-fd4085dc8bb3-7324"},{id:16,namespace:"Office.Telemetry",ariaTenant:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405"},{id:17,namespace:"Office.System",ariaTenant:"cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521"},{id:18,namespace:"Office.TellMe",ariaTenant:"31d9dd3e4c7046a696537586281d7ed1-06d11dd6-a946-4281-8ac3-a7c2ab4776f5-7063"},{id:19,namespace:"Office.Voice",ariaTenant:"9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162"},{id:20,namespace:"Office.Insights",ariaTenant:"250a372c4a854d8fb120ef0366f9410c-dd39bcd8-3b38-4c6c-9f8d-3821e5c28b47-7487"},{id:21,namespace:"Office.Graphics",ariaTenant:"cfcfdb91c68c4329bb8b7cb7babb3cf7-e082c2f2-ef1d-427a-ac4d-b0b700afe7a7-7655"},{id:22,namespace:"Office.AugLoop",ariaTenant:"3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770"},{id:23,namespace:"Office.FileIO",ariaTenant:"d2b065c5ae634beb9cec4813140e22da-eda42ada-ffd9-4e26-92a1-e3b440eaf8bf-7717"},{id:24,namespace:"Office.Sandbox",ariaTenant:"1cd66059dc1d41f1887e3770ea8ba967-f1d0108c-8535-4cf9-bf23-ec8227f6afa7-6999"},{id:25,namespace:"Office.UX",ariaTenant:"c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879"}],ui={alwaysOnMetadata:void 0,useOneDsLogger:!0,logToUls:!1,logToExp:!1,ariaAndOneDsTransportSettings:{enabled:!0,collectorEndpointEnum:"PUBLIC",eventUploadFrequency:2e3,cacheMemorySizeLimitInNumberOfEvents:1e4},expLoggerTransportSettings:{enabled:!1,endpointUrl:"",numEventsToTriggerUpload:200,timeToWaitBeforeAutoUploadingEvents:1e4,maxEventsPerRequest:500},throttlingSettings:{enabled:!0,totalEventsThrottlePerSec:100,singleEventThrottlePerSec:20,eventNamesToBeSuppressedCommaSeparated:""},statsSettings:{taskDurationLogFrequency:20,durationThreshold:100,reportTaskDetails:!1,sessionDurationCutoff:1e4}};function ci(e,t){return null==e?t:e}function li(e,t){return null==e?t:e}function di(e,t){return null==e?t:e}!function(e){e[e.None=0]="None",e[e.Activity=2]="Activity",e[e.EssentialMetadata=4]="EssentialMetadata",e[e.CompleteEventNameAndTenantInfo=8]="CompleteEventNameAndTenantInfo",e[e.GDRPRelated=16]="GDRPRelated",e[e.ExpRelated=32]="ExpRelated"}(oi||(oi={})),function(e){e[e.TelemetryEvent=1]="TelemetryEvent",e[e.ULS=2]="ULS"}(si||(si={}));var fi={};function pi(e){return function(e){var t=(i=e.statsSettings,r={settings:i,tags:{sessionStats:593597393,taskStats:593597394,taskDetailsStats:593597395,taskDurationThresholdExceeded:593597396,sdkHealth:593597397},sdkInitializationTime:Date.now()},new Gn(r)),n=new hi(e,t);var i,r;return n.initialize(e.aom),n}({aom:e.alwaysOnMetadata||{},transportSettings:e.expLoggerTransportSettings,statsSettings:e.statsSettings})}var hi=function(){function e(e,t){this.protocolVersion="0.1",this.endpointUrl=e.transportSettings.endpointUrl+"?version="+this.protocolVersion,this.numEventsToTriggerUpload=e.transportSettings.numEventsToTriggerUpload,this.timeToWaitBeforeAutoUploadingEvents=e.transportSettings.timeToWaitBeforeAutoUploadingEvents,this.maxEventsPerRequest=e.transportSettings.maxEventsPerRequest,this.sendToCollector=e.sendToCollectorOverride||_i,this.alwaysOnMetadataSerializedPayload="",this.asyncFlushTimerId=0,this.periodicUploaderTimerId=0,this.events=[],this.reporter=t}return e.prototype.initialize=function(e){this.alwaysOnMetadataSerializedPayload=JSON.stringify(function(e){var t={},n={appLanguage:"a",applicationMode:"b",applicationModeExtended:"c",audienceGroup:"d",browserLanguage:"e",browserName:"f",browserVersion:"g",contentLanguage:"h",datacenter:"i",flightsImpressionId:"j",host:"k",isAnonymousUser:"l",isBusinessUser:"m",isEduUser:"n",isSynthetic:"o",loggableUserId:"p",loggableUserIdSpace:"q",name:"r",omsTenantId:"s",osBuild:"t",osVersion:"u",ring:"v",serverDocId:"w",sessionId:"x",uiHost:"y",version:"z"};for(var i in e){var r=n[i],o=e[i];r&&o&&(t[r]="boolean"==typeof o?1:o)}return t}(e)),this.schedulePeriodicUploadTimer()},e.prototype.sendOtelTelemetryEvent=function(e){var t=window.performance.now();try{var n=function(e){var t={},n=oi.None;if(t.t=Date.now(),e.dataFields&&e.dataFields.length>0){for(var i={},r=0;r<e.dataFields.length;r+=1)i[e.dataFields[r].name]=e.dataFields[r].value;t.d=i}if(e.telemetryProperties&&e.telemetryProperties.ariaTenantToken){var o=fi[e.telemetryProperties.ariaTenantToken];if(o)t.n=e.eventName.substring(o.namespace.length+1),t.a=o.id;else{t.n=e.eventName;var s=e.telemetryProperties.ariaTenantToken.indexOf("-");t.a=-1!==s?e.telemetryProperties.ariaTenantToken.substring(0,s):e.telemetryProperties.ariaTenantToken,n|=oi.CompleteEventNameAndTenantInfo}}else t.n=e.eventName;if(e.eventContract&&e.eventContract.dataFields){n|=oi.Activity;for(r=0;r<e.eventContract.dataFields.length;r+=1){var a=e.eventContract.dataFields[r].value;switch(e.eventContract.dataFields[r].name){case"Activity.Duration":a&&(t.q=a);break;case"Activity.Success":a&&(t.r=!0);break;case"Activity.CV":a&&(t.s=a);break;case"Activity.AggMode":a>0&&(t.x=a);break;case"Activity.Count":a>1&&(t.y=a)}}}n&&(t.m=n);return t}(e);this.addEventToQueue(n)}catch(e){u.sendTraceTag(593597398,r.msoulscat_Wac_Telemetry,i.Warning,e.message)}this.reporter.stats.eventsProcessingTime+=window.performance.now()-t},e.prototype.sendEvent=function(e,t,n){var i=window.performance.now();this.addEventToQueue({t:Date.now(),n:t,a:e,d:n}),this.reporter.stats.eventsProcessingTime+=window.performance.now()-i},e.prototype.sendActivityEvent=function(e,t,n,i,r,o){var s=window.performance.now();this.addEventToQueue({t:Date.now(),n:t,a:e,d:n,q:i,r:r||void 0,s:o,m:oi.Activity}),this.reporter.stats.eventsProcessingTime+=window.performance.now()-s},e.prototype.addEventToQueue=function(e){this.reporter.stats.processed+=1,this.events.push(e),this.events.length>=this.numEventsToTriggerUpload&&this.flush(!0)},e.prototype.flush=function(e){var t=this;if(!e)return this.cancelOutstandingFlushTimer(),void this.sendOutstandingTelemetryEvents();this.asyncFlushTimerId||(this.asyncFlushTimerId=window.setTimeout((function(){t.flushRoutine()}),0))},e.prototype.flushRoutine=function(){this.asyncFlushTimerId=0,this.sendOutstandingTelemetryEvents()},e.prototype.cancelOutstandingFlushTimer=function(){this.asyncFlushTimerId&&(window.clearTimeout(this.asyncFlushTimerId),this.asyncFlushTimerId=0)},e.prototype.shutdown=function(){this.sendOutstandingTelemetryEvents(!0),this.cancelOutstandingFlushTimer(),this.cancelPeriodicUploadTimer(),this.reporter.logSessionStats(),this.reporter.logAndClearTaskStats()},e.prototype.getStats=function(){return this.reporter},e.prototype.sendOutstandingTelemetryEvents=function(e){if(void 0===e&&(e=!1),this.schedulePeriodicUploadTimer(),!(this.events.length<=0)){try{for(var t=0;t<this.events.length;){var n=void 0,o=window.performance.now();n=this.events.length<this.maxEventsPerRequest?this.events:this.events.slice(t,t+this.maxEventsPerRequest),t+=this.maxEventsPerRequest;var s=JSON.stringify(n),a=this.alwaysOnMetadataSerializedPayload+"\n"+s,c=window.performance.now();this.sendToCollector(this.endpointUrl,a,e);var l=window.performance.now(),d=l-o,f=c-o,p=l-c;this.reporter.stats.sent+=n.length,this.reporter.recordUploadTaskDuration(d,n.length,f,p),this.reporter.stats.bytesOverWire+=a.length}}catch(e){u.sendTraceTag(593597399,r.msoulscat_Wac_Telemetry,i.Warning,e.message)}this.events=[]}},e.prototype.periodicUploaderRoutine=function(){this.periodicUploaderTimerId=0,this.sendOutstandingTelemetryEvents()},e.prototype.schedulePeriodicUploadTimer=function(){var e=this;this.cancelPeriodicUploadTimer(),this.periodicUploaderTimerId=window.setTimeout((function(){e.periodicUploaderRoutine()}),this.timeToWaitBeforeAutoUploadingEvents)},e.prototype.cancelPeriodicUploadTimer=function(){this.periodicUploaderTimerId&&(window.clearTimeout(this.periodicUploaderTimerId),this.periodicUploaderTimerId=0)},e}();function _i(e,t,n){if(n){if(void 0!==navigator.sendBeacon)try{navigator.sendBeacon(e,t)}catch(n){var i;(i=new XMLHttpRequest).open("POST",e),i.send(t)}}else(i=new XMLHttpRequest).open("POST",e),i.send(t)}var vi,gi,yi=!1,mi="",Ti="",Si="unknown";function Ei(e){if(yi)throw new Error("Telemetry is already initialized!");if(!e.ulsLogger)throw new Error("Must provide a ULS logger!");!function(e){if(!e)throw new Error("The 'logger' argument is missing");u.setLogger(e)}(e.ulsLogger),e.alwaysOnMetadata&&(Si=e.alwaysOnMetadata.name+", "+e.alwaysOnMetadata.applicationMode+", "+e.alwaysOnMetadata.applicationModeExtended),u.sendTraceTag(595947925,r.msoulscat_Wac_Telemetry,i.Info,"Initializing Otel library ["+Si+"] with settings "+function(e){return JSON.stringify(e,(function(e,t){if("alwaysOnMetadata"!==e)return t}))}(e)),function(e){e.alwaysOnMetadata&&(null==e.alwaysOnMetadata.name||""===e.alwaysOnMetadata.name?(mi="Office.Online.UserAction",Ti="Office.Online.Data.Activity",u.sendTraceTag(595900060,r.msoulscat_Wac_Telemetry,i.Info,"Cannot determine the App for UserActionEvent, using generic UserAction event name.")):(mi="Office."+e.alwaysOnMetadata.name+".Online.UserAction.",Ti="Office."+e.alwaysOnMetadata.name+".Online.Data.Activity."))}(e);var t=function(e){return{alwaysOnMetadata:e.alwaysOnMetadata||ui.alwaysOnMetadata,useOneDsLogger:ci(e.otelUseOneDsSink,ui.useOneDsLogger),logToUls:ci(e.sendToUls,ui.logToUls),logToExp:ci(e.sendToExpLogger,ui.logToExp),ariaAndOneDsTransportSettings:{enabled:ci(e.sendToAria,ui.ariaAndOneDsTransportSettings.enabled),collectorEndpointEnum:di(e.ariaEndpointTarget,ui.ariaAndOneDsTransportSettings.collectorEndpointEnum),eventUploadFrequency:li(e.eventUploadFrequency,ui.ariaAndOneDsTransportSettings.eventUploadFrequency),cacheMemorySizeLimitInNumberOfEvents:li(e.cacheMemorySizeLimitInNumberOfEvents,ui.ariaAndOneDsTransportSettings.cacheMemorySizeLimitInNumberOfEvents)},throttlingSettings:{enabled:ci(e.wacAriaThrottlingIsEnabled,ui.throttlingSettings.enabled),totalEventsThrottlePerSec:li(e.wacAriaTotalEventsThrottlePerSec,ui.throttlingSettings.totalEventsThrottlePerSec),singleEventThrottlePerSec:li(e.wacAriaSingleEventThrottlePerSec,ui.throttlingSettings.singleEventThrottlePerSec),eventNamesToBeSuppressedCommaSeparated:di(e.otelEventNamesToBeSuppressedCommaSeparated,ui.throttlingSettings.eventNamesToBeSuppressedCommaSeparated)},expLoggerTransportSettings:{enabled:ci(e.sendToExpLogger,ui.expLoggerTransportSettings.enabled),endpointUrl:di(e.expLoggerEndpointUrl,ui.expLoggerTransportSettings.endpointUrl),numEventsToTriggerUpload:li(e.expLoggerNumEventsToTriggerUpload,ui.expLoggerTransportSettings.numEventsToTriggerUpload),timeToWaitBeforeAutoUploadingEvents:li(e.expLoggerTimeToWaitBeforeAutoUploadingEvents,ui.expLoggerTransportSettings.timeToWaitBeforeAutoUploadingEvents),maxEventsPerRequest:li(e.expLoggerMaxEventsPerRequest,ui.expLoggerTransportSettings.maxEventsPerRequest)},statsSettings:{taskDurationLogFrequency:li(e.taskDurationLogFrequency,ui.statsSettings.taskDurationLogFrequency),durationThreshold:li(e.taskDurationLogThreshold,ui.statsSettings.durationThreshold),reportTaskDetails:ci(e.reportTaskDetails,ui.statsSettings.reportTaskDetails),sessionDurationCutoff:ui.statsSettings.sessionDurationCutoff}}}(e),n=ii(t);e.sendToUls&&(n.onProcessedEvent().addListener(Ii),n.onThrottledEvent().addListener(Ci)),e.sendToExpLogger&&(ai.forEach((function(e){fi[e.ariaTenant]=e})),gi=pi(t),n.onProcessedEvent().addListener((function(e){gi.sendOtelTelemetryEvent(e)}))),S.addListener((function(t){!function(e,t){if(e.category===h.Transport&&!t)return;u.sendTraceTag(595947933,r.msoulscat_Wac_Telemetry,function(e){switch(e){case p.Verbose:return i.Verbose;case p.Info:return i.Info;case p.Warning:return i.Warning;case p.Error:return i.Error;default:throw new Error(e)}}(e.level),e.message())}(t,e.enableAdditionalDiagnosticTracing||!1)})),ai.forEach((function(e){n.setTenantToken(e.namespace,e.ariaTenant)})),e.pingCollectorPingUrl&&n.pingCollectorPingUrl(),e.pingCollectorEndpoint&&n.pingCollectorEndpoint(),vi=n,yi=!0,u.sendTraceTag(595947926,r.msoulscat_Wac_Telemetry,i.Info,"Successfully initialized Otel library")}function bi(e,t){Pi();var n=function(e){if(!e.name)throw new Error("Event is missing a name");var t=Fn(e.dataFields,e.name);return{eventName:e.name,dataFields:t}}(e);vi.sendOtelTelemetryEvent(n,t)}function wi(e,t){Pi(),null!=e&&null!=e.name&&(e.name.indexOf("Office.")>=0||(e.name=Ti+e.name));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0),(null==e.count||isNaN(e.count))&&(e.count=1),null==e.aggMode&&(e.aggMode=0);var t=Math.floor(1e3*e.durationMs),n=Fn(e.dataFields,e.name),i=j.Office.System.Activity.getFields({cV:e.CV||void 0,duration:t,count:e.count,aggMode:e.aggMode,success:e.succeeded});return{eventName:e.name,eventContract:{name:j.Office.System.Activity.contractName,dataFields:i},dataFields:n}}(e);vi.sendOtelTelemetryEvent(n,t)}function Ai(e,t){Pi(),null==e.name&&(e.name=mi,null!=e.actionName&&(e.name+=e.actionName));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0);var t=Math.floor(1e3*e.durationMs);null==e.dataFields&&(e.dataFields=[]);var n=Fn(e.dataFields,e.name),i=j.Office.System.UserAction.getFields("UserAction",{id:null==e.actionId?void 0:e.actionId,name:null==e.actionName?void 0:e.actionName,commandSurface:null==e.commandSurface?void 0:e.commandSurface,parentName:null==e.parentName?void 0:e.parentName,triggerMethod:null==e.triggerMethod?void 0:e.triggerMethod,timeOffsetMs:null==e.timeOffsetMs?void 0:e.timeOffsetMs});n.push.apply(n,i);var r=j.Office.System.Activity.getFields({duration:t,count:1,aggMode:0,success:e.succeeded});return{eventName:e.name,eventContract:{name:j.Office.System.Activity.contractName,dataFields:r},dataFields:n}}(e);vi.sendOtelTelemetryEvent(n,t)}function Ii(e){u.sendTraceTag(595947932,r.msoulscat_Wac_Telemetry,i.Info,"Processed TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function Ci(e){u.sendTraceTag(593597440,r.msoulscat_Wac_Telemetry,i.Warning,"Throttled TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function Pi(){if(!yi)throw new Error("Telemetry is not initialized!")}function Oi(e){switch(e.kind){case"event":try{bi(e.event)}catch(t){u.sendTraceTag(595947920,r.msoulscat_Wac_Telemetry,i.Error,"Error while processing TelemetryEvent "+e.event.name+" : "+ki(t)+" \nEvent: "+JSON.stringify(e))}break;case"activity":try{wi(e.event)}catch(t){u.sendTraceTag(595947921,r.msoulscat_Wac_Telemetry,i.Error,"Error while processing ActivityEvent "+e.event.name+" : "+ki(t)+" \nEvent: "+JSON.stringify(e))}break;case"action":try{Ai(e.event)}catch(t){u.sendTraceTag(595928211,r.msoulscat_Wac_Telemetry,i.Error,"Error while processing UserActionEvent "+e.event.name+" : "+ki(t)+" \nEvent: "+JSON.stringify(e))}break;case"otel":try{!function(e){var t;Pi();var n=e.otelEvent;if(!n||!n.dataFields)throw new Error("Invalid Otel event");if(e.additionalDataFields){var i=Fn(e.additionalDataFields,n.eventName);(t=n.dataFields).push.apply(t,i)}vi.sendOtelTelemetryEvent(n)}(e.event)}catch(o){var t="",n=e.event;n&&(t=n.eventName),u.sendTraceTag(595947922,r.msoulscat_Wac_Telemetry,i.Error,"Error while processing OtelEvent "+t+" : "+ki(o)+" \nEvent: "+JSON.stringify(e))}break;case"addNamespaceMapping":try{o=e.namespace,s=e.ariaTenantToken,Pi(),vi.setTenantToken(o,s)}catch(t){u.sendTraceTag(595947923,r.msoulscat_Wac_Telemetry,i.Error,"Error while adding namespace mapping for "+e.namespace+" : "+ki(t))}break;case"shutdown":try{Pi(),u.sendTraceTag(595947931,r.msoulscat_Wac_Telemetry,i.Info,"Otel library shutdown triggered ["+Si+"]"),vi.shutdown(),gi&&gi.shutdown()}catch(e){u.sendTraceTag(595947924,r.msoulscat_Wac_Telemetry,i.Error,"Error while processing shutdown event")}break;default:throw new Error(e)}var o,s}function ki(e){return e instanceof Error?e.message?e.message:"":null!=e.message?e.message:JSON.stringify(e)}var Ni=new(function(){function e(){}return e.prototype.initialize=function(e){if(!e)throw new Error("Must supplied valid telemetry settings!");Ei(e)},e.prototype.processTelemetryEvent=function(e){Oi(e)},e}());n.d(t,"TelemetryFullGlobal",(function(){return Ni})),n.d(t,"initializeEventProcessor",(function(){return Ei})),n.d(t,"processEvent",(function(){return Oi}))}]);
//# sourceMappingURL=otelFull.min.js.map