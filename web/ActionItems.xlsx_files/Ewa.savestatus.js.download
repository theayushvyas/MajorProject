Type.registerNamespace("Common.App.SaveStatus");Common.App.SaveStatus.e=function(){this.h=Function.createDelegate(this,this.i)};Common.App.SaveStatus.e.prototype={d:null,g:null,e:null,f:null,a:function(){return"Common.App.SaveStatus"},c:function(n){var t,r,i;this.d=n;Common.a.a.a("PostMessageEmbedded")&&Common.a.E?(t=this,this.d.b(Common.App.SaveStatus.c).c(Common.App.SaveStatus.a).a().b(function(){return new Common.App.SaveStatus.c(t.d.c(Common.App.HostNotification.b),t.d.c(Common.S))})):Common.a.b().a().P()||(Common.a.b().a().d()?(r=this,this.d.b(Common.App.SaveStatus.b).c(Common.App.SaveStatus.a).a().b(function(){return new Common.App.SaveStatus.b(r.d.c(Common.App.HostNotification.b))})):(i=this,this.d.b(Common.App.SaveStatus.d).c(Common.App.SaveStatus.a).a().b(function(){return new Common.App.SaveStatus.d(Common.E.a(),i.d.c(Common.cP),i.d.c(Common.App.HostNotification.b),Common.a.i)})))},b:function(){Common.a.a.h(this.h)},i:function(){var n=Common.a.a,t=!!Common.a.b().a()&&Common.a.b().a().c()===4;(n.a("WordEditorAutoSaveImprovementIsEnabled")||n.a("PptEditorSaveStatusInHeaderEnabled")||t&&n.a("SimplifiedReactRibbonUxIsEnabled")||n.a("ExcelSaveStatusInHeaderEnabled")||n.a("VisioSaveStatusInHeaderEnabled"))&&(Common.a.a.a("PostMessageEmbedded")&&Common.a.E?(this.f=this.d.a(Common.App.SaveStatus.c),this.f&&this.f.o()):Common.a.b().a().P()||(Common.a.b().a().d()?(this.e=this.d.a(Common.App.SaveStatus.b),this.e&&this.e.u(n.a("IsSkyDrive"),n.i.HostNameToIncludeInSavedStatus)):(this.g=this.d.a(Common.App.SaveStatus.d),this.g&&this.g.A(n.a("IsSkyDrive"),n.i.HostNameToIncludeInSavedStatus))))}};Common.App.SaveStatus.f=function(){};Common.App.SaveStatus.f.a=function(){Common.App.a.a().a(new Common.App.SaveStatus.e,0,!1)};Common.App.SaveStatus.c=function(n,t){this.i=Function.createDelegate(this,this.p);this.l=$a.M;this.m=$a.N;this.j=$a.J;this.k=$a.L;this.g=t;this.e=n;this.f=3;this.c=!0};Common.App.SaveStatus.c.prototype={d:null,g:null,e:null,c:!1,f:0,o:function(){var n,t;this.e&&(n=this,this.e.a(function(t){t.b(n.i)}));t=this;this.g.a(function(n){t.d=n})},a:function(n,t){this.f=t;t===3?this.b(this.c):t===2?this.h(this.k):this.h(this.j)},p:function(){this.b(!1)},b:function(n){this.c=n;var t=this.c?this.l:this.m;this.h(t)},h:function(n){this.d&&this.d.a("UI_SaveStatus",this.n(n),"")},n:function(n){var t={};return t.StatusText=n,t}};Common.App.SaveStatus.d=function(n,t,i,r){this.w=Function.createDelegate(this,this.F);this.v=Function.createDelegate(this,this.C);this.u=Function.createDelegate(this,this.x);this.t=n;this.o=t;this.n=i;this.q=r;this.p=!0;this.e=!1;this.d=3;this.h=!0};Common.App.SaveStatus.d.prototype={t:null,o:null,n:null,k:null,l:null,i:null,j:null,p:!1,q:!1,e:!1,d:0,h:!1,g:0,s:null,m:null,f:null,r:null,c:null,A:function(n,t){return this.t?(this.k=this.z(n,t),this.l=$a.N,this.i=$a.J,this.j=$a.L,this.B(),!0):!1},z:function(n,t){return n?String.format($a.q,$a.G):t&&t.length?String.format($a.q,t):$a.M},B:function(){var n,t;this.o&&(n=this,this.o.a(function(t){t.d(n.u);t.f(n.v);t.b&&n.x(null,null)}));this.n&&(t=this,this.n.a(function(n){n.b(t.w)}))},C:function(n,t){this.a(t==="true",this.d)},a:function(n,t){this.e=n;this.d=t;this.m&&(this.m.style.display=this.e||this.d===3||!this.s?"none":"");this.f&&(this.f.style.display=this.e||this.d===3?"none":"",this.f.innerText=this.d===1?this.i:this.j,this.f.title=this.d===1?$a.gj:$a.gF);this.r&&(this.r.style.display=this.e||this.d===1||!this.s&&!this.f?"none":"");this.c&&(this.c.style.display=this.e||this.d===1?"none":"",this.b(this.h),this.c.title=$a.gL)},x:function(n,t){var i=document.getElementById(Common.o.m),r=t,u=t?r.a:!1;!u&&i&&this.k!==""&&this.l!==""&&this.i!==""&&this.j!==""&&(this.s=document.getElementById("BreadcrumbTitle"),this.m=Common.o.a(i,"BreadcrumbAppModeDash","-",null,!1),this.f=Common.o.a(i,"BreadcrumbAppModeStatus",this.d===1?this.i:this.j,null,!1),this.y(this.f),this.r=Common.o.a(i,"BreadcrumbSaveStatusDash","-",null,!1),this.c=Common.o.a(i,"BreadcrumbSaveStatus",this.k,null,!1),this.y(this.c),this.a(this.e,this.d))},F:function(){this.b(!1)},b:function(n){this.h=n;this.E(this.h?this.k:this.l)},E:function(n){this.c&&(this.d===3||this.d===2)&&(this.p&&!this.h?(this.g=this.c.offsetWidth<this.g?this.g:this.c.offsetWidth,this.D(this.l),this.p=!1):this.c.innerText=n)},y:function(n){n.style.direction=this.q?"rtl":"ltr";n.style.width="auto";n.style.textAlign=this.q?"right":"left";n.style.display=this.e?"none":"";n.setAttribute("Unselectable","on")},D:function(n){if(this.c){this.c.style.width="";this.c.innerText=n;this.g=this.c.offsetWidth<this.g?this.g:this.c.offsetWidth;var t=Common.A.a(this.c);this.c.style.width=this.g-Common.m.a(t.paddingLeft)-Common.m.a(t.paddingRight)+1+"px"}}};Common.App.SaveStatus.b=function(n){this.p=Function.createDelegate(this,this.w);this.f=n;this.c=3;this.e=!0};Common.App.SaveStatus.b.prototype={f:null,n:null,o:null,l:null,m:null,c:0,e:!1,d:!1,h:!1,i:!1,k:null,g:null,j:0,u:function(n,t){if(this.n=this.t(n,t),this.o=$a.N,this.l=$a.J,this.m=$a.L,this.f){var i=this;this.f.a(function(n){n.b(i.p)})}return this.h=!0,!0},a:function(n,t){this.d=n;this.c=t;this.b(this.e)},b:function(n){this.e=n;var t=null;this.c===3&&(t=this.e?this.n:this.o);this.s(t)},t:function(n,t){return n?String.format($a.q,$a.G):t&&t.length?String.format($a.q,t):$a.M},w:function(){this.b(!1)},r:function(){switch(this.c){case 1:return this.l;case 2:return this.m;default:return null}},v:function(n){return this.i===this.d&&this.j===this.c&&this.k===n},q:function(n){var i=window.performance.now(),t;Common.I.d("getHeaderApi")?(t=this,appChrome.getHeaderApi().then(function(r){return r.updateDocumentTitleStatus(t.d,n,t.r()),Diag.a.a(51709962,340,50,"Call UpdateDocumentTitleStatus time:"+(window.performance.now()-i).toString()+" ms"),null})):(appChrome.api.dispatch(appChrome.actions.updateDocumentTitleStatus(this.d,n,this.r())),Diag.a.a(51709962,340,50,"Dispatch  UpdateDocumentTitleStatus time:"+(window.performance.now()-i).toString()+" ms"));this.g=null},s:function(n){var t,i;this.h&&Common.I.a()&&!this.v(n)&&(Common.g.O()?(this.g&&Diag.a.a(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),t=this,this.g=window.requestIdleCallback(function(){t.q(n)})):(i=this,window.requestAnimationFrame(function(){i.q(n)})),this.i=this.d,this.k=n,this.j=this.c)}};Common.App.SaveStatus.c.registerClass("Common.App.SaveStatus.c",null,Common.App.SaveStatus.a);Common.App.SaveStatus.d.registerClass("Common.App.SaveStatus.d",null,Common.App.SaveStatus.a);Common.App.SaveStatus.b.registerClass("Common.App.SaveStatus.b",null,Common.App.SaveStatus.a);Common.App.SaveStatus.f.a();Type.registerNamespace("_Ewa");_Ewa.xn=function(n){_Ewa.xn.initializeBase(this);this.h=n;this.j()};_Ewa.xn.a=function(n){n.b().b(_Ewa.baR.$$(Sys.IDisposable),299,new _Ewa.xn(n))};_Ewa.xn.prototype={h:null,b:function(){var n=Common.Utils.a.a(),t,i;this.h.isChangeGateEnabled("OfficeVSO:3995153_ISaveStatusHandler_LoadWithFuture")?(t=this,n.c(Common.App.SaveStatus.a).a(function(i){var r=new _Ewa.jV(t.h,i);n.b(_Ewa.jV).a().b(function(){return r});t.i(n.a(_Ewa.jV))})):(i=this,n.b(_Ewa.jV).a().b(function(){return new _Ewa.jV(i.h,n.a(Common.App.SaveStatus.a))}),this.i(n.a(_Ewa.jV)))}};_Ewa.jV=function(n,t){this.b=Function.createDelegate(this,this.q);this.f=Function.createDelegate(this,this.r);this.j=Function.createDelegate(this,this.v);this.i=Function.createDelegate(this,this.u);this.h=Function.createDelegate(this,this.t);this.k=Function.createDelegate(this,this.w);this.g=Function.createDelegate(this,this.s);this.d=t;this.a=n;this.a.g().c(this.g);this.a.E(this.k);this.a.c().co(this.h);this.a.c().g(this.i);this.a.cR(this.j);this.a.c().F(this.f);this.o(!1)};_Ewa.jV.prototype={d:null,a:null,c:!1,l:!1,v:function(n,t){t&&t.a&&_Ewa.h.M([t.a])&&this.n(!0)},r:function(){this.n(!1)},u:function(n,t){t&&t.a||this.o(!0);this.n(!1)},p:function(){return this.a.c()?this.a.c().bK():!1},m:function(n){return n?this.c=!0:_Ewa.b.a(this.a)&&_Ewa.b.a(this.a).b()&&(_Ewa.b.a(this.a).b().k()?this.c=!1:_Ewa.b.a(this.a).b().e(this.b)),this.e(),n},n:function(n){return this.l=n,this.e(),n},dispose:function(){this.a&&(this.a.G(this.k),this.a.dl(this.j),this.a.g()&&this.a.g().e(this.g),this.a.c()&&(this.a.c().cD(this.h),this.a.c().h(this.i),this.a.c().G(this.f)),_Ewa.b.a(this.a)&&_Ewa.b.a(this.a).b()&&_Ewa.b.a(this.a).b().f(this.b))},o:function(n){var t=this.a.J()&&_Ewa.s.a();n=!!(n|(t&&!this.a.k()));this.d.a(n,this.a.k()?3:1);this.e()},e:function(){this.a.k()&&this.d.b(!this.c&&!this.p()&&!this.l)},w:function(){this.m(this.a.bl());this.o(!1)},t:function(){this.e()},s:function(){this.m(this.a.bl())},q:function(){_Ewa.b.a(this.a).b().f(this.b);this.m(this.a.bl())}};_Ewa.xn.registerClass("_Ewa.xn",_Ewa.pZ.$$(Sys.IDisposable));_Ewa.jV.registerClass("_Ewa.jV",null,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.bdw=function(){};_Ewa.bdw.a=function(){_Ewa.j.a(_Ewa.xn.a)};_Ewa.bdw.a();