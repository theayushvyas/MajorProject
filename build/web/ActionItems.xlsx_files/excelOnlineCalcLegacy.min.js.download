var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=11)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.utils=n;var i=r(2);t.ULS=i.ULS,t.TraceLevel=i.TraceLevel,t.LogCategory=i.LogCategory,t.NulLogger=i.NulLogger,t.ConsoleLogger=i.ConsoleLogger;var a=r(3);t.browserSupport=a;var o=r(4);t.perfWatch=o;var u=r(5);t.initEwaUtils=u.initEwaUtils,t.ewaUtils=u.ewaUtils;var s=r(6);t.initStopwatchFactory=s.initStopwatchFactory;var c=r(7);t.getNewGuid=c.getNewGuid},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i=Object.getPrototypeOf(t);i&&"object"==typeof i&&Object.keys(i).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a={};return Object.keys(n).forEach((function(t){a[t]=e(n[t],r+1)})),a}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(void 0),n=function(t){r=r.catch((function(r){return e(t,r)}))},i=1;i<=t;i+=1)n(i);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.resolve();for(var r=t(e[0]),n=function(n){var i=e[n];r=r.catch((function(){return t(i)}))},i=1;i<e.length;i+=1)n(i);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").body.innerHTML:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,i=0;i<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==n-1);i+=2)r=4294967295&((r<<5)+r^e.charCodeAt(i+1));var a=t+35685*r+(23896*r<<16)&4294967295;return a<0&&(a+=4294967296),a},t.getCharIndexInTextFromPoint=function(e,t){var r=-1,n=null;if(void 0!==document.caretPositionFromPoint)null!==(i=document.caretPositionFromPoint(e,t))&&(r=i.offset,n=null!=i.offsetNode&&null!=i.offsetNode.parentElement&&"SPAN"===i.offsetNode.parentElement.nodeName?i.offsetNode.parentElement:i.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(i=document.caretRangeFromPoint(e,t))&&(r=i.startOffset,n=null!=i.startContainer&&null!=i.startContainer.parentElement&&"SPAN"===i.startContainer.parentElement.nodeName?i.startContainer.parentElement:i.startContainer)}else try{var i;n=document.elementFromPoint(e,t),(i=document.body.createTextRange()).moveToPoint(e,t);var a=document.body.createTextRange();a.moveToElementText(n),a.setEndPoint("EndToStart",i),r=a.text.length}catch(e){return r}for(;null!=n;)null!=(n=n.previousSibling)&&null!=n.textContent&&(r+=n.textContent.length);return r},t.getBoundingRectForText=function(e,t,r){function n(e,t,r){if(!e||!e.textContent)return t;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var i=e.childNodes,a=0;a<i.length&&t>=0;a+=1)t=n(i[a],t,r);return t}var i=document.createRange();return n(e,t,(function(e,t){return i.setStart(e,t)})),n(e,r,(function(e,t){return i.setEnd(e,t)})),i.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,i){return t.traceTag(e,r,n,i)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,i){return t.debugTraceTag(e,r,n,i)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,i){return t.assertTag(e,r,n,i)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,i){return t.shipAssertTag(e,r,n,i)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var i=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function i(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=n(),r=e,a=t,o={},u=function(e,t,n){return function(e,t,r,n,a,o){i(e,"end",r);var u={sessionName:t,result:n?"success":"failure",message:o,marks:e},s=JSON.stringify(u);a(s)}(o,r,a,e,t,n)};return o.start=0,{mark:function(e){return function(e){return i(o,e,a)}(e)},end:function(e){return u(!0,e)},success:function(e,t){return u(!0,e,t)},failure:function(e,t){return u(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var i=n(),a=r;return{reset:function(e){null!=e&&(a=e),i=n()},stop:function(){var r=n()-i,o=JSON.stringify({Target:a,Duration:r.toFixed(t)});e(o)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r=window.crypto||window.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,i=window.performance;try{i&&i.now&&i.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var a=0;a<e.length;a+=1){try{if(n){t.perfNow=!0;var o=Math.floor(100*i.now())%10;(o<0||o>9)&&(o=0);for(var u=0;u<o;u+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[a]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";r.r(t),function(e,n){r.d(t,"testEmitter",(function(){return i})),r.d(t,"allWorkersDestroyed",(function(){return u}));var i=void 0,a=0,o=void 0;function u(){return 0===a?Promise.resolve():new Promise((function(e){return o.addListener("noworkers",e)}))}function s(e){return"undefined"!=typeof MessageEvent?new MessageEvent("message",{data:e}):{type:"message",data:e}}e:if("undefined"==typeof Worker){var c=void 0!==e&&null!=Object({NODE_ENV:"production"})&&null!=Object({NODE_ENV:"production"}).JEST_WORKER_ID,l=void 0!==n&&n.global===n;if(c||l){var f,d;try{f=require}catch(e){console.log("require is not defined (is this in a script executed by vm.runInThisContext?)");break e}try{d=f("worker_threads")}catch(e){console.log("error importing worker_threads (was node run without --experimental-worker?): "+e.stack);break e}var h=f("events");if(i=new h.EventEmitter,o=new h.EventEmitter,n.Worker=function(){function e(e){var t=this;this._onmessage=null,this._onerror=null,this.onmessageerror=null,this._messageHandler=function(e){null!=t._onmessage&&t._onmessage.call(t,s(e))},this._errorHandler=function(e){null!=t._onerror&&t._onerror.call(t,function(e,t){return"undefined"!=typeof ErrorEvent?new ErrorEvent("error",{message:e,error:t}):{type:"error",message:e,error:t,preventDefault:function(){}}}(e.message,e))},this._worker=new d.Worker(e),this._worker.on("exit",(function(e){i.emit("workerdestroyed",t),0==(a-=1)&&o.emit("noworkers")})),a+=1,i.emit("workercreated",this)}return Object.defineProperty(e.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?this._worker.removeListener("message",this._messageHandler):null==this._onmessage&&this._worker.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onerror",{get:function(){return this._onerror},set:function(e){null==e?this._worker.removeListener("error",this._errorHandler):null==this._onerror&&this._worker.on("error",this._errorHandler),this._onerror=e},enumerable:!0,configurable:!0}),e.prototype.postMessage=function(e){this._worker.postMessage(e)},e.prototype.terminate=function(){this._worker.terminate()},e.prototype.addEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.addEventListener")},e.prototype.removeEventListener=function(){throw new Error("unimplemented: WorkerPolyfill.removeEventListener")},e.prototype.dispatchEvent=function(e){throw new Error("unimplemented: WorkerPolyfill.dispatchEvent")},e}(),!d.isMainThread&&"undefined"==typeof DedicatedWorkerGlobalScope){var p=function(){function t(){var e=this;this._onmessage=null,this.onmessageerror=null,this.onunhandledrejection=null,this._messageHandler=function(t){null!=e._onmessage&&e._onmessage.call(e,s(t))}}return Object.defineProperty(t.prototype,"onmessage",{get:function(){return this._onmessage},set:function(e){null==e?d.parentPort.removeListener("message",this._messageHandler):null==this._onmessage&&d.parentPort.on("message",this._messageHandler),this._onmessage=e},enumerable:!0,configurable:!0}),t.prototype.postMessage=function(e,t){d.parentPort.postMessage(e)},t.prototype.close=function(){e.exit()},t}();n.DedicatedWorkerGlobalScope=p,n.self=new p,n.importScripts=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=f("vm"),n=f("fs");e.forEach((function(e){var t=n.readFileSync(e,"utf-8");r.runInThisContext(t)}))}}}}}.call(this,r(9),r(10))},function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var s,c=[],l=!1,f=-1;function d(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&h())}function h(){if(!l){var e=u(d);l=!0;for(var t=c.length;t;){for(s=c,c=[];++f<t;)s&&s[f].run();f=-1,t=c.length}s=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new p(e,t)),1!==c.length||l||u(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"createParseGlobals",(function(){return ti})),r.d(n,"ReasonKind",(function(){return ri})),r.d(n,"notImplemented",(function(){return ei})),r.d(n,"notFormulaString",(function(){return ni})),r.d(n,"createParser",(function(){return cs})),r.d(n,"parseResultHelper",(function(){return gs}));var i={};r.r(i),r.d(i,"createAnalyzeGlobals",(function(){return Os})),r.d(i,"createAnalyzer",(function(){return hl}));var a={};r.r(a),r.d(a,"fastMathpack",(function(){return Al})),r.d(a,"createCompiler",(function(){return id})),r.d(a,"createEvaluator",(function(){return Bp})),r.d(a,"createFormulaInspector",(function(){return Zp})),r.d(a,"ReasonKind",(function(){return af})),r.d(a,"interval",(function(){return cf})),r.d(a,"CellKind",(function(){return uf})),r.d(a,"Interrupt",(function(){return sf})),r.d(a,"notImplemented",(function(){return rf})),r.d(a,"finalValue",(function(){return ff})),r.d(a,"pendingValue",(function(){return df})),r.d(a,"cellFormula",(function(){return hf})),r.d(a,"unavailable",(function(){return nf})),r.d(a,"unevaluated",(function(){return vf})),r.d(a,"stopped",(function(){return pf})),r.d(a,"nameCycle",(function(){return gf})),r.d(a,"cellCycle",(function(){return Ef})),r.d(a,"paused",(function(){return Tf})),r.d(a,"previousFailure",(function(){return Sf})),r.d(a,"javaScriptError",(function(){return Cf})),r.d(a,"evalGlobals",(function(){return mf})),r.d(a,"getEvalFailureReason",(function(){return Rf})),r.d(a,"illFormedFormula",(function(){return lf})),r.d(a,"createCompileGlobals",(function(){return of})),r.d(a,"extractResultValue",(function(){return Uf})),r.d(a,"evalToCellValue",(function(){return Pf})),r.d(a,"getBasicFirstOrderFunc",(function(){return sE})),r.d(a,"extension",(function(){return aE}));var o={};r.r(o),r.d(o,"WorkerKind",(function(){return bS})),r.d(o,"ErrorKind",(function(){return DS})),r.d(o,"isWorkerSupported",(function(){return dC})),r.d(o,"createWorker",(function(){return pC})),r.d(o,"tryCreateWorker",(function(){return vC})),r.d(o,"dedicatedWorkerInsideInit",(function(){return gC})),r.d(o,"runSmokeTest",(function(){return IC})),r.d(o,"cancelSmokeTest",(function(){return RC})),r.d(o,"smokeTestInsideDef",(function(){return EC}));var u={};r.r(u),r.d(u,"getBasicFirstOrderFunc",(function(){return sE})),r.d(u,"makeGetFirstOrderFunc",(function(){return cE}));var s={};r.r(s),r.d(s,"recalcMapper",(function(){return LE})),r.d(s,"mapperContext",(function(){return ME})),r.d(s,"formulaCacheGlobals",(function(){return HE})),r.d(s,"formulaCache",(function(){return KE})),r.d(s,"createFormatInfo",(function(){return WE})),r.d(s,"worksheetFunctionName",(function(){return JE})),r.d(s,"errorTypeName",(function(){return XE})),r.d(s,"localeData",(function(){return YE})),r.d(s,"numberFormat",(function(){return QE})),r.d(s,"sheetName",(function(){return zE})),r.d(s,"blankValue",(function(){return ZE})),r.d(s,"errorValue",(function(){return $E})),r.d(s,"richValue",(function(){return eS})),r.d(s,"getCellValueKind",(function(){return tS})),r.d(s,"cellLocation",(function(){return rS})),r.d(s,"rangeLocation",(function(){return nS})),r.d(s,"sheetRangeLocation",(function(){return iS})),r.d(s,"cellData",(function(){return aS})),r.d(s,"cellFormulaCellData",(function(){return oS})),r.d(s,"arrayFormulaCellData",(function(){return uS})),r.d(s,"valueCellData",(function(){return sS})),r.d(s,"rangeUpdate",(function(){return cS})),r.d(s,"rangeWrite",(function(){return lS})),r.d(s,"rangePromote",(function(){return fS})),r.d(s,"arrayData",(function(){return dS})),r.d(s,"arrayUpdate",(function(){return hS})),r.d(s,"arrayWrite",(function(){return pS})),r.d(s,"arrayPromote",(function(){return vS})),r.d(s,"unusedCellsUpdate",(function(){return mS})),r.d(s,"namedValueData",(function(){return gS})),r.d(s,"namedFormulaData",(function(){return ES})),r.d(s,"namedRangeData",(function(){return SS})),r.d(s,"namedFailureData",(function(){return CS})),r.d(s,"namedObject",(function(){return TS})),r.d(s,"namedObjectsUpdate",(function(){return RS})),r.d(s,"namedObjectsWrite",(function(){return yS})),r.d(s,"undefinedNamesWrite",(function(){return IS})),r.d(s,"namedObjectsPromote",(function(){return OS})),r.d(s,"rangeFormulaEdit",(function(){return AS})),r.d(s,"cellFormulaRangeFormulaEdit",(function(){return NS})),r.d(s,"valueRangeFormulaEdit",(function(){return kS})),r.d(s,"inferredRangeFormulaEdit",(function(){return FS})),r.d(s,"arrayFormulaEdit",(function(){return _S})),r.d(s,"inferredFormat",(function(){return wS})),r.d(s,"cellDataDelta",(function(){return US})),r.d(s,"rangeDelta",(function(){return PS})),r.d(s,"arrayDelta",(function(){return GS})),r.d(s,"rangeFailure",(function(){return VS})),r.d(s,"recalcResults",(function(){return xS})),r.d(s,"updateRequest",(function(){return BS})),r.d(s,"recalcServiceConfig",(function(){return WS})),r.d(s,"createRecalcService",(function(){return vI})),r.d(s,"RecalcServiceCreateMode",(function(){return fI})),r.d(s,"recalcServiceInsideDef",(function(){return pI}));var c=r(0),l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function f(e,t){function r(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function h(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function p(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{s(n.next(e))}catch(e){a(e)}}function u(e){try{s(n.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,u)}s((n=n.apply(e,t||[])).next())}))}function v(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function m(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,u=a.length;o<u;o++,i++)n[i]=a[o];return n}function g(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function E(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.apply(void 0,m([e],r))}}function S(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t}function C(e){return e}function T(e,t){if("string"==typeof t&&null!=I[t])return e;var r=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),n=void 0!==r?A[r]:void 0;return void 0===n&&(n=O[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(e instanceof Array)return"Array"}return t}(e)]),void 0!==n?n(e,t):"<unexpected>"}function R(e){try{var t=function(e){if("object"==typeof e&&null!=e){if(e.hasOwnProperty("node")&&e.hasOwnProperty("spans"))return"Formula";if(e.hasOwnProperty("kind")&&("Literal"===(t=e.kind)||"Array"===t||"App"===t||"Paren"===t||"Name"===t||"CellRef"===t||"Bad"===t||"Operator"===t))return"FormulaNode"}var t}(e);if(void 0!==t){var r=N[t](e);return void 0!==r?r:JSON.stringify(T(e,void 0))}return JSON.stringify(T(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var y,I={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},O={boolean:C,symbol:C,undefined:C,null:C,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function "+t+">":"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=T(e[r],r));return t},Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(T):"<unexpected>"}},A=Object.create(null),N={},k={ULS:new c.NulLogger};function F(e){k.ULS=e}function b(e,t){var r=e+": code should be unreachable because a value has type 'never'; given "+R(t);return k.ULS.assertTag(595980872,c.LogCategory.msoulscat_ES_EWAJS,!1,r)}function D(e){return k.ULS.assertTag(595980873,c.LogCategory.msoulscat_ES_EWAJS,!1,e)}function L(e,t){t||D(e+": expected condition to be true")}function M(e,t){(!g(t)||t<0)&&D(e+": expected natural number; given "+R(t))}function _(e,t){(!g(t)||t<=0)&&D(e+": expected positive integer; given "+R(t))}function w(e,t,r){(!g(t)||t<0||t>=r)&&D(e+": expected natural number less than "+R(r)+"; given "+R(t))}function U(e,t,r){(!g(t)||t<=0||t>r)&&D(e+": expected positive integer at most "+R(r)+"; given "+R(t))}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation"}(y||(y={}));var P=G(void 0,"");function G(e,t){return{path:e,name:t}}function V(e,t,r){return{document:e,index:t,index2:r,length:1}}function x(e,t){return V(e,t,t)}function B(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function W(e,t,r,n){return w("calc.lang.gridRange",e,1<<20),w("calc.lang.gridRange",t,16384),U("calc.lang.gridRange",r,(1<<20)-e),U("calc.lang.gridRange",n,16384-t),B(e,t,r,n)}function H(e,t){return w("calc.lang.gridCell",e,1<<20),w("calc.lang.gridCell",t,16384),B(e,t,1,1)}function K(e,t){return{sheet:e,range:t}}var j,q,J,X,Y,Q,z,Z,$=K,ee=K,te=K;function re(e){return{document:e,index:void 0}}function ne(e,t){return void 0===t?re(e):x(e,t)}function ie(e,t){return{scope:e,name:t}}function ae(e,t,r,n,i,a){(M("calc.lang.functionType",e),0===r.length&&t.length<e)&&D("calc.lang.functionType: expected headTypes.length >= "+e+"; given "+JSON.stringify(t));return{minArgs:e,headTypes:t,restTypes:r,returnType:n,staticPrecs:i,flags:a}}function oe(e,t,r,n){return{cells:e,names:t,special:r,bound:n}}function ue(e){var t=Ee[e];return void 0!==t?t:ge(e)}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(j||(j={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(q||(q={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.All=8191]="All"}(J||(J={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro"}(X||(X={})),function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(Q||(Q={})),function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=13]="FIELD"}(z||(z={})),function(e){e[e.First=1]="First",e[e.Last=13]="Last"}(Z||(Z={}));var se=ge(z.NULL),ce=ge(z.DIV0),le=ge(z.VALUE),fe=ge(z.REF),de=ge(z.NAME),he=ge(z.NUM),pe=ge(z.NA),ve=ge(z.GETTING_DATA),me=ge(z.FIELD);function ge(e){return{kind:j.Error,type:e}}var Ee=S(((Y={})[z.NULL]=se,Y[z.DIV0]=ce,Y[z.VALUE]=le,Y[z.REF]=fe,Y[z.NAME]=de,Y[z.NUM]=he,Y[z.NA]=pe,Y[z.GETTING_DATA]=ve,Y[z.FIELD]=me,Y));function Se(e,t,r){return M("calc.lang.arrayOper",e),M("calc.lang.arrayOper",t),r.length!==e?D("calc.lang.arrayOper: Inconsistent row number"):{kind:j.Array,rows:e,cols:t,opers:r}}function Ce(e,t){return _("calc.lang.rangeSeqOper",t.length),{kind:j.Range,sheets:e,ranges:t}}function Te(e,t){return{kind:j.Range,sheets:e,ranges:[t]}}var Re,ye,Ie,Oe,Ae,Ne,ke,Fe={kind:j.Missing},be={kind:j.Blank};function De(e){return void 0===e&&(e=0),{kind:ye.Error,isQuoted:!1,label:e}}function Le(e){return void 0===e&&(e=0),{kind:ye.Relative,isQuoted:!1,label:e}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(Re||(Re={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(ye||(ye={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(Ie||(Ie={})),function(e){e.Abs="Abs",e.Rel="Rel"}(Oe||(Oe={})),function(e){e.WorksheetFuncName="WorksheetFuncName",e.LocalName="LocalName"}(Ae||(Ae={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(Ne||(Ne={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(ke||(ke={}));var Me=De(),_e=Le();function we(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ye.Document,isQuoted:r,label:n,document:e,path:t}}function Ue(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ye.Sheet,isQuoted:r,label:n,sheet:e,document:t}}function Pe(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:ye.Ident,isQuoted:t,label:r,name:e}}function Ge(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:ye.SheetRange,isQuoted:r,label:n,sheet1:e,sheet2:t}}function Ve(e,t){return{kind:e,index:t}}function xe(e){return void 0===e&&(e=0),{kind:Ie.Error,label:e}}var Be,We=xe();function He(e,t,r){return void 0===r&&(r=0),{kind:Ie.Single,label:r,row:e,col:t}}function Ke(e,t,r){return void 0===r&&(r=0),{kind:Ie.Range,label:r,ref1:e,ref2:t}}function je(e,t,r){return void 0===r&&(r=0),{kind:Ie.Row,label:r,row1:e,row2:t}}function qe(e,t,r){return void 0===r&&(r=0),{kind:Ie.Col,label:r,col1:e,col2:t}}function Je(e,t){return{node:e,spans:t}}function Xe(e,t,r,n){var i,a;return M("calc.lang.formulaSpan",e),i="calc.lang.formulaSpan",g(a=t)||D(i+": expected integer; given "+R(a)),t<e&&D("calc.lang.formulaSpan: expected end >= "+e+"; given "+t),{start:e,end:t,pre:r,post:n}}function Ye(e){return{kind:Ae.WorksheetFuncName,id:e}}function Qe(e){return{kind:Ae.LocalName,name:e}}function ze(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:Ne.Literal,label:r,oper:e,isClosed:t}}function Ze(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:Ne.Array,label:r,nodes:e,isClosed:t}}function $e(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:Ne.App,label:n,head:e,args:t,isClosed:r}}function et(e,t){return void 0===t&&(t=0),{kind:Ne.Operator,label:t,id:e}}function tt(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:Ne.Paren,label:r,node:e,isClosed:t}}function rt(e,t,r){return void 0===r&&(r=0),{kind:Ne.Name,label:r,whole:e,qualifier:t}}function nt(e,t,r){return void 0===r&&(r=0),{kind:Ne.CellRef,label:r,ref:e,qualifier:t}}function it(e,t,r){return void 0===r&&(r=0),{kind:Ne.Bad,label:r,type:e,contents:t}}!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.ERROR_CODE=249]="ERROR_CODE",e[e.ALLOC_COUNT=250]="ALLOC_COUNT",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.DEBUG=524]="DEBUG",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e.IMAGE=612]="IMAGE",e[e.RECORD=613]="RECORD",e[e.RECORDTEST=614]="RECORDTEST",e[e.GRF=615]="GRF",e[e.UNIT=616]="UNIT",e[e.RICHERROR=617]="RICHERROR",e[e.FILTER=618]="FILTER",e[e.FUN=619]="FUN",e[e.LET=620]="LET",e[e.ARRAYMAKE=621]="ARRAYMAKE",e[e.APPLY=622]="APPLY",e[e.ISFUN=623]="ISFUN",e[e.ARITY=624]="ARITY",e[e.RECURSE=625]="RECURSE",e[e.FIELDVALUE=626]="FIELDVALUE"}(Be||(Be={}));var at=[];at[Be.COUNT]=ae(1,[],[57],1,0,0),at[Be.IF]=ae(1,[36,575,575],[],567,0,0),at[Be.ISNA]=ae(1,[15],[],4,0,0),at[Be.ISERROR]=ae(1,[15],[],4,0,0),at[Be.SUM]=ae(1,[],[49],1,0,0),at[Be.AVERAGE]=ae(1,[],[49],1,0,0),at[Be.MIN]=ae(1,[],[49],1,0,0),at[Be.MAX]=ae(1,[],[49],1,0,0),at[Be.ROW]=ae(0,[16],[],33,0,0),at[Be.COLUMN]=ae(0,[16],[],33,0,0),at[Be.NA]=ae(0,[],[],3,0,0),at[Be.NPV]=ae(2,[1],[49],1,0,0),at[Be.STDEV]=ae(1,[],[49],1,0,0),at[Be.DOLLAR]=ae(1,[1,1],[],2,0,0),at[Be.FIXED]=ae(1,[1,65,4],[],2,0,0),at[Be.SIN]=ae(1,[1],[],1,0,0),at[Be.COS]=ae(1,[1],[],1,0,0),at[Be.TAN]=ae(1,[1],[],1,0,0),at[Be.ATAN]=ae(1,[1],[],1,0,0),at[Be.PI]=ae(0,[],[],1,0,0),at[Be.SQRT]=ae(1,[1],[],1,0,0),at[Be.EXP]=ae(1,[1],[],1,0,0),at[Be.LN]=ae(1,[1],[],1,0,0),at[Be.LOG10]=ae(1,[1],[],1,0,0),at[Be.ABS]=ae(1,[1],[],1,0,0),at[Be.INT]=ae(1,[1],[],1,0,0),at[Be.SIGN]=ae(1,[1],[],1,0,0),at[Be.ROUND]=ae(2,[1,1],[],1,0,0),at[Be.LOOKUP]=ae(2,[7,48,48],[],7,0,0),at[Be.INDEX]=ae(2,[48,1,1,1],[],55,0,0),at[Be.REPT]=ae(2,[2,1],[],2,0,0),at[Be.MID]=ae(3,[2,1,1],[],2,0,0),at[Be.LEN]=ae(1,[2],[],1,0,0),at[Be.VALUE]=ae(1,[7],[],1,0,0),at[Be.TRUE]=ae(0,[],[],4,0,0),at[Be.FALSE]=ae(0,[],[],4,0,0),at[Be.AND]=ae(1,[],[52],4,0,0),at[Be.OR]=ae(1,[],[52],4,0,0),at[Be.NOT]=ae(1,[4],[],4,0,0),at[Be.MOD]=ae(2,[1,1],[],1,0,0),at[Be.DCOUNT]=ae(3,[16,83,18],[],1,0,0),at[Be.DSUM]=ae(3,[16,19,18],[],1,0,0),at[Be.DAVERAGE]=ae(3,[16,19,18],[],1,0,0),at[Be.DMIN]=ae(3,[16,19,18],[],1,0,0),at[Be.DMAX]=ae(3,[16,19,18],[],1,0,0),at[Be.DSTDEV]=ae(3,[16,19,18],[],1,0,0),at[Be.VAR]=ae(1,[],[49],1,0,0),at[Be.DVAR]=ae(3,[16,19,18],[],1,0,0),at[Be.TEXT]=ae(2,[7,2],[],2,0,0),at[Be.LINEST]=ae(1,[48,112,84,84],[],32,0,0),at[Be.TREND]=ae(1,[48,112,112,84],[],32,0,0),at[Be.LOGEST]=ae(1,[48,112,84,84],[],32,0,0),at[Be.GROWTH]=ae(1,[48,112,112,84],[],32,0,0),at[Be.GOTO]=ae(1,[16],[],512,0,2),at[Be.HALT]=ae(0,[4],[],512,0,2),at[Be.RETURN]=ae(0,[575],[],512,0,2),at[Be.PV]=ae(3,[1,1,1,1,1],[],1,0,0),at[Be.FV]=ae(3,[1,1,1,1,1],[],1,0,0),at[Be.NPER]=ae(3,[1,1,1,1,1],[],1,0,0),at[Be.PMT]=ae(3,[1,1,1,1,1],[],1,0,0),at[Be.RATE]=ae(3,[1,1,1,1,1,1],[],1,0,0),at[Be.MIRR]=ae(3,[48,1,1],[],1,0,0),at[Be.IRR]=ae(1,[48,1],[],1,0,0),at[Be.RAND]=ae(0,[],[],1,8191,0),at[Be.MATCH]=ae(2,[7,49,17],[],1,0,0),at[Be.DATE]=ae(3,[1,1,1],[],1,0,0),at[Be.TIME]=ae(3,[1,1,1],[],1,0,0),at[Be.DAY]=ae(1,[1],[],1,0,0),at[Be.MONTH]=ae(1,[1],[],1,0,0),at[Be.YEAR]=ae(1,[1],[],1,0,0),at[Be.WEEKDAY]=ae(1,[1,1],[],1,0,0),at[Be.HOUR]=ae(1,[1],[],1,0,0),at[Be.MINUTE]=ae(1,[1],[],1,0,0),at[Be.SECOND]=ae(1,[1],[],1,0,0),at[Be.NOW]=ae(0,[],[],1,8191,0),at[Be.AREAS]=ae(1,[16],[],1,0,0),at[Be.ROWS]=ae(1,[48],[],1,0,0),at[Be.COLUMNS]=ae(1,[48],[],1,0,0),at[Be.OFFSET]=ae(3,[16,65,65,65,65],[],16,8191,0),at[Be.ABSREF]=ae(2,[2,16],[],16,0,2),at[Be.RELREF]=ae(2,[16,16],[],2,0,2),at[Be.ARGUMENT]=ae(0,[66,81,16],[],4,0,2),at[Be.SEARCH]=ae(2,[2,2,1],[],1,0,0),at[Be.TRANSPOSE]=ae(1,[39],[],32,0,0),at[Be.ERROR]=ae(0,[1,24],[],4,0,2),at[Be.STEP]=ae(0,[],[],4,0,2),at[Be.TYPE]=ae(1,[47],[],1,0,0),at[Be.ECHO]=ae(0,[4],[],4,0,2),at[Be.SET_NAME]=ae(1,[2,63],[],4,0,2),at[Be.CALLER]=ae(0,[],[],50,0,2),at[Be.DEREF]=ae(1,[16],[],47,0,2),at[Be.WINDOWS]=ae(0,[65,66],[],32,0,2),at[Be.SERIES]=ae(4,[87,117,117,1,117],[],4,0,0),at[Be.DOCUMENTS]=ae(0,[1,66],[],32,0,2),at[Be.ACTIVE_CELL]=ae(0,[],[],16,0,2),at[Be.SELECTION]=ae(0,[],[],16,0,2),at[Be.RESULT]=ae(0,[1],[],4,0,2),at[Be.ATAN2]=ae(2,[1,1],[],1,0,0),at[Be.ASIN]=ae(1,[1],[],1,0,0),at[Be.ACOS]=ae(1,[1],[],1,0,0),at[Be.CHOOSE]=ae(2,[33],[575],567,0,0),at[Be.HLOOKUP]=ae(3,[7,49,49,4],[],39,0,0),at[Be.VLOOKUP]=ae(3,[7,49,49,4],[],39,0,0),at[Be.LINKS]=ae(0,[66,65],[],32,0,2),at[Be.INPUT]=ae(1,[2,65,66,67,65,65,2],[],575,0,2),at[Be.ISREF]=ae(1,[63],[],4,0,0),at[Be.GET_FORMULA]=ae(1,[18],[],2,0,2),at[Be.GET_NAME]=ae(1,[2,4],[],6,0,2),at[Be.SET_VALUE]=ae(2,[16,47],[],4,0,2),at[Be.LOG]=ae(1,[1,1],[],1,0,0),at[Be.EXEC]=ae(1,[2,1,4,4],[],7,0,2),at[Be.CHAR]=ae(1,[1],[],2,0,0),at[Be.LOWER]=ae(1,[2],[],2,0,0),at[Be.UPPER]=ae(1,[2],[],2,0,0),at[Be.PROPER]=ae(1,[2],[],2,0,0),at[Be.LEFT]=ae(1,[2,9],[],2,0,0),at[Be.RIGHT]=ae(1,[2,9],[],2,0,0),at[Be.EXACT]=ae(2,[2,2],[],4,0,0),at[Be.TRIM]=ae(1,[2],[],2,0,0),at[Be.REPLACE]=ae(4,[2,1,1,2],[],2,0,0),at[Be.SUBSTITUTE]=ae(3,[2,2,2,2],[],2,0,0),at[Be.CODE]=ae(1,[2],[],1,0,0),at[Be.NAMES]=ae(0,[66,65,66],[],32,0,2),at[Be.DIRECTORY]=ae(0,[2],[],2,0,2),at[Be.FIND]=ae(2,[2,2,1],[],1,0,0),at[Be.CELL]=ae(1,[2,16],[],47,8191,0),at[Be.ISERR]=ae(1,[15],[],4,0,0),at[Be.ISTEXT]=ae(1,[143],[],4,0,0),at[Be.ISNUMBER]=ae(1,[143],[],4,0,0),at[Be.ISBLANK]=ae(1,[143],[],4,0,0),at[Be.T]=ae(1,[23],[],2,0,0),at[Be.N]=ae(1,[23],[],1,0,0),at[Be.FOPEN]=ae(1,[2,1],[],1,0,2),at[Be.FCLOSE]=ae(1,[1],[],1,0,2),at[Be.FSIZE]=ae(1,[1],[],1,0,2),at[Be.FREADLN]=ae(1,[1],[],2,0,2),at[Be.FREAD]=ae(2,[1,1],[],2,0,2),at[Be.FWRITELN]=ae(2,[1,2],[],1,0,2),at[Be.FWRITE]=ae(2,[1,2],[],1,0,2),at[Be.FPOS]=ae(1,[1,1],[],1,0,2),at[Be.DATEVALUE]=ae(1,[3],[],1,0,0),at[Be.TIMEVALUE]=ae(1,[3],[],1,0,0),at[Be.SLN]=ae(3,[1,1,1],[],1,0,0),at[Be.SYD]=ae(4,[1,1,1,1],[],1,0,0),at[Be.DDB]=ae(4,[1,1,1,1,1],[],1,0,0),at[Be.GET_DEF]=ae(1,[2,66,65],[],2,0,2),at[Be.REFTEXT]=ae(1,[16,4],[],2,0,2),at[Be.TEXTREF]=ae(1,[2,4],[],16,0,2),at[Be.INDIRECT]=ae(1,[2,4],[],16,8191,0),at[Be.REGISTER]=ae(1,[2,3,66,66,66,65,67,66,67],[66],3,0,2),at[Be.CALL]=ae(1,[3],[127],575,0,2),at[Be.ADD_BAR]=ae(0,[3],[],1,0,2),at[Be.ADD_MENU]=ae(2,[3,115,83,3],[],1,0,2),at[Be.ADD_COMMAND]=ae(3,[3,83,115,83,3],[],1,0,2),at[Be.ENABLE_COMMAND]=ae(4,[3,3,3,4,3],[],4,0,2),at[Be.CHECK_COMMAND]=ae(4,[3,3,3,4,3],[],4,0,2),at[Be.RENAME_COMMAND]=ae(4,[3,3,3,3,3],[],4,0,2),at[Be.SHOW_BAR]=ae(0,[3],[],4,0,2),at[Be.DELETE_MENU]=ae(2,[3,3,3],[],4,0,2),at[Be.DELETE_COMMAND]=ae(3,[3,3,3,3],[],4,0,2),at[Be.GET_CHART_ITEM]=ae(1,[1,67,66],[],1,0,2),at[Be.DIALOG_BOX]=ae(1,[52],[],36,0,2),at[Be.CLEAN]=ae(1,[2],[],2,0,0),at[Be.MDETERM]=ae(1,[32],[],1,0,0),at[Be.MINVERSE]=ae(1,[32],[],32,0,0),at[Be.MMULT]=ae(2,[32,32],[],32,0,0),at[Be.FILES]=ae(0,[2,2],[],32,0,2),at[Be.IPMT]=ae(4,[1,1,1,1,1,1],[],1,0,0),at[Be.PPMT]=ae(4,[1,1,1,1,1,1],[],1,0,0),at[Be.COUNTA]=ae(1,[],[121],1,0,0),at[Be.CANCEL_KEY]=ae(0,[1,16],[],4,0,2),at[Be.FOR]=ae(3,[2,1,1,1],[],512,0,2),at[Be.WHILE]=ae(1,[4],[],512,0,2),at[Be.BREAK]=ae(0,[],[],512,0,2),at[Be.NEXT]=ae(0,[],[],512,0,2),at[Be.INITIATE]=ae(2,[2,2],[],1,0,2),at[Be.REQUEST]=ae(2,[1,2],[],32,0,2),at[Be.POKE]=ae(3,[1,18,18],[],4,0,2),at[Be.EXECUTE]=ae(2,[1,2],[],4,0,2),at[Be.TERMINATE]=ae(1,[1],[],4,0,2),at[Be.RESTART]=ae(0,[1],[],512,0,2),at[Be.HELP]=ae(0,[2],[],4,0,2),at[Be.GET_BAR]=ae(0,[3,3,3,3],[],3,0,2),at[Be.PRODUCT]=ae(1,[],[113],1,0,0),at[Be.FACT]=ae(1,[1],[],1,0,0),at[Be.GET_CELL]=ae(1,[1,16],[],47,0,2),at[Be.GET_WORKSPACE]=ae(1,[1],[],47,0,2),at[Be.GET_WINDOW]=ae(1,[1,2],[],47,0,2),at[Be.GET_DOCUMENT]=ae(1,[1,2],[],63,0,2),at[Be.DPRODUCT]=ae(3,[16,19,18],[],1,0,0),at[Be.ISNONTEXT]=ae(1,[143],[],4,0,0),at[Be.GET_NOTE]=ae(0,[82,65,65],[],2,0,2),at[Be.NOTE]=ae(0,[66,82,17,17],[],1,0,2),at[Be.STDEVP]=ae(1,[],[49],1,0,0),at[Be.VARP]=ae(1,[],[49],1,0,0),at[Be.DSTDEVP]=ae(3,[16,19,18],[],1,0,0),at[Be.DVARP]=ae(3,[16,19,18],[],1,0,0),at[Be.TRUNC]=ae(1,[1,1],[],1,0,0),at[Be.ISLOGICAL]=ae(1,[143],[],4,0,0),at[Be.DCOUNTA]=ae(3,[16,83,18],[],1,0,0),at[Be.DELETE_BAR]=ae(1,[3],[],4,0,2),at[Be.UNREGISTER]=ae(1,[3],[],4,0,2),at[Be.USDOLLAR]=ae(1,[1,1],[],2,0,0),at[Be.FINDB]=ae(2,[2,2,1],[],1,0,0),at[Be.SEARCHB]=ae(2,[2,2,1],[],1,0,0),at[Be.REPLACEB]=ae(4,[2,1,1,2],[],2,0,0),at[Be.LEFTB]=ae(1,[2,9],[],2,0,0),at[Be.RIGHTB]=ae(1,[2,9],[],2,0,0),at[Be.MIDB]=ae(3,[2,1,1],[],2,0,0),at[Be.LENB]=ae(1,[2],[],1,0,0),at[Be.ROUNDUP]=ae(2,[1,1],[],1,0,0),at[Be.ROUNDDOWN]=ae(2,[1,1],[],1,0,0),at[Be.ASC]=ae(1,[2],[],2,0,0),at[Be.DBCS]=ae(1,[2],[],2,0,0),at[Be.RANK]=ae(2,[1,16,4],[],1,0,0),at[Be.ADDRESS]=ae(2,[1,65,65,68,66],[],2,0,0),at[Be.DAYS360]=ae(2,[1,1,4],[],1,0,0),at[Be.TODAY]=ae(0,[],[],1,8191,0),at[Be.VDB]=ae(5,[1,1,1,1,1,1,4],[],1,0,0),at[Be.ELSE]=ae(0,[],[],512,0,2),at[Be.ELSE_IF]=ae(1,[12],[],512,0,2),at[Be.END_IF]=ae(0,[],[],512,0,2),at[Be.FOR_CELL]=ae(1,[2,82,84],[],512,0,2),at[Be.MEDIAN]=ae(1,[],[49],1,0,0),at[Be.SUMPRODUCT]=ae(1,[],[32],1,0,0),at[Be.SINH]=ae(1,[1],[],1,0,0),at[Be.COSH]=ae(1,[1],[],1,0,0),at[Be.TANH]=ae(1,[1],[],1,0,0),at[Be.ASINH]=ae(1,[1],[],1,0,0),at[Be.ACOSH]=ae(1,[1],[],1,0,0),at[Be.ATANH]=ae(1,[1],[],1,0,0),at[Be.DGET]=ae(3,[16,19,18],[],7,0,0),at[Be.CREATE_OBJECT]=ae(2,[1,18,17,17,18,17,17,115,84,21,17],[],2,0,2),at[Be.VOLATILE]=ae(0,[4],[],4,0,2),at[Be.LAST_ERROR]=ae(0,[],[],16,0,2),at[Be.CUSTOM_UNDO]=ae(0,[2,2],[],4,0,2),at[Be.CUSTOM_REPEAT]=ae(0,[2,2,2],[],4,0,2),at[Be.FORMULA_CONVERT]=ae(2,[2,23,23,23,23],[],2,0,2),at[Be.GET_LINK_INFO]=ae(2,[2,1,1,2],[],1,0,2),at[Be.TEXT_BOX]=ae(1,[2,66,65,65],[],1,0,2),at[Be.INFO]=ae(1,[2],[],3,8191,0),at[Be.GROUP]=ae(0,[],[],2,0,2),at[Be.GET_OBJECT]=ae(1,[1,2,1,1,1],[],47,0,2),at[Be.DB]=ae(4,[1,1,1,1,1],[],1,0,0),at[Be.PAUSE]=ae(0,[4],[],512,0,2),at[Be.ERROR_CODE]=ae(0,[],[],2,0,2),at[Be.ALLOC_COUNT]=ae(0,[],[],1,0,2),at[Be.RESUME]=ae(0,[1],[],512,0,2),at[Be.FREQUENCY]=ae(2,[48,48],[],32,0,0),at[Be.ADD_TOOLBAR]=ae(0,[66,96],[],2,0,2),at[Be.DELETE_TOOLBAR]=ae(1,[2],[],4,0,2),at[Be._UDF]=ae(1,[17],[127],575,0,0),at[Be.RESET_TOOLBAR]=ae(1,[3],[],4,0,2),at[Be.EVALUATE]=ae(1,[2],[],63,0,2),at[Be.GET_TOOLBAR]=ae(1,[1,3],[],47,0,2),at[Be.GET_TOOL]=ae(1,[1,3,1],[],47,0,2),at[Be.SPELLING_CHECK]=ae(1,[2,66,4],[],4,0,2),at[Be.ERROR_TYPE]=ae(1,[15],[],1,0,0),at[Be.APP_TITLE]=ae(0,[2],[],4,0,2),at[Be.WINDOW_TITLE]=ae(0,[2],[],4,0,2),at[Be.SAVE_TOOLBAR]=ae(0,[99,66],[],4,0,2),at[Be.ENABLE_TOOL]=ae(3,[3,1,4],[],4,0,2),at[Be.PRESS_TOOL]=ae(3,[3,1,4],[],4,0,2),at[Be.REGISTER_ID]=ae(2,[2,3,66],[],1,0,2),at[Be.GET_PROJECT]=ae(1,[1,2],[],35,0,2),at[Be.AVEDEV]=ae(1,[],[49],1,0,0),at[Be.BETADIST]=ae(3,[1,1,1,65,65],[],1,0,0),at[Be.GAMMALN]=ae(1,[1],[],1,0,0),at[Be.BETAINV]=ae(3,[1,1,1,65,65],[],1,0,0),at[Be.BINOMDIST]=ae(4,[1,1,1,4],[],1,0,0),at[Be.CHIDIST]=ae(2,[1,1],[],1,0,0),at[Be.CHIINV]=ae(2,[1,1],[],1,0,0),at[Be.COMBIN]=ae(2,[1,1],[],1,0,0),at[Be.CONFIDENCE]=ae(3,[1,1,1],[],1,0,0),at[Be.CRITBINOM]=ae(3,[1,1,1],[],1,0,0),at[Be.EVEN]=ae(1,[1],[],1,0,0),at[Be.EXPONDIST]=ae(3,[1,1,4],[],1,0,0),at[Be.FDIST]=ae(3,[1,1,1],[],1,0,0),at[Be.FINV]=ae(3,[1,1,1],[],1,0,0),at[Be.FISHER]=ae(1,[1],[],1,0,0),at[Be.FISHERINV]=ae(1,[1],[],1,0,0),at[Be.FLOOR]=ae(2,[1,1],[],1,0,0),at[Be.GAMMADIST]=ae(4,[1,1,1,4],[],1,0,0),at[Be.GAMMAINV]=ae(3,[1,1,1],[],1,0,0),at[Be.CEILING]=ae(2,[1,1],[],1,0,0),at[Be.HYPGEOMDIST]=ae(4,[1,1,1,1],[],1,0,0),at[Be.LOGNORMDIST]=ae(3,[1,1,1],[],1,0,0),at[Be.LOGINV]=ae(3,[1,1,1],[],1,0,0),at[Be.NEGBINOMDIST]=ae(3,[1,1,1],[],1,0,0),at[Be.NORMDIST]=ae(4,[1,1,1,4],[],1,0,0),at[Be.NORMSDIST]=ae(1,[1],[],1,0,0),at[Be.NORMINV]=ae(3,[1,1,1],[],1,0,0),at[Be.NORMSINV]=ae(1,[1],[],1,0,0),at[Be.STANDARDIZE]=ae(3,[1,1,1],[],1,0,0),at[Be.ODD]=ae(1,[1],[],1,0,0),at[Be.PERMUT]=ae(2,[1,1],[],1,0,0),at[Be.POISSON]=ae(3,[1,1,4],[],1,0,0),at[Be.TDIST]=ae(3,[1,1,1],[],1,0,0),at[Be.WEIBULL]=ae(4,[1,1,1,4],[],1,0,0),at[Be.SUMXMY2]=ae(2,[32,32],[],1,0,0),at[Be.SUMX2MY2]=ae(2,[32,32],[],1,0,0),at[Be.SUMX2PY2]=ae(2,[32,32],[],1,0,0),at[Be.CHITEST]=ae(2,[32,32],[],1,0,0),at[Be.CORREL]=ae(2,[32,32],[],1,0,0),at[Be.COVAR]=ae(2,[32,32],[],1,0,0),at[Be.FORECAST]=ae(3,[1,32,32],[],1,0,0),at[Be.FTEST]=ae(2,[32,32],[],1,0,0),at[Be.INTERCEPT]=ae(2,[32,32],[],1,0,0),at[Be.PEARSON]=ae(2,[32,32],[],1,0,0),at[Be.RSQ]=ae(2,[32,32],[],1,0,0),at[Be.STEYX]=ae(2,[32,32],[],1,0,0),at[Be.SLOPE]=ae(2,[32,32],[],1,0,0),at[Be.TTEST]=ae(4,[32,32,1,1],[],1,0,0),at[Be.PROB]=ae(3,[32,32,1,65],[],1,0,0),at[Be.DEVSQ]=ae(1,[],[49],1,0,0),at[Be.GEOMEAN]=ae(1,[],[49],1,0,0),at[Be.HARMEAN]=ae(1,[],[49],1,0,0),at[Be.SUMSQ]=ae(1,[],[49],1,0,0),at[Be.KURT]=ae(1,[],[49],1,0,0),at[Be.SKEW]=ae(1,[],[49],1,0,0),at[Be.ZTEST]=ae(2,[49,1,1],[],1,0,0),at[Be.LARGE]=ae(2,[49,1],[],1,0,0),at[Be.SMALL]=ae(2,[49,1],[],1,0,0),at[Be.QUARTILE]=ae(2,[49,1],[],1,0,0),at[Be.PERCENTILE]=ae(2,[49,1],[],1,0,0),at[Be.PERCENTRANK]=ae(2,[49,1,65],[],1,0,0),at[Be.MODE]=ae(1,[],[32],1,0,0),at[Be.TRIMMEAN]=ae(2,[49,1],[],1,0,0),at[Be.TINV]=ae(2,[1,1],[],1,0,0),at[Be.MOVIE_COMMAND]=ae(3,[2,1,1,1],[],1,0,2),at[Be.GET_MOVIE]=ae(2,[2,1,1],[],1,0,2),at[Be.CONCATENATE]=ae(1,[],[2],2,0,0),at[Be.POWER]=ae(2,[1,1],[],1,0,0),at[Be.SPREADBASE_DATA_FIELD]=ae(2,[66,2,66,65,65,65,66,66,66],[],2,0,2),at[Be.GET_VIEW]=ae(1,[1,2],[],35,0,2),at[Be.GET_FIELD]=ae(1,[1,66,2],[],35,0,2),at[Be.GET_ITEM]=ae(1,[1,66,66,2],[],7,0,2),at[Be.RADIANS]=ae(1,[1],[],1,0,0),at[Be.DEGREES]=ae(1,[1],[],1,0,0),at[Be.SUBTOTAL]=ae(2,[1],[16],1,0,0),at[Be.SUMIF]=ae(2,[16,15,16],[],1,0,0),at[Be.COUNTIF]=ae(2,[16,15],[],1,0,0),at[Be.COUNTBLANK]=ae(1,[16],[],1,0,0),at[Be.SCENARIO_GET]=ae(1,[1,2],[],19,0,2),at[Be.OPTIONS_LISTS]=ae(1,[33],[],33,0,2),at[Be.ISPMT]=ae(4,[1,1,1,1],[],1,0,0),at[Be.DATEDIF]=ae(3,[1,1,2],[],1,0,0),at[Be.DATESTRING]=ae(1,[1],[],2,0,0),at[Be.NUMBERSTRING]=ae(2,[1,1],[],2,0,0),at[Be.ROMAN]=ae(1,[1,5],[],2,0,0),at[Be.OPENDIALOG]=ae(0,[66,66,66,65],[],6,0,2),at[Be.SAVEDIALOG]=ae(0,[66,66,66,66,65],[],6,0,2),at[Be.VIEW_GET]=ae(1,[1,2],[],19,0,2),at[Be.GETPIVOTDATA]=ae(2,[18,18],[2,79],15,0,0),at[Be.HYPERLINK]=ae(1,[2,39],[],39,0,0),at[Be.FURIGANA]=ae(1,[16],[],2,0,0),at[Be.AVERAGEA]=ae(1,[],[49],1,0,0),at[Be.MAXA]=ae(1,[],[49],1,0,0),at[Be.MINA]=ae(1,[],[49],1,0,0),at[Be.STDEVPA]=ae(1,[],[49],1,0,0),at[Be.VARPA]=ae(1,[],[49],1,0,0),at[Be.STDEVA]=ae(1,[],[49],1,0,0),at[Be.VARA]=ae(1,[],[49],1,0,0),at[Be.BAHTTEXT]=ae(1,[1],[],2,0,0),at[Be.THAIDOW]=ae(1,[1],[],2,0,0),at[Be.THAIDIGIT]=ae(1,[3],[],2,0,0),at[Be.THAIMOY]=ae(1,[1],[],2,0,0),at[Be.THAINUMSOUND]=ae(1,[1],[],2,0,0),at[Be.THAINUMSTRING]=ae(1,[1],[],2,0,0),at[Be.THAISTRINGLENGTH]=ae(1,[2],[],1,0,0),at[Be.ISTHAIDIGIT]=ae(1,[2],[],4,0,0),at[Be.ROUNDBAHTDOWN]=ae(1,[1],[],1,0,0),at[Be.ROUNDBAHTUP]=ae(1,[1],[],1,0,0),at[Be.THAIYEAR]=ae(1,[1],[],1,0,0),at[Be.RTD]=ae(3,[],[2],2,0,0),at[Be.CUBEVALUE]=ae(1,[2],[50],15,0,0),at[Be.CUBEMEMBER]=ae(2,[2,50,2],[],10,0,0),at[Be.CUBEMEMBERPROPERTY]=ae(3,[2,2,2],[],15,0,0),at[Be.CUBERANKEDMEMBER]=ae(3,[2,2,1,2],[],10,0,0),at[Be.HEX2BIN]=ae(1,[95,95],[],9,0,0),at[Be.HEX2DEC]=ae(1,[95],[],9,0,0),at[Be.HEX2OCT]=ae(1,[95,95],[],9,0,0),at[Be.DEC2BIN]=ae(1,[95,95],[],9,0,0),at[Be.DEC2HEX]=ae(1,[95,95],[],9,0,0),at[Be.DEC2OCT]=ae(1,[95,95],[],9,0,0),at[Be.OCT2BIN]=ae(1,[95,95],[],9,0,0),at[Be.OCT2HEX]=ae(1,[95,95],[],9,0,0),at[Be.OCT2DEC]=ae(1,[95],[],9,0,0),at[Be.BIN2DEC]=ae(1,[95],[],9,0,0),at[Be.BIN2OCT]=ae(1,[95,95],[],9,0,0),at[Be.BIN2HEX]=ae(1,[95,95],[],9,0,0),at[Be.IMSUB]=ae(2,[95,95],[],9,0,0),at[Be.IMDIV]=ae(2,[95,95],[],9,0,0),at[Be.IMPOWER]=ae(2,[95,95],[],9,0,0),at[Be.IMABS]=ae(1,[95],[],9,0,0),at[Be.IMSQRT]=ae(1,[95],[],9,0,0),at[Be.IMLN]=ae(1,[95],[],9,0,0),at[Be.IMLOG2]=ae(1,[95],[],9,0,0),at[Be.IMLOG10]=ae(1,[95],[],9,0,0),at[Be.IMSIN]=ae(1,[95],[],9,0,0),at[Be.IMCOS]=ae(1,[95],[],9,0,0),at[Be.IMEXP]=ae(1,[95],[],9,0,0),at[Be.IMARGUMENT]=ae(1,[95],[],9,0,0),at[Be.IMCONJUGATE]=ae(1,[95],[],9,0,0),at[Be.IMAGINARY]=ae(1,[95],[],9,0,0),at[Be.IMREAL]=ae(1,[95],[],9,0,0),at[Be.COMPLEX]=ae(2,[95,95,95],[],9,0,0),at[Be.IMSUM]=ae(1,[],[127],9,0,0),at[Be.IMPRODUCT]=ae(1,[],[127],9,0,0),at[Be.SERIESSUM]=ae(4,[95,95,95,127],[],9,0,0),at[Be.FACTDOUBLE]=ae(1,[95],[],9,0,0),at[Be.SQRTPI]=ae(1,[95],[],9,0,0),at[Be.QUOTIENT]=ae(2,[95,95],[],9,0,0),at[Be.DELTA]=ae(1,[95,95],[],9,0,0),at[Be.GESTEP]=ae(1,[95,95],[],9,0,0),at[Be.ISEVEN]=ae(1,[95],[],9,0,0),at[Be.ISODD]=ae(1,[95],[],9,0,0),at[Be.MROUND]=ae(2,[95,95],[],9,0,0),at[Be.ERF]=ae(1,[95,95],[],9,0,0),at[Be.ERFC]=ae(1,[95],[],9,0,0),at[Be.BESSELJ]=ae(2,[95,95],[],9,0,0),at[Be.BESSELK]=ae(2,[95,95],[],9,0,0),at[Be.BESSELY]=ae(2,[95,95],[],9,0,0),at[Be.BESSELI]=ae(2,[95,95],[],9,0,0),at[Be.XIRR]=ae(2,[127,127,95],[],9,0,0),at[Be.XNPV]=ae(3,[95,127,127],[],9,0,0),at[Be.PRICEMAT]=ae(5,[95,95,95,95,95,95],[],9,0,0),at[Be.YIELDMAT]=ae(5,[95,95,95,95,95,95],[],9,0,0),at[Be.INTRATE]=ae(4,[95,95,95,95,95],[],9,0,0),at[Be.RECEIVED]=ae(4,[95,95,95,95,95],[],9,0,0),at[Be.DISC]=ae(4,[95,95,95,95,95],[],9,0,0),at[Be.PRICEDISC]=ae(4,[95,95,95,95,95],[],9,0,0),at[Be.YIELDDISC]=ae(4,[95,95,95,95,95],[],9,0,0),at[Be.TBILLEQ]=ae(3,[95,95,95],[],9,0,0),at[Be.TBILLPRICE]=ae(3,[95,95,95],[],9,0,0),at[Be.TBILLYIELD]=ae(3,[95,95,95],[],9,0,0),at[Be.PRICE]=ae(6,[95,95,95,95,95,95,95],[],9,0,0),at[Be.YIELD]=ae(6,[95,95,95,95,95,95,95],[],9,0,0),at[Be.DOLLARDE]=ae(2,[95,95],[],9,0,0),at[Be.DOLLARFR]=ae(2,[95,95],[],9,0,0),at[Be.NOMINAL]=ae(2,[95,95],[],9,0,0),at[Be.EFFECT]=ae(2,[95,95],[],9,0,0),at[Be.CUMPRINC]=ae(6,[95,95,95,95,95,95],[],9,0,0),at[Be.CUMIPMT]=ae(6,[95,95,95,95,95,95],[],9,0,0),at[Be.EDATE]=ae(2,[95,95],[],9,0,0),at[Be.EOMONTH]=ae(2,[95,95],[],9,0,0),at[Be.YEARFRAC]=ae(2,[95,95,95],[],9,0,0),at[Be.COUPDAYBS]=ae(3,[95,95,95,95],[],9,0,0),at[Be.COUPDAYS]=ae(3,[95,95,95,95],[],9,0,0),at[Be.COUPDAYSNC]=ae(3,[95,95,95,95],[],9,0,0),at[Be.COUPNCD]=ae(3,[95,95,95,95],[],9,0,0),at[Be.COUPNUM]=ae(3,[95,95,95,95],[],9,0,0),at[Be.COUPPCD]=ae(3,[95,95,95,95],[],9,0,0),at[Be.DURATION]=ae(5,[95,95,95,95,95,95],[],9,0,0),at[Be.MDURATION]=ae(5,[95,95,95,95,95,95],[],9,0,0),at[Be.ODDLPRICE]=ae(7,[95,95,95,95,95,95,95,95],[],9,0,0),at[Be.ODDLYIELD]=ae(7,[95,95,95,95,95,95,95,95],[],9,0,0),at[Be.ODDFPRICE]=ae(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),at[Be.ODDFYIELD]=ae(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),at[Be.RANDBETWEEN]=ae(2,[95,95],[],9,8191,0),at[Be.WEEKNUM]=ae(1,[95,95],[],9,0,0),at[Be.AMORDEGRC]=ae(6,[95,95,95,95,95,95,95],[],9,0,0),at[Be.AMORLINC]=ae(6,[95,95,95,95,95,95,95],[],9,0,0),at[Be.CONVERT]=ae(3,[95,95,95],[],9,0,0),at[Be.ACCRINT]=ae(6,[95,95,95,95,95,95,95,95],[],9,0,0),at[Be.ACCRINTM]=ae(4,[95,95,95,95,95],[],9,0,0),at[Be.WORKDAY]=ae(2,[95,95,127],[],9,0,0),at[Be.NETWORKDAYS]=ae(2,[95,95,127],[],9,0,0),at[Be.GCD]=ae(1,[],[127],9,0,0),at[Be.MULTINOMIAL]=ae(1,[],[127],9,0,0),at[Be.LCM]=ae(1,[],[127],9,0,0),at[Be.FVSCHEDULE]=ae(2,[95,127],[],9,0,0),at[Be.CUBEKPIMEMBER]=ae(3,[2,2,1,2],[],10,0,0),at[Be.CUBESET]=ae(2,[2,50,2,1,2],[],10,0,0),at[Be.CUBESETCOUNT]=ae(1,[2],[],9,0,0),at[Be.IFERROR]=ae(2,[47,575],[],47,0,0),at[Be.COUNTIFS]=ae(2,[],[16,15],1,0,0),at[Be.SUMIFS]=ae(3,[16],[16,15],1,0,0),at[Be.AVERAGEIF]=ae(2,[16,15,16],[],1,0,0),at[Be.AVERAGEIFS]=ae(3,[16],[16,15],1,0,0),at[Be.AGGREGATE]=ae(3,[1,1,48,17],[16],1,0,0),at[Be.BINOM_DIST]=ae(4,[1,1,1,4],[],1,0,0),at[Be.BINOM_INV]=ae(3,[1,1,1],[],1,0,0),at[Be.CONFIDENCE_NORM]=ae(3,[1,1,1],[],1,0,0),at[Be.CONFIDENCE_T]=ae(3,[1,1,1],[],1,0,0),at[Be.CHISQ_TEST]=ae(2,[32,32],[],1,0,0),at[Be.F_TEST]=ae(2,[32,32],[],1,0,0),at[Be.COVARIANCE_P]=ae(2,[32,32],[],1,0,0),at[Be.COVARIANCE_S]=ae(2,[32,32],[],1,0,0),at[Be.EXPON_DIST]=ae(3,[1,1,4],[],1,0,0),at[Be.GAMMA_DIST]=ae(4,[1,1,1,4],[],1,0,0),at[Be.GAMMA_INV]=ae(3,[1,1,1],[],1,0,0),at[Be.MODE_MULT]=ae(1,[],[32],32,0,0),at[Be.MODE_SNGL]=ae(1,[],[32],1,0,0),at[Be.NORM_DIST]=ae(4,[1,1,1,4],[],1,0,0),at[Be.NORM_INV]=ae(3,[1,1,1],[],1,0,0),at[Be.PERCENTILE_EXC]=ae(2,[49,1],[],1,0,0),at[Be.PERCENTILE_INC]=ae(2,[49,1],[],1,0,0),at[Be.PERCENTRANK_EXC]=ae(2,[49,1,65],[],1,0,0),at[Be.PERCENTRANK_INC]=ae(2,[49,1,65],[],1,0,0),at[Be.POISSON_DIST]=ae(3,[1,1,4],[],1,0,0),at[Be.QUARTILE_EXC]=ae(2,[49,1],[],1,0,0),at[Be.QUARTILE_INC]=ae(2,[49,1],[],1,0,0),at[Be.RANK_AVG]=ae(2,[1,16,4],[],1,0,0),at[Be.RANK_EQ]=ae(2,[1,16,4],[],1,0,0),at[Be.STDEV_S]=ae(1,[],[49],1,0,0),at[Be.STDEV_P]=ae(1,[],[49],1,0,0),at[Be.T_DIST]=ae(3,[1,1,4],[],1,0,0),at[Be.T_DIST_2T]=ae(2,[1,1],[],1,0,0),at[Be.T_DIST_RT]=ae(2,[1,1],[],1,0,0),at[Be.T_INV]=ae(2,[1,1],[],1,0,0),at[Be.T_INV_2T]=ae(2,[1,1],[],1,0,0),at[Be.VAR_S]=ae(1,[],[49],1,0,0),at[Be.VAR_P]=ae(1,[],[49],1,0,0),at[Be.WEIBULL_DIST]=ae(4,[1,1,1,4],[],1,0,0),at[Be.NETWORKDAYS_INTL]=ae(2,[95,95,75,127],[],9,0,0),at[Be.WORKDAY_INTL]=ae(2,[95,95,75,127],[],9,0,0),at[Be.ECMA_CEILING]=ae(2,[1,1],[],1,0,0),at[Be.ISO_CEILING]=ae(1,[1,65],[],1,0,0),at[Be.DEBUG]=ae(1,[2],[1151],1087,0,0),at[Be.BETA_DIST]=ae(4,[1,1,1,4,65,65],[],1,0,0),at[Be.BETA_INV]=ae(3,[1,1,1,65,65],[],1,0,0),at[Be.CHISQ_DIST]=ae(3,[1,1,4],[],1,0,0),at[Be.CHISQ_DIST_RT]=ae(2,[1,1],[],1,0,0),at[Be.CHISQ_INV]=ae(2,[1,1],[],1,0,0),at[Be.CHISQ_INV_RT]=ae(2,[1,1],[],1,0,0),at[Be.F_DIST]=ae(4,[1,1,1,4],[],1,0,0),at[Be.F_DIST_RT]=ae(3,[1,1,1],[],1,0,0),at[Be.F_INV]=ae(3,[1,1,1],[],1,0,0),at[Be.F_INV_RT]=ae(3,[1,1,1],[],1,0,0),at[Be.HYPGEOM_DIST]=ae(5,[1,1,1,1,4],[],1,0,0),at[Be.LOGNORM_DIST]=ae(4,[1,1,1,4],[],1,0,0),at[Be.LOGNORM_INV]=ae(3,[1,1,1],[],1,0,0),at[Be.NEGBINOM_DIST]=ae(4,[1,1,1,4],[],1,0,0),at[Be.NORM_S_DIST]=ae(2,[1,4],[],1,0,0),at[Be.NORM_S_INV]=ae(1,[1],[],1,0,0),at[Be.T_TEST]=ae(4,[32,32,1,1],[],1,0,0),at[Be.Z_TEST]=ae(2,[49,1,1],[],1,0,0),at[Be.ERF_PRECISE]=ae(1,[95],[],9,0,0),at[Be.ERFC_PRECISE]=ae(1,[95],[],9,0,0),at[Be.GAMMALN_PRECISE]=ae(1,[1],[],1,0,0),at[Be.CEILING_PRECISE]=ae(1,[1,65],[],1,0,0),at[Be.FLOOR_PRECISE]=ae(1,[1,65],[],1,0,0),at[Be.ACOT]=ae(1,[1],[],1,0,0),at[Be.ACOTH]=ae(1,[1],[],1,0,0),at[Be.COT]=ae(1,[1],[],1,0,0),at[Be.COTH]=ae(1,[1],[],1,0,0),at[Be.CSC]=ae(1,[1],[],1,0,0),at[Be.CSCH]=ae(1,[1],[],1,0,0),at[Be.SEC]=ae(1,[1],[],1,0,0),at[Be.SECH]=ae(1,[1],[],1,0,0),at[Be.IMTAN]=ae(1,[95],[],9,0,0),at[Be.IMCOT]=ae(1,[95],[],9,0,0),at[Be.IMCSC]=ae(1,[95],[],9,0,0),at[Be.IMCSCH]=ae(1,[95],[],9,0,0),at[Be.IMSEC]=ae(1,[95],[],9,0,0),at[Be.IMSECH]=ae(1,[95],[],9,0,0),at[Be.BITAND]=ae(2,[1,1],[],1,0,0),at[Be.BITOR]=ae(2,[1,1],[],1,0,0),at[Be.BITXOR]=ae(2,[1,1],[],1,0,0),at[Be.BITLSHIFT]=ae(2,[1,1],[],1,0,0),at[Be.BITRSHIFT]=ae(2,[1,1],[],1,0,0),at[Be.PERMUTATIONA]=ae(2,[1,1],[],1,0,0),at[Be.COMBINA]=ae(2,[1,1],[],1,0,0),at[Be.XOR]=ae(1,[],[52],4,0,0),at[Be.PDURATION]=ae(3,[1,1,1],[],1,0,0),at[Be.BASE]=ae(2,[1,1,65],[],2,0,0),at[Be.DECIMAL]=ae(2,[2,1],[],1,0,0),at[Be.DAYS]=ae(2,[3,3],[],1,0,0),at[Be.BINOM_DIST_RANGE]=ae(3,[1,1,1,65],[],1,0,0),at[Be.GAMMA]=ae(1,[1],[],1,0,0),at[Be.SKEW_P]=ae(1,[],[49],1,0,0),at[Be.GAUSS]=ae(1,[1],[],1,0,0),at[Be.PHI]=ae(1,[1],[],1,0,0),at[Be.RRI]=ae(3,[1,1,1],[],1,0,0),at[Be.UNICHAR]=ae(1,[1],[],2,0,0),at[Be.UNICODE]=ae(1,[2],[],1,0,0),at[Be.MUNIT]=ae(1,[1],[],32,0,0),at[Be.ARABIC]=ae(1,[2],[],1,0,0),at[Be.ISOWEEKNUM]=ae(1,[1],[],1,0,0),at[Be.NUMBERVALUE]=ae(1,[2,66,66],[],1,0,0),at[Be.SHEET]=ae(0,[50],[],1,8191,0),at[Be.SHEETS]=ae(0,[48],[],1,8191,0),at[Be.FORMULATEXT]=ae(1,[16],[],2,8191,0),at[Be.ISFORMULA]=ae(1,[16],[],4,0,0),at[Be.IFNA]=ae(2,[47,575],[],47,0,0),at[Be.CEILING_MATH]=ae(1,[1,65,65],[],1,0,0),at[Be.FLOOR_MATH]=ae(1,[1,65,65],[],1,0,0),at[Be.IMSINH]=ae(1,[95],[],9,0,0),at[Be.IMCOSH]=ae(1,[95],[],9,0,0),at[Be.FILTERXML]=ae(2,[2,2],[],47,0,0),at[Be.WEBSERVICE]=ae(1,[2],[],10,0,0),at[Be.ENCODEURL]=ae(1,[2],[],10,0,0),at[Be.FORECAST_ETS]=ae(3,[1,48,48,65,65,65],[],1,0,0),at[Be.FORECAST_ETS_CONFINT]=ae(3,[1,48,48,65,65,65,65],[],1,0,0),at[Be.FORECAST_ETS_SEASONALITY]=ae(2,[48,48,65,65],[],1,0,0),at[Be.FORECAST_LINEAR]=ae(3,[1,32,32],[],1,0,0),at[Be.FORECAST_ETS_STAT]=ae(3,[48,48,1,65,65,65],[],1,0,0),at[Be.MAXIFS]=ae(3,[16],[16,15],1,0,0),at[Be.MINIFS]=ae(3,[16],[16,15],1,0,0),at[Be.TEXTJOIN]=ae(3,[114,68],[114],2,0,0),at[Be.CONCAT]=ae(1,[],[114],2,0,0),at[Be.IFS]=ae(2,[],[44,575],575,0,0),at[Be.SWITCH]=ae(3,[47,575],[575,575],575,0,0),at[Be.SINGLE]=ae(1,[1079,4],[],1055,0,1),at[Be.AVERAGE_WEIGHTED]=ae(2,[],[113,113],1,0,1),at[Be.ANCHORARRAY]=ae(1,[16],[],48,0,1),at[Be.IMAGE]=ae(1,[2],[],2,0,1),at[Be.RECORD]=ae(2,[],[2,303],256,0,1),at[Be.RECORDTEST]=ae(3,[15],[2,47],256,0,1),at[Be.GRF]=ae(1,[15,2],[],15,0,1),at[Be.UNIT]=ae(2,[15,2],[],15,0,1),at[Be.RICHERROR]=ae(1,[1],[],10,0,1),at[Be.FILTER]=ae(2,[48,48],[],32,0,1),at[Be.FUN]=ae(1,[],[63],63,0,1),at[Be.LET]=ae(3,[63,63,63],[],63,0,1),at[Be.ARRAYMAKE]=ae(3,[1,1,63],[],32,0,1),at[Be.APPLY]=ae(1,[],[63],63,0,1),at[Be.ISFUN]=ae(1,[63],[],4,0,1),at[Be.ARITY]=ae(1,[63],[],9,0,1),at[Be.RECURSE]=ae(0,[],[],63,0,1),at[Be.FIELDVALUE]=ae(2,[263,2],[],295,0,1);var ot,ut=ae(0,[],[q.All],q.All,J.All,X.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot",e[e.At=25]="At",e[e.Pound=26]="Pound"}(ot||(ot={}));var st=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,".","@","#"],ct=j.Number|j.String|j.Boolean|j.Blank,lt=j.Number|j.String|j.Boolean|j.Blank,ft=ae(2,[j.Number,j.Number],[],j.Number,J.None,X.None),dt=ae(1,[j.Number],[],j.Number,J.None,X.None),ht=ae(1,[ct],[],ct,J.None,X.None),pt=ae(2,[j.String,j.String],[],j.String,J.None,X.None),vt=ae(2,[lt,lt],[],j.Boolean,J.None,X.None),mt=ae(2,[j.Range,j.Range],[],j.Range,J.AllCells,X.None),gt=ae(2,[j.Range,j.Range],[],j.Range,J.None,X.None),Et=ae(2,[j.Boolean,j.Boolean],[],j.Boolean,J.None,X.None),St=[];function Ct(e){var t=St[e];return null!=t?t:ut}function Tt(e){var t=at[e];return null!=t?t:ut}function Rt(e,t){var r=at[e];null!=r&&(r.staticPrecs=t)}function yt(e){return e.index===e.index2}function It(e){return e.isWellFormed}function Ot(e){return 1===e.rows&&1===e.cols}function At(e){return yt(e.sheet)}function Nt(e){return Ot(e.range)}function kt(e,t){if(Ot(e))return t(e,0,0);for(var r=e.row,n=e.rows,i=e.col,a=e.cols,o=0;o<n;o+=1)for(var u=0;u<a;u+=1)if(!t(H(r+o,i+u),o,u))return!1;return!0}function Ft(e,t){return e===t||e.name===t.name&&e.path===t.path}function bt(e,t){return Ft(e.document,t.document)&&e.index===t.index}function Dt(e,t){return e.row===t.row&&e.col===t.col}function Lt(e,t){return bt(e.sheet,t.sheet)&&Dt(e.range,t.range)}function Mt(e){return Ot(e)?e:B(e.row,e.col,1,1)}function _t(e){return Nt(e)?e:te(e.sheet,Mt(e.range))}function wt(e,t){var r=e.row,n=e.col,i=t.row,a=t.col;return B(Math.min(r,i),Math.min(n,a),Math.abs(i-r)+1,Math.abs(a-n)+1)}function Ut(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,i=!0;i;)switch(i=!1,n.kind){case Ne.Array:for(var a=n.nodes,o=a.length-1;!i&&o>=0;o-=1)for(var u=a[o],s=u.length-1;!i&&s>=0;s-=1){r(l=u[s])&&(n=l,i=!0)}break;case Ne.App:var c=n.args;for(s=c.length-1;!i&&s>=0;s-=1){r(l=c[s])&&(n=l,i=!0)}break;case Ne.Paren:var l;r(l=n.node)&&(n=l,i=!0);break;case Ne.Bad:case Ne.Name:case Ne.CellRef:case Ne.Literal:break;default:b("getSubExpressionFromPosition",n)}return n}function Pt(e,t){var r=-1,n=document.elementFromPoint(e,t);if(void 0!==document.caretPositionFromPoint)null!==(i=document.caretPositionFromPoint(e,t))&&(r=i.offset);else if(void 0!==document.caretRangeFromPoint){null!==(i=document.caretRangeFromPoint(e,t))&&(r=i.startOffset)}else try{var i;(i=document.body.createTextRange()).moveToPoint(e,t);var a=document.body.createTextRange();a.moveToElementText(n),a.setEndPoint("EndToStart",i),r=a.text.length}catch(e){return r}for(;null!=n&&"SPAN"===n.nodeName;)null!=(n=n.previousSibling)&&null!=n.textContent&&(r+=n.textContent.length);return r}St[ot.Add]=ft,St[ot.Sub]=ft,St[ot.Mul]=ft,St[ot.Div]=ft,St[ot.Pow]=ft,St[ot.Percent]=dt,St[ot.Neg]=dt,St[ot.At]=at[Be.SINGLE],St[ot.Pound]=at[Be.ANCHORARRAY],St[ot.Pos]=ht,St[ot.Concat]=pt,St[ot.Eq]=vt,St[ot.Ne]=vt,St[ot.Lt]=vt,St[ot.Le]=vt,St[ot.Gt]=vt,St[ot.Ge]=vt,St[ot.Range]=mt,St[ot.Isect]=gt,St[ot.Union]=gt,St[ot.And]=Et,St[ot.Or]=Et,St[ot.Xor]=Et,St[ot.Min]=ft,St[ot.Max]=ft,St[ot.Dot]=at[Be.FIELDVALUE],Rt(Be.ROW,J.OwnRow),Rt(Be.COLUMN,J.OwnCol),Rt(Be.SHEET,J.OwnDocSheets),Rt(Be.SHEETS,J.OwnDocSheets),Rt(Be.OFFSET,J.AllCells),Rt(Be.INDIRECT,J.AllCells),Rt(Be.SUMIF,J.AllCells),Rt(Be.NOW,J.Time),Rt(Be.TODAY,J.Time),Rt(Be.RAND,J.Calc),Rt(Be.RANDBETWEEN,J.Calc),Rt(Be.SUBTOTAL,J.CellProps),Rt(Be.CELL,J.CellProps|J.AllCells),Rt(Be.INFO,J.Calc),Rt(Be.FORMULATEXT,J.None);var Gt,Vt,xt=[];function Bt(e){return 0===function(e){if(1===e.args.length){var t=e.args[0];if(t.kind===Ne.Literal&&Kt(t.oper)===j.Missing)return 0}return e.args.length}(e)?xt:e.args}function Wt(e,t){M("calc.runtime.getArgType",t);var r=e.headTypes,n=r.length;if(t<n)return r[t];var i=e.restTypes,a=i.length;return a>0?i[(t-n)%a]:q.None}function Ht(e,t){return!(t<e.minArgs)&&(t<=e.headTypes.length||e.restTypes.length>0)}function Kt(e){switch(typeof e){case"number":return j.Number;case"string":return j.String;case"boolean":return j.Boolean;default:return e.kind}}function jt(e){return"number"==typeof e&&isFinite(e)}function qt(e,t,r){if(typeof t!=typeof e)return!1;if("object"!=typeof t||"object"!=typeof e)return t===e;if(t.kind!==e.kind)return!1;switch(t.kind){case j.Error:return t.type===e.type;case j.Rich:return r;case j.Array:var n=e;if(t.cols!==n.cols||t.rows!==n.rows)return!1;for(var i=0;i<t.rows;i+=1)for(var a=t.opers[i],o=n.opers[i],u=0;u<t.cols;u+=1)if(!qt(o[u],a[u],r))return!1;return!0;case j.Blank:return!0;default:return b("calc.lang.readOperEq",t)}}function Jt(e){return{kind:Gt.Success,value:e}}function Xt(e){return{kind:Gt.Failure,reason:e}}function Yt(e){return null!=e&&e.kind===Gt.Success}function Qt(e){return{kind:Vt.NotImplemented,features:e}}function zt(e){return 0===e.length&&D("calc.lang.unavailable: expected nonempty array"),{kind:Vt.Unavailable,objects:e}}!function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(Gt||(Gt={})),function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable"}(Vt||(Vt={}));var Zt=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};function $t(e){if(null!=e){var t=e.path,r=e.name;return null!=t&&"string"!=typeof t?(k.ULS.traceTag(595969803,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Illegal document path: type is "+typeof t),P):"string"!=typeof r?(k.ULS.traceTag(595969804,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Illegal document name: type is "+typeof r),P):e}}(Zt.prototype=Object.create(Error.prototype)).constructor=Zt;function er(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(65+n)+r,t=Math.floor((t-n)/26)}return r}function tr(e,t,r){var n=r.kind,i=r.index;return n===Oe.Abs?t+e.formatNumber(i+1):0===i?t:t+e.leftBracket+e.formatNumber(i)+e.rightBracket}function rr(e,t,r,n){if(t===Re.A1){if(null==r){return k.ULS.assertTag(595935437,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatRow: in A1 style, expected origin to be defined")}return function(e,t,r){var n=r.kind===Oe.Abs,i=e.formatNumber(r.index+(n?0:t)+1);return n?"$"+i:i}(e,r,n)}return tr(e,e.rowLetter,n)}function nr(e,t,r,n){if(t===Re.A1){if(null==r){return k.ULS.assertTag(595935438,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatCol: in A1 style, expected origin to be defined")}return function(e,t){var r=t.kind===Oe.Abs,n=er(t.index+(r?0:e));return r?"$"+n:n}(r,n)}return tr(e,e.columnLetter,n)}function ir(e){return function(t,r,n,i,a){var o=e(t,r,n,i);return r===Re.R1C1&&i.kind===a.kind&&i.index===a.index?o:o+":"+e(t,r,n,a)}}var ar=ir(rr),or=ir(nr);function ur(e,t,r,n,i){var a=rr(e,t,null!=r?r.row:void 0,n),o=nr(e,t,null!=r?r.col:void 0,i);return t===Re.A1?o+a:a+o}function sr(e,t){return{wrap:e,unwrap:t}}function cr(e){return e}function lr(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function fr(e){return null!=e}function dr(e){return null==e}function hr(e,t){return fr(e)?e:t}function pr(e,t){return[e,t]}function vr(e,t){return e<t?e:t}function mr(e,t){return e<t?t:e}function gr(e){return e<0?-e:e}function Er(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}}var Sr,Cr="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()},Tr={ULS:new c.NulLogger},Rr=Object(c.initStopwatchFactory)((function(e){return Tr.ULS.traceTag(595948114,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,e)}));function yr(e,t){return p(this,void 0,void 0,(function(){var r;return v(this,(function(n){switch(n.label){case 0:r=Rr(e),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,t()];case 2:return[2,n.sent()];case 3:return r.stop(),[7];case 4:return[2]}}))}))}!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcNewFunctions="CalcNewFunctions",e.CalcContractChecks="CalcContractChecks",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcFormatCalculations="CalcFormatCalculations",e.CalcFormulaCacheAPIChanges="CalcFormulaCacheAPIChanges",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcSupportRowReference="CalcSupportRowReference",e.CalcHashSet="CalcHashSet",e.CalcFieldValueFunction="CalcFieldValueFunction",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcWebWorker="CalcWebWorker",e.CalcWebWorkerTest="CalcWebWorkerTest",e.CalcWorksheetFunctions="CalcWorksheetFunctions",e.CalcLogStopWatch="CalcLogStopWatch",e.CalcDynamicArrayOperators="CalcDynamicArrayOperators",e["OfficeVSO:3832565_CalcCGRowColRefs"]="OfficeVSO:3832565_CalcCGRowColRefs",e["OfficeVSO:3832568_CalcCGGetUsedRange"]="OfficeVSO:3832568_CalcCGGetUsedRange",e["OfficeVSO:3852168_CalcCGAVERAGEIF"]="OfficeVSO:3852168_CalcCGAVERAGEIF",e["OfficeVSO:3852168_CalcCGCOUNT"]="OfficeVSO:3852168_CalcCGCOUNT",e["OfficeVSO:3852168_CalcCGCOUNTIF"]="OfficeVSO:3852168_CalcCGCOUNTIF",e["OfficeVSO:3852168_CalcCGMEDIAN"]="OfficeVSO:3852168_CalcCGMEDIAN",e["OfficeVSO:3852168_CalcCGSUMIF"]="OfficeVSO:3852168_CalcCGSUMIF",e["OfficeVSO:3852168_CalcCGROWS"]="OfficeVSO:3852168_CalcCGROWS",e["OfficeVSO:3852168_CalcCGCOLUMNS"]="OfficeVSO:3852168_CalcCGCOLUMNS",e["OfficeVSO:3852168_CalcCGINDEX"]="OfficeVSO:3852168_CalcCGINDEX",e["OfficeVSO:3852168_CalcCGMATCH"]="OfficeVSO:3852168_CalcCGMATCH",e["OfficeVSO:3852168_CalcCGHLOOKUP"]="OfficeVSO:3852168_CalcCGHLOOKUP",e["OfficeVSO:3852168_CalcCGVLOOKUP"]="OfficeVSO:3852168_CalcCGVLOOKUP",e["OfficeVSO:3852168_CalcCGLARGE"]="OfficeVSO:3852168_CalcCGLARGE",e["OfficeVSO:3852168_CalcCGSMALL"]="OfficeVSO:3852168_CalcCGSMALL",e["OfficeVSO:3852168_CalcCGPERCENTILE"]="OfficeVSO:3852168_CalcCGPERCENTILE",e["OfficeVSO:3852168_CalcCGPERCENTILE_EXC"]="OfficeVSO:3852168_CalcCGPERCENTILE_EXC",e["OfficeVSO:3852168_CalcCGQUARTILE"]="OfficeVSO:3852168_CalcCGQUARTILE",e["OfficeVSO:3852168_CalcCGQUARTILE_EXC"]="OfficeVSO:3852168_CalcCGQUARTILE_EXC",e["OfficeVSO:3852168_CalcCGTRIMMEAN"]="OfficeVSO:3852168_CalcCGTRIMMEAN",e["OfficeVSO:3852168_CalcCGTRUE"]="OfficeVSO:3852168_CalcCGTRUE",e["OfficeVSO:3852168_CalcCGFALSE"]="OfficeVSO:3852168_CalcCGFALSE",e["OfficeVSO:3852168_CalcCGNOT"]="OfficeVSO:3852168_CalcCGNOT",e["OfficeVSO:3852168_CalcCGNA"]="OfficeVSO:3852168_CalcCGNA",e["OfficeVSO:3852168_CalcCGAVERAGEA"]="OfficeVSO:3852168_CalcCGAVERAGEA",e["OfficeVSO:3852168_CalcCGMAXA"]="OfficeVSO:3852168_CalcCGMAXA",e["OfficeVSO:3852168_CalcCGMINA"]="OfficeVSO:3852168_CalcCGMINA",e["OfficeVSO:3852168_CalcCGXOR"]="OfficeVSO:3852168_CalcCGXOR",e["OfficeVSO:3852168_CalcCGT"]="OfficeVSO:3852168_CalcCGT",e["OfficeVSO:3852168_CalcCGN"]="OfficeVSO:3852168_CalcCGN",e["OfficeVSO:3852168_CalcCGHYPERLINK"]="OfficeVSO:3852168_CalcCGHYPERLINK",e["OfficeVSO:3852168_CalcCGAGGREGATE"]="OfficeVSO:3852168_CalcCGAGGREGATE",e["OfficeVSO:3852168_CalcCGSUBTOTAL"]="OfficeVSO:3852168_CalcCGSUBTOTAL",e["OfficeVSO:3852168_CalcCGVAR"]="OfficeVSO:3852168_CalcCGSVAR",e["OfficeVSO:3852168_CalcCGVARP"]="OfficeVSO:3852168_CalcCGVARP",e["OfficeVSO:3852168_CalcCGSTDEV"]="OfficeVSO:3852168_CalcCGSTDEV",e["OfficeVSO:3852168_CalcCGSTDEVP"]="OfficeVSO:3852168_CalcCGSTDEVP",e["OfficeVSO:3852168_CalcCGVARA"]="OfficeVSO:3852168_CalcCGSVARA",e["OfficeVSO:3852168_CalcCGVARPA"]="OfficeVSO:3852168_CalcCGVARPA",e["OfficeVSO:3852168_CalcCGSTDEVA"]="OfficeVSO:3852168_CalcCGSTDEVA",e["OfficeVSO:3852168_CalcCGSTDEVPA"]="OfficeVSO:3852168_CalcCGSTDEVPA",e["OfficeVSO:3852168_CalcCGMODE"]="OfficeVSO:3852168_CalcCGMODE",e["OfficeVSO:3852168_CalcCGMODE_MULT"]="OfficeVSO:3852168_CalcCGMODE_MULT",e["OfficeVSO:3913458_CalcCGChangeDetection"]="OfficeVSO:3913458_CalcCGChangeDetection"}(Sr||(Sr={}));var Ir=function(e){return!1},Or={};function Ar(e){return void 0===Or[e]&&(Or[e]=Ir(e)),Or[e]}function Nr(e,t,r){return void 0===r&&(r=100),t.maxDepth=r,t.level=0,kr(e,t)}function kr(e,t){if(t.level===t.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+t.level;var r;switch(t.level+=1,e.kind){case Ne.Literal:r=function(e,t){if("boolean"==typeof e)return t.visitBoolean(e);if("number"==typeof e)return t.visitNumber(e);if("string"==typeof e)return t.visitString(e);if(e.kind===j.Missing)return t.visitMissing(e);if(e.kind===j.Error)switch(e.type){case z.NULL:return t.visitNullError(e);case z.DIV0:return t.visitDiv0Error(e);case z.VALUE:return t.visitValueError(e);case z.REF:return t.visitRefError(e);case z.NAME:return t.visitNameError(e);case z.NUM:return t.visitNumError(e);case z.NA:return t.visitNAError(e);case z.GETTING_DATA:return t.visitDataError(e);case z.FIELD:return t.visitFieldError(e)}throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,t.operVisitor);break;case Ne.Array:r=t.visitArray(e);break;case Ne.App:r=t.visitApp(e);break;case Ne.Paren:r=t.visitParen(e);break;case Ne.Name:r=t.visitName(e);break;case Ne.CellRef:r=t.visitCellRef(e);break;case Ne.Bad:r=t.visitBad(e);break;case Ne.Operator:r=t.visitOperator(e);break;case Ie.Error:r=t.visitRefError(e);break;case Ie.Single:r=t.visitSingle(e);break;case Ie.Range:r=t.visitRange(e);break;case Ie.Row:r=t.visitRow(e);break;case Ie.Col:r=t.visitCol(e);break;case ye.Error:r=t.visitNameError(e);break;case ye.Relative:r=t.visitRelative(e);break;case ye.Document:r=t.visitDocument(e);break;case ye.Sheet:r=t.visitSheet(e);break;case ye.Ident:r=t.visitIdent(e);break;case ye.SheetRange:r=t.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return t.level-=1,r}function Fr(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitNullError:e,visitDiv0Error:e,visitValueError:e,visitRefError:e,visitNameError:e,visitNumError:e,visitNAError:e,visitDataError:e,visitFieldError:e}}function br(e,t,r){return{level:0,operVisitor:e,visitArray:hr(r.vArray,t),visitApp:hr(r.vApp,t),visitParen:hr(r.vParen,t),visitName:hr(r.vName,t),visitCellRef:hr(r.vCellRef,t),visitBad:hr(r.vBad,t),visitOperator:hr(r.vOperator,t),visitRefError:hr(r.vRefError,t),visitSingle:hr(r.vSingle,t),visitRange:hr(r.vRange,t),visitRow:hr(r.vRow,t),visitCol:hr(r.vCol,t),visitNameError:hr(r.vNameError,t),visitRelative:hr(r.vRelative,t),visitDocument:hr(r.vDocument,t),visitSheet:hr(r.vSheet,t),visitIdent:hr(r.vIdent,t),visitSheetRange:hr(r.vSheetRange,t)}}var Dr,Lr=["+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":"," ",",","","","","","","","@","#"],Mr={localeInfo:void 0,range:void 0,refStyle:Re.A1,source:y.Cell,level:0,operVisitor:{visitString:function(e){return'"'+e+'"'},visitBoolean:function(e){return e.toString().toLocaleUpperCase()},visitNumber:function(e){return e.toString()},visitMissing:function(e){return""},visitNullError:function(e){return"#NULL!"},visitDiv0Error:function(e){return"#DIV/0!"},visitValueError:function(e){return"#VALUE!"},visitRefError:function(e){return"#REF!"},visitNameError:function(e){return"#NAME?"},visitNumError:function(e){return"#NUM!"},visitNAError:function(e){return"#N/A"},visitDataError:function(e){return"#GETTING_DATA!"},visitFieldError:function(e){return"#FIELD"}},visitArray:function(e){var t=[];return e.nodes.forEach((function(e){var r=[];e.forEach((function(e){r.push(kr(e,Mr))})),t.push(r.join(","))})),"{"+t.join(";")+"}"},visitApp:function(e){var t=[];e.args.forEach((function(e){t.push(kr(e,Mr))}));var r=kr(e.head,Mr);if(e.head.kind===Ne.Operator){if(e.head.id===ot.Percent)return t[0]+"%";if(e.head.id===ot.Pound)return t[0]+"#";if(1===t.length)return r+t[0];if(2===t.length)return t[0]+r+t[1];throw"Tried to pretty print operator with 0 or more than 2 operators"}return r+"("+t.join(",")+")"},visitParen:function(e){return"("+kr(e.node,Mr)+")"},visitName:function(e){return e.whole},visitCellRef:function(e){var t="";return void 0!==e.qualifier&&(t=kr(e.qualifier,this)+"!"),t+kr(e.ref,this)},visitBad:function(e){if(e.type===ke.Sequence){var t=[];return e.contents.forEach((function(e){t.push(kr(e,Mr))})),t.join("")}return e.contents},visitOperator:function(e){return Lr[e.id-1]},visitRefError:function(e){return"#REF!"},visitSingle:function(e){var t=void 0===this.range?void 0:this.range.range;return ur(this.localeInfo,this.refStyle,t,e.row,e.col)},visitRange:function(e){return kr(e.ref1,Mr)+":"+kr(e.ref2,Mr)},visitRow:function(e){var t=void 0===this.range?void 0:this.range.range.row;return rr(this.localeInfo,this.refStyle,t,e.row1)+":"+rr(this.localeInfo,this.refStyle,t,e.row2)},visitCol:function(e){var t=void 0===this.range?void 0:this.range.range.col;return nr(this.localeInfo,this.refStyle,t,e.col1)+":"+nr(this.localeInfo,this.refStyle,t,e.col2)},visitNameError:function(e){return"#REF"},visitRelative:function(e){return""},visitDocument:function(e){return void 0!==e.path?e.path+"/"+e.document:e.document},visitSheet:function(e){return(void 0!==e.document?kr(e.document,Mr):"")+e.sheet},visitIdent:function(e){return e.name},visitSheetRange:function(e){return e.sheet1+":"+e.sheet2}};function _r(e){return{kind:Dr.VisitorFailure,message:e}}function wr(){return{kind:Dr.NoLocaleInfo}}function Ur(e,t,r,n,i){void 0===n&&(n=Re.A1),void 0===i&&(i=y.Cell);try{return void 0===r&&n===Re.A1?Xt(wr()):(Mr.localeInfo=t,Mr.range=r,Mr.refStyle=n,Mr.source=i,Jt("="+Nr(e,Mr)))}catch(e){if(k.ULS.traceTag(595964180,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.lang.prettyPrinter: Format failed: "+e),Mr.level=0,"string"==typeof e)return Xt(_r(e));throw e}}!function(e){e.NoLocaleInfo="NoLocaleInfo",e.VisitorFailure="VisitorFailure"}(Dr||(Dr={}));var Pr,Gr=ee(x(G(void 0,"Book1"),0),W(0,0,1,1));function Vr(e,t){var r=Ur(t,e,Gr);if(r.kind===Gt.Success){return r.value.toLowerCase().replace(/d/g,"w").replace(/[0-9]/g,"d").replace(new RegExp("[^=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?\"&<>'!{}~\\^\\*$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹\\sꃂd]","g"),"w")}}function xr(e,t){return Vr(e,t.node)}function Br(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],i=e[r+1],a=n;a<i;a+=1)t(a,n,i)}!function(e){e[e.Ordinal=15]="Ordinal",e[e.DigitClass=16]="DigitClass",e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(Pr||(Pr={}));var Wr=function(e,t,r){var n;function i(e){n[e]|=Pr.IdentStartClass}function a(e){n[e]|=Pr.IdentContinueClass}function o(e,t){n[e]|=Pr.DigitClass,n[e]|=e-t}return function(u){if(void 0===n){var s=mr(e[e.length-1],mr(t[t.length-1],r[r.length-1]));n=new Uint8Array(s),Br(e,i),Br(t,a),Br(r,o);for(var c=4969;c<4978;c+=1)o(c,4968)}var l=n[u];return void 0!==l?l:0}}([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2208,2229,2230,2238,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3294,3295,3296,3298,3313,3315,3333,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5906,5920,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6988,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11311,11312,11359,11360,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12731,12784,12800,13312,19894,19968,40944,40960,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42944,42946,42951,42999,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43880,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[46,47,48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2208,2229,2230,2238,2259,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2902,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3133,3141,3142,3145,3146,3150,3157,3159,3160,3163,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3294,3295,3296,3300,3302,3312,3313,3315,3328,3332,3333,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3458,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5901,5902,5909,5920,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6159,6160,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6847,6912,6988,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7674,7675,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8384,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11160,11311,11312,11359,11360,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12731,12736,12772,12784,12831,12832,19894,19904,40944,40960,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42944,42946,42951,42999,43052,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43880,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64450,64467,64830,64848,64912,64914,64968,65008,65022,65024,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534],[48,58,1632,1642,1776,1786,1984,1994,2406,2416,2534,2544,2662,2672,2790,2800,2918,2928,3046,3056,3174,3184,3302,3312,3430,3440,3558,3568,3664,3674,3792,3802,3872,3882,4160,4170,4240,4250,6112,6122,6160,6170,6470,6480,6608,6618,6784,6794,6800,6810,6992,7002,7088,7098,7232,7242,7248,7258,42528,42538,43216,43226,43264,43274,43472,43482,43504,43514,43600,43610,44016,44026,65296,65306]);function Hr(e,t){return{key:e,value:t}}var Kr,jr,qr=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([e,t])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],i=this.values[r];e(n,i)&&t.push([n,i])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return Hr(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return},e.prototype.setValues=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.keys.map((function(t,r){return[t,e.values[r],r]})),i=n.length;t.forEach((function(e,t){var r=e[0],a=e[1];return n.push([r,a,t+i])})),n.sort((function(t,r){var n=t[0],i=t[2],a=r[0],o=r[2],u=e.keyCompare(n,a);return 0!==u?u:i-o}));for(var a=[],o=void 0,u=0;u<n.length;u+=1){var s=n[u],c=s[0],l=s[1];void 0===o||0!==this.keyCompare(c,o)?(a.push([c,l]),o=c):a[a.length-1]=[c,l]}return this.ofSequence(a)},e.prototype.getKeyIndex=function(e){for(var t=Jr;t>=0&&t<this.keys.length;){var r=this.keyCompare(e,this.keys[t]);if(0===r)return t;r<0?t=Xr(t):r>0&&(t=Yr(t))}},e.prototype.ofSequence=function(t){var r=this,n=t.slice();n.sort((function(e,t){var n=e[0],i=t[0];return r.keyCompare(n,i)}));for(var i=new Array(n.length),a=new Array(n.length),o=function(e){var t=new Array(e);return function e(t,r,n,i){if(t>=r.length)return;var a=function(e){var t=function(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}(e);if(t/2-1<=e-t)return t-1;return e-t/2}(i);r[t]=n+a,e(Xr(t),r,n,a),e(Yr(t),r,n+a+1,i-a-1)}(Jr,t,0,e),t}(n.length),u=0;u<n.length;u+=1){var s=n[o[u]],c=s[0],l=s[1];i[u]=c,a[u]=l}return new e(this.keyCompare,i,a)},e}(),Jr=0;function Xr(e){return 2*e+1}function Yr(e){return 2*e+2}function Qr(e){return N.FormulaNode=E(e,Vr),N.Formula=E(e,xr),{localeInfo:e}}var zr=!1,Zr=void 0;function $r(e,t,r){if(zr){k.ULS.traceTag(595910878,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{var n;if(F(e),function(e){Tr.ULS=e}(e),"function"==typeof(n=t)&&(Ir=n),null!=r&&!/(^https:\/\/)|(^http:\/\/)/.test(r)){var i="calc.config.initCalc: calcAbsUrl is not absolute: "+r;k.ULS.traceTag(595910879,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,i)}Zr=r,zr=!0;k.ULS.traceTag(594642132,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.config.initCalc: Calc version 10.16.1 (production) initialized")}}function en(){return zr}function tn(){return Zr}function rn(e,t,r,n,i,a,o,u,s,c,l,f,d,h,p,v,m,g,E,S,C,T){function R(e){return 92===e||95===e||u(String.fromCharCode(e))}return nn(e,t,r,n,(function(e){return i(String.fromCharCode(e))}),(function(e){return a(String.fromCharCode(e))}),(function(e){return o(e).charCodeAt(0)}),R,(function(e){return R(e)||46===e||63===e||i(String.fromCharCode(e))}),s,c,l,f,d,h,p,v,m,g,E,S,C,T)}function nn(e,t,r,n,i,a,o,u,s,c,l,f,d,h,p,v,m,g,E,S,C,T,R){return{parseNumber:e,formatNumber:t,getWorksheetFuncId:function(e){return r(e.toLocaleUpperCase())},getWorksheetFuncName:n,isNumeral:i,getOrdinal:a,getNumeral:o,isIdentStart:u,isIdentContinue:s,stringCompareCI:c,errorNames:l,trueName:f,falseName:d,rowLetter:h,columnLetter:p,leftBrace:v,rightBrace:m,leftBracket:g,rightBracket:E,decimalSeparator:S,listSeparator:C,columnSeparator:T,rowSeparator:R}}function an(e){return function(t){if(!(0===t.length||t.indexOf("x")>=0||t.indexOf("X")>=0)){t="."===e?t:t.replace(e,".");var r=Number(t);return isFinite(r)?r:(t=String.fromCharCode.apply(String,t.split("").map((function(e){return t=e.charCodeAt(0),0==((r=Wr(t))&Pr.DigitClass)?t:cn(r&Pr.Ordinal);var t,r}))),r=Number(t),isFinite(r)?r:void 0)}}}function on(e){return"."===e?function(e){return String(e).replace("e","E")}:function(t){return String(t).replace(".",e).replace("e","E")}}function un(e){return 0!=(Wr(e)&Pr.DigitClass)}function sn(e){var t=Wr(e);return 0==(t&Pr.DigitClass)?D("calc.config.getOrdinal: expected numeral; given "+R(e)):t&Pr.Ordinal}function cn(e){w("calc.config.getNumeral",e,10);return 48+e}function ln(e){return 0!=(Wr(e)&Pr.IdentStartClass)}function fn(e){return 0!=(Wr(e)&Pr.IdentContinueClass)}var dn=S(((Kr={})[z.NULL]="#NULL!",Kr[z.DIV0]="#DIV/0!",Kr[z.VALUE]="#VALUE!",Kr[z.REF]="#REF!",Kr[z.NAME]="#NAME?",Kr[z.NUM]="#NUM!",Kr[z.NA]="#N/A",Kr[z.GETTING_DATA]="#GETTING_DATA",Kr[z.FIELD]="#FIELD",Kr)),hn=((jr={})[Be.ARRAYMAKE]="ARRAY.MAKE",jr),pn=void 0;function vn(e){var t=mn()[e];return void 0===t?String(e):t}function mn(){if(null==pn)for(var e in pn=[],Be){var t=Number(e);if(!isNaN(t)){var r=hn[t],n=null!=r?r:Be[e].replace("_",".");pn[t]=n}}return pn}function gn(e,t){var r=function(e,t){var r,n=[];return t.forEach((function(e,t){null!=e&&n.push([e,t])})),(r=qr.create(e)).setValues.apply(r,n)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?D("calc.config.getWorksheetFuncName: unknown function ID "+e):r}}}function En(){var e=mn(),t=Er("en-US"),r=gn(t,e),n=r.getWorksheetFuncId,i=r.getWorksheetFuncName;return nn(an("."),on("."),n,i,un,sn,cn,ln,fn,t,dn,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";")}var Sn,Cn,Tn,Rn,yn,In,On,An,Nn,kn,Fn,bn,Dn=Ie,Ln=Oe,Mn=ye,_n=we,wn=H,Un=x,Pn=V,Gn=$,Vn=re,xn=ie,Bn=wt,Wn=Yt,Hn=Vt,Kn=Qt;function jn(e){if(void 0===e)return!0;if(null===e||"object"!=typeof e)return!1;switch(e.kind){case Hn.NotImplemented:case Hn.Unavailable:return!0}return!1}function qn(e,t,r){return function(n,i){return void 0===i?t(n):jn(i)?r(i,n):e(i)}}function Jn(e,t){return function(r){if(Array.isArray(r)){for(var n=void 0,i=0;i<r.length;i+=1){var a=r[i];if(void 0!==(n=e(a)))return[a,n]}return t}var o=e(r);return void 0===o?t:[r,o]}}function Xn(e,t,r,n){var i=t.kind===Ln.Abs?t.index:e+t.index;return n?i&r-1:i}function Yn(e,t,r){var n=Xn(e.row,t.row,1<<20,r),i=Xn(e.col,t.col,16384,r);return wn(n,i)}function Qn(e,t,r){switch(void 0===r&&(r=!0),t.kind){case Dn.Error:return;case Dn.Single:var n=Yn(e,t,r);return wn(n.row,n.col);case Dn.Range:var i=Yn(e,t.ref1,r),a=Yn(e,t.ref2,r);return Bn(i,a);case Dn.Row:if(Ar(Sr["OfficeVSO:3832565_CalcCGRowColRefs"])){var o=Xn(e.row,t.row1,1<<20,r),u=Xn(e.row,t.row2,1<<20,r);return Bn(wn(o,0),wn(u,16383))}return Kn(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]);case Dn.Col:if(Ar(Sr["OfficeVSO:3832565_CalcCGRowColRefs"])){var s=Xn(e.col,t.col1,16384,r),c=Xn(e.col,t.col2,16384,r);return Bn(wn(0,s),wn(1048575,c))}return Kn(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]);default:return b("calc.runtime.resolverService.resolveGridRef",t)}}function zn(e){function t(t){var r=e.getDocumentLoc(t.path,t.document);return fr(r)?r:void 0}function r(r,n){var i=fr(n.document)?t(n.document):r;if(!dr(i)){var a=e.getSheetIndex(i,n.sheet);return Wn(a)?fr(a.value)?Un(i,a.value):void 0:a.reason}}return{resolveName:function(n,i,a){var o;if(dr(i)||i.kind===Mn.Relative){if(void 0===e.getNameLoc){var u=a.toLocaleUpperCase();return[xn(n.sheet,u),xn(Vn(n.sheet.document),u)]}var s=e.getNameLoc(n.sheet,a);if(s.kind===Gt.Failure)return s.reason;if(!dr(s.value))return s.value;o=Vn(n.sheet.document)}else{var c=function(n,i){switch(i.kind){case Mn.Document:var a=t(i);return fr(a)?Vn(a):a;case Mn.Sheet:return r(n.sheet.document,i);case Mn.Ident:var o=n.sheet.document,u=e.getSheetIndex(o,i.name);if(Wn(u)){if(fr(u.value))return Un(o,u.value);var s=t(_n(i.name));return fr(s)?Vn(s):void 0}return u.reason;default:return b("calc.runtime.resolverService.resolveNameQualifier",i)}}(n,i);if(jn(c))return c;o=c}if(void 0===e.getNameLoc){u=a.toLocaleUpperCase();return xn(o,u)}var l=e.getNameLoc(o,a);return l.kind===Gt.Failure?l.reason:dr(l.value)?void 0:l.value},resolveGridRef:Qn,resolveCellRef:function(t,n,i,a){void 0===a&&(a=!0);var o=Qn(t.range,i,a);if(jn(o))return o;var u=dr(n)?t.sheet:function(t,n){switch(n.kind){case Mn.Error:return;case Mn.Sheet:return r(t.document,n);case Mn.SheetRange:var i=t.document,a=e.getSheetIndex(i,n.sheet1);if(!Wn(a))return a.reason;var o=e.getSheetIndex(i,n.sheet2);if(!Wn(o))return o.reason;var u=a.value,s=o.value;if(dr(u)||dr(s))return;return Pn(i,u,s);case Mn.Relative:return t;default:return b("calc.runtime.resolverService.resolveCellRefQualifier",n)}}(t.sheet,n);return jn(u)?u:Gn(u,o)}}}(Cn=Sn||(Sn={})).FormulaSource=y,Cn.sheetRows=1<<20,Cn.sheetCols=16384,Cn.documentLoc=G,Cn.sheetIndex=x,Cn.sheetRange=V,Cn.gridCell=H,Cn.gridRange=W,Cn.sheetGridCell=te,Cn.sheetGridRange=ee,Cn.sheetGridCube=$,Cn.documentScope=re,Cn.nameLoc=ie,Cn.nameScope=ne,(Rn=Tn||(Tn={})).SpecialPrecs=J,Rn.PrecsBound=Q,Rn.OperKind=j,Rn.ErrorType=z,Rn.ErrorTypeBounds=Z,Rn.precedents=oe,Rn.errorOper=ue,Rn.nullErrorOper=se,Rn.div0ErrorOper=ce,Rn.valueErrorOper=le,Rn.refErrorOper=fe,Rn.nameErrorOper=de,Rn.numErrorOper=he,Rn.naErrorOper=pe,Rn.gettingDataErrorOper=ve,Rn.fieldErrorOper=me,Rn.arrayOper=Se,Rn.rangeSeqOper=Ce,Rn.range3DOper=Te,Rn.missingOper=Fe,Rn.blankOper=be,(In=yn||(yn={})).RefStyle=Re,In.QualifierKind=ye,In.CellRefKind=Ie,In.PosKind=Oe,In.NodeKind=Ne,In.BadType=ke,In.errorQualifierLabeled=De,In.relativeQualifierLabeled=Le,In.errorQualifier=Me,In.relativeQualifier=_e,In.documentQualifier=we,In.sheetQualifier=Ue,In.identQualifier=Pe,In.sheetRangeQualifier=Ge,In.pos=Ve,In.cellRefErrorLabeled=xe,In.cellRefError=We,In.cellRefSingle=He,In.cellRefRange=Ke,In.cellRefRow=je,In.cellRefCol=qe,In.formula=Je,In.formulaSpan=Xe,In.literalNode=ze,In.arrayNode=Ze,In.appNode=$e,In.operatorNode=et,In.parenNode=tt,In.nameNode=rt,In.cellRefNode=nt,In.badNode=it,In.AnnotationKind=Ae,In.worksheetFuncNameAnnotation=Ye,In.localNameAnnotation=Qe,(An=On||(On={})).SignatureType=q,An.FunctionFlags=X,An.OperatorId=ot,An.WorksheetFuncId=Be,An.SpecialPrecs=J,An.functionType=ae,An.unknownFunctionType=ut,An.getOperatorType=Ct,An.getWorksheetFuncType=Tt,(kn=Nn||(Nn={})).isSheetIndex=yt,kn.isSheetGridRange=At,kn.isGridCell=Ot,kn.isSheetGridCell=Nt,kn.isDocumentLocEqual=Ft,kn.isSheetIndexEqual=bt,kn.isGridCellEqual=Dt,kn.isSheetGridCellEqual=Lt,kn.isWellFormed=It,kn.gridRangeAnchor=Mt,kn.sheetGridRangeAnchor=_t,kn.gridCellRange=wt,kn.getArguments=Bt,kn.getArgType=Wt,kn.isValidArgsLength=Ht,kn.operKind=Kt,kn.ResultKind=Gt,kn.success=Jt,kn.failure=Xt,kn.FailureError=Zt,kn.isSuccess=Yt,kn.ReasonKind=Vt,kn.notImplemented=Qt,kn.unavailable=zt,kn.columnName=er,kn.formatRow=rr,kn.formatCol=nr,kn.formatRowRange=ar,kn.formatColRange=or,kn.formatCellPos=ur,kn.getSubExpressionFromPosition=Ut,kn.getFormulaCharIndexFromPoint=Pt,kn.createResolver=zn,kn.createResolutionHandler=qn,kn.createNameFinder=Jn,kn.defaultLiteralVisitor=Fr,kn.defaultFormulaVisitor=br,kn.dispatch=kr,kn.startVisit=Nr,kn.prettyPrinter=Ur,kn.visitorFailure=_r,kn.noLocaleInfo=wr,(bn=Fn||(Fn={})).LogCategory=c.LogCategory,bn.TraceLevel=c.TraceLevel,bn.localeInfo=rn,bn.localeInfo2=nn,bn.calcConfig=Qr,bn.initCalc=$r,bn.createSimpleLocaleInfo=En,bn.createWorksheetFuncNameCallbacks=gn,bn.isCalcInit=en,bn.getCalcAbsUrl=tn;var Zn,$n=Nn.ReasonKind,ei=Nn.notImplemented;function ti(e){return{config:e}}!function(e){e.BadFormulaString="BadFormulaString"}(Zn||(Zn={}));var ri=d(d({},$n),Zn);function ni(e){return{kind:ri.BadFormulaString,message:e}}function ii(e){return 32===e||10===e}function ai(e,t){var r=t-1;return function(t){if(t<=r){var n=e+": internal error: no progress made at index "+t;return k.ULS.assertTag(595980821,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=t}}function oi(e,t,r){for(var n=t;n<e.length&&r(e[n]);n+=1);return[e.substring(t,n),n]}function ui(e,t,r,n,i){var a=e[t];return r(a)?1:a===n&&t+1<e.length&&i(e[t+1])?2:0}function si(e,t,r,n,i){for(var a=[],o=t,u=t;u<e.length;){var s=ui(e,u,r,n,i);if(0===s)break;2===s&&(o!==u&&a.push(e.substring(o,u)),o=u+1),u+=s}return o!==u&&a.push(e.substring(o,u)),[a.join(""),u]}var ci,li,fi,di,hi=On.OperatorId;function pi(e,t,r){return{kind:e,start:t,chars:r}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(ci||(ci={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(li||(li={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}(fi||(fi={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(di||(di={}));var vi=function(e){return pi(ci.End,e,"")},mi=function(e,t){return pi(ci.Spaces,e,t)},gi=function(e,t){return pi(ci.Unexpected,e,t)},Ei=function(e,t){return pi(ci.Ident,e,t)};function Si(e,t,r,n){return{kind:e,start:t,chars:r,value:n}}var Ci=function(e,t){return Si(ci.Left,e,t,li.Bracket)},Ti=function(e,t){return Si(ci.Left,e,t,li.Brace)},Ri=function(e){return Si(ci.Right,e,")",li.Paren)},yi=function(e,t){return Si(ci.Right,e,t,li.Bracket)},Ii=function(e,t){return Si(ci.Right,e,t,li.Brace)},Oi=function(e){return Si(ci.Right,e,"'",li.SQuote)},Ai=function(e,t){return Si(ci.Sep,e,t,fi.List)},Ni=function(e,t){return Si(ci.Sep,e,t,fi.Col)},ki=function(e,t){return Si(ci.Sep,e,t,fi.Row)},Fi=function(e){return Si(ci.Sep,e,"!",fi.Qual)},bi={"#ALL":function(e,t){return Si(ci.SpecialRef,e,t,di.All)},"#DATA":function(e,t){return Si(ci.SpecialRef,e,t,di.Data)},"#HEADERS":function(e,t){return Si(ci.SpecialRef,e,t,di.Headers)},"#TOTALS":function(e,t){return Si(ci.SpecialRef,e,t,di.Totals)},"#THIS ROW":function(e,t){return Si(ci.SpecialRef,e,t,di.ThisRow)}};function Di(e,t,r,n,i,a,o,u){return{kind:ci.CellRef,start:e,chars:t,row:r,col:n,refStyle:i,isName:a,isNumber:o,isQualPart:u}}function Li(e,t,r,n){void 0===n&&(n=!0);var i="number"==typeof r&&function(e){for(var t=0;t<e.length;t+=1)if("+"===e[t]||"-"===e[t])return!1;return!0}(t);return{kind:ci.Literal,start:e,chars:t,oper:r,hasRight:n,isQualPart:i}}function Mi(e,t,r){return 0===e.stringCompareCI(e.falseName,r)?Li(t,r,!1):0===e.stringCompareCI(e.trueName,r)?Li(t,r,!0):Ei(t,r)}function _i(e){var t=st[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator "+e);return function(r){return{kind:ci.Operator,start:r,chars:t,value:e}}}var wi=_i(hi.Add),Ui=_i(hi.Sub),Pi=_i(hi.Mul),Gi=_i(hi.Div),Vi=_i(hi.Pow),xi=_i(hi.Percent),Bi=_i(hi.Concat),Wi=_i(hi.Eq),Hi=_i(hi.Lt),Ki=_i(hi.Gt),ji=_i(hi.Ne),qi=_i(hi.Le),Ji=_i(hi.Ge),Xi=_i(hi.Range),Yi=(_i(hi.And),_i(hi.Or),_i(hi.Xor),_i(hi.Dot),_i(hi.At)),Qi=_i(hi.Pound);function zi(e,t,r){return r.push(t),t.start+e}var Zi=yn.PosKind,$i=yn.pos,ea=yn.RefStyle,ta=Sn.sheetRows,ra=ta.toString(10).length,na=Sn.sheetCols,ia=na.toString(26).length,aa=na.toString(10).length;function oa(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function ua(e){return e.toUpperCase().charCodeAt(0)-65+1}function sa(e,t,r,n){for(var i=0,a=n,o=Math.min(r.length,n+t);a<o;a+=1){var u=r.charCodeAt(a);if(!e.isNumeral(u))break;i=10*i+e.getOrdinal(u)}return a===o&&a<r.length&&e.isNumeral(r.charCodeAt(a))?[0,n]:[i,a]}function ca(e,t,r){return function(n,i,a,o){var u=function(e,t){return"$"===e[t]?[Zi.Abs,t+1]:[Zi.Rel,t]}(a,o),s=u[0],c=u[1],l=e(n,r,a,c),f=l[0],d=l[1];if(d>c){if(f<1||f>t)return;var h=s===Zi.Rel?f-i:f;return[$i(s,h-1),!1,d]}return[void 0,!1,o]}}function la(e,t,r){return function(n,i,a,o){var u=e?n.rowLetter:n.columnLetter;if(o>=a.length||0!==n.stringCompareCI(u,a[o]))return[void 0,!1,o];var s=o+1,c=sa(n,r,a,s),l=c[0],f=c[1];if(f>s){if(l<1||l>t)return;return[$i(Zi.Abs,l-1),!1,f]}if(a[s]===n.leftBracket){var d=1;"+"===a[s+=1]?s+=1:"-"===a[s]&&(d=-1,s+=1);var h=sa(n,r,a,s),p=h[0],v=h[1];if(v>s&&p<t&&a[v]===n.rightBracket)return[$i(Zi.Rel,p*d),!0,v+1]}return[!1,!1,f]}}function fa(e,t,r,n,i,a,o){var u=n(e,t,a,o);if(null==u)return[void 0,void 0,!1,o];var s=u[0],c=u[1],l=u[2];if(l>o){var f=i(e,r,a,l);if(null==f)return c?[s,void 0,!0,l]:[void 0,void 0,!1,o];var d=f[0],h=f[1],p=f[2];return p>l?[s,d,h,p]:[s,void 0,c,l]}var v=i(e,r,a,o);if(null==v)return[void 0,void 0,!1,o];var m=v[0],g=v[1],E=v[2];return E>o?[void 0,m,g,E]:[void 0,void 0,!1,o]}var da=ca(sa,ta,ra),ha=ca((function(e,t,r,n){return function(e,t,r){for(var n=0,i=r,a=Math.min(t.length,r+e);i<a;i+=1){var o=t[i];if(!oa(o))break;n=26*n+ua(o)}return i===a&&oa(t[i])?[0,r]:[n,i]}(t,r,n)}),na,ia),pa=la(!0,ta,ra),va=la(!1,na,aa);function ma(e,t,r,n,i,a){var o,u,s,c,l,f=function(e,t,r,n,i){if(t===ea.A1&&null!=r){var a=fa(e,r.col,r.row,ha,da,n,i),o=a[0],u=a[1],s=a[2],c=a[3];if((null!=u&&null!=o||null!=u&&u.kind===Zi.Abs||null!=o&&o.kind===Zi.Abs||(null!=u||null!=o)&&(":"===n[i-1]||":"===n[c]))&&(s||c>=n.length||!e.isIdentContinue(n.charCodeAt(c))))return[ea.A1,u,o,c]}var l=fa(e,void 0,void 0,pa,va,n,i),f=l[0],d=l[1],h=l[2],p=l[3];if((null!=f||null!=d)&&(h||p>=n.length||!e.isIdentContinue(n.charCodeAt(p))))return[ea.R1C1,f,d,p]}(e,t,r,n,i);if(null!=f){var d=f[0],h=f[1],p=f[2],v=f[3],m=n.substring(v,i);return zi(v-i,d===ea.A1?function(e,t,r,n){var i=null==r&&null!=n&&n.kind===yn.PosKind.Rel,a=null==n&&null!=r&&r.kind===yn.PosKind.Rel,o=!(null!=r&&r.kind!==yn.PosKind.Rel||null!=n&&n.kind!==yn.PosKind.Rel);return Di(e,t,r,n,yn.RefStyle.A1,i,a,o)}(i,m,h,p):(o=i,u=m,c=p,l=!(!1!==(s=h)&&null!=s&&s.kind!==yn.PosKind.Abs||!1!==c&&null!=c&&c.kind!==yn.PosKind.Abs),Di(o,u,!1===s?yn.pos(yn.PosKind.Rel,0):s,!1===c?yn.pos(yn.PosKind.Rel,0):c,yn.RefStyle.R1C1,!1,!1,l)),a)}}var ga=Tn.numErrorOper,Ea="+-*/^%&=<>:",Sa=!1;function Ca(e){return!Sa&&Ar(Sr.CalcDynamicArrayOperators)&&(Ea+="@#",Sa=!0),Ea.indexOf(e)>=0}var Ta={"+":wi,"-":Ui,"*":Pi,"/":Gi,"^":Vi,"%":xi,"&":Bi,"=":Wi,"<":Hi,">":Ki,":":Xi,"@":Yi,"#":Qi},Ra={"<>":ji,"<=":qi,">=":Ji};function ya(e,t,r){if(t<e.length-1){var n=Ra[e.substr(t,2)];if(null!=n)return zi(2,n(t),r)}var i=Ta[e[t]];if(null!=i)return zi(1,i(t),r);return k.ULS.assertTag(595980822,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function Ia(e,t,r,n){function i(r){var n=r,i=t[n];if("e"!==i&&"E"!==i)return r;if((n+=1)>=t.length)return r;if("+"===(i=t[n])||"-"===i){if((n+=1)>=t.length)return r;i=t[n]}if(!e.isNumeral(i.charCodeAt(0)))return r;for(n+=1;n<t.length&&e.isNumeral(t.charCodeAt(n));n+=1);return n}function a(r,n){var a=r,o=t[a];if(o===e.decimalSeparator){if((a+=1)>=t.length)return n?r:a;o=t[a]}if(!e.isNumeral(o.charCodeAt(0)))return n?r:i(a);for(a+=1;a<t.length;a+=1)if(!e.isNumeral(t.charCodeAt(a)))return i(a);return a}for(var o=r;o<t.length;o+=1)if(!e.isNumeral(t.charCodeAt(o))){o=a(o,o===r);break}if(o>r){var u=t.substring(r,o),s=e.parseNumber(u);return zi(o-r,Li(r,u,jt(s)?s:ga,!0),n),o}}function Oa(e,t,r){var n=si(e,t+1,(function(e){return'"'!==e}),'"',(function(e){return'"'===e})),i=n[0],a=n[1],o=e.substring(t,a+1);return a<e.length?zi(a+1-t,Li(t,o,i,!0),r):zi(a-t,Li(t,o,i,!1),r)}function Aa(e,t,r,n){for(var i=1;i<e.errorNames.length;i+=1){var a=e.errorNames[i];if(void 0!==a){var o=t.substr(r,a.length);if(0===e.stringCompareCI(a,o))return zi(a.length,Li(r,o,ue(i)),n)}}}var Na=Object.getOwnPropertyNames(bi);function ka(e,t,r,n){for(var i=0;i<Na.length;i+=1){var a=Na[i],o=t.substr(r,a.length);if(0===e.stringCompareCI(a,o))return zi(a.length,bi[a](r,o),n)}}function Fa(e,t){return"'"!==t&&"#"!==t&&t!==e.leftBracket&&t!==e.rightBracket}function ba(e,t,r,n){var i=zi(1,Ci(r,t[r]),n);"#"===t[i]&&(null!=(c=ka(e,t,i,n))&&(i=c));for(var a=function(t){return Fa(e,t)},o=function(t){return!Fa(e,t)},u=ai("calc.parse.tokenizeBracketedColRef",i);i<t.length;){u(i);var s=t[i];if(s===e.rightBracket)return zi(1,yi(i,s),n);if(ui(t,i,a,"'",o)>0){var c,l=si(t,i,a,"'",o),f=l[0];i=zi((c=l[1])-i,Ei(i,f),n)}else i=zi(1,gi(i,s),n)}return i}function Da(e,t){return!ii(t.charCodeAt(0))&&"'"!==t&&"#"!==t&&":"!==t&&t!==e.listSeparator&&t!==e.leftBracket&&t!==e.rightBracket}function La(e,t,r,n){var i=zi(1,Ci(r,t[r]),n);"#"===t[i]&&(null!=(f=ka(e,t,i,n))&&(i=f));for(var a=function(t){return Da(e,t)},o=function(t){return!Da(e,t)},u=ai("calc.parse.tokenizeBracketedRef",i);i<t.length;){u(i);var s=t[i];if(s===e.rightBracket)return zi(1,yi(i,s),n);if(ui(t,i,a,"'",o)>0){var c=si(t,i,a,"'",o),l=c[0];i=zi((f=c[1])-i,Ei(i,l),n)}else if(ii(s.charCodeAt(0))){var f,d=oi(t,i,(function(e){return ii(e.charCodeAt(0))}));l=d[0];i=zi((f=d[1])-i,mi(i,l),n)}else i=":"!==s?s!==e.listSeparator?s!==e.leftBracket?zi(1,gi(i,s),n):ba(e,t,i,n):zi(1,Ai(i,s),n):zi(1,Xi(i),n)}return i}var Ma;function _a(e,t,r,n){for(var i,a=zi(1,(i=r,Si(ci.Left,i,"'",li.SQuote)),n),o=function(t){return function(e,t){return"':*?".indexOf(t)<0&&t!==e.leftBracket&&t!==e.rightBracket}(e,t)},u=function(e){return"'"===e},s=ai("calc.parse.tokenizeQuotedQualifier",a);a<t.length;){s(a);var c=t[a];if("'"===c&&"'"!==t[a+1])return zi(1,Oi(a),n);if(":"!==c)if(c!==e.leftBracket)if(ui(t,a,o,"'",u)>0){var l=si(t,a,o,"'",u),f=l[0];a=zi(l[1]-a,Ei(a,f),n)}else a=zi(1,gi(a,c),n);else a=La(e,t,a,n);else a=zi(1,Xi(a),n)}return a}function wa(e,t,r,n){for(var i=e[t],a=t+1;a<e.length;a+=1){var o=e[a];if(o.kind!==r)break;i=n(i,o)}return[i,a]}function Ua(e,t){return gi(e.start,e.chars+t.chars)}function Pa(e,t,r,n,i){for(var a=function(e,t,r,n,i){for(var a,o=[],u=[],s=Ma.Decimal,l=i,f=ai("calc.parse.tokenize",l);l<n.length;){f(l);var d=ma(e,t,r,n,l,o);if(null==d){var h=n[l];if(s===Ma.Decimal&&h===e.decimalSeparator||e.isNumeral(h.charCodeAt(0))){var p=Ia(e,n,l,o);if(null!=p){l=p,s=Ma.FieldAccess;continue}if(h!==e.decimalSeparator){var v="calc.parse.tokenize: failed to tokenize numeral at "+l;return k.ULS.assertTag(595980823,c.LogCategory.msoulscat_ES_EWAJS,!1,v)}}if('"'!==h)if(e.isIdentStart(h.charCodeAt(0))){var m=oi(n,l,(function(t){return e.isIdentContinue(t.charCodeAt(0))})),g=m[0];l=zi(m[1]-l,Mi(e,l,g),o),s=Ma.FieldAccess}else if("#"!==h)if(Ca(h))l=ya(n,l,o),s=Ma.Decimal;else if(ii(h.charCodeAt(0))){var E=oi(n,l,(function(e){return ii(e.charCodeAt(0))}));g=E[0];l=zi(E[1]-l,mi(l,g),o),s=Ma.Decimal}else if("("!==h)if(")"!==h)if(h!==e.leftBrace)if(h!==e.rightBrace)if(h!==e.leftBracket)if(h!==e.rightBracket){if(u.length>0&&u[u.length-1]===li.Brace){if(h===e.columnSeparator){l=zi(1,Ni(l,h),o),s=Ma.Decimal;continue}if(h===e.rowSeparator){l=zi(1,ki(l,h),o),s=Ma.Decimal;continue}}h!==e.listSeparator?"!"!==h?"'"!==h?(l=zi(1,gi(l,h),o),s=Ma.Decimal):(l=_a(e,n,l,o),s=Ma.Decimal):(l=zi(1,Fi(l),o),s=Ma.Decimal):(l=zi(1,Ai(l,h),o),s=Ma.Decimal)}else l=zi(1,yi(l,h),o),s=Ma.FieldAccess;else l=La(e,n,l,o),s=Ma.FieldAccess;else u.length>0&&u[u.length-1]===li.Brace&&u.pop(),l=zi(1,Ii(l,h),o),s=Ma.FieldAccess;else u.push(li.Brace),l=zi(1,Ti(l,h),o),s=Ma.Decimal;else u.length>0&&u[u.length-1]===li.Paren&&u.pop(),l=zi(1,Ri(l),o),s=Ma.FieldAccess;else u.push(li.Paren),l=zi(1,(a=l,Si(ci.Left,a,"(",li.Paren)),o),s=Ma.Decimal;else{var S=Aa(e,n,l,o);if(null!=S){l=S,s=Ma.FieldAccess;continue}Ar(Sr.CalcDynamicArrayOperators)?(l=ya(n,l,o),s=Ma.Decimal):(l=zi(1,gi(l,h),o),s=Ma.Decimal)}else l=Oa(n,l,o),s=Ma.FieldAccess}else l=d,s=Ma.FieldAccess}return o}(e.config.localeInfo,t,r,n,i),o=[],u=0;u<a.length;){var s=a[u];if(s.kind!==ci.Unexpected)o.push(s),u+=1;else{var l=wa(a,u,ci.Unexpected,Ua),f=l[0],d=l[1];o.push(f),u=d}}return o.push(vi(n.length)),o}function Ga(e,t,r,n){var i=void 0;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,n,(function(e,t){i=[e,t]}),(function(){i=!1}))),null==i){var a="calc.parse.runParser: internal error: parser did not call resolve or reject on "+R(t);return k.ULS.assertTag(595980827,c.LogCategory.msoulscat_ES_EWAJS,!1,a)}return i}function Va(e){return function(t,r,n,i,a){return i(e,r)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}(Ma||(Ma={}));var xa,Ba=function(e,t,r,n,i){return i};function Wa(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,n){return t(i,e)(r,n,i,a,o)}),o)}}function Ha(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(function(){return t(r,n,i,a,o)}))}}function Ka(e){return 0===e.length?Ba:e.reduce(Ha)}function ja(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(function(){return a(t,n)}))}}function qa(e,t){return function(r,n,i,a,o){var u=r[n];if(null==u)return o;var s=e(i,u);return null==s?o:a(s,n+t)}}function Ja(e){return qa(e,1)}function Xa(e){return qa(e,0)}function Ya(e){return function(t,r,n,i,a){var o=t[r],u=t[r+1];if(null==o||null==u)return a;var s=e(n,o,u);return null==s?a:i(s,r+1)}}function Qa(e,t,r){return function(n,i,a,o,u){var s=r,l=i;function f(){return e(n,l,a,d,h)}function d(e,r){if(r<=l){var i=R(n),o="calc.parse.reduce: internal error: no progress made at index "+l+" on "+i;return k.ULS.assertTag(595980829,c.LogCategory.msoulscat_ES_EWAJS,!1,o)}return s=t(a,e,s),l=r,f}function h(){return o(s,l)}return f}}function za(e,t){return Qa(e,(function(e,t,r){return r.push(t),r}),t)}function Za(e){return function(t,r,n,i,a){return za(e,[])(t,r,n,i,a)}}function $a(e,t){return Wa(e,(function(e,r){return za(t,[r])}))}function eo(e){var t=e.length;return function(r,n,i,a,o){var u=n,s=[];function c(){return e[s.length](r,u,i,l,o)}function l(e,r){return u=r,s.push(e),s.length<t?c:a(s,u)}return c}}function to(e,t){return eo([e,t])}function ro(e,t,r,n,i){return eo([e,t,r,n,i])}function no(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,r){return a(t(i,e),r)}),o)}}function io(e,t,r){return no(eo([e,t]),(function(e,t){return r(e,t[0],t[1])}))}function ao(e,t,r,n){return no(eo([e,t,r]),(function(e,t){return n(e,t[0],t[1],t[2])}))}function oo(e,t,r,n,i){return no(eo([e,t,r,n]),(function(e,t){return i(e,t[0],t[1],t[2],t[3])}))}function uo(e,t,r,n,i,a){return no(eo([e,t,r,n,i]),(function(e,t){return a(e,t[0],t[1],t[2],t[3],t[4])}))}function so(e,t){return io(e,t,(function(e,t,r){return t}))}function co(e,t){return io(e,t,(function(e,t,r){return r}))}function lo(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+R(t);return k.ULS.assertTag(595980824,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}return r}function fo(e,t,r,n,i){var a=e.label;return e.label+=1,e.spans[a]=yn.formulaSpan(t,r,n,i),a}function ho(e,t,r,n){var i=lo(e,r);return i.pre=t,i.post=n,r}function po(e,t,r){return function(n,i,a,o,u){var s=a.leftDelim,c=a.listSep;return a.leftDelim=e,a.listSep=t,r(n,i,a,(function(e,t){return a.leftDelim=s,a.listSep=c,o(e,t)}),(function(){return a.leftDelim=s,a.listSep=c,u}))}}function vo(e,t){return t.kind===ci.Spaces||t.kind===ci.End?t.start:lo(e,t).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(xa||(xa={}));var mo=ja(Ja((function(e,t){return t.kind===ci.Spaces?t.chars:void 0})),""),go=function(e,t,r,n,i){var a=e[t];if(null==a){var o="calc.parse.pStart: internal error: expected term at "+t+" in "+R(e);return k.ULS.assertTag(595980864,c.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(vo(r,a),t)};function Eo(e){return ao(mo,Ja(e),mo,ho)}function So(e){return io(mo,Ja(e),(function(e,t,r){return ho(e,t,r,"")}))}function Co(e){return io(Ja(e),mo,(function(e,t,r){return ho(e,"",t,r)}))}var To=Eo((function(e,t){return t.kind!==yn.NodeKind.Operator||t.id!==On.OperatorId.Add&&t.id!==On.OperatorId.Sub?void 0:t})),Ro=Co((function(e,t){if(t.kind===yn.NodeKind.Operator){if(t.id===On.OperatorId.Add)return yn.operatorNode(On.OperatorId.Pos,t.label);if(t.id===On.OperatorId.Sub)return yn.operatorNode(On.OperatorId.Neg,t.label)}})),yo=Co((function(e,t){if(t.kind===yn.NodeKind.Operator&&t.id===On.OperatorId.At)return yn.operatorNode(On.OperatorId.At,t.label)})),Io=So((function(e,t){return t.kind===yn.NodeKind.Operator&&t.id===On.OperatorId.Pound?t:void 0})),Oo=Eo((function(e,t){return t.kind!==yn.NodeKind.Operator||t.id!==On.OperatorId.Mul&&t.id!==On.OperatorId.Div?void 0:t})),Ao=Eo((function(e,t){return t.kind===yn.NodeKind.Operator&&t.id===On.OperatorId.Pow?t:void 0})),No=So((function(e,t){return t.kind===yn.NodeKind.Operator&&t.id===On.OperatorId.Percent?t:void 0})),ko=Eo((function(e,t){return t.kind===yn.NodeKind.Operator&&t.id===On.OperatorId.Concat?t:void 0})),Fo=Eo((function(e,t){return t.kind===yn.NodeKind.Operator&&t.id>=On.OperatorId.Eq&&t.id<=On.OperatorId.Ge?t:void 0})),bo=Eo((function(e,t){return t.kind===yn.NodeKind.Operator&&t.id===On.OperatorId.Range?t:void 0})),Do=Eo((function(e,t){return t.kind===yn.NodeKind.Operator&&t.id===On.OperatorId.Union?t:void 0})),Lo=Ya((function(e,t,r){if(t.kind===ci.Spaces&&r.kind!==ci.End&&r.kind!==yn.NodeKind.Operator){var n=fo(e,t.start,vo(e,r),t.chars,"");return yn.operatorNode(On.OperatorId.Isect,n)}}));function Mo(e,t,r){return io(e,Za(to(t,e)),(function(e,t,n){return 0===n.length?t:n.reduce(r(e),t)}))}function _o(e,t,r){return io(Za(t),e,(function(e,t,n){return 0===t.length?n:t.reduceRight(r(e),n)}))}function wo(e,t,r){return io(e,Za(t),(function(e,t,n){return 0===n.length?t:n.reduce(r(e),t)}))}function Uo(e){return function(t,r){var n=r[0],i=r[1],a=lo(e,t).start,o=lo(e,i).end,u=fo(e,a,o,"","");return yn.appNode(n,[t,i],!0,u)}}function Po(e){return function(t,r){var n=lo(e,t).start,i=lo(e,r).end,a=fo(e,n,i,"","");return yn.appNode(r,[t],!0,a)}}function Go(e){var t=!0;return function(r,n){var i=lo(e,n).start,a=lo(e,r).end,o=fo(e,i,a,"","");if(t&&(t=!1,r.kind===yn.NodeKind.Literal&&"number"==typeof r.oper)){var u=n.id===On.OperatorId.Pos?r.oper:-r.oper;return yn.literalNode(u,!0,o)}return yn.appNode(n,[r],!0,o)}}function Vo(e){return function(t,r){var n=lo(e,r).start,i=lo(e,t).end,a=fo(e,n,i,"","");return yn.appNode(r,[t],!0,a)}}var xo,Bo,Wo,Ho,Ko,jo,qo,Jo,Xo,Yo,Qo,zo,Zo,$o,eu=Ja((function(e,t){return t.kind!==yn.NodeKind.Operator&&t.kind!==ci.Spaces&&t.kind!==ci.End?t:void 0}));function tu(e,t){var r=fo(e,lo(e,t[0]).start,lo(e,t[t.length-1]).end,"","");return yn.badNode(yn.BadType.Sequence,t,r)}var ru=!1;function nu(e,t){ru||(Ar(Sr.CalcDynamicArrayOperators)?(xo=io(go,Za(eu),(function(e,t,r){return 0===r.length?yn.literalNode(Tn.missingOper,!0,fo(e,t,t,"","")):1===r.length?r[0]:tu(e,r)})),Bo=wo(xo,Io,Po),Wo=Mo(Bo,bo,Uo),Ho=Mo(Wo,Lo,Uo),Ko=_o(Ho,yo,Vo),jo=Mo(Ko,Do,Uo),qo=_o(jo,Ro,Go),Jo=wo(qo,No,Po),Xo=Mo(Jo,Ao,Uo),Yo=Mo(Xo,Oo,Uo),Qo=Mo(Yo,To,Uo),zo=Mo(Qo,ko,Uo),Zo=Mo(zo,Fo,Uo)):(Wo=io(go,Za(eu),(function(e,t,r){return 0===r.length?yn.literalNode(Tn.missingOper,!0,fo(e,t,t,"","")):1===r.length?r[0]:tu(e,r)})),Ho=Mo(Wo,bo,Uo),Ko=Mo(Ho,Lo,Uo),jo=Mo(Ko,Do,Uo),qo=_o(jo,Ro,Go),Jo=wo(qo,No,Po),Xo=Mo(Jo,Ao,Uo),Yo=Mo(Xo,Oo,Uo),Qo=Mo(Yo,To,Uo),zo=Mo(Qo,ko,Uo),Zo=Mo(zo,Fo,Uo)),$o=io(Zo,Za(co(Xa((function(e,t){return t.kind===ci.End?void 0:t})),Zo)),(function(e,t,r){return 0===r.length?t:tu(e,[t].concat(r))})),ru=!0);var r=e.length-1;if(r<0){var n="calc.parse.parseTerms: internal error: expected at least 1 term";return k.ULS.assertTag(595980865,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[0].kind===ci.Spaces){n="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+R(e);return k.ULS.assertTag(595980866,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(r-1>=0&&e[r-1].kind===ci.Spaces){n="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+R(e);return k.ULS.assertTag(595980867,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(e[r].kind!==ci.End){n="calc.parse.parseTerms: internal error: array[n].kind !== End in "+R(e);return k.ULS.assertTag(595980868,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i=Ga($o,e,0,t);if(!1===i){n="calc.parse.parseTerms: internal error: failed to parse "+R(e);return k.ULS.assertTag(595980869,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=i[0],o=i[1];if(o<r){n="calc.parse.parseTerms: internal error: consumed "+o+" out of "+r+" in "+R(e);return k.ULS.assertTag(595980870,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}return a}var iu=ja(Ja((function(e,t){return t.kind===ci.Spaces?t.chars:void 0})),""),au=function(e,t,r,n,i){var a=e[t];if(null==a){var o="calc.parse.pStart: internal error: expected token at "+t+" in "+R(e);return k.ULS.assertTag(595980830,c.LogCategory.msoulscat_ES_EWAJS,!1,o)}return n(a.start,t)};function ou(e){return Ja((function(t,r){return r.kind===ci.Sep&&r.value===e||void 0}))}function uu(e){return Ja((function(t,r){return r.kind===ci.Left&&r.value===e?r.start:void 0}))}function su(e){return Ja((function(t,r){return r.kind===ci.Right&&r.value===e||void 0}))}var cu,lu=ou(fi.List),fu=ou(fi.Row),du=ou(fi.Col),hu=ou(fi.Qual),pu=uu(li.Paren),vu=su(li.Paren),mu=uu(li.Brace),gu=su(li.Brace),Eu=uu(li.SQuote),Su=su(li.SQuote),Cu=Ja((function(e,t){return t.kind===ci.Operator&&t.value===On.OperatorId.Range||void 0})),Tu=cu={impl:function(e,t,r,n,i){return k.ULS.assertTag(595980828,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(e,t,r,n,i){return function(){return cu.impl(e,t,r,n,i)}}},Ru=ao(iu,Tu.parser,iu,ho),yu=oo(pu,po(li.Paren,xa.Union,Ru),ja(vu,!1),au,(function(e,t,r,n,i){var a=fo(e,t,i,"","");return yn.parenNode(r,n,a)})),Iu=$a(Ru,co(du,Ru)),Ou=$a(Iu,co(fu,Iu)),Au=oo(mu,po(li.Brace,xa.Union,Ou),ja(gu,!1),au,(function(e,t,r,n,i){var a=fo(e,t,i,"","");return yn.arrayNode(r,n,a)})),Nu=Ja((function(e,t){if(t.kind===ci.Ident||t.kind===ci.CellRef&&t.isQualPart||t.kind===ci.Literal&&t.isQualPart||t.kind===ci.Operator&&t.value===On.OperatorId.Dot)return t.chars})),ku=$a(Nu,Nu),Fu=Ja((function(e,t){return t.kind===ci.Ident?t.chars:void 0}));function bu(e){return e.kind===ci.Literal&&"object"==typeof e.oper&&e.oper.kind===Tn.OperKind.Error&&e.oper.type===Tn.ErrorType.REF}function Du(e,t,r,n){return null==t?[yn.identQualifier(e,r,n),r?"'"+e+"'":e]:[yn.sheetRangeQualifier(e,t,r,n),r?"'"+e+":"+t+"'":e+":"+t]}var Lu=oo(au,ku,ja(co(Cu,ku),void 0),au,(function(e,t,r,n,i){var a=fo(e,t,i,"","");return Du(r.join(""),null!=n?n.join(""):void 0,!1,a)})),Mu=uo(Eu,Fu,ja(co(Cu,Fu),void 0),Su,au,(function(e,t,r,n,i,a){return Du(r,n,!0,fo(e,t,a,"",""))})),_u=oo(Eu,Za(Ja((function(e,t){return t.kind===ci.End||t.kind===ci.Right&&t.value===li.SQuote?void 0:t.chars}))),ja(to(Su,ja(so(hu,iu),!1)),[!1,!1]),au,(function(e,t,r,n,i){var a=n[0],o=n[1],u="'"+r.join("")+(a?"'":"")+(o?"!":""),s=fo(e,t,i,"","");return[yn.badNode(yn.BadType.Qualifier,u,s),u]})),wu=Ya((function(e,t,r){if(bu(t)){var n=fo(e,t.start,r.start,"","");return[yn.errorQualifierLabeled(n),t.chars]}})),Uu=io(Ka([Lu,Mu,Xa((function(e,t){var r=fo(e,t.start,t.start,"","");return[yn.relativeQualifierLabeled(r),""]}))]),so(hu,iu),(function(e,t,r){return[t[0],t[1]+"!"]})),Pu=Ka([wu,Uu,_u]);function Gu(e,t){return t.kind===ci.CellRef&&e.refStyle===t.refStyle}var Vu=Ya((function(e,t,r){return Gu(e,t)?[t,r.start]:void 0}));function xu(e,t){if(null!=e.row&&null!=e.col)return yn.cellRefSingle(e.row,e.col,t);if(null!=e.row)return yn.cellRefRow(e.row,e.row,t);if(null!=e.col)return yn.cellRefCol(e.col,e.col,t);var r="calc.parse.cellRefToken2cellRef: bad token "+R(e);return k.ULS.assertTag(595980831,c.LogCategory.msoulscat_ES_EWAJS,!1,r)}var Bu=Ya((function(e,t,r){if(Gu(e,t)&&(t.refStyle!==yn.RefStyle.A1||null!=t.row&&null!=t.col))return xu(t,n=fo(e,t.start,r.start,"",""));if(bu(t)){var n=fo(e,t.start,r.start,"","");return yn.cellRefErrorLabeled(n)}})),Wu=Ha(Wa(ro(Vu,iu,Cu,iu,Vu),(function(e,t){var r=t[0],n=r[0],i=r[1],a=t[1],o=(t[2],t[3]),u=t[4],s=u[0],c=u[1],l=fo(e,n.start,i,"",a),f=fo(e,s.start,c,o,""),d=xu(n,l),h=xu(s,f),p=void 0;if(d.kind===yn.CellRefKind.Single&&h.kind===yn.CellRefKind.Single){var v=fo(e,n.start,c,"","");p=yn.cellRefRange(d,h,v)}else if(0===a.length&&0===o.length)if(d.kind===yn.CellRefKind.Row&&h.kind===yn.CellRefKind.Row){v=fo(e,n.start,c,"","");p=yn.cellRefRow(d.row1,h.row1,v)}else if(d.kind===yn.CellRefKind.Col&&h.kind===yn.CellRefKind.Col){v=fo(e,n.start,c,"","");p=yn.cellRefCol(d.col1,h.col1,v)}return null==p?Ba:n.isQualPart&&s.isQualPart?Xa((function(e,t){return t.kind===ci.Sep&&t.value===fi.Qual?void 0:p})):Va(p)})),Bu),Hu=Ja((function(e,t){return t.kind===ci.Ident||t.kind===ci.CellRef&&t.isName?t.chars:void 0})),Ku=Wa(ro(au,Pu,au,ja(Ha(Wu,Hu),void 0),au),(function(e,t){var r=t[0],n=t[1],i=n[0],a=n[1],o=t[2],u=t[3],s=t[4];if(null==u)return i.kind!==yn.QualifierKind.SheetRange||i.isQuoted?i.kind===yn.QualifierKind.Error?Va(yn.literalNode(Tn.refErrorOper,!0,i.label)):Va(i.kind===yn.NodeKind.Bad?i:yn.badNode(yn.BadType.Qualifier,a,i.label)):Ba;if("string"==typeof u){if(i.kind===yn.QualifierKind.SheetRange&&!i.isQuoted)return Ba;var c=fo(e,r,s,"","");if(i.kind===yn.NodeKind.Bad||i.kind===yn.QualifierKind.Error||i.kind===yn.QualifierKind.SheetRange){var l=i.kind===yn.NodeKind.Bad?i:yn.badNode(yn.BadType.Qualifier,a,i.label),f=yn.nameNode(u,void 0,fo(e,o,s,"",""));return Va(yn.badNode(yn.BadType.Sequence,[l,f],c))}return Va(yn.nameNode(u,i,c))}var d=fo(e,r,s,"","");if(i.kind===yn.NodeKind.Bad||i.kind===yn.QualifierKind.Document){var h=i.kind===yn.NodeKind.Bad?i:yn.badNode(yn.BadType.Qualifier,a,i.label);f=yn.cellRefNode(u,void 0,fo(e,o,s,"",""));return Va(yn.badNode(yn.BadType.Sequence,[h,f],d))}var p=i.kind===yn.QualifierKind.Ident?yn.sheetQualifier(i.name,void 0,i.isQuoted,i.label):i;return Va(yn.cellRefNode(u,p,d))})),ju=ao(au,Ha(Wu,Hu),au,(function(e,t,r,n){var i=fo(e,t,n,"","");return"string"==typeof r?yn.nameNode(r,void 0,i):r.kind===yn.CellRefKind.Error?yn.literalNode(Tn.refErrorOper,!0,i):yn.cellRefNode(r,void 0,i)})),qu=Ya((function(e,t,r){if(t.kind===ci.Literal)return yn.literalNode(t.oper,t.hasRight,fo(e,t.start,r.start,"",""));if(t.kind===ci.CellRef&&t.isNumber&&"object"==typeof t.row&&null!=e.range){var n=t.row.index+e.range.row+1;return yn.literalNode(n,!0,fo(e,t.start,r.start,"",""))}}));function Ju(e){return Ya((function(t,r,n){if(e(r)){var i=fo(t,r.start,n.start,"","");return yn.badNode(yn.BadType.Unexpected,r.chars,i)}}))}var Xu=Ju((function(e){return e.kind===ci.Left&&e.value===li.Bracket})),Yu=Ju((function(e){return e.kind===ci.Right&&e.value===li.Bracket})),Qu=uo(au,Xu,po(li.Bracket,xa.Union,Ru),ja(Yu,void 0),au,(function(e,t,r,n,i,a){var o=[r,n];null!=i&&o.push(i);var u=fo(e,t,a,"","");return yn.badNode(yn.BadType.Sequence,o,u)})),zu=Ya((function(e,t,r){switch(t.kind){case ci.End:case ci.Operator:case ci.Spaces:return;case ci.Sep:if(t.value!==fi.Qual&&(e.leftDelim===li.Brace||t.value!==fi.Col&&t.value!==fi.Row))return;break;case ci.Right:if(t.value===e.leftDelim)return}var n=t.kind===ci.CellRef?yn.BadType.CellRef:yn.BadType.Unexpected,i=fo(e,t.start,r.start,"","");return yn.badNode(n,t.chars,i)})),Zu=Ya((function(e,t,r){if((t.kind===ci.Ident||t.kind===ci.CellRef||t.kind===ci.Literal&&"boolean"==typeof t.oper)&&r.kind===ci.Left&&r.value===li.Paren&&null!=e.localeInfo.getWorksheetFuncId(t.chars)){var n=fo(e,t.start,r.start,"","");return yn.nameNode(t.chars,void 0,n)}})),$u=oo(pu,po(li.Paren,xa.Arg,$a(Ru,co(lu,Ru))),ja(vu,!1),au,(function(e,t,r,n,i){return[r,n,i]})),es=io(Zu,$u,(function(e,t,r){var n=r[0],i=r[1],a=r[2],o=fo(e,lo(e,t).start,a,"","");return yn.appNode(t,n,i,o)})),ts=io(Ka([es,Ku,ju,qu,yu,Au,Qu,zu]),Za($u),(function(e,t,r){var n=lo(e,t).start;return r.reduce((function(t,r){var i=r[0],a=r[1],o=r[2],u=fo(e,n,o,"","");return yn.appNode(t,i,a,u)}),t)})),rs=Ya((function(e,t,r){var n=void 0;if(t.kind===ci.Operator&&(n=t.value),t.kind===ci.Sep&&t.value===fi.List&&e.listSep===xa.Union&&(n=On.OperatorId.Union),null!=n){var i=fo(e,t.start,r.start,"","");return yn.operatorNode(n,i)}})),ns=Ja((function(e,t){return t.kind===ci.Spaces?t:void 0})),is=Ha(ts,rs),as=Wa(is,(function(e,t){return Qa(to(ja(ns,void 0),is),(function(e,t,r){var n=t[0],i=t[1];return null!=n&&r.push(n),r.push(i),r}),[t])})),os=io(ja(as,void 0),au,(function(e,t,r){if(null==t){var n=fo(e,r,r,"","");return yn.literalNode(Tn.missingOper,!0,n)}if(1===t.length){var i=t[0];if(i.kind!==yn.NodeKind.Operator&&i.kind!==ci.Spaces)return i}return t.push(vi(r)),nu(t,e)}));function us(e,t,r,n,i){var a=i.length-1;if(a<0){var o="calc.parse.parseTokens: internal error: expected at least 1 token";return k.ULS.assertTag(595980832,c.LogCategory.msoulscat_ES_EWAJS,!1,o)}if(i[a].kind!==ci.End){o="calc.parse.parseTokens: internal error: array[n] !== End in "+R(i);return k.ULS.assertTag(595980833,c.LogCategory.msoulscat_ES_EWAJS,!1,o)}var u=function(e,t,r,n){return{localeInfo:e,refStyle:t,range:r,source:n,leftDelim:void 0,listSep:xa.Union,label:1,spans:[]}}(e.config.localeInfo,t,r,n),s=Ga(Ru,i,0,u);if(!1===s){o="calc.parse.parseTokens: internal error: failed to parse "+R(i);return k.ULS.assertTag(595980834,c.LogCategory.msoulscat_ES_EWAJS,!1,o)}var l=s[0],f=s[1];if(f<a){o="calc.parse.parseTokens: internal error: consumed "+f+" out of "+a+" in "+R(i);return k.ULS.assertTag(595980835,c.LogCategory.msoulscat_ES_EWAJS,!1,o)}return yn.formula(l,u.spans)}Tu.impl=os;var ss={"=":1,"+":0,"-":0,"@":-1};function cs(e){return{parseFormula:function(t,r,n,i){return function(e,t,r,n,i){var a=i[0],o=null!=a?ss[a]:void 0;if(null==o)return Nn.failure(ni("first character is not '=', '+', '-' or '@'"));if(o<0)return Nn.failure(ei(["Lotus 1-2-3 syntax"]));if(t===yn.RefStyle.A1&&null==r){return k.ULS.assertTag(595980825,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: in A1 style, expected range to be defined")}var u=us(e,t,r,n,Pa(e,t,r,i,o));return Nn.success(u)}(e,t,function(e){return void 0===e||void 0===e.range}(r)?r:r.range,n,i)},formatFormula:function(t,r,n,i){return Nn.prettyPrinter(i.node,e.config.localeInfo,r,t,n)}}}var ls=yn.QualifierKind,fs=yn.CellRefKind,ds=yn.NodeKind,hs=Nn.ResultKind;function ps(e){return e.kind===hs.Success}function vs(e,t){var r=e[t];return null==r?D("ParseResultHelper.getFormulaSpan: expected span for label "+t+" to be defined"):r}function ms(e,t,r){return!!ps(e)&&(function(e,t,r){if(null==e||null==r)return;var n={};null!=t?t.forEach((function(e){n[e]=!0})):n["*"]=!0;var i=[];i.push(e.node);for(;i.length>0;){var a=i.pop();if(null!=a)switch(a.kind){case ds.Literal:s("literal")&&r("literal",{label:a.label,value:a});break;case ds.Array:a.nodes.map((function(e){return e.map((function(e){i.push(e)}))}));break;case ds.App:if("object"!=typeof a.head)s("literal")&&r("literal",{label:a.label,value:a.head});else{var o=a.head;switch(o.kind){case ds.Operator:s("operator")&&r("operator",{label:a.label,value:o.id});break;case ds.Name:s("function")&&r("function",{label:a.label,name:o.whole,isClosed:a.isClosed,args:a.args});break;default:i.push(o)}}a.args.map((function(e){i.push(e)}));break;case ds.Paren:i.push(a.node);break;case ds.Name:if(s("namedRange")){var u=a.whole.split(".");r("namedRange",{label:a.label,name:u[0],names:u.slice(1),qualifier:c(a)})}break;case ds.CellRef:s("range")&&l(a);break;case ds.Bad:break;default:return b("calc.parse.traverseFormula",a)}}function s(e){return n[e]||n["*"]}function c(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case ls.Sheet:var r=e.qualifier;t.type=ls.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case ls.SheetRange:var n=e.qualifier;t.type=ls.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case ls.Ident:var i=e.qualifier;t.type=ls.Ident,t.name=i.name;break;case ls.Document:var a=e.qualifier;t.document=a.document,null!=a.path&&(t.documentPath=a.path)}return t}}function l(t){if(null!=e&&null!=r)switch(t.ref.kind){case fs.Error:break;case fs.Col:var n=t.ref;r("range",{label:t.label,type:"col",startIndex:n.col1,endIndex:n.col2,span:vs(e.spans,n.label),qualifier:c(t)});break;case fs.Row:var i=t.ref;r("range",{label:t.label,type:"row",startIndex:i.row1,endIndex:i.row2,span:vs(e.spans,i.label),qualifier:c(t)});break;case fs.Single:var a=t.ref;r("range",{label:t.label,type:"cell",row:a.row,col:a.col,span:vs(e.spans,a.label),qualifier:c(t)});break;case fs.Range:var o=t.ref;r("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:vs(e.spans,o.ref1.label),bottomRightSpan:vs(e.spans,o.ref2.label),qualifier:c(t)})}}}(e.value,t,r),!0)}var gs={isSuccess:ps,traverse:ms,extractReferences:function(e){if(ps(e)){var t=[];return ms(e,["range","namedRange"],(function(r,n){var i={kind:r,ref:n,span:vs(e.value.spans,n.label)};t.push(i)})),t.sort((function(e,t){return e.span.start-t.span.start})),t}}};var Es,Ss,Cs=Nn.ReasonKind,Ts=Nn.FailureError;!function(e){e[e.General=0]="General",e[e.CurrencyDec=11]="CurrencyDec",e[e.CoCurrencyDec=12]="CoCurrencyDec",e[e.Percentage0=13]="Percentage0",e[e.Percentage=14]="Percentage",e[e.MMDDYY=19]="MMDDYY",e[e.HHMMAP=23]="HHMMAP",e[e.MDYHMS=27]="MDYHMS",e[e.AbsHMMSS=31]="AbsHMMSS"}(Es||(Es={})),function(e){e.BadOperation="BadOperation",e.BadFormula="BadFormula",e.JavaScriptError="JavaScriptError"}(Ss||(Ss={}));var Rs,ys=d(d({},Cs),Ss),Is=Ts;function Os(e,t,r,n,i){return{config:e,getDocumentLoc:t,getSheetIndex:r,getCellFormat:n,getKnownFormat:i}}!function(e){e[e.SyntaxError=0]="SyntaxError",e[e.TypeError=1]="TypeError"}(Rs||(Rs={}));var As={Unclosed_expression:{code:1,category:Rs.SyntaxError},Illegal_array_literal_element:{code:2,category:Rs.SyntaxError},Empty_array_literal:{code:3,category:Rs.SyntaxError},Irregular_array_shape:{code:4,category:Rs.SyntaxError},Empty_parenthesis:{code:5,category:Rs.SyntaxError},Missing_operation_argument:{code:6,category:Rs.SyntaxError},Bad_node:{code:7,category:Rs.SyntaxError},Invalid_binder:{code:8,category:Rs.SyntaxError},Empty_formula:{code:9,category:Rs.SyntaxError},Invalid_rel_sheet_qualifier_in_cell:{code:10,category:Rs.SyntaxError},Types_not_related:{code:1001,category:Rs.TypeError},Unexpected_application_head:{code:1002,category:Rs.TypeError},Unexpected_application_head_with_fix:{code:1003,category:Rs.TypeError},Incorrect_number_of_operator_arguments:{code:1004,category:Rs.TypeError},Excess_function_arguments:{code:1005,category:Rs.TypeError},Insufficient_function_arguments:{code:1006,category:Rs.TypeError}},Ns=yn.NodeKind,ks=yn.QualifierKind,Fs=yn.BadType,bs=yn.CellRefKind,Ds=Sn.FormulaSource,Ls=Tn.OperKind,Ms=Tn.ErrorType,_s=On.SignatureType,ws=On.SpecialPrecs,Us=On.getOperatorType,Ps=On.WorksheetFuncId,Gs=On.getWorksheetFuncType,Vs=Nn.operKind,xs=Nn.getArguments,Bs=Nn.getArgType,Ws=Nn.defaultLiteralVisitor,Hs=Nn.defaultFormulaVisitor,Ks=Nn.dispatch,js=Nn.startVisit,qs={};function Js(e,t){return{context:e,result:t}}function Xs(e){return function(t){return t.kind===Ns.Literal&&e(t.oper)}}var Ys=Xs((function(e){return Vs(e)===Ls.Missing})),Qs=Xs((function(e){return Vs(e)===Ls.Error&&e.type===Ms.REF})),zs=Xs((function(e){return 0!=(Vs(e)&(Ls.String|Ls.Error|Ls.Boolean))}));function Zs(e){return e.kind===Ns.Name&&void 0===e.qualifier}function $s(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function ec(e,t){return t!==Ls.Range||0!=(e&Ls.Range)}function tc(e,t){if(t.kind===Ns.Literal)switch($s(e,t,As.Unclosed_expression,t.isClosed),Vs(t.oper)){case Ls.Number:case Ls.Boolean:case Ls.String:case Ls.Error:return;default:return void $s(e,t,As.Illegal_array_literal_element)}$s(e,t,As.Illegal_array_literal_element)}function rc(e,t,r){$s(e,t,As.Types_not_related,ec(Ls.Array,r)),$s(e,t,As.Unclosed_expression,t.isClosed);var n=t.nodes.length>0;if($s(e,t,As.Empty_array_literal,n),!n)return Js(e,r);for(var i=t.nodes[0].length,a=0;a<t.nodes.length;a+=1){var o=t.nodes[a],u=o.length;$s(e,t,As.Irregular_array_shape,u===i);for(var s=0;s<u;s+=1)tc(e,o[s])}return Js(e,r)}function nc(e,t,r){if(e.earlyExit&&!e.isOk())throw qs;switch(t.kind){case Ns.Array:return rc(e,t,r);case Ns.Paren:return $s(e,t,As.Unclosed_expression,t.isClosed),$s(e,t,As.Empty_parenthesis,!Ys(t.node)),nc(e,t.node,r);case Ns.Bad:case Ns.Name:case Ns.CellRef:case Ns.App:case Ns.Literal:var n=oc(e,t);return $s(e,t,As.Types_not_related,ec(n.result,r)),n.result=r,n;default:return b("calc.analyze.checker.check: unhandled formula case",t)}}function ic(e,t,r){var n=Gs(t),i=r.args,a=i.length,o=xs(r),u=o.length,s=e.isOk();u<n.minArgs&&$s(e,void 0===(c=i[a-1])?r:c,As.Insufficient_function_arguments);0===n.restTypes.length&&u>n.headTypes.length&&$s(e,void 0===(c=i[a-1])?r:c,As.Excess_function_arguments);if(n.restTypes.length>1&&t!==Ps.SWITCH){var c,l=u-n.headTypes.length;if(l>0&&l%n.restTypes.length!=0)$s(e,void 0===(c=i[a-1])?r:c,As.Insufficient_function_arguments)}for(var f=0;f<u;f+=1)nc(e,o[f],Bs(n,f));var d=!s||e.isOk();return d&&(e.specialDependencies|=n.staticPrecs,function(e,t,r){switch(t){case Ps.LET:var n=r[0];return void 0!==n?$s(e,n,As.Invalid_binder,Zs(n)):b("calc.anaylze.checker.applySpecificWorksheetFunctionChecks: undefined binder",n);case Ps.FUN:for(var i=0;i<r.length-1;i+=1){var a=r[i];$s(e,a,As.Invalid_binder,Zs(a))}}}(e,t,i)),Js(e,d?n.returnType:_s.All)}function ac(e,t){$s(e,t,As.Unclosed_expression,t.isClosed);var r=t.args;if(t.head.kind===Ns.Operator)return function(e,t,r){var n=Us(t.id),i=r.length,a=i===n.minArgs;$s(e,t,As.Incorrect_number_of_operator_arguments,a);for(var o=0;o<i;o+=1){var u=r[o];Ys(u)&&(a=!1,$s(e,u,As.Missing_operation_argument)),nc(e,u,Bs(n,o))}return a?(e.specialDependencies|=n.staticPrecs,Js(e,n.returnType)):Js(e,_s.All)}(e,t.head,r);if(Zs(t.head)){var n=e.globals.config.localeInfo.getWorksheetFuncId(t.head.whole);if(void 0!==n)return ic(e,n,t)}for(var i=0;i<r.length;i+=1)nc(e,r[i],_s.All);var a=t.head,o=oc(e,a);return ec(o.result,Ls.Range)||o.result===Ls.Error&&function(e){for(var t=e;t.kind===Ns.Paren;)t=t.node;return Qs(t)}(a)||$s(e,a,zs(a)||a.kind===Ns.Array?As.Unexpected_application_head:As.Unexpected_application_head_with_fix),Js(e,_s.All)}function oc(e,t){if(e.earlyExit&&!e.isOk())throw qs;switch(t.kind){case Ns.App:return ac(e,t);case Ns.Array:return rc(e,t,Ls.Array);case Ns.Bad:return $s(e,t,As.Bad_node),Js(e,_s.All);case Ns.CellRef:return e.source!==Ds.Cell&&e.source!==Ds.Range||void 0===t.qualifier||t.qualifier.kind!==ks.Relative?Js(e,Ls.Range):($s(e,t,As.Invalid_rel_sheet_qualifier_in_cell),Js(e,_s.All));case Ns.Literal:return $s(e,t,As.Unclosed_expression,t.isClosed),Js(e,Vs(t.oper));case Ns.Name:return Js(e,_s.All);case Ns.Paren:return $s(e,t,As.Unclosed_expression,t.isClosed),$s(e,t,As.Empty_parenthesis,!Ys(t.node)),oc(e,t.node);default:return b("calc.analyze.checker.infer: unhandled formula case",t)}}var uc={ok:!0,isOk:cr,collect:function(e,t,r){return!1}};function sc(e,t,r,n,i){void 0===i&&(i=!0);var a={globals:e,location:t,source:r,reportError:n.collect,isOk:function(){return n.isOk(a.errorData)},earlyExit:i,specialDependencies:ws.None,errorData:n.ok};return a}function cc(e,t){try{return $s(e,t.node,As.Empty_formula,!Ys(t.node)),nc(e,t.node,_s.All)}catch(t){return t!==qs&&k.ULS.traceTag(595952020,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.check.runChecker: Exception "+R(t)),Js(e,_s.All)}}function lc(e,t){if(t.kind!==Ns.Bad||t.type!==Fs.Sequence||3!==t.contents.length)return!1;var r=t.contents[0],n=t.contents[2];return r.kind===Ns.Bad&&r.type===Fs.Unexpected&&r.contents===e.leftBracket&&(n.kind===Ns.Bad&&n.type===Fs.Unexpected&&n.contents===e.rightBracket)}function fc(e,t){if(2===t.length){var r,n=t[0],i=t[1];return lc(e,n)?(r=i).kind===Ns.Name&&null!=r.qualifier&&r.qualifier.kind===ks.Ident?Ns.Name:function(e){return e.kind===Ns.CellRef&&null!=e.qualifier&&e.qualifier.kind===ks.Sheet&&null==e.qualifier.document}(i)?Ns.CellRef:void 0:function(e,t){return t.kind===Ns.Bad&&t.type===Fs.Qualifier&&t.contents.indexOf(e.leftBracket)>=0}(e,n)?Zs(i)?Ns.Name:function(e){return e.kind===Ns.CellRef&&null==e.qualifier}(i)?Ns.CellRef:void 0:void 0}}function dc(e){if(e.kind===Ns.Literal&&e.isClosed)switch(Vs(e.oper)){case Ls.Number:case Ls.Boolean:case Ls.String:case Ls.Error:return!0;default:return!1}return!1}function hc(e,t){var r=t.head,n=r.kind!==Ns.Operator;if(!t.isClosed||t.args.some((function(t){return!pc(e,t,n)})))return!1;if(r.kind===Ns.Operator)return(a=Us(r.id)).minArgs===t.args.length;if(!pc(e,r,!1))return!1;if(Zs(r)){var i=e.config.localeInfo.getWorksheetFuncId(r.whole);if(void 0!==i){var a=Gs(i),o=xs(t).length;if(o<a.minArgs)return!1;if(0===a.restTypes.length&&o>a.headTypes.length)return!1;if(a.restTypes.length>1&&i!==Ps.SWITCH){var u=o-a.headTypes.length;if(u>0&&u%a.restTypes.length!=0)return!1}return function(e,t){switch(e){case Ps.LET:return Zs(t[0]);case Ps.FUN:return t.slice(0,t.length-1).every(Zs);default:return!0}}(i,t.args)}}return!0}function pc(e,t,r){switch(t.kind){case Ns.Literal:return t.isClosed&&(!!r||Vs(t.oper)!==Ls.Missing);case Ns.Name:case Ns.CellRef:return!0;case Ns.Array:return t.isClosed&&t.nodes.length>0&&t.nodes.every((function(e){return r=e,n=t.nodes[0].length,r.length===n&&r.every(dc);var r,n}));case Ns.App:return hc(e,t);case Ns.Paren:return t.isClosed&&pc(e,t.node,!1);case Ns.Bad:return!1;default:return b("calc.analyze.isWF",t)}}function vc(e,t,r){switch(t.kind){case Ns.Literal:case Ns.Name:break;case Ns.CellRef:t.ref.kind===bs.Row&&(r.rowRef+=1),t.ref.kind===bs.Col&&(r.colRef+=1);break;case Ns.Array:t.nodes.forEach((function(t){return t.forEach((function(t){return vc(e,t,r)}))}));break;case Ns.App:t.head.kind!==Ns.Operator&&vc(e,t.head,r),t.args.forEach((function(t){return vc(e,t,r)}));break;case Ns.Paren:vc(e,t.node,r);break;case Ns.Bad:if(t.type===Fs.Sequence){var n=t.contents;if(function(e,t){return 2===t.length&&Zs(t[0])&&lc(e,t[1])}(e,n))r.structRef+=1;else{var i=fc(e,n);null!=i?(i===Ns.Name?r.docQualName+=1:i===Ns.CellRef&&(r.docQualCellRef+=1),vc(e,n[1],r)):n.forEach((function(t){return vc(e,t,r)}))}}else t.type===Fs.Qualifier&&(r.badQual+=1);break;default:return b("calc.analyze.collectRefStats",t)}}var mc=Hs(Ws((function(e){return 1})),(function(e){return 1}),{vArray:function(e){var t=-1;return e.nodes.forEach((function(e){e.forEach((function(e){var r=Ks(e,mc);t=Math.max(t,r)}))})),1+t},vRange:function(e){var t=Ks(e.ref1,mc),r=Ks(e.ref2,mc);return 1+Math.max(t,r)},vBad:function(e){if(e.type===Fs.Sequence){var t=-1;return e.contents.forEach((function(e){var r=Ks(e,mc);t=Math.max(t,r)})),1+t}return 1},vCellRef:function(e){var t=-1;if(void 0!==e.qualifier){var r=Ks(e.qualifier,mc);t=Math.max(t,r)}return 1+Math.max(t,Ks(e.ref,mc))},vParen:function(e){return 1+Ks(e.node,mc)},vApp:function(e){var t=-1;return e.args.forEach((function(e){var r=Ks(e,mc);t=Math.max(t,r)})),1+t}});var gc,Ec=[];function Sc(e,t,r,n,i){var a,o={rowRef:0,colRef:0,structRef:0,docQualName:0,docQualCellRef:0,badQual:0};if(vc(e.config.localeInfo,n.node,o),o.rowRef+o.colRef+o.structRef+o.docQualName+o.docQualCellRef+o.badQual>0&&k.ULS.traceTag(595961670,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.checkFormula: possible unsupported references; operation: "+i+"; anonymize: "+R(n.node)+"; stats = "+JSON.stringify(o)),Ar(Sr.CalcStrictFormulaChecking))if(Ec.length<10){var u=(a=n.node,js(a,mc,-1));Ec.push(u)}else k.ULS.traceTag(595957962,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+Ec.join("; ")),Ec=[];var s=Ar(Sr.CalcStrictFormulaChecking)?function(e,t,r,n){return cc(sc(e,t,r,uc),n).context.errorData}(e,t,r,n):pc(e,n.node,!1);return s||function(e){e.kind!==Ns.App||e.isClosed||k.ULS.traceTag(595949718,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.tracePossibleFixes: formula missing paren that could be automatically closed")}(n.node),d(d({},n),{isWellFormed:s})}var Cc=yn.NodeKind,Tc=Tn.OperKind,Rc=On.OperatorId,yc=On.getWorksheetFuncType,Ic=On.WorksheetFuncId,Oc=Nn.success,Ac=Nn.failure,Nc=Nn.operKind,kc=Nn.isSuccess,Fc=Nn.getArguments,bc=Nn.unavailable,Dc=Nn.sheetGridRangeAnchor,Lc=Nn.createResolutionHandler,Mc=Nn.createResolver,_c=Nn.isSheetGridRange,wc=Nn.isValidArgsLength,Uc={kind:ys.BadOperation},Pc={kind:ys.BadFormula},Gc=function(){},Vc=function(){return Ac(bc(["defaultInferenceGlobals getSheetIndex"]))},xc=function(){return Ac(bc(["defaultInferenceGlobals getNameLoc"]))},Bc=function(){return Ac(bc(["defaultInferenceGlobals getCellFormat"]))},Wc=function(){return Ac(bc(["defaultInferenceGlobals getKnownFormat"]))};function Hc(e,t,r){return dr(t)?r:t.bind(e)}function Kc(e){return{getDocumentLoc:Hc(e,e.getDocumentLoc,Gc),getSheetIndex:Hc(e,e.getSheetIndex,Vc),getNameLoc:Hc(e,e.getNameLoc,xc)}}function jc(e){return{getDocumentLoc:Hc(e,e.getDocumentLoc,Gc),getSheetIndex:Hc(e,e.getSheetIndex,Vc),getNameLoc:Hc(e,e.getNameLoc,xc),getCellFormat:Hc(e,e.getCellFormat,Bc),getKnownFormat:Hc(e,e.getKnownFormat,Wc)}}function qc(e,t,r,n){return{strongFormat:e,category:t,iformat:r,decimals:n}}var Jc,Xc={Number:1,Currency:2,Accounting:2,Percentage:3,Date:4,Time:5,Fraction:6,Scientific:7,Text:8,Custom:9,Special:9,General:0};!function(e){e[e.Propagate=-1]="Propagate",e[e.Ignore=-2]="Ignore"}(Jc||(Jc={}));var Yc=((gc={})[Ic.INT]=Jc.Propagate,gc[Ic.MOD]=Jc.Propagate,gc[Ic.ROUND]=Jc.Propagate,gc[Ic.SUM]=Jc.Propagate,gc[Ic.TRUNC]=Jc.Propagate,gc[Ic.AVERAGE]=Jc.Propagate,gc[Ic.MAX]=Jc.Propagate,gc[Ic.MEDIAN]=Jc.Propagate,gc[Ic.MIN]=Jc.Propagate,gc[Ic.ROUNDUP]=Jc.Propagate,gc[Ic.ROUNDDOWN]=Jc.Propagate,gc[Ic.NPV]=Es.CoCurrencyDec,gc[Ic.PV]=Es.CoCurrencyDec,gc[Ic.FV]=Es.CoCurrencyDec,gc[Ic.PMT]=Es.CoCurrencyDec,gc[Ic.RATE]=Es.Percentage0,gc[Ic.MIRR]=Es.Percentage0,gc[Ic.IRR]=Es.Percentage0,gc[Ic.DATE]=Es.MMDDYY,gc[Ic.TIME]=Es.HHMMAP,gc[Ic.NOW]=Es.MDYHMS,gc[Ic.SLN]=Es.CoCurrencyDec,gc[Ic.SYD]=Es.CoCurrencyDec,gc[Ic.DDB]=Es.CoCurrencyDec,gc[Ic.IPMT]=Es.CoCurrencyDec,gc[Ic.PPMT]=Es.CoCurrencyDec,gc[Ic.TODAY]=Es.MMDDYY,gc[Ic.VDB]=Es.CoCurrencyDec,gc[Ic.DB]=Es.CoCurrencyDec,gc);var Qc=[["General","Number","Currency","Percentage","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Percentage","Date","Time","Number","Scientific","Text","Custom"],["General","General","Currency","General","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","General","General","Percentage","Percentage","Text","Custom"],["General","General","General","General","General","Date","General","General","Text","Custom"],["General","General","General","General","General","Time","General","General","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]],zc=[["General","Number","Currency","General","Date","Time","Fraction","Scientific","Text","Custom"],["General","Number","Currency","Number","Date","Time","Fraction","Scientific","Text","Custom"],["General","General","General","Currency","General","General","Currency","Currency","Text","Custom"],["General","General","General","Percentage","Date","Time","Percentage","Scientific","Text","Custom"],["General","General","General","General","General","General","Date","Date","Text","Custom"],["General","General","General","General","General","General","Time","Time","Text","Custom"],["General","General","General","General","General","General","Fraction","Scientific","Text","Custom"],["General","General","General","General","General","General","General","Scientific","Text","Custom"],["General","General","General","General","General","General","General","General","Text","Custom"],["General","General","General","General","General","General","General","General","General","Custom"]];function Zc(e,t,r){if(2===t.length)return r(e,ol(e,t[0]),ol(e,t[1]));throw new Is(Pc)}function $c(e,t,r,n){var i=r.iformat,a=n.iformat,o=r.category,u=n.category,s=Xc[o],c=Xc[u],l=s<=c?t[s][c]:t[c][s],f=Xc[l],d=n.decimals>r.decimals?n.decimals:r.decimals;switch(f){case s:return qc(!0,o,i,d);case c:return qc(!0,u,a,d);default:return e.unitlessFormat}}function el(e,t,r){return $c(e,zc,t,r)}function tl(e,t,r){var n=t.iformat,i=r.iformat,a=t.category,o=r.category;if(n===i&&a===o&&"Time"===a)return qc(!0,a,n,0);if("Date"===a&&"Time"===o||"Time"===a&&"Date"===o){var u=e.globals.getKnownFormat(Es.MDYHMS);if(!kc(u))throw new Is(u.reason);return qc(!0,u.value.category,u.value.iformat,u.value.decimals)}return $c(e,Qc,t,r)}var rl=function(e){return e.unitlessFormat};function nl(e,t,r){var n=t.iformat;return n===r.iformat?qc(!0,t.category,n,t.decimals):e.unitlessFormat}function il(e,t){return Xc[t]===Xc[e.defaultFormat.category]}var al=Lc(Oc,(function(e){return Ac(bc([e]))}),(function(e){return Ac(e)}));function ol(e,t){switch(t.kind){case Cc.App:var r=t.head;if(r.kind===Cc.Operator)return function(e,t,r){switch(t){case Rc.Mul:case Rc.Div:return e.multOrDivTainted=!0,Zc(e,r.args,el);case Rc.Pow:return Zc(e,r.args,el);case Rc.Add:case Rc.Sub:return Zc(e,r.args,tl);case Rc.Percent:if(1===r.args.length){var n=r.args[0];if(n.kind!==Cc.Literal||"number"!=typeof n.oper)return e.defaultFormat;var i=ol(e,n);return qc(i.strongFormat,"Percentage",Es.Percentage,i.decimals)}throw new Is(Pc);case Rc.Pound:case Rc.At:return e.defaultFormat;case Rc.Neg:case Rc.Pos:if(1===r.args.length)return ol(e,r.args[0]);throw new Is(Pc);case Rc.Lt:case Rc.Le:case Rc.Eq:case Rc.Ge:case Rc.Gt:case Rc.Ne:return Zc(e,r.args,rl);case Rc.Isect:case Rc.Union:case Rc.Range:case Rc.Concat:return Zc(e,r.args,nl);case Rc.And:case Rc.Or:case Rc.Xor:case Rc.Min:case Rc.Max:case Rc.Dot:throw new Is(Uc);default:return b("calc.analyzer.inferFormat: unexpected operator id",t)}}(e,r.id,t);if((N=r).kind===Cc.Name&&void 0===N.qualifier){var n=e.config.localeInfo.getWorksheetFuncId(r.whole);if(void 0!==n){var i=hr(Yc[n],Jc.Ignore),a=yc(n),o=Fc(t);if(!wc(a,o.length))throw new Is(Pc);if(n===Ic.HYPERLINK&&(e.hyperlinkTainted=!0),i===Jc.Ignore)return e.defaultFormat;if(i===Jc.Propagate){if(0===o.length)return e.defaultFormat;var u=ol(e,o[0]),s=u.iformat,c=u.category,l=u.decimals,f=!il(e,c);if(!u.strongFormat&&f)return e.unitlessFormat;for(var d=f,h=1;h<o.length;h+=1){var p=ol(e,o[h]),v=!il(e,p.category);if(!p.strongFormat&&v)return e.unitlessFormat;d||(s=p.iformat,c=p.category,l=p.decimals,d=v)}return qc(!0,c,s,l)}var m=e.globals.getKnownFormat(i);if(!kc(m))throw new Is(m.reason);return qc(!0,m.value.category,i,m.value.decimals)}}return ol(e,r);case Cc.Array:return e.defaultFormat;case Cc.CellRef:var g=e.resolver.resolveCellRef(e.origin,t.qualifier,t.ref),E=al(t.ref,g);if(!kc(E))throw new Is(E.reason);var S=E.value;if(!_c(S))return e.unitlessFormat;var C=Dc(S),T=e.globals.getCellFormat(C);if(!kc(T))throw new Is(T.reason);var R=T.value.iformat,y=T.value.category;return qc(!0,y,R,"Date"!==y&&"Time"!==y&&"Text"!==y&&"Custom"!==y&&"Special"!==y?T.value.decimals:0);case Cc.Literal:var I=Nc(t.oper);switch(I){case Tc.String:case Tc.Boolean:case Tc.Error:case Tc.Missing:return e.defaultFormat;case Tc.Number:var O=t.oper.toString(),A=O.indexOf(".");l=A>=0?O.length-A-1:0;return qc(!1,e.defaultFormat.category,e.defaultFormat.iformat,l);default:return b("calc.analyze.inferFormat: unexpected literal oper",I)}case Cc.Name:return e.defaultFormat;case Cc.Paren:return ol(e,t.node);case Cc.Bad:throw new Is(Pc);default:return b("calc.analyzer.inferFormat",t)}var N}function ul(e,t,r){try{var n=function(e,t){return{globals:jc(e),config:e.config,origin:t,defaultFormat:qc(!1,"General",Es.General,0),unitlessFormat:qc(!0,"General",Es.General,0),resolver:Mc(Kc(e)),multOrDivTainted:!1,hyperlinkTainted:!1}}(e,t),i=ol(n,r);return k.ULS.traceTag(595948253,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Verbose,"calc.analyze.inferFormat: inferred format info = "+i),Oc(d(d({},i),{multOrDivTainted:n.multOrDivTainted,hyperlinkTainted:n.hyperlinkTainted}))}catch(e){return e instanceof Is?(k.ULS.traceTag(595948254,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.inferFormat: inference failed = "+R(e.reason)),e.reason):(k.ULS.traceTag(595948255,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.inferFormat: caught exception = "+R(e)),Ac((a=e,{kind:Ss.JavaScriptError,error:a})))}var a}var sl,cl,ll=Tn.SpecialPrecs,fl=Tn.PrecsBound,dl=Tn.precedents;function hl(e){return{findStaticPrecedents:function(e){return dl([],[],ll.All,fl.Upper)},checkFormula:function(t,r,n,i){return Sc(e,t,r,n,void 0!==i?i:"undefined")},checkFormulaWithCodes:function(t,r,n){return function(e,t,r,n){return cc(sc(e,t,r,{ok:[],isOk:function(e){return 0===e.length},collect:function(e,t,r){return r.push({label:e.label,errorCode:t.code}),r}},!1),n).context.errorData}(e,t,r,n)},findBestFormat:function(t,r){return ul(e,t,r.node)}}}function pl(e){return{kind:cl.RangeValues,arrays:e}}!function(e){e.WorksheetFunction="WorksheetFunction"}(sl||(sl={})),function(e){e.RangeValues="RangeValues"}(cl||(cl={}));var vl=Tn.div0ErrorOper,ml=Tn.numErrorOper,gl=Math.pow(2,-52),El=Math.pow(2,-1022);function Sl(e){return Math.abs(e)<El?0:e}function Cl(e){return isFinite(e)?Sl(e):ml}var Tl=Math.pow(2,32)-2;function Rl(e,t){var r=Math.pow(e,t);return isFinite(r)?Sl(r):t<0?vl:ml}var yl,Il,Ol,Al={sqrt:function(e){return Cl(Math.sqrt(e))},sqrtpi:function(e){return Cl(function(e){var t=e*Math.PI;return isFinite(t)?Math.sqrt(t):Math.sqrt(e)*Math.sqrt(Math.PI)}(e))},exp:function(e){return Cl(Math.exp(e))},power:function(e,t){return 0===t?0===e?ml:1:0===e?t<0?vl:0:e>0?Rl(e,t):function(e){if(e<-Tl||e>Tl)return!1;if(e===Math.floor(e))return!0;var t=Math.abs(e);return 1+-22.5*gl<=t&&t<=1+2*gl}(t)?Rl(e,Math.round(t)):ml},ln:function(e){return Cl(Math.log(e))},log10:function(e){return Cl(Math.log(e)/Math.LN10)},log:function(e,t){if(e<=0||t<=0)return ml;var r=Math.log(e)/Math.log(t);return isFinite(r)?Sl(r):vl},sin:function(e){return Math.abs(e)<Math.pow(2,27)?Cl(Math.sin(e)):ml},cos:function(e){return Math.abs(e)<Math.pow(2,27)?Cl(Math.cos(e)):ml},tan:function(e){return Math.abs(e)<Math.pow(2,27)?Cl(Math.tan(e)):ml},asin:function(e){return Cl(Math.asin(e))},acos:function(e){return Cl(Math.acos(e))},atan:function(e){return Cl(Math.atan(e))},atan2:function(e,t){return 0===e&&0===t?vl:Sl(Math.atan2(t,e))}};!function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483643]="Name",e[e.CellRef=-2147483642]="CellRef",e[e.Ident=-2147483641]="Ident",e[e.If=-2147483640]="If"}(Ol||(Ol={}));var Nl=(yl=sr(cr,cr)).wrap,kl=yl.unwrap,Fl=(Il=sr((function(e){return-e}),(function(e){return-e}))).wrap,bl=Il.unwrap;function Dl(e){return e>0}function Ll(e){return{kind:e,data:void 0,children:void 0}}function Ml(e,t,r){var n=Ll(Ol.Array);return n.children=r,n.data={rows:e,cols:t},n}function _l(e,t){var r=Ll(Ol.Fun);return r.children=t,r.data=e,r}function wl(e,t,r){var n=Ll(Ol.Let);return n.children=[t,r],n.data=e,n}function Ul(e,t,r){var n=Ll(Ol.App);return n.children=r,n.data={funName:e,funType:t},n}function Pl(e){var t=Ll(Ol.Ident);return t.data=e,t}function Gl(e,t,r){var n=Ll(Ol.If);return n.children=[e,t,r],n}function Vl(e){return"object"!=typeof e||e.kind>0}function xl(e,t){for(var r,n=0;n<e.length;n+=1){var i=e[n],a=t(i);void 0===r?a!==i&&(r=e.slice(0,n)).push(a):r.push(a)}return void 0!==r?r:e}function Bl(e,t){return xl(e,function(e){return function(t){return xl(t,e)}}(t))}function Wl(e,t){return t(function(e,t){if(Vl(e))return e;switch(e.kind){case Ol.Let:var r=e.children,n=r[0],i=r[1],a=t(n),o=t(i);return n===a&&i===o?e:wl(e.data,a,o);case Ol.App:var u=xl(e.children,t);return u===e.children?e:Ul(e.data.funName,e.data.funType,u);case Ol.If:var s=e.children,c=s[0],l=s[1],f=s[2],d=t(c),h=t(l),p=t(f);return c===d&&l===h&&f===p?e:Gl(d,h,p);case Ol.Fun:var v=t(e.children);return v===e.children?e:_l(e.data,v);case Ol.Array:var m=Bl(e.children,t);return m===e.children?e:Ml(e.data.rows,e.data.cols,m);case Ol.Name:case Ol.CellRef:case Ol.Ident:return e}}(e,(function(e){return Wl(e,t)})))}var Hl=function(){function e(e,t,r){M("calc.common.StrictArray2D",e),M("calc.common.StrictArray2D",t);var n=r.length;n<e&&D("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+n);for(var i=0;i<n;i+=1){var a=r[i].length;a<t&&D("calc.common.StrictArray2D: expected elements["+i+"].length >= "+e+"; given "+a)}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return w("calc.common.StrictArray2D.get",e,this.rows),w("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new jl(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();var Kl=function(){function e(e,t,r,n,i,a){M("calc.common.StrictSparseArray2D",e),M("calc.common.StrictSparseArray2D",t),w("calc.common.StrictSparseArray2D",r,e+1),w("calc.common.StrictSparseArray2D",n,t+1);var o=i.length;o<r&&D("calc.common.StrictSparseArray2D: expected elements.length >= "+r+"; given "+o);for(var u=0;u<o;u+=1){var s=i[u].length;s<n&&D("calc.common.StrictSparseArray2D: expected elements["+u+"].length >= "+n+"; given "+s)}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseElements=i,this.sparseElement=a}return e.prototype.get=function(e,t){return w("calc.common.StrictSparseArray2D.get",e,this.rows),w("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new ql(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}(),jl=function(){function e(e,t,r){M("calc.common.NonstrictArray2D",e),M("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return w("calc.common.NonstrictArray2D.get",e,this.rows),w("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=Jl(this.rows,this.cols,this.func);return new Hl(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}(),ql=function(){function e(e,t,r,n,i,a){M("calc.common.NonstrictSparseArray2D",e),M("calc.common.NonstrictSparseArray2D",t),w("calc.common.NonstrictSparseArray2D",r,e+1),w("calc.common.NonstrictSparseArray2D",n,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=n,this.denseFunc=i,this.sparseFunc=a}return e.prototype.get=function(e,t){return w("calc.common.NonstrictSparseArray2D.get",e,this.rows),w("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=Jl(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new Kl(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function Jl(e,t,r){for(var n=[],i=0;i<e;i+=1){for(var a=[],o=0;o<t;o+=1)a[o]=r(i,o);n[i]=a}return n}function Xl(e){return Jl(e.rows,e.cols,e.get.bind(e))}function Yl(e,t,r){for(var n=[],i=[],a=0;a<t;a+=1)i[a]=r;for(var o=0;o<e;o+=1)n[o]=i;return n}function Ql(e,t,r){return new jl(e,t,(function(e,t){return r}))}var zl,Zl=Sn.FormulaSource,$l=Nn.ResultKind,ef=Nn.isGridCell,tf=Nn.ReasonKind,rf=Nn.notImplemented,nf=Nn.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.Unevaluated="Unevaluated",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.JavaScriptError="JavaScriptError",e.IllFormedFormula="IllFormedFormula"}(zl||(zl={}));var af=d(d({},tf),zl);function of(e,t){return{config:e,mathpack:t}}var uf,sf,cf=function(e,t){return _("calc.runtime.interval: end",t),w("calc.runtime.interval: start",e,t),{start:e,end:t}};function lf(e){return{kind:af.IllFormedFormula,message:e}}function ff(e){return{kind:uf.FinalValue,oper:e}}function df(e){return{kind:uf.PendingValue,anchor:e}}function hf(e,t,r){return t!==Zl.Cell||ef(e.range)||D("calc.runtime.cellFormula: expected single-cell range; given "+R(e)),{kind:uf.Formula,range:e,source:t,formula:r}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(uf||(uf={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(sf||(sf={}));var pf={kind:af.Stopped};function vf(e){return 0===e.length&&D("calc.runtime.unevaluated: expected nonempty array"),{kind:af.Unevaluated,anchors:e}}function mf(e,t,r,n,i,a,o,u,s,c,l,f,d,h,p,v,m,g,E,S){return{config:e,mathpack:t,getDocumentLoc:r,getSheetIndex:n,getSheetRangeIndexes:null!=g?g:void 0,getNameLoc:null!=m?m:void 0,getCellValue:i,getCellValues:a,getFirstOrderFunc:o,getNameFormula:u,getCellFormula:s,getUsedRange:function(e){return Xt(rf(["getUsedRange"]))},interruptToken:[sf.Continue],getHiddenRows:null!=E?E:void 0,isInFilterMode:null!=S?S:void 0,schedulerInfo:null!=p?p:{},setCellValue:c,setCellValues:l,setCellFailure:f,setDynamicPrecs:d,loadObjects:h}}function gf(e){return{kind:af.NameCycle,names:e}}function Ef(e){return{kind:af.CellCycle,cells:e}}function Sf(e){return{kind:af.PreviousFailure,range:e}}function Cf(e){return{kind:af.JavaScriptError,error:e}}function Tf(e){return{kind:$l.Paused,reason:af.Timeout,resume:e}}function Rf(e){if(e.kind===$l.Failure)return e.reason.kind}var yf,If=Sn.gridCell,Of=Tn.arrayOper,Af=Tn.naErrorOper,Nf=Tn.OperKind,kf=Nf.Number|Nf.String|Nf.Boolean|Nf.Error|Nf.Rich|Nf.Array,Ff=Nf.Number|Nf.String|Nf.Boolean|Nf.Error|Nf.Blank|Nf.Rich,bf=Ff|Nf.Array;function Df(e,t,r){var n=e+": generated Excel error, type "+t+"; "+r;k.ULS.traceTag(596120270,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Verbose,n)}function Lf(e){return"object"==typeof e&&e.kind===Nf.Error}function Mf(e){return"object"==typeof e&&e.kind===Nf.Blank}function _f(e){return"object"==typeof e&&e.kind===Nf.Array}function wf(e){return"object"==typeof e&&e.kind===Nf.Rich}function Uf(e){return e.kind===Gt.Success?e.value:void 0}function Pf(e,t){switch(e.kind){case Gt.Success:return Jt(ff(e.value));case Gt.Failure:return Xt(Sf(t))}}function Gf(e,t,r){var n=_f(r)?function(e,t,r,n,i,a){if(e===r&&t===n)return i;if(1===e&&1===t)return Yl(r,n,void 0===i[0]?a:i[0][0]);var o,u=[];o=1===e?function(e,r){return r<t?i[0][r]:a}:1===t?function(t,r){return t<e?i[t][0]:a}:function(r,n){return r<e&&n<t?i[r][n]:a};for(var s=0;s<r;s+=1){u.push([]);for(var c=0;c<n;c+=1)u[s][c]=o(s,c)}return u}(r.rows,r.cols,e,t,r.opers,Af):Yl(e,t,r);return Of(e,t,n)}function Vf(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols,l=vr(r,o),f=vr(n,u);return B(l,f,mr(r+i,o+s)-l,mr(n+a,u+c)-f)}function xf(e){return 0===e.length&&D("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(Vf)}function Bf(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols,l=mr(r,o),f=mr(n,u),d=vr(r+i,o+s)-l,h=vr(n+a,u+c)-f;if(!(d<=0||h<=0))return B(l,f,d,h)}function Wf(e){return e.rows*e.cols}var Hf,Kf=yn.NodeKind,jf=Nn.getArguments,qf=Tn.arrayOper,Jf=On.WorksheetFuncId,Xf=On.OperatorId,Yf=Nn.success,Qf=(Hf=0,function(){var e=Hf;return Hf+=1,e});function zf(e){return"object"!=typeof e||Vl(e)&&("object"!=typeof(t=e)||t.kind===Nf.Error||t.kind===Nf.Array||t.kind===Nf.Rich);var t}function Zf(e,t,r,n){switch(n.kind){case Kf.Array:var i=n.nodes.map((function(n){return n.map((function(n){return Zf(e,t,r,n)}))}));return g=(m=i).length,E=void 0===m[0]?0:m[0].length,m.every((function(e){return e.every(zf)}))?qf(g,E,m):Ml(g,E,m);case Kf.App:var a=n.head;if(a.kind===Kf.Operator){var o=jf(n).map((function(n){return Zf(e,t,r,n)})),u=On.getOperatorType(a.id);return Ul(Nl(a.id),u,o)}if(a.kind===Kf.Name&&null==a.qualifier)if(null!=(l=e.config.localeInfo.getWorksheetFuncId(a.whole))){var s=void 0;switch(l){case Jf.LET:s=function(e,t,r,n){if(3===n.args.length){var i=n.args[0];if(i.kind===Kf.Name&&null==i.qualifier){var a=i.whole;r[i.label]=Qe(a);var o=Qf(),u=t.setValue(a,o);return wl(o,Zf(e,t,r,n.args[1]),Zf(e,u,r,n.args[2]))}}}(e,t,r,n);break;case Jf.FUN:s=function(e,t,r,n){var i=n.args.slice(0,n.args.length-1);if(i.length>0&&i.every((function(e){return e.kind===Kf.Name&&null==e.qualifier}))){for(var a=i.map((function(e){var t=e.whole;return r[e.label]=Qe(t),t})),o=a.map(Qf),u=t,s=0;s<a.length;s+=1)u=u.setValue(a[s],o[s]);return _l(o,Zf(e,u,r,n.args[i.length-1]))}}(e,t,r,n);break;case Jf.IF:s=function(e,t,r,n){var i=n.args;return 3===i.length?Gl(Zf(e,t,r,i[0]),Zf(e,t,r,i[1]),Zf(e,t,r,i[2])):2===i.length?Gl(Zf(e,t,r,i[0]),Zf(e,t,r,i[1]),!1):void 0}(e,t,r,n);break;default:o=jf(n).map((function(n){return Zf(e,t,r,n)})),u=On.getWorksheetFuncType(l);s=Ul(Fl(l),u,o)}if(void 0!==s)return r[a.label]=Ye(l),s}return function(e,t,r,n){var i=jf(n).map((function(n){return Zf(e,t,r,n)})),a=On.getWorksheetFuncType(Jf._UDF);return Ul(Fl(Jf._UDF),a,[Zf(e,t,r,n.head)].concat(i))}(e,t,r,n);case Kf.Paren:return Zf(e,t,r,n.node);case Kf.Name:var l;if(null==n.qualifier)if(void 0!==(l=t.getEntry(n.whole)))return r[n.label]=Qe(l.key),Pl(l.value);return d=n.whole,h=n.whole.split("."),p=n.qualifier,(v=Ll(Ol.Name)).data={whole:d,split:h,qualifier:p},v;case Kf.CellRef:return function(e,t){var r=Ll(Ol.CellRef);return r.data={ref:e,qualifier:t},r}(n.ref,n.qualifier);case Kf.Literal:return n.oper;case Kf.Bad:var f="calc.runtime.compile: unexpected bad node "+R(n);return k.ULS.assertTag(595980820,c.LogCategory.msoulscat_ES_EWAJS,!1,f);default:return b("calc.runtime.compile",n)}var d,h,p,v,m,g,E}var $f=((yf={})[Xf.At]=Jf.SINGLE,yf[Xf.Pound]=Jf.ANCHORARRAY,yf[Xf.Dot]=Jf.FIELDVALUE,yf);var ed=function(e){return function(e){if(!Vl(e)&&e.kind===Ol.App&&Dl(e.data.funName)){var t=$f[kl(e.data.funName)];if(void 0!==t)return Ul(Fl(t),On.getWorksheetFuncType(t),e.children)}return e}(function(e){if(!Vl(e)&&e.kind===Ol.App&&!Dl(e.data.funName)){var t=bl(e.data.funName);if(t===Jf.IFERROR||t===Jf.IFNA){var r=Qf(),n=Pl(r),i=t===Jf.IFERROR?Jf.ISERROR:Jf.ISNA,a=On.getWorksheetFuncType(i),o=Gl(Ul(Fl(i),a,[n]),e.children[1],n);return wl(r,e.children[0],o)}}return e}(e))};var td;function rd(e,t){return function(e){return"__compiledFormulaBrand__"===e.kind}(t)?t.term:b(e+": expected known compiled formula type; given "+R(t),t)}function nd(e,t,r,n){var i=e.config.localeInfo,a=[],o=Zf(e,qr.create(i.stringCompareCI.bind(i)),a,n.node),u=Wl(o,ed);return Yf(function(e,t,r){return d(d({kind:"__compiledFormulaBrand__"},e),{annotations:t,term:r})}(n,a,u))}function id(e){return{compileFormula:function(t,r,n){return nd(e,dr(t),0,n)}}}function ad(e,t){return 0==(e&t)}function od(e,t){return(e|t-1)&~t}!function(e){e[e.Empty=0]="Empty",e[e.Lf=1]="Lf",e[e.Br=2]="Br"}(td||(td={}));var ud={kind:td.Empty};function sd(e){return e===ud}function cd(e,t){return{kind:td.Lf,key:e,value:t}}function ld(e,t,r,n){return{kind:td.Br,prefix:e,mask:t,l:r,r:n}}function fd(e,t,r,n){var i=function(e,t){return r=e^t,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,(r|=r>>>16)^r>>>1;var r}(e,r),a=od(e,i),o=ad(e,i);return ld(a,i,o?t:n,o?n:t)}var dd,hd=ud,pd=function e(t,r,n){switch(n.kind){case td.Empty:return cd(t,r);case td.Lf:var i=cd(t,r);return n.key===t?i:fd(t,i,n.key,n);case td.Br:return function(e,t,r){return od(e,r)===t}(t,n.prefix,n.mask)?ad(t,n.mask)?ld(n.prefix,n.mask,e(t,r,n.l),n.r):ld(n.prefix,n.mask,n.l,e(t,r,n.r)):fd(t,cd(t,r),n.prefix,n)}},vd=function(e,t){for(var r=t;r.kind===td.Br;)r=ad(e,r.mask)?r.l:r.r;if(!sd(r))return e===r.key?r.value:void 0},md=Sn.FormulaSource,gd=Tn.SpecialPrecs,Ed=Tn.PrecsBound,Sd=Tn.precedents,Cd=Nn.isSheetGridCell,Td=Zt;function Rd(e){throw new Td(e)}function yd(){return Sd([],[],gd.None,Ed.Lower)}function Id(e,t,r,n){return{range:e,source:t,precedents:r,visitedCellMap:n}}function Od(e,t,r,n){if(t===md.Cell){if(Cd(e))return Id(e,t,r,n);D("calc.runtime.evalLocals: expected single-cell range; given "+R(e))}return Id(e,t,r,n)}!function(e){e[e.Default=1]="Default",e[e.Dependency=2]="Dependency",e[e.Call=3]="Call",e[e.Write=4]="Write",e[e.Return=5]="Return"}(dd||(dd={}));var Ad={kind:dd.Default},Nd=function(){function e(e){this.context=e,this.latestTransition=dd.Default}return e.prototype.receiveJavaScriptError=function(e){},e.prototype.cleanup=function(){},e.prototype.performDefaultTransition=function(){return this.latestTransition=dd.Default,Ad},e.prototype.performDependencyTransition=function(e){return this.latestTransition=dd.Dependency,{kind:dd.Dependency,machines:e}},e.prototype.performCallTransition=function(e){return this.latestTransition=dd.Call,{kind:dd.Call,machine:e}},e.prototype.performWriteTransition=function(e,t,r){this.latestTransition=dd.Write;var n=void 0!==r?r:e;return{kind:dd.Write,writeResult:n,result:e,locals:t}},e.prototype.performReturnTransition=function(e){return this.latestTransition=dd.Return,{kind:dd.Return,result:e}},e}();function kd(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:lr(),keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return fr(n)?n.value:void 0},getEntry:function(e){var t=this.getValue(e);return void 0===t?void 0:Hr(e,t)},setValue:function(e,r){var n=this.keyToString(e),i=t(this.entries,n)?this.entries[n]:void 0;fr(i)?i.value=r:this.entries[n]=Hr(e,r)},contains:function(e){var r=this.keyToString(e);return fr(t(this.entries,r)?this.entries[r]:void 0)},remove:function(e){var r=this.keyToString(e);return!!t(this.entries,r)&&(delete this.entries[r],!0)},getOrSetValue:function(e,r){var n=this.keyToString(e),i=t(this.entries,n)?this.entries[n]:void 0;if(fr(i))return i.value;var a=r();return delete this.entries[n],this.entries[n]=Hr(e,a),a},forEach:function(e){for(var r in this.entries){var n=t(this.entries,r)?this.entries[r]:void 0;if(fr(n)&&!e(n.key,n.value))break}},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var i=n[r];this.remove(i)}}}}var Fd={newVisitedMap:Dd,visit:function(e,t,r){return Ld(Pd,e,t,r)},unVisit:function(e,t,r){return Md(Pd,e,t,r)},lookup:function(e,t){return _d(Pd,e,t)},runFrom:function(e,t){return wd(Pd,e,t)}},bd={newVisitedMap:Dd,visit:function(e,t,r){return Ld(Gd,e,t,r)},unVisit:function(e,t,r){return Md(Gd,e,t,r)},lookup:function(e,t){return _d(Gd,e,t)},runFrom:function(e,t){return wd(Gd,e,t)}};function Dd(){return{__visitedMapBrand:!0,run:[],visited:kd(cr)}}function Ld(e,t,r,n){var i=e(t);n.visited.setValue(i,r),n.run.push([i,t,void 0])}function Md(e,t,r,n){var i=e(t);void 0===r?n.visited.remove(i):n.visited.setValue(i,r);var a=n.run.pop();return void 0!==a?a[2]:void 0}function _d(e,t,r){return r.visited.getValue(e(t))}function wd(e,t,r){for(var n=[],i=r.run,a=0;a<i.length;){var o=i[a][0];if(e(t)===o)break;a+=1}for(;a<i.length;)n.push(i[a][1]),i[a][2]=n,a+=1;return n}function Ud(e){return G(null!=e.path?e.path:void 0,e.name)}function Pd(e){var t=e.scope,r=t.document,n=t.index,i=e.name;return JSON.stringify(ie(ne(Ud(r),n),i))}function Gd(e){var t=e.sheet,r=t.index,n=t.document,i=e.range,a=i.row,o=i.col,u=x(Ud(n),r);return JSON.stringify({sheet:u,row:a,col:o})}var Vd=Tn.OperKind,xd=Nn.failure,Bd=Nn.sheetGridRangeAnchor,Wd=Nn.success,Hd=Nn.ResultKind,Kd=function(e){function t(t,r){var n=e.call(this,t)||this;return n.cell=r,n.locals=void 0,n}return f(t,e),t.prototype.getRealReason=function(e){if(e.kind!==af.PreviousFailure)return e;var t=Bd(e.range),r=bd.lookup(t,this.context.visitedCellMap);return"object"==typeof r&&r.kind===Hd.Failure?r.reason:e},t.prototype.visitAnchor=function(e){var t=Bd(e.range),r=bd.lookup(t,this.context.visitedCellMap);if(null!=r){var n="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+R(t)+"; given "+R(r));return k.ULS.assertTag(595980812,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}return bd.visit(t,uf.PendingValue,this.context.visitedCellMap),this.locals=Od(e.range,e.source,yd(),this.context.visitedCellMap),this.locals},t.prototype.unVisitAnchor=function(e){var t=this.locals;if(null!=t){var r=Bd(t.range),n=bd.unVisit(r,e,this.context.visitedCellMap);return this.locals=void 0,[t,n]}},t.prototype.next=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===Hd.Failure)return this.performReturnTransition(xd(this.getRealReason(e.reason)));var t=e.value;if(t.kind===uf.FinalValue)return this.performReturnTransition(Wd(t.oper));var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===Hd.Failure){var n="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return k.ULS.assertTag(595980813,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}var i=r.value;if(null==i){n="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+R(t.anchor)+") != null");return k.ULS.assertTag(595980814,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}var a=this.visitAnchor(i),o=this.context.createFormulaEvaluationMachine(this.context,a,i.formula);return this.performCallTransition(o)},t.prototype.receiveSuccess=function(e){var t=e.value;if("object"==typeof t&&(t.kind===Vd.Range||t.kind===Vd.Missing)){var r="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+R(t));return k.ULS.assertTag(595980815,c.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=this.unVisitAnchor(void 0);if(null==n){r="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return k.ULS.assertTag(595980816,c.LogCategory.msoulscat_ES_EWAJS,!1,r)}var i=n[0];return this.performWriteTransition(e,i)},t.prototype.receiveFailure=function(e){var t=this.getRealReason(e.reason);if(t.kind===af.Unevaluated){var r="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+R(t));return k.ULS.assertTag(595980817,c.LogCategory.msoulscat_ES_EWAJS,!1,r)}var n=t===e.reason?e:xd(t),i=this.unVisitAnchor(n);if(null==i){r="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return k.ULS.assertTag(595980818,c.LogCategory.msoulscat_ES_EWAJS,!1,r)}var a=i[0],o=i[1],u=e.reason.kind===af.PreviousFailure&&void 0!==o?xd(Ef(o)):e;return this.performWriteTransition(n,a,u)},t.prototype.receiveJavaScriptError=function(e){var t=this.unVisitAnchor(e);if(null!=t){var r=t[0];return this.performWriteTransition(e,r)}},t.prototype.cleanup=function(){this.unVisitAnchor(void 0)},t}(Nd);function jd(e,t){return new Kd(e,t)}function qd(e,t){for(var r=Sp(e),n=[],i=0;i<t.length;i+=1)n.push(jd(r.machineContext,t[i]));return new Tp(r,n)}var Jd=Sn.FormulaSource,Xd=Sn.sheetGridCell,Yd=Sn.sheetGridRange,Qd=Tn.OperKind,zd=Tn.ErrorType,Zd=Tn.refErrorOper,$d=Tn.valueErrorOper,eh=Tn.arrayOper,th=Nn.ResultKind,rh=Nn.isGridCell,nh=Nn.isSheetIndex,ih=Nn.getArgType;function ah(e,t){if(bd.lookup(e,t.visitedCellMap)===uf.PendingValue)return Rd(Ef(bd.runFrom(e,t.visitedCellMap)))}function oh(e,t,r,n){t.precedents.cells.push(r);var i=e.getCellValue(r);if(i.kind===th.Failure)return Rd(i.reason);var a=i.value;if(a.kind===uf.FinalValue)return a.oper;ah(a.anchor,t),n.push(a.anchor)}function uh(e,t,r,n,i){var a;if(t.precedents.cells.push(r),!i||Wf(r.range)<=16||!Ar(Sr["OfficeVSO:3832568_CalcCGGetUsedRange"]))a=r;else{var o=e.getUsedRange(r.sheet),u=void 0;Yt(o)?u=null==o.value?void 0:o.value.range:o.reason.kind===Vt.NotImplemented?u=r.range:Rd(o.reason);var s=void 0===u?void 0:Bf(r.range,W(0,0,u.row+u.rows,u.col+u.cols));if(void 0===s)return new Kl(r.range.rows,r.range.cols,0,0,[],be);a=Yd(r.sheet,s)}var c=e.getCellValues(a);if(c.kind===th.Failure)return Rd(c.reason);var l=n.length,f=function(e,t,r,n,i){var a=[],o=n.length,u=0;L("calc.runtime.deference: readIntoArray2D number of rows",o===r.rows);for(var s=0;s<o;s+=1){a.push([]);var c=n[s].length;L("calc.runtime.deference: readIntoArray2D number of cols",c===r.cols),u=0===s?c:vr(c,u);for(var l=0;l<c;l+=1){var f=n[s][l];uf.FinalValue===f.kind?a[s][l]=f.oper:(ah(f.anchor,e),i.push(f.anchor),a[s][l]=Zd)}}return new Kl(t.rows,t.cols,o,u,a,be)}(t,r.range,a.range,c.value,n);return l===n.length?f:void 0}function sh(e,t,r,n){var i=uh(e,t,r,n,!1);if(null!=i)return eh(i.rows,i.cols,i.rows===i.denseRows&&i.cols===i.denseCols?i.denseElements:Xl(i))}function ch(e,t,r,n,i){if(0!=(n&Qd.Range))return r;if("object"!=typeof r||r.kind!==Qd.Range)return r;var a=r.sheets;if(!nh(a))return Df("calc.runtime.dereference",zd.REF,"3D range, oper = "+R(r)),Zd;if(1!==r.ranges.length)return Df("calc.runtime.dereference",zd.VALUE,"union range, oper = "+R(r)),$d;var o=r.ranges[0];if(0!=(n&Ff)){if(rh(o))return oh(e,t,Xd(a,o),i);if(t.source===Jd.Cell&&!Ar(Sr.CalcSupportDynamicArrays)&&!Ar(Sr.CalcPreventSpillingHack)){var u=function(e,t){var r=e.row,n=e.col,i=t.row,a=t.col,o=t.rows,u=t.cols,s=i<=r&&r<i+o,c=a<=n&&n<a+u;return s&&c?If(r,n):s&&1===u?If(r,a):c&&1===o?If(i,n):void 0}(t.range.range,o);return null==u?(Df("calc.runtime.dereference",zd.VALUE,"empty intersection, oper = "+R(r)),$d):oh(e,t,Xd(a,u),i)}return sh(e,t,Yd(a,o),i)}return 0!=(n&Qd.Array)?sh(e,t,Yd(a,o),i):(Df("calc.runtime.dereference",zd.VALUE,"bad target type "+n),$d)}function lh(e,t,r,n){for(var i=[],a=0;a<r.length;a+=1){var o=ch(e,t,r[a],ih(n,a),i);null!=o&&(r[a]=o)}if(i.length>0)return Rd(vf(i))}var fh=Tn.OperKind,dh=Tn.valueErrorOper,hh=Tn.arrayOper,ph=Nn.operKind,vh=Nn.notImplemented,mh=[dh,0,"",!1,!1],gh=fh.Number|fh.String|fh.Boolean;function Eh(e){var t=e&gh;return mh[t&-t]}function Sh(e,t,r){var n=function e(t,r,n){if("number"==typeof r)return 0!=(n&fh.Number)?r:0!=(n&fh.String)?t.formatNumber(r):0!=(n&fh.Boolean)?0!==r:0!=(n&fh.Array)?hh(1,1,[[r]]):dh;if("string"==typeof r){if(0!=(n&fh.String))return r;if(0!=(n&fh.Number)){if(0===r.length)return dh;var i=t.parseNumber(r);if(jt(i))return i;throw new Td(vh(["string -> number coercion: "+R(yn.literalNode(r))]))}return 0!=(n&fh.Boolean)?0===t.stringCompareCI(r,t.trueName)||0!==t.stringCompareCI(r,t.falseName)&&dh:0!=(n&fh.Array)?hh(1,1,[[r]]):dh}if("boolean"==typeof r)return 0!=(n&fh.Boolean)?r:0!=(n&fh.Number)?r?1:0:0!=(n&fh.String)?r?t.trueName:t.falseName:0!=(n&fh.Array)?hh(1,1,[[r]]):dh;if(0!=(n&r.kind))return r;switch(r.kind){case fh.Error:return r;case fh.Missing:return 0!=(n&fh.Blank)?Tn.blankOper:Eh(n);case fh.Blank:return Eh(n);case fh.Rich:return e(t,r.getFallback(),n);default:return dh}}(e.config.localeInfo,t,r);return Lf(n)&&!Lf(t)&&Df("calc.runtime.coerceOper",n.type,"kind = "+ph(t)),n}var Ch=Sn.sheetIndex,Th=Tn.OperKind,Rh=Tn.rangeSeqOper,yh=Tn.ErrorType,Ih=Tn.valueErrorOper,Oh=Tn.div0ErrorOper,Ah=Tn.nullErrorOper,Nh=On.OperatorId,kh=Nn.operKind,Fh=Nn.isSheetIndex,bh=Nn.isDocumentLocEqual;function Dh(e,t){switch(e){case Nh.Eq:return 0===t;case Nh.Ne:return 0!==t;case Nh.Lt:return t<0;case Nh.Gt:return t>0;case Nh.Le:return t<=0;case Nh.Ge:return t>=0}}function Lh(e,t,r){return Dh(e,t-r)}function Mh(e,t,r,n){return Dh(t,e.stringCompareCI(r,n))}function _h(e,t,r){return Dh(e,t<r?-1:t>r?1:0)}function wh(e,t,r){if(Fh(t.sheets))if(Fh(r.sheets))if(bh(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return Ch(t.sheets.document,t.sheets.index);n="different sheet, range1 = "+R(t)+", range2 = "+R(r);Df(e,yh.VALUE,n)}else{var n="different document, range1 = "+R(t)+", range2 = "+R(r);Df(e,yh.VALUE,n)}else Df(e,yh.VALUE,"3D reference, range2 = "+R(r));else Df(e,yh.VALUE,"3D reference, range1 = "+R(t))}function Uh(e,t,r){if(1===r.length){var n=r[0];switch(t){case Nh.Percent:return Sl(n/100);case Nh.Neg:return-n;case Nh.Pos:return n;default:var i="bad application of "+t+" to 1 argument";return Df("calc.runtime.applyOperator",yh.VALUE,i),Ih}}if(2===r.length){n=r[0];var a=r[1];switch(t){case Nh.Add:return Cl(n+a);case Nh.Sub:return Cl(n-a);case Nh.Mul:return Cl(n*a);case Nh.Div:return 0===a?(Df("calc.runtime.applyOperator",yh.DIV0,"division by zero"),Oh):Cl(n/a);case Nh.Pow:return e.mathpack.power(n,a);case Nh.Concat:return n+a;case Nh.Eq:case Nh.Ne:case Nh.Lt:case Nh.Le:case Nh.Gt:case Nh.Ge:return function(e,t,r,n){var i=kh(r),a=kh(n);if(i!==a){if(i===Th.Blank)switch(a){case Th.Number:return _h(t,0,n);case Th.String:return Mh(e,t,"",n);case Th.Boolean:return Lh(t,!1,n)}if(a===Th.Blank)switch(i){case Th.Number:return _h(t,r,0);case Th.String:return Mh(e,t,r,"");case Th.Boolean:return Lh(t,r,!1)}return Dh(t,i-a)}switch(i){case Th.Number:return _h(t,r,n);case Th.String:return Mh(e,t,r,n);case Th.Boolean:return Lh(t,r,n);case Th.Blank:return Dh(t,0);default:return!1}}(e.config.localeInfo,t,n,a);case Nh.Range:return function(e,t){var r=wh("calc.runtime.applyRangeOp",e,t);if(null==r)return Ih;var n=[Vf(xf(e.ranges),xf(t.ranges))];return Rh(r,n)}(n,a);case Nh.Isect:return function(e,t){var r=wh("calc.runtime.applyIsectOp",e,t);if(null==r)return Ih;for(var n=[],i=0;i<e.ranges.length;i+=1)for(var a=0;a<t.ranges.length;a+=1){var o=Bf(e.ranges[i],t.ranges[a]);null!=o&&n.push(o)}if(0===n.length){var u="empty intersection, range1 = "+R(e)+", range2 = "+R(t);return Df("calc.runtime.applyIsectOp",yh.NULL,u),Ah}return Rh(r,n)}(n,a);case Nh.Union:return null==(c=wh("calc.runtime.applyUnionOp",u=n,s=a))?Ih:Rh(c,u.ranges.concat(s.ranges));case Nh.And:return n&&a;case Nh.Or:return n||a;case Nh.Xor:return n!==a;case Nh.Min:return Math.min(n,a);case Nh.Max:return Math.max(n,a);default:var o="bad application of "+t+" to 2 arguments";return Df("calc.runtime.applyOperator",yh.VALUE,o),Ih}}var u,s,c,l="bad application of "+t+" to "+r.length+" arguments";return Df("calc.runtime.applyOperator",yh.VALUE,l),Ih}var Ph=Sn.sheetIndex,Gh=Sn.sheetGridRange,Vh=Tn.arrayOper,xh=Tn.nameErrorOper,Bh=Tn.naErrorOper,Wh=Tn.numErrorOper,Hh=Tn.valueErrorOper,Kh=Tn.OperKind,jh=Tn.ErrorType,qh=Tn.SpecialPrecs,Jh=On.functionType,Xh=On.FunctionFlags,Yh=On.OperatorId,Qh=On.SignatureType,zh=On.WorksheetFuncId,Zh=On.getOperatorType,$h=On.getWorksheetFuncType,ep=Nn.operKind,tp=Nn.ResultKind,rp=Nn.success,np=Nn.isSuccess,ip=Nn.getArgType,ap=Nn.isValidArgsLength,op=Kh.Number|Kh.String|Kh.Boolean|Kh.Rich|Kh.Error|Kh.Blank,up=Jh(3,[Kh.Boolean,op,op],[],Qh.All,qh.None,Xh.None),sp=function(){function e(e,t){this.globals=e,this.locals=t}return Object.defineProperty(e.prototype,"config",{get:function(){return this.globals.config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mathpack",{get:function(){return this.globals.mathpack},enumerable:!0,configurable:!0}),e.prototype.applyFunction=function(e,t){var r=$h(e),n=t.some((function(e){return"object"==typeof e&&e.kind===Kh.Range}))?t.slice(0):t;return lh(this.globals,this.locals,n,r),this.runFunctionToCompletion(Fl(e),r,n)},e.prototype.applyOperatorOrFunction=function(e,t){if(Dl(e))return Uh(this.globals,kl(e),t);var r=bl(e);if(r===zh._UDF)return Rd(rf(["call UDF"]));var n=this.globals.getFirstOrderFunc(r);if(n.kind===tp.Failure)return Rd(n.reason);var i=n.value;if(null==i){var a="nonexistent worksheet function "+r;return Df("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",jh.NAME,a),xh}var o=i(this,t);if("object"==typeof o&&o.kind===Kh.Error){a="worksheet function "+r+" return value";Df("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",o.type,a)}return o},e.prototype.arrayLift=function(e,t,r){for(var n=this,i=0,a=0,o=0;o<r.length;o+=1){var u=r[o];_f(u)&&0==(ip(e,o)&Kh.Array)?(i=Math.max(i,u.rows),a=Math.max(a,u.cols)):(i=Math.max(i,1),a=Math.max(a,1))}var s=r.map((function(t,r){return n.broadcastOper(i,a,t,ip(e,r))})),c=new jl(i,a,(function(e,r){return t(s.map((function(t){return t.get(e,r)})))})).map((function(e){var t;if("object"!=typeof(t="object"==typeof e&&e.kind===sl.WorksheetFunction?n.runFunctionMachineToCompletion(e):e))return t;switch(t.kind){case Kh.Range:return Hh;case Kh.Missing:return 0;default:return t}}));return Vh(c.rows,c.cols,Xl(c))},e.prototype.dispatchFunction=function(e,t,r){var n=this;if(!ap(t,r.length)){var i=JSON.stringify(t),a="bad application of "+JSON.stringify(e)+" to "+r.length+" arguments, ftype = "+i;return Df("calc.runtime.FunctionDispatcher.dispatchFunction",jh.NUM,a),Wh}for(var o=r.length,u=Qh.None,s=0;s<o;s+=1){var c=ep(r[s]);0==(c&ip(t,s))&&(u|=c)}if(u===Qh.None)return this.applyOperatorOrFunction(e,r);if(0!=(u&Kh.Array)){return this.arrayLift(t,(function(r){return n.dispatchFunction(e,t,r)}),r)}u&=~Kh.Array;var l=[];for(s=0;s<o;s+=1){var f=r[s];if(0!=(u&ep(f))){var d=ip(t,s);if(f=this.coerceOper(f,d),ep(f)===Kh.Error&&0==(d&Kh.Error))return f}l[s]=f}return this.applyOperatorOrFunction(e,l)},e.prototype.dispatchStrictIf=function(e){var t=this,r=e[0];if("object"!=typeof r){var n=this.coerceOper(r,Kh.Boolean);return!0===n?e[1]:!1===n?e[2]:n}switch(r.kind){case Kh.Error:return r;case Kh.Missing:case Kh.Blank:return e[2];case Kh.Array:return this.arrayLift(up,(function(e){return t.dispatchStrictIf(e)}),e);case Kh.Rich:return Rd(rf(["calc.runtime.evalFunction.FunctionDispatcher.dispatchStrictIf: Strict IF with a rich value condition"]));case Kh.Range:var i="calc.runtime.FunctionDispatcher.dispatchStrictIf: "+("internal error: range condition "+R(r));return k.ULS.assertTag(595980809,c.LogCategory.msoulscat_ES_EWAJS,!1,i);default:return b("calc.runtime.FunctionDispatcher.dispatchStrictIf",r)}},e.prototype.getAvailableFormula=function(e){if(!Ar(Sr.CalcWebWorker))return Rd(rf(["getCellFormula on non-anchor"]));var t=this.globals.getCellFormula(e);return np(t)?dr(t.value)?void 0:t.value:Rd(t.reason)},e.prototype.dereferenceOper=function(e,t){return function(e,t,r,n){var i=[],a=ch(e,t,r,n,i);if(null==a){if(i.length>0)return Rd(vf(i));var o="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+R(r);return k.ULS.assertTag(595980819,c.LogCategory.msoulscat_ES_EWAJS,!1,o)}return a}(this.globals,this.locals,e,t)},e.prototype.dereferenceOpers=function(e,t){lh(this.globals,this.locals,e,t)},e.prototype.getSheetRangeIndexes=function(e){if(e.index===e.index2)return[e.index];if(null!=this.globals.getSheetRangeIndexes){var t=this.globals.getSheetRangeIndexes(e);return np(t)?t.value:Rd(t.reason)}"number"==typeof e.index&&"number"==typeof e.index2||Rd(rf(["getSheetRangeIndexes"]));for(var r=vr(e.index,e.index2),n=mr(e.index,e.index2),i=[],a=r;a<=n;a+=1)i.push(a);return i},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var i=[],a=[],o=function(o){var s=e[o];if("object"!=typeof s||s.kind!==Kh.Range)return a.push(s),"continue";for(var c=[],l=function(e){var r=uh(n.globals,n.locals,e,i,!0);void 0!==r&&c.push(t(r,e))},f=u.getSheetRangeIndexes(s.sheets),d=function(e){for(var t=Ph(s.sheets.document,f[e]),n=function(e){var n=s.ranges[e];if(!r)return l(Gh(t,n)),"continue";if(null==u.globals.getHiddenRows)return{value:Rd(rf(["getHiddenRows"]))};var i=u.globals.getHiddenRows(t,n.row,n.row+n.rows);if(!np(i))return{value:Rd(i.reason)};var a=i.value;if(0===a.length)return l(Gh(t,n)),"continue";for(var o=function(e,r){var i=W(e,n.col,r-e,n.cols);l(Gh(t,i))},c=0;c<a.length;c+=1){var f=a[c],d=f.start,h=f.end,p=0===c?n.row:a[c-1].end;L("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",p<=d&&d<h&&h<=n.row+n.rows),p!==d&&o(p,d);var v=W(d,n.col,h-d,n.cols);u.locals.precedents.cells.push(Gh(t,v))}var m=a[a.length-1].end;m!==n.row+n.rows&&o(m,n.row+n.rows)},i=0;i<s.ranges.length;i+=1){var a=n(i);if("object"==typeof a)return a}},h=0;h<f.length;h+=1){var p=d(h);if("object"==typeof p)return p}a.push({kind:cl.RangeValues,arrays:c})},u=this,s=0;s<e.length;s+=1){var c=o(s);if("object"==typeof c)return c.value}return i.length>0?Rd(vf(i)):a},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,cr,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new ql(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,i){var a=e.get(n,i),o=te(t.sheet,H(t.range.row+n,t.range.col+i));return[a,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.makeOperatorReducer=function(e,t){var r=this,n=this.getBinaryOperator(e);return function(i,a,o){var u,s=o;if(void 0!==i)u=i;else{if(u=null!=t?t(a):a,s<=1)return u;s-=1}var c=a;return s>1&&(e===Yh.Add&&1===a?c=s:function(e,t,r){var n=Sh(e,r,Ct(t).headTypes[1]);switch(t){case Nh.Add:return 0===n;case Nh.Mul:return 1===n;case Nh.Concat:return""===n;case Nh.And:case Nh.Or:return"boolean"==typeof n;case Nh.Xor:return!1===r}return!1}(r.globals,e,a)||D("calc.evalFunction.makeOperatorReducer: count/coerce unhandled")),n(u,c)}},e.prototype.makeBranchOperatorReducer=function(e){var t=this.makeOperatorReducer(e);return function(e,r,n){return void 0===e?r:Lf(e)||!0===t(e,r,1)?e:r}},e.prototype.reduceDerefOpers=function(e,t,r,n){function i(r,i,o,u){if("object"==typeof i&&i.kind===Kh.Array){for(var s=new Hl(i.rows,i.cols,i.opers),c=r,l=0;l<o;l+=1)c=a(c,s);return c}var f=(u&&void 0!==n?n:t)(i);return null==f?r:e(r,f,o)}function a(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var a=0;a<t.cols;a+=1){var o=t.get(n,a);void 0!==o&&(r=i(r,o,1,!0))}return r}function o(e,t){for(var r=e,n=t.getSparse(),a=t.cols-t.denseCols,o=0;o<t.denseRows;o+=1){for(var u=0;u<t.denseCols;u+=1){var s=t.get(o,u);void 0!==s&&(r=i(r,s,1,!1))}a>0&&void 0!==n&&(r=i(r,n,a,!1))}var c=(t.rows-t.denseRows)*t.cols;return c>0&&void 0!==n&&(r=i(r,n,c,!1)),r}return r.reduce((function(e,t){return"object"==typeof t&&t.kind===cl.RangeValues?t.arrays.reduce(o,e):i(e,t,1,!1)}),void 0)},e.prototype.broadcastOper=function(e,t,r,n){if("object"!=typeof r)return Ql(e,t,r);switch(r.kind){case Kh.Missing:case Kh.Blank:return Ql(e,t,0);case Kh.Array:return 0!=(n&Kh.Array)?Ql(e,t,r):function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?Ql(e,t,r.get(0,0)):1===r.rows?new jl(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new jl(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new jl(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}(e,t,new Hl(r.rows,r.cols,r.opers),Bh);case Kh.Range:default:return Ql(e,t,r)}},e.prototype.coerceOper=function(e,t){return Sh(this.globals,e,t)},e.prototype.getBinaryOperator=function(e){var t=this,r=Zh(e),n=[0,0];return function(i,a){return n[0]=i,n[1]=a,lh(t.globals,t.locals,n,r),t.runFunctionToCompletion(Nl(e),r,n)}},e.prototype.getUnaryOperator=function(e){var t=this,r=Zh(e),n=[0];return function(i){return n[0]=i,lh(t.globals,t.locals,n,r),t.runFunctionToCompletion(Nl(e),r,n)}},e.prototype.isInFilterMode=function(e){if(null==this.globals.isInFilterMode)return Rd(rf(["isInFilterMode"]));this.locals.precedents.special|=qh.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if("object"==typeof n&&n.kind===Kh.Range)for(var i=0,a=this.getSheetRangeIndexes(n.sheets);i<a.length;i++){var o=a[i],u=this.globals.isInFilterMode(Ph(n.sheets.document,o));if(!np(u))return Rd(u.reason);if(u.value)return!0}}return!1},e.prototype.runFunctionToCompletion=function(e,t,r){var n=this.dispatchFunction(e,t,r);return"object"==typeof n&&n.kind===sl.WorksheetFunction?this.runFunctionMachineToCompletion(n):n},e.prototype.runFunctionMachineToCompletion=function(e){for(;;){var t=e.next();if(null!=t)return t}},e}(),cp=function(e){function t(t,r){var n=e.call(this,t)||this;return n.func=r,n}return f(t,e),t.prototype.next=function(){var e=this.func.next();return null==e?this.performDefaultTransition():this.performReturnTransition(rp(e))},t.prototype.receiveSuccess=function(e){return k.ULS.assertTag(595980810,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.runtime.FunctionEvaluationMachine.receiveSuccess: received unexpected result")},t.prototype.receiveFailure=function(e){var t=e.reason;switch(t.kind){case af.Unevaluated:for(var r=[],n=t.anchors,i=n.length-1;i>=0;i-=1){var a=this.context.createCellEvaluationMachine(this.context,n[i]);r.push(a)}return this.performDependencyTransition(r);default:return this.performReturnTransition(e)}},t}(Nd);function lp(e,t){return new cp(e,t)}var fp=Sn.FormulaSource,dp=Tn.naErrorOper,hp=Nn.failure,pp=Nn.ResultKind,vp=Nn.createResolver;function mp(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Cr()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function gp(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=Cr()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:Math.min(e.endTimeMs,t)}}var Ep={kind:af.Timeout};function Sp(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Cr()>=e}},machineContext:Cp(e)}}function Cp(e){return{globals:e,visitedCellMap:bd.newVisitedMap(),resolver:vp(e),createCellEvaluationMachine:jd,createFormulaEvaluationMachine:Vp,createFunctionEvaluationMachine:lp}}var Tp=function(){function e(e,t){_("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.inputMachines=t.slice(),this.evaluationStack=[],this.results=[],this.nextIndex=0,this.currentResult=void 0}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===sf.Stop)return this.generatePartialResults(),k.ULS.traceTag(595953880,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime cancelled."),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(gp(e));return r instanceof Array?(k.ULS.traceTag(595953881,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime complete."),Promise.resolve(r)):(k.ULS.traceTag(595953882,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime yielding."),new Promise((function(r){return e.scheduleFunction((function(){return k.ULS.traceTag(595964228,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Resuming async evaluation."),r(t.evaluateAsync(e))}))})))}catch(e){return Promise.reject(hp(e))}},e.prototype.evaluateSync=function(e){var t=this,r=function(n){if(t.context.globals.interruptToken[0]===sf.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var i=t.evaluate(n);return i instanceof Array?i:Tf((function(t){return r(void 0!==t?t:gp(e))}))};return r(gp(e))},e.prototype.evaluate=function(e){try{for(;;){if(0===this.evaluationStack.length){if(!(this.nextIndex<this.inputMachines.length))return this.results;this.evaluationStack.push(this.inputMachines[this.nextIndex]),this.nextIndex+=1}if(this.context.timer.doTimeout(e))return Ep;var t=this.evaluationStack[this.evaluationStack.length-1],r=this.evaluateMachine(t);switch(this.currentResult=void 0,r.kind){case dd.Default:break;case dd.Dependency:for(var n=0;n<r.machines.length;n+=1)this.evaluationStack.push(r.machines[n]);break;case dd.Call:this.evaluationStack.push(r.machine);break;case dd.Return:case dd.Write:var i=this.performResultTransition(r);void 0!==i&&this.unwindWithJavaScriptError(i);break;case af.JavaScriptError:this.unwindWithJavaScriptError(r);break;default:return b("calc.runtime.EvaluationRuntime.evaluate",r)}}}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+e.message;return k.ULS.assertTag(595980807,c.LogCategory.msoulscat_ES_EWAJS,!1,a)}},e.prototype.evaluateMachine=function(e){try{if(null==this.currentResult)return e.next();if(this.currentResult.kind===pp.Success)return e.receiveSuccess(this.currentResult)}catch(e){if(!(e instanceof Td))return Cf(e);this.currentResult=hp(e.reason)}try{return e.receiveFailure(this.currentResult)}catch(e){return Cf(e)}},e.prototype.performResultTransition=function(e){if(e.kind===dd.Write)try{this.writeResult(e.locals,e.writeResult)}catch(e){return Cf(e)}var t=this.evaluationStack.pop();if(null!=t&&t.cleanup(),0===this.evaluationStack.length)this.results.push(e.result);else if(e.result.kind===pp.Success){(r=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===dd.Call&&(this.currentResult=e.result)}else{for(;this.evaluationStack.length>0;){var r;if((r=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===dd.Dependency)break;if(r.latestTransition===dd.Call){this.currentResult=e.result;break}var n=this.evaluationStack.pop();null!=n&&n.cleanup()}if(0===this.evaluationStack.length){var i="calc.runtime.EvaluationRuntime.evaluate: "+("internal error: empty stack while returning "+R(e.result));return k.ULS.assertTag(595980808,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}}},e.prototype.writeResult=function(e,t){switch(t.kind){case pp.Success:this.setFormulaValue(e,t.value);break;case pp.Failure:this.context.globals.setCellFailure(e.range,t.reason,e.precedents)}this.context.globals.setDynamicPrecs(e.range,e.precedents)},e.prototype.setFormulaValue=function(e,t){var r=Mf(t)?0:t;if(e.source===fp.Cell){if(_f(r)){var n=void 0===r.opers[0]?dp:r.opers[0][0],i=Mf(n)?0:n;return this.context.globals.setCellValue(e.range,i,e.precedents)}return this.context.globals.setCellValue(e.range,r,e.precedents)}var a=e.range.range,o=Gf(a.rows,a.cols,r).opers.map((function(e){return e.map((function(e){return Mf(e)?0:e}))}));return this.context.globals.setCellValues(e.range,o,e.precedents)},e.prototype.generatePartialResults=function(){for(var e=this.inputMachines.length-this.results.length,t=0;t<e;t+=1)this.results.push(hp(pf))},e.prototype.unwindWithJavaScriptError=function(e){for(var t=hp(e);this.evaluationStack.length>0;){var r=this.evaluationStack[this.evaluationStack.length-1],n=r.receiveJavaScriptError(t);if(void 0!==n){var i=this.performResultTransition(n);if(void 0===i)return;var a=function(e){if(null==e)return"null/undefined";var t=e.message;return"string"==typeof t?t:"no message"};t=hp(Cf(new Error("failed to write ("+a(t.reason.error)+"): "+a(i.error))))}else this.evaluationStack.pop(),r.cleanup()}this.results.push(t)},e}(),Rp=Sn.FormulaSource,yp=Tn.PrecsBound,Ip=Tn.ErrorType,Op=Tn.nameErrorOper,Ap=Tn.refErrorOper,Np=Tn.OperKind,kp=Tn.arrayOper,Fp=Tn.range3DOper,bp=Nn.ResultKind,Dp=Nn.success,Lp=Nn.failure,Mp=Nn.sheetGridRangeAnchor,_p=Nn.createResolutionHandler,wp=Nn.createNameFinder,Up=[void 0,Op],Pp=hd;var Gp=function(e){function t(t,r,n){var i=e.call(this,t)||this;return i.nameEvaluator=_p(wp((function(e){var t=i.getNameFormulaAsTerm(i.locals,e);return void 0!==t&&i.checkForNameCycle(e,i.visitedNameMap),t}),Up),(function(e){var t="name resolution; qualifier = "+R(e);return Df("calc.runtime.FormulaEvaluationMachine.evalName",Ip.NAME,t),Up}),Rd),i.cellEvaluator=_p((function(e){return Fp(e.sheet,e.range)}),(function(e){var t="error ref, qualifier = "+R(e.data.qualifier);return Df("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",Ip.REF,t),Ap}),Rd),i.term=rd("calc.runtime.FormulaEvaluationMachine",n),i.locals=r,i.continuation=[],i.env=Pp,i.visitedNameMap=Fd.newVisitedMap(),i.dispatcher=new sp(i.context.globals,r),i}return f(t,e),t.prototype.next=function(){if(Vl(this.term)){var e=this.continuation;if(0===e.length){var t=this.dispatcher.dereferenceOper(this.term,bf),r=this.dispatcher.coerceOper(t,bf);return this.locals.precedents.bound=yp.Exact,Ar(Sr.CalcPreventSpillingHack)&&this.locals.source===Rp.Cell&&_f(r)&&(1!==r.rows||1!==r.cols)?this.performReturnTransition(Lp(rf(["spilling"]))):this.performReturnTransition(Dp(r))}var n=e[e.length-1];return this.applyContinuation(this.term,n)}return this.reduceFormula(this.term)},t.prototype.receiveSuccess=function(e){return this.updateTermTransition(e.value)},t.prototype.receiveFailure=function(e){var t=e.reason;switch(t.kind){case af.Unevaluated:for(var r=[],n=t.anchors,i=n.length-1;i>=0;i-=1){var a=this.context.createCellEvaluationMachine(this.context,n[i]);r.push(a)}return this.performDependencyTransition(r);default:return this.performReturnTransition(e)}},t.prototype.applyContinuation=function(e,t){var r=t.context;switch(r.kind){case Ol.App:var n=t.holeIndex,i=r.children.length;if((s=t.locals)[n]=e,n+1<i)return this.nextHoleTransition(t,r.children[n+1]);var a=r.data.funName,o=r.data.funType;this.dispatcher.dereferenceOpers(s,o);var u=this.dispatcher.dispatchFunction(a,o,s);return"object"==typeof u&&u.kind===sl.WorksheetFunction?this.evaluateFunctionTransition(u,t.env):this.popContextTransition(t.env,u);case Ol.If:var s;if(0===(n=t.holeIndex)){var l=this.dispatcher.dereferenceOper(e,Np.Boolean);if("object"!=typeof l){var f=this.dispatcher.coerceOper(l,Np.Boolean),d=!0===f?r.children[1]:!1===f?r.children[2]:f;return this.popContextTransition(t.env,d)}switch(l.kind){case Np.Error:return this.popContextTransition(t.env,l);case Np.Missing:case Np.Blank:return this.popContextTransition(t.env,r.children[2]);case Np.Array:return t.locals=[l],this.nextHoleTransition(t,r.children[n+1]);case Np.Rich:return this.performReturnTransition(Lp(rf(["IF with a rich value condition"])));case Np.Range:var h="calc.runtime.FormulaEvaluationMachine.applyContinuation: "+("internal error: range condition "+R(l));return k.ULS.assertTag(595980811,c.LogCategory.msoulscat_ES_EWAJS,!1,h);default:return b("calc.runtime.FormulaEvaluationMachine.applyContinuation (if)",l)}}if((s=t.locals)[n]=e,1===n)return this.nextHoleTransition(t,r.children[n+1]);this.dispatcher.dereferenceOpers(s,up);var p=this.dispatcher.dispatchStrictIf(s);return this.popContextTransition(t.env,p);case Ol.Name:var v=t.locals;return Fd.unVisit(v,void 0,this.visitedNameMap),this.popContextTransition(t.env,e);case Ol.Let:var m=r.data,g=e,E=t.env;return this.popContextTransition(pd(m,g,E),r.children[1]);case Ol.Array:var S=this.dispatcher.dereferenceOper(e,kf),C=r.data,T=C.rows,y=C.cols,I=t.holeIndex,O=I%y,A=y===O+1,N=(I-O)/y,F=t.locals;if(F[N][O]=this.dispatcher.coerceOper(S,kf),T===N+1&&A)return this.popContextTransition(t.env,kp(T,y,F));var D=A?N+1:N,L=A?0:O+1;return this.nextHoleTransition(t,r.children[D][L]);default:return b("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}},t.prototype.reduceFormula=function(e){switch(e.kind){case Ol.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case Ol.App:var t=e.data.funName;if(!Dl(t)){var r=this.context.globals.getFirstOrderFunc(bl(t));if(r.kind===bp.Failure)return Rd(r.reason)}if(0===e.children.length){var n=this.dispatcher.dispatchFunction(t,e.data.funType,[]);return"object"==typeof n&&n.kind===sl.WorksheetFunction?this.evaluateFunctionTransition(n,void 0):this.updateTermTransition(n)}return this.pushContextTransition(e,e.children[0],[]);case Ol.If:case Ol.Let:return this.pushContextTransition(e,e.children[0],void 0);case Ol.Name:var i=this.evalName(this.locals,e.data.qualifier,e.data.whole);return void 0!==i[0]?this.pushContextTransition(e,i[1],i[0]):this.updateTermTransition(i[1]);case Ol.Ident:var a=vd(e.data,this.env);if(null==a){var o="undefined local "+e.data;Df("calc.runtime.FormulaEvaluationMachine.reduceFormula",Ip.NAME,o)}return this.updateTermTransition(void 0===a?Op:a);case Ol.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case Ol.Fun:return this.performReturnTransition(Lp(rf(["Step: FunNode to closure"])));default:return b("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},t.prototype.pushContextTransition=function(e,t,r){var n=function(e,t,r){return{context:e,holeIndex:0,env:t,locals:r}}(e,this.env,r);return this.continuation[this.continuation.length]=n,this.updateTermTransition(t)},t.prototype.popContextTransition=function(e,t){return this.env=e,this.continuation.pop(),this.updateTermTransition(t)},t.prototype.evaluateFunctionTransition=function(e,t){void 0!==t&&(this.env=t,this.continuation.pop());var r=this.context.createFunctionEvaluationMachine(this.context,e);return this.performCallTransition(r)},t.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.env=e.env,this.updateTermTransition(t)},t.prototype.updateTermTransition=function(e){return this.term=e,this.performDefaultTransition()},t.prototype.getNameFormulaAsTerm=function(e,t){e.precedents.names.push(t);var r=this.context.globals.getNameFormula(t);if(r.kind===bp.Failure)return Rd(r.reason);var n=r.value;return null!=n?rd("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0},t.prototype.checkForNameCycle=function(e,t){if(void 0!==Fd.lookup(e,t))return Rd(gf(Fd.runFrom(e,t)));Fd.visit(e,!0,t)},t.prototype.evalName=function(e,t,r){var n=Mp(e.range),i=this.context.resolver.resolveName(n,t,r);return this.nameEvaluator(t,i)},t.prototype.evalCellRefTerm=function(e){var t=Mp(this.locals.range),r=this.context.resolver.resolveCellRef(t,e.data.qualifier,e.data.ref);return this.cellEvaluator(e,r)},t}(Nd);function Vp(e,t,r){return new Gp(e,t,r)}function xp(e,t,r,n){var i=Sp(e),a=Vp(i.machineContext,t,r);return function e(t,r){var n=t.evaluate(r);return n instanceof Array?n[0]:Tf((function(n){return e(t,"number"==typeof n?n:r)}))}(new Tp(i,[a]),dr(n)?void 0:n)}function Bp(e){var t=bd.newVisitedMap();return{evalFormula:function(r,n,i,a){var o=Od(r,n,yd(),t);return xp(e,o,i,a)},evalCells:function(t){return function(e,t){if(0===t.length)return[];var r=qd(e,t),n=mp(e.schedulerInfo);return r.evaluateSync(n)}(e,t)},evalCellsAsync:function(t){return function(e,t){if(0===t.length)return Promise.resolve([]);var r=qd(e,t),n=mp(e.schedulerInfo);return r.evaluateAsync(n)}(e,t)}}}var Wp,Hp=yn.formulaSpan,Kp=yn.RefStyle,jp=Sn.FormulaSource,qp=Nn.getSubExpressionFromPosition,Jp=Nn.isSuccess,Xp=Nn.failure,Yp=Nn.ResultKind,Qp=Nn.isWellFormed,zp=Hp(0,0,"","");function Zp(e){var t,r,n,i,a=e.config,o=e.mathpack,u=ti(a),s=Os(a),c=of(a,o),l=hl(s),f=id(c),d=Bp(e),h=cs(u).parseFormula,p=!1,v=void 0,m=-1,g=!1;function E(){p=!1,n=void 0,m=-1,v=void 0,i=void 0,g=!1}function S(){if(!p){if(p=!0,void 0===t||void 0===r)return;var e=h(Kp.A1,t,jp.Range,r);Jp(e)&&(n=e.value)}}function C(e){if(S(),void 0!==n&&e!==m){var t=v;v=void 0,e>=0&&e<r.length&&(v=qp(n,e)),v!==t&&(i=void 0,g=!1),m=e}}function T(){if(void 0!==v&&!g&&void 0!==n){var e=t,r=l.checkFormula(e,jp.Range,{node:v,spans:n.spans});if(Qp(r)){var a=f.compileFormula(e,jp.Range,r);if(Jp(a)){var o=d.evalFormula(e,jp.Range,a.value,void 0);o.kind!==Yp.Paused&&(i=o)}}g=!0}}return{setCellAndFormula:function(e,n){t=e,r=n,E()},getSubExpressionSpanFromFormulaCharacterIndex:function(e){if(C(e),void 0!==n&&void 0!==v){var t=n.spans[v.label];if(void 0!==t)return t}return zp},evaluateSubExpressionFromFormulaCharacterIndex:function(e){return C(e),T(),void 0!==i?Promise.resolve(i):Promise.resolve(Xp(Cf("formula Inspector Service.evaluateSubExpressionFromFormulaCharacterIndex : No valid formula to evaluate.")))},evaluateSubExpression:function(){return S(),void 0!==n&&(v=n.node,i=void 0,g=!1),T(),void 0!==i?Promise.resolve(i):Promise.resolve(Xp(Cf("formula Inspector Service.evaluateSubExpression : No valid formula to evaluate.")))}}}!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(Wp||(Wp={}));var $p=function(){function e(e,t){this.localeInfo=e,this.source=t,this.bytecode=[],this.blocks=[];for(var r="",n=0;n<t.length;n+=1){var i=t.charCodeAt(n);if(126===i&&n+1<t.length){var a=t.charCodeAt(n+1);if(63===a||42===a){r+=t.charAt(n+1),n+=1;continue}}63!==i&&42!==i?r+=t.charAt(n):(this.pushBlock(r),r="",this.pushMeta(i))}this.pushBlock(r)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(Wp.OP_DOT)}},e.prototype.pushMeta=function(e){63===e?this.bytecode.push(Wp.OP_DOT):this.bytecode.push(Wp.OP_DOTSTAR)},e.prototype.test=function(e){var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var n=Object.keys(t);if(t=Object.create(null),0===n.length)return!1;for(var i=0;i<n.length;i+=1){var a=Number(n[i]);if(a!==this.bytecode.length){var o=this.bytecode[a];switch(o){case Wp.OP_DOT:this.addState(t,a+1);break;case Wp.OP_DOTSTAR:this.addState(t,a);break;default:var u=this.blocks[o];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,a+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;var r=this.bytecode;t<r.length&&r[t]===Wp.OP_DOTSTAR&&(e[t+1]=!0)},e}(),ev={"=":ot.Eq,"<":ot.Lt,">":ot.Gt},tv={"<>":ot.Ne,"<=":ot.Le,">=":ot.Ge};function rv(e,t){if("string"!=typeof t)return t;var r,n,i=(r=t).length>=2&&void 0!==(n=tv[r.substring(0,2)])?[n,r.substring(2)]:r.length>=1&&void 0!==(n=ev[r.substring(0,1)])?[n,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:i[0],operand:function(e,t){if(0===e.stringCompareCI(t,e.trueName))return!0;if(0===e.stringCompareCI(t,e.falseName))return!1;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(void 0!==n&&0===e.stringCompareCI(n,t))return ue(r)}var i=e.parseNumber(t);return void 0===i||isNaN(i)?t:i}(e,i[1])}}function nv(e,t,r,n){var i=function(e,t){var r="object"==typeof t&&"FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:ot.Eq,operand:t};if(r.operator===ot.Ne&&""===r.operand)return function(e){return!Mf(e)};if(r.operator===ot.Eq&&""===r.operand)return Mf;if(void 0!==r.operator&&""===r.operand)return function(e){return!1};if(void 0===r.operator&&""===r.operand)return function(e){return Mf(e)||""===e};var n,i,a=void 0===r.operator?ot.Eq:r.operator;switch(typeof r.operand){case"number":return n=a,i=r.operand,function(t){var r=wf(t)?t.getFallback():t;if("number"==typeof r)return Uh(e,n,[r,i]);if("string"==typeof r&&n===ot.Eq){var a=e.config.localeInfo.parseNumber(r);return void 0!==a&&!isNaN(a)&&Uh(e,n,[a,i])}return n===ot.Ne};case"boolean":return function(t,r){return function(n){var i=wf(n)?n.getFallback():n;return"boolean"==typeof i?Uh(e,t,[i,r]):t===ot.Ne}}(a,r.operand);case"string":return function(t,r){switch(t){case ot.Eq:case ot.Ne:var n=new $p(e.config.localeInfo,r);return function(e){var r=wf(e)?e.getFallback():e;return"string"!=typeof r?t===ot.Ne:n.test(r)===(t===ot.Eq)};case ot.Lt:case ot.Gt:case ot.Le:case ot.Ge:return function(n){var i=wf(n)?n.getFallback():n;return"string"==typeof i&&Uh(e,t,[i,r])}}}(a,r.operand);case"object":return Lf(r.operand)?function(e,t){return function(r){var n=wf(r)?r.getFallback():r;return Lf(n)?Dh(e,n.type-t.type):e===ot.Ne}}(a,r.operand):b("calc.funcs.criteria.compileCriteria",r.operand)}return b("calc.funcs.criteria.compileCriteria",r.operand)}(e,rv(e.config.localeInfo,r)),a=t,o=void 0===n?a:n;return new ql(o.rows,o.cols,mr(a.denseRows,o.denseRows),mr(a.denseCols,o.denseCols),(function(e,t){return i(a.get(e,t))?o.get(e,t):void 0}),(function(){return i(a.getSparse())?o.getSparse():void 0}))}var iv=On.OperatorId,av=Nn.isSheetIndex;function ov(e){if("object"!=typeof e)return"number"==typeof e?e:void 0;switch(e.kind){case j.Error:return e;case j.Missing:case j.Blank:return;case j.Rich:return ov(e.getFallback());default:return b("calc.funcs.arithmeticOperationCoerce",e)}}function uv(e){switch(typeof e){case"boolean":return e?1:0;case"number":return e;case"string":return 0;case"object":break;default:return b("calc.funcs.arithmeticAOperationCoerce",e)}switch(e.kind){case j.Error:return e;case j.Missing:case j.Blank:return;case j.Rich:return uv(e.getFallback());default:return b("calc.funcs.arithmeticAOperationCoerce",e)}}function sv(e){return function(t){if(null!=e(t))return 1}}function cv(e,t){var r=e.reduceDerefOpers(e.makeOperatorReducer(iv.Add),ov,t);return null==r?0:r}function lv(e){return e.kind===j.Range&&(!av(e.sheets)||1!==e.ranges.length)}function fv(e,t,r){if(lv(t))return Xt(le);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return Jt({values:n,valuesToFilter:n})}if(lv(r))return Xt(le);var i=function(e,t){var r=e.ranges[0],n=t.ranges[0],i=vr(r.cols,16384-n.col),a=vr(r.rows,(1<<20)-n.row),o=W(r.row,r.col,a,i),u=Te(e.sheets,o),s=W(n.row,n.col,a,i),c=Te(t.sheets,s);return{actualEvalRange:u,actualFilterRange:c}}(t,r),a=i.actualEvalRange,o=i.actualFilterRange,u=a.ranges[0],s=o.ranges[0],c=e.dereferenceAllOpers([a])[0];return u.col===s.col&&u.row===s.row?Jt({values:c,valuesToFilter:c}):Jt({values:c,valuesToFilter:e.dereferenceAllOpers([o])[0]})}function dv(e,t){var r=t,n=r[0],i=r[1],a=fv(e,n,r[2]);if(!Yt(a))return a.reason;var o=a.value,u=o.values,s=o.valuesToFilter;return cv(e,[pl([nv(e,u.arrays[0],i,s.arrays[0])])])}function hv(e,t){var r=e.reduceDerefOpers(e.makeOperatorReducer(iv.Mul),ov,t);return null==r?0:r}function pv(e,t,r,n){var i=r.makeOperatorReducer(iv.Add),a=r.reduceDerefOpers(i,e,n,t),o=r.reduceDerefOpers(i,sv(e),n,void 0===t?void 0:sv(t));if(null!=a&&null!=o)return r.getBinaryOperator(iv.Div)(a,o);if(null==a&&null==o)return ce;var u="calc.funcs.averageInner: (sumOper == null) !== (countOper == null); values = "+R(n);return k.ULS.assertTag(595980871,c.LogCategory.msoulscat_ES_EWAJS,!1,u)}var vv=pv.bind(void 0,ov,void 0),mv=pv.bind(void 0,uv,(function e(t){return"string"==typeof t?0:wf(t)?e(t.getFallback()):ov(t)}));function gv(e,t){var r=t,n=r[0],i=r[1],a=fv(e,n,r[2]);if(!Yt(a))return a.reason;var o=a.value,u=o.values,s=o.valuesToFilter,c=[pl([nv(e,u.arrays[0],i,s.arrays[0]).strict()])];return vv(e,c)}function Ev(e,t){var r=e.dereferenceAllOpers(t);return mv(e,r)}function Sv(e,t){var r=e.dereferenceAllOpers(t),n=e.reduceDerefOpers(e.makeOperatorReducer(iv.Concat,(function(t){return e.coerceOper(t,j.String)})),cr,r);if(null==n){var i="calc.funcs.concat: returned undefined; args = "+R(t);return k.ULS.assertTag(595969627,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return"string"==typeof n&&n.length>32767?Tn.valueErrorOper:n}function Cv(e,t,r){var n=t.makeOperatorReducer(iv.Add),i=t.reduceDerefOpers(n,e,r);return null==i?0:i}var Tv=Cv.bind(void 0,(function(e){return"number"==typeof(wf(e)?e.getFallback():e)?1:0}));function Rv(e,t){var r=e.dereferenceAllOpers(t);return Tv(e,r)}var yv=Cv.bind(void 0,(function(e){var t="object"==typeof e&&e.kind===j.Blank;return(t=t||""===e)?1:0}));var Iv=Cv.bind(void 0,(function(e){var t=wf(e)?e.getFallback():e;return"object"!=typeof t||t.kind!==j.Blank?1:0}));function Ov(e,t){var r=e.dereferenceAllOpers(t);return Iv(e,r)}var Av=Cv.bind(void 0,(function(e){return 1}));function Nv(e,t){var r=t,n=r[0],i=r[1];if(lv(n))return le;var a=e.dereferenceAllOpers([n])[0],o=[pl([nv(e,a.arrays[0],i)])];return Av(e,o)}function kv(e,t,r,n,i){var a=n.makeBranchOperatorReducer(e),o=n.reduceDerefOpers(a,t,i,r);return null==o?0:o}var Fv=kv.bind(void 0,iv.Gt,ov,void 0),bv=kv.bind(void 0,iv.Lt,ov,void 0),Dv=kv.bind(void 0,iv.Gt,uv,ov),Lv=kv.bind(void 0,iv.Lt,uv,ov);function Mv(e,t){var r=e.dereferenceAllOpers(t);return Dv(e,r)}function _v(e,t){var r=e.dereferenceAllOpers(t);return Lv(e,r)}function wv(e,t,r){var n=t.reduceDerefOpers(t.makeOperatorReducer(e),function(e){return function t(r){if("boolean"==typeof r)return r;if("number"==typeof r)return e.coerceOper(r,j.Boolean);if("string"!=typeof r)switch(r.kind){case j.Error:return r;case j.Missing:case j.Blank:return;case j.Rich:return t(r.getFallback());default:return b("funcs.aggregationFuncs: booleanOperationCoerce",r)}}}(t),r);return null==n?le:n}var Uv=wv.bind(void 0,iv.And),Pv=wv.bind(void 0,iv.Or),Gv=wv.bind(void 0,iv.Xor);function Vv(e,t){var r=e.dereferenceAllOpers(t);return Uv(e,r)}function xv(e,t){var r=e.dereferenceAllOpers(t);return Pv(e,r)}function Bv(e,t){var r=e.dereferenceAllOpers(t);return Gv(e,r)}function Wv(e){return function(t,r,n){if(void 0!==t&&Lf(t))return t;if("number"==typeof r)for(var i=0;i<n;i+=1)e.push(r);return r}}function Hv(e,t,r,n){var i=[],a=t.reduceDerefOpers(Wv(i),ov,[r]);if(null==a)return he;if(Lf(a))return a;if(n<1)return he;if(n>i.length)return he;var o=i.sort((function(e,t){return e-t}));return e?o[i.length-Math.ceil(n)]:o[Math.floor(n)-1]}var Kv=Hv.bind(void 0,!0);function jv(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return Kv(e,n,i)}var qv=Hv.bind(void 0,!1);function Jv(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return qv(e,n,i)}function Xv(e,t,r,n){var i=[],a=e.reduceDerefOpers(Wv(i),ov,t);if(null==a)return he;if(Lf(a))return a;if(r<0)return he;if(r>1)return he;var o=i.sort((function(e,t){return e-t})),u=n?(o.length-1)*r:(o.length+1)*r-1;return u<0||u>o.length-1?he:g(u)?o[u]:o[Math.floor(u)]+(o[Math.ceil(u)]-o[Math.floor(u)])*(u-Math.floor(u))}var Yv=function(e,t,r){return Xv(e,[t],r,!0)};function Qv(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return Yv(e,n,i)}var zv=function(e,t,r){return Xv(e,[t],r,!1)};function Zv(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return zv(e,n,i)}var $v=function(e,t,r){return Xv(e,[t],Math.floor(r)/4,!0)};function em(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return $v(e,n,i)}var tm=function(e,t,r){return Xv(e,[t],Math.floor(r)/4,!1)};function rm(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return tm(e,n,i)}function nm(e,t){return Xv(e,t,.5,!0)}function im(e,t){var r=e.dereferenceAllOpers(t);return nm(e,r)}function am(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1],a=[],o=e.reduceDerefOpers(Wv(a),ov,[n]);if(null==o)return he;if(Lf(o))return o;if(i<0)return he;if(i>=1)return he;a=a.sort((function(e,t){return e-t}));var u=Math.floor(a.length*i/2);L("calc.funcs.trimmean",u+u<a.length);var s=a[u],c=a[a.length-1-u],l=0,f=0,d=e.makeOperatorReducer(iv.Add),h=e.reduceDerefOpers(d,(function(e){var t=ov(e);if(void 0===t)return t;if("number"!=typeof t)return D("calc.funcs.trimmean: unexpected error");if(t<s)l+=1;else{if(!(t>c))return t;f+=1}}),[n]);if(null==h)return D("calc.funcs.trimmean: found no elements");if("number"!=typeof h)return D("calc.funcs.trimmean: unexpected error");for(L("calc.funcs.trimmean: trimmed too many",l<=u&&f<=u);l<u;l+=1)h-=s;for(;f<u;f+=1)h-=c;return e.getBinaryOperator(iv.Div)(h,a.length-u-u)}function om(e){return function(t){var r=e(t);return"number"==typeof r?r*r:r}}function um(e,t){return function(r){var n=e(r);if("number"!=typeof n)return n;var i=n-t;return i*i}}function sm(e,t,r,n){var i=r.makeOperatorReducer(iv.Add),a=r.reduceDerefOpers(i,sv(e),n,void 0===t?void 0:sv(t));if(null==a)return ce;if("number"!=typeof a||a<1)return D("calc.funcs.varFirstPass: unexpected count type");var o=r.reduceDerefOpers(i,e,n,t),u=r.reduceDerefOpers(i,om(e),n,void 0===t?void 0:om(t));return null==o?D("calc.funcs.varFirstPass: unexpected error"):Lf(o)?o:"number"!=typeof o||"number"!=typeof u?D("calc.funcs.varFirstPass: unexpected error"):[a,o,u,o/a]}function cm(e,t,r,n,i){var a=r.makeOperatorReducer(iv.Add),o=r.reduceDerefOpers(a,um(e,i),n,void 0===t?void 0:um(t,i));return"number"!=typeof o?D("calc.funcs.varSecondPass: unexpected error"):o}function lm(e,t,r,n){var i=sm(e,t,r,n);if(!Array.isArray(i))return i;var a=i[0],o=i[1],u=i[2],s=i[3];if(a<2)return ce;var c=o*o/a,l=u-c;if(0===s)return l<0?0:l/(a-1);if(l>=0){var f=l/(a-1);if(f>21219957905e-324&&Math.abs(c/u-1)>.01&&Math.abs(s/f)-1e3<0)return f}var d=cm(e,t,r,n,s);return d<0?0:d/(a-1)}function fm(e,t,r,n){var i=sm(e,t,r,n);if(!Array.isArray(i))return i;var a=i[0],o=i[1],u=i[2],s=i[3];if(a<1)return ce;var c=o*o,l=u*a-c;if(0===s)return l<0?0:l/(a*a);if(l>=0){var f=l/(a*a);if(f>21219957905e-324&&Math.abs(c/a/u-1)>.01&&Math.abs(s/f)-1e3<0)return f}var d=cm(e,t,r,n,s);return d<0?0:d/a}var dm=lm.bind(void 0,ov,void 0),hm=fm.bind(void 0,ov,void 0),pm=lm.bind(void 0,uv,ov),vm=fm.bind(void 0,uv,ov);function mm(e){return function(t,r){var n=e(t,r);return"number"!=typeof n?n:Math.sqrt(n)}}var gm=mm(dm),Em=mm(hm),Sm=mm(pm),Cm=mm(vm);function Tm(e,t){var r=e.dereferenceAllOpers(t);return gm(e,r)}function Rm(e,t){var r=e.dereferenceAllOpers(t);return Em(e,r)}function ym(e,t){var r=e.dereferenceAllOpers(t);return Sm(e,r)}function Im(e,t){var r=e.dereferenceAllOpers(t);return Cm(e,r)}function Om(e,t){var r=e.dereferenceAllOpers(t);return dm(e,r)}function Am(e,t){var r=e.dereferenceAllOpers(t);return hm(e,r)}function Nm(e,t){var r=e.dereferenceAllOpers(t);return pm(e,r)}function km(e,t){var r=e.dereferenceAllOpers(t);return vm(e,r)}var Fm=[vv,Tv,Iv,Fv,bv,hv,gm,Em,cv,dm,hm];function bm(e,t){var r,n=[],i=e.reduceDerefOpers((r=n,function(e,t,n){if(void 0!==e&&Lf(e))return e;if("number"==typeof t)for(var i=0;i<n;i+=1)r.push({value:t,index:r.length});return t}),ov,t);if(null==i)return pe;if(Lf(i))return i;var a=n.sort((function(e,t){return e.value<t.value?-1:e.value===t.value?0:1})),o=1,u=0,s=Number.MAX_SAFE_INTEGER,c=[];function l(e){o=1,s=e.index}var f,d,h,p=function(e){var t=e.value;o>u?(u=o,c=[{value:t,index:s}]):o===u&&c.push({value:t,index:s})};l(a[0]);for(var v=1;v<a.length;v+=1)d=a[v-1],h=a[v],d.value===h.value?((f=a[v]).index<s&&(s=f.index),o+=1):(p(a[v-1]),l(a[v]));return p(a[a.length-1]),u<2?pe:0===c.length?D("calc.funcs.modeInner: unexpected error"):c.sort((function(e,t){return e.index-t.index}))}function Dm(e,t){var r=bm(e,t);return Array.isArray(r)?r[0].value:r}function Lm(e,t){var r=e.dereferenceAllOpers(t);return Dm(e,r)}function Mm(e,t){var r=e.dereferenceAllOpers(t),n=bm(e,r);return Array.isArray(n)?Se(Lm.length,1,n.map((function(e){return[e.value]}))):n}function _m(e){return"object"!=typeof e||e.kind!==cl.RangeValues?e:pl(e.arrays.map((function(e){return e.map((function(e){var t=e[0],r=e[1];return void 0!==r&&function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(void 0!==r&&r.kind===Ae.WorksheetFuncName&&(r.id===Be.SUBTOTAL||r.id===Be.AGGREGATE))return!0}return!1}(r.formula.annotations)?void 0:t}))})))}function wm(e,t){var r=Math.floor(t[0]),n=Fm.length;if(!(r>=1&&r<=n||r>=101&&r<=n+100))return le;var i=r>100||e.isInFilterMode(t.slice(1)),a=e.dereferenceAllOpersAndFormulae(t.slice(1),i).map(_m);return(0,Fm[r%100-1])(e,a)}var Um=m(Fm,[nm,Dm]),Pm=[Kv,qv,Yv,$v,zv,tm];function Gm(e,t){var r=Math.floor(t[0]),n=Math.floor(t[1]);if(!(r>=1&&r<=Um.length+Pm.length&&n>=0&&n<=7))return le;var i=1==(1&n),a=2==(2&n),o=!(4==(4&n));function u(t){var r=o?e.dereferenceAllOpersAndFormulae(t,i).map(_m):e.dereferenceAllOpers(t,i);return a&&(r=r.map((function(e){if("object"!=typeof e)return e;if(e.kind===cl.RangeValues)return pl(e.arrays.map((function(e){return e.map((function(e){return void 0===e||Lf(e)?void 0:e}))})));if(e.kind===j.Array){var t=e.opers.map((function(e){return e.map((function(e){return void 0===e||Lf(e)?void 0:e}))}));return function(e,t,r){return M("calc.runtime.coercedArrayOper",e),M("calc.runtime.coercedArrayOper",t),r.length!==e?D("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:j.Array,rows:e,cols:t,opers:r}}(e.rows,e.cols,t)}return e}))),r}if(r>Um.length){if(4!==t.length)return le;var s=e.dereferenceOper(t[3],j.Number);if(Lf(s))return le;var c=t[2];if(c.kind===j.Range&&!av(c.sheets))return le;var l=u([c])[0],f=Um.length;return(0,Pm[r-f-1])(e,l,s)}for(var d=2;d<t.length;d+=1){var h=t[d];if("object"!=typeof h||h.kind!==j.Range||!av(h.sheets))return le}var p=u(t.slice(2));return r<1||r>Um.length?D("calc.funcs.aggregate: requested non-array function with unexpected number"):(0,Um[r-1])(e,p)}function Vm(e){return function(t,r){return e(t)(r[0])}}function xm(e){return function(t,r){return e(t)(r[0],r[1])}}var Bm=Tn.numErrorOper,Wm=Tn.div0ErrorOper,Hm=180/Math.PI,Km=Math.PI/180;function jm(e,t){return Math.PI}var qm=Vm((function(e){return e.mathpack.sqrt})),Jm=Vm((function(e){return e.mathpack.exp})),Xm=xm((function(e){return e.mathpack.power})),Ym=Vm((function(e){return e.mathpack.ln})),Qm=Vm((function(e){return e.mathpack.log10}));function zm(e,t){var r=t[0],n=t.length<2?10:t[1];return e.mathpack.log(r,n)}var Zm=Vm((function(e){return e.mathpack.sin})),$m=Vm((function(e){return e.mathpack.cos})),eg=Vm((function(e){return e.mathpack.tan})),tg=Vm((function(e){return e.mathpack.asin})),rg=Vm((function(e){return e.mathpack.acos})),ng=Vm((function(e){return e.mathpack.atan})),ig=xm((function(e){return e.mathpack.atan2}));function ag(e,t){var r=t,n=r[0],i=r[1],a=Math.pow(10,Math.ceil(i));return n<0?-Math.round(-n*a)/a:Math.round(n*a)/a}function og(e,t){var r=t,n=r[0],i=r[1],a=Math.pow(10,i<0?-Math.floor(-i):Math.floor(i));return n<0?-Math.ceil(-n*a)/a:Math.ceil(n*a)/a}function ug(e,t){var r=t,n=r[0],i=r[1],a=Math.pow(10,i<0?-Math.floor(-i):Math.floor(i));return n<0?-Math.floor(-n*a)/a:Math.floor(n*a)/a}function sg(e,t){var r=t,n=r[0],i=r[1];return 0===i?0:i<0&&n>0?Bm:i*Math.ceil(n/i)}function cg(e,t){var r=t,n=r[0],i=r[1];return 0===i?0===n?0:Wm:i<0&&n>0?Bm:i*Math.floor(n/i)}function lg(e,t){var r=t[0];return 2*(r<0?Math.floor(r/2):Math.ceil(r/2))}function fg(e,t){var r=t[0];return Math.abs(r)}function dg(e,t){var r=t[0];return r>0?1:0===r?0:r<0?-1:Bm}function hg(e,t){return t[0]*Hm}function pg(e,t){return t[0]*Km}function vg(e,t){var r=t[0];if(!isFinite(r)||r<0)return Bm;var n=Math.floor(r+2147483648-2147483648);return n>170?Bm:function e(t){return M("call just Fact with non Natural value",t),0===t?1:t*e(t-1)}(n)}function mg(e,t){var r=t[0];if(Nn.operKind(r)===Tn.OperKind.Range){var n=r;if(!Nn.isSheetIndex(n.sheets)||1!==n.ranges.length||1!==n.ranges[0].rows||1!==n.ranges[0].cols)return Tn.valueErrorOper;r=e.dereferenceOper(r,Tn.OperKind.Number)}switch(Nn.operKind(r)===Tn.OperKind.String&&(r=e.coerceOper(r,Tn.OperKind.Number)),Nn.operKind(r)){case Tn.OperKind.Number:return 0==(1&Math.floor(Math.abs(r)));case Tn.OperKind.Error:return r;case Tn.OperKind.Missing:return Tn.naErrorOper;case Tn.OperKind.Blank:return!0;case Tn.OperKind.Rich:return mg(e,[r.getFallback()]);default:return Tn.valueErrorOper}}var gg=Tn.valueErrorOper,Eg=function(e){return void 0===e?1:Math.floor(e)};function Sg(e,t){var r=t,n=r[0],i=r[1];if(void 0!==i&&Lf(i))return i;var a=Eg(i);return a<0?gg:a>=n.length?n:n.substring(n.length-a)}function Cg(e,t){var r=t,n=r[0],i=r[1];if(void 0!==i&&Lf(i))return i;var a=Eg(i);return a<0?gg:a>=n.length?n:n.substring(0,a)}function Tg(e,t){var r=t[0],n=Math.floor(t[1])-1,i=Math.floor(t[2]);return n<0||i<0?gg:r.substring(n,n+i)}function Rg(e,t){return t[0].length}function yg(e,t){if(2!==t.length)return me;var r=t[0],n=t[1];if(wf(r)&&"string"==typeof n){var i=r.getField(n);if(void 0!==i)return i}return me}function Ig(e,t){return Og(e,m([le],t))}function Og(e,t){for(var r=t[0],n={},i=1;i<t.length;i+=2){var a=t[i],o=t[i+1];n[a.toLowerCase()]=o}return new Ag(n,r)}var Ag=function(e,t){var r=this;void 0===e&&(e={}),void 0===t&&(t=le),this._fields=e,this._fallback=t,this.kind=j.Rich,this.getFallback=function(){return r._fallback},this.getField=function(e){var t=e.toLowerCase(),n=r._fields[t];if(void 0!==n)return n}};function Ng(e,t){var r=t[0];return _f(r)?r.rows:yt(r.sheets)?r.ranges.length>1?fe:r.ranges[0].rows:le}function kg(e,t){var r=t[0];return _f(r)?r.cols:yt(r.sheets)?r.ranges.length>1?fe:r.ranges[0].cols:le}function Fg(e,t){return!0}function bg(e,t){return!1}function Dg(e,t){return!t[0]}function Lg(e,t){var r=t,n=r[0],i=r[1];return void 0!==i?i:n}function Mg(e,t){return pe}function _g(e,t){if("object"==typeof t&&t.kind===j.Range){if(yt(t.sheets)){var r=Ce(t.sheets,[Mt(t.ranges[0])]);return e.dereferenceOper(r,bf)}return le}return t}function wg(e,t){var r=_g(e,t[0]);return"string"==typeof r||Lf(r)?r:""}function Ug(e,t){var r=_g(e,t[0]);return"number"==typeof r||Lf(r)?r:"boolean"==typeof r&&r?1:0}var Pg=Tn.OperKind,Gg=Tn.rangeSeqOper,Vg=Tn.valueErrorOper,xg=Tn.refErrorOper,Bg=Tn.arrayOper,Wg=Sn.gridRange,Hg=Sn.sheetIndex,Kg=Nn.isSheetIndex;function jg(e,t){var r=t,n=r[0],i=r[1],a=r[2],o=r[3];if(i<0)return Vg;if(void 0!==a&&a<0)return Vg;var u,s,c=void 0===o?0:Math.floor(o)-1;if(c<0)return Vg;switch(n.kind){case Pg.Range:if(!Kg(n.sheets))return Vg;if(c>=n.ranges.length)return xg;var l=n.ranges[c];if(void 0===a)if(1===l.rows)u=0,s=Math.floor(i)-1;else{if(1!==l.cols)return xg;u=Math.floor(i)-1,s=-1}else u=Math.floor(i)-1,s=Math.floor(a)-1;if(u>=l.rows||s>=l.cols)return xg;var f=Wg(l.row+Math.max(u,0),l.col+Math.max(s,0),-1===u?l.rows:1,-1===s?l.cols:1);return Gg(Hg(n.sheets.document,n.sheets.index),[f]);case Pg.Array:return c>0?xg:(void 0===a?1===n.rows?(u=0,s=Math.floor(i)-1):(u=Math.floor(i)-1,s=-1):(u=Math.floor(i)-1,s=Math.floor(a)-1),u>=n.rows||s>=n.cols?xg:-1===u&&-1===s?n:-1===u?Bg(n.rows,1,n.opers.map((function(e){return[e[s]]}))):-1===s?Bg(1,n.cols,[n.opers[u]]):n.opers[u][s]);default:return b("funcs.lookupFuncs: INDEX",n)}}function qg(e,t,r){void 0===r&&(r=!1);var n,i=wf(t)?t.getFallback():t;switch(typeof i){case"number":n=function(e){return e>i?{correctType:!0,sgnT:ot.Gt}:e<i?{correctType:!0,sgnT:ot.Lt}:{correctType:!0,sgnT:ot.Eq}};break;case"string":if(r){var a=new $p(e.config.localeInfo,i);n=function(e){return{correctType:!0,sgnT:a.test(e)?ot.Eq:ot.Ne}}}else n=function(t){var r=e.config.localeInfo.stringCompareCI(t,i);return r>0?{correctType:!0,sgnT:ot.Gt}:r<0?{correctType:!0,sgnT:ot.Lt}:{correctType:!0,sgnT:ot.Eq}};break;case"boolean":n=function(e){return e>i?{correctType:!0,sgnT:ot.Gt}:e<i?{correctType:!0,sgnT:ot.Lt}:{correctType:!0,sgnT:ot.Eq}};break;case"object":n=function(e){return i.kind!==e.kind?{correctType:!1,sgnT:ot.Ne}:{correctType:!0,sgnT:ot.Ne}}}return function(e){var t=wf(e)?e.getFallback():e;return typeof i!=typeof t?{correctType:!1,sgnT:ot.Ne}:n(t)}}function Jg(e,t,r){for(var n=!1,i=1===r.rows,a=i?r.cols-1:r.rows-1,o=Math.floor((0+a)/2),u=0,s=a,c=function(e,t){return i?r.get(e,t):r.get(t,e)},l=qg(e,t);;){var f=l(c(0,o)).sgnT;if(f===ot.Ne){if(o<s)for(var d=o+1;d<=s;d+=1)if((f=l(c(0,d)).sgnT)!==ot.Ne){o=d;break}f===ot.Ne&&(o=Math.floor((u+s)/2),f=ot.Gt)}if(f===ot.Eq){if(o<a){n=!0,u=o+=1,s=o;continue}return o}if(f===ot.Lt?u=o+1:s=o-1,!(u<=s)){if(n)o-=1;else if(f===ot.Gt&&(o-=1)>=0){u=o,s=o;continue}return o}o=Math.floor((u+s)/2)}}function Xg(e,t,r,n){for(var i=1===r.rows,a=function(e,t){return i?r.get(e,t):r.get(t,e)},o=i?r.cols:r.rows,u=-1,s=qg(e,t,n===ot.Eq),c=0;c<o;c+=1){var l=s(a(0,c)),f=l.correctType,d=l.sgnT;if(f){if(d===ot.Eq)return c;if(d!==ot.Ne&&d===n)return u;u=c}}return n!==ot.Eq?u:o}function Yg(e,t){if("number"==typeof t)return t;var r;switch(t.kind){case cl.RangeValues:r=e.coerceOper(t.arrays[0].get(0,0),Pg.Number);break;case Pg.Array:r=e.coerceOper(t.opers[0][0],Pg.Number);break;default:return b("calc.funcs.lookupFuncs.getIntFromRef",t)}return Lf(r)?xg:r}function Qg(e,t){var r=t,n=r[0],i=r[1],a=r[2],o=function(e){if("number"==typeof e)return pe;switch(e.kind){case Pg.Range:if(!Kg(e.sheets))return Vg;if(e.ranges.length>1)return pe;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?pe:e;case Pg.Array:return 1!==e.rows&&1!==e.cols?pe:e}}(i);if(Lf(o))return o;var u=void 0===a?1:function(e){if("object"==typeof e&&e.kind===Pg.Range){if(!Kg(e.sheets))return Vg;if(1!==e.ranges.length)return xg}return e}(a);if(Lf(u))return u;var s=e.dereferenceAllOpers([o,u]),c=s[0],l=Yg(e,s[1]);if(Lf(l))return l;var f=tE(c),d=-1;l>0?d=Jg(e,n,f):0===l?d=Xg(e,n,f,ot.Eq):l<0&&(d=Xg(e,n,f,ot.Lt));var h=1===f.rows?f.cols-1:f.rows-1;return d<0||d>h?pe:d+1}function zg(e,t,r){var n=t,i=n[0],a=n[1],o=n[2],u=n[3],s=function(e){if("number"==typeof e)return pe;switch(e.kind){case Pg.Range:return Kg(e.sheets)?e.ranges.length>1?pe:e:Vg;case Pg.Array:return e}}(a);if(Lf(s))return s;var c=function(e){if("object"==typeof e)switch(e.kind){case Pg.Range:if(!Kg(e.sheets))return Vg;if(1!==e.ranges.length)return xg;var t=e.ranges;(t.length>1||t[0].rows>1||t[0].cols>1)&&Rd(Qt(["HLOOKUP/VLOOKUP non-singleton argument 3"]));break;case Pg.Array:(e.cols>1||e.rows>1)&&Rd(Qt(["HLOOKUP/VLOOKUP non-singleton argument 3"]))}return e}(o);if(Lf(c))return c;var l=e.dereferenceAllOpers([s,c]),f=l[0],d=l[1],h=tE(f);if(void 0===h)return pe;var p=Yg(e,d);if(Lf(p))return p;var v=Math.floor(p);if(v<=0)return Vg;if(r){if(v-1>=h.rows)return xg}else if(v-1>=h.cols)return xg;var m=!(void 0===u||u)?Xg(e,i,h,ot.Eq):Jg(e,i,h);return Lf(m)?m:r?m<0||m>=h.cols?pe:h.get(v-1,m):m<0||m>=h.rows?pe:h.get(m,v-1)}function Zg(e,t){return zg(e,t,!0)}function $g(e,t){return zg(e,t,!1)}var eE=function(){function e(e){this.table=e}return Object.defineProperty(e.prototype,"rows",{get:function(){return this.table.opers.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cols",{get:function(){return this.table.opers[0].length},enumerable:!0,configurable:!0}),e.prototype.get=function(e,t){return this.table.opers[e][t]},e}();function tE(e){switch(e.kind){case cl.RangeValues:return e.arrays[0];case Pg.Array:return new eE(e)}}var rE=Nn.success,nE=Nn.failure,iE={};iE[On.WorksheetFuncId.SUM]=function(e,t){var r=e.dereferenceAllOpers(t);return cv(e,r)},iE[On.WorksheetFuncId.PRODUCT]=function(e,t){var r=e.dereferenceAllOpers(t);return hv(e,r)},iE[On.WorksheetFuncId.AVERAGE]=function(e,t){var r=e.dereferenceAllOpers(t);return vv(e,r)},iE[On.WorksheetFuncId.CONCAT]=Sv,iE[On.WorksheetFuncId.CONCATENATE]=Sv,iE[On.WorksheetFuncId.COUNTBLANK]=function(e,t){var r=t[0];if("object"!=typeof r||r.kind!==j.Range||!av(r.sheets)||1!==r.ranges.length)return le;var n=e.dereferenceAllOpers(t);return yv(e,n)},iE[On.WorksheetFuncId.MAX]=function(e,t){var r=e.dereferenceAllOpers(t);return Fv(e,r)},iE[On.WorksheetFuncId.MIN]=function(e,t){var r=e.dereferenceAllOpers(t);return bv(e,r)},iE[On.WorksheetFuncId.ISERROR]=function(e,t){return Nn.operKind(t[0])===Tn.OperKind.Error},iE[On.WorksheetFuncId.ISERR]=function(e,t){var r=t[0];return Lf(r)&&r.type!==Tn.ErrorType.NA},iE[On.WorksheetFuncId.ISBLANK]=function(e,t){return Nn.operKind(t[0])===Tn.OperKind.Blank},iE[On.WorksheetFuncId.ISLOGICAL]=function(e,t){return Nn.operKind(t[0])===Tn.OperKind.Boolean},iE[On.WorksheetFuncId.ISNA]=function(e,t){var r=t[0];return Lf(r)&&r.type===Tn.ErrorType.NA},iE[On.WorksheetFuncId.ISNONTEXT]=function(e,t){return Nn.operKind(t[0])!==Tn.OperKind.String},iE[On.WorksheetFuncId.ISTEXT]=function(e,t){return Nn.operKind(t[0])===Tn.OperKind.String},iE[On.WorksheetFuncId.ISNUMBER]=function(e,t){return Nn.operKind(t[0])===Tn.OperKind.Number},iE[On.WorksheetFuncId.ISREF]=function(e,t){return Nn.operKind(t[0])===Tn.OperKind.Range},iE[On.WorksheetFuncId.ISEVEN]=mg,iE[On.WorksheetFuncId.ISODD]=function(e,t){var r=mg(e,t);return"boolean"==typeof r?!r:r};var aE,oE,uE=!1;function sE(e){return uE||(uE=!0,Ar(Sr.CalcNewFunctions)&&(iE[On.WorksheetFuncId.AND]=Vv,iE[On.WorksheetFuncId.COUNTA]=Ov,iE[On.WorksheetFuncId.OR]=xv,iE[On.WorksheetFuncId.ABS]=fg,iE[On.WorksheetFuncId.CEILING]=sg,iE[On.WorksheetFuncId.DEGREES]=hg,iE[On.WorksheetFuncId.FLOOR]=cg,iE[On.WorksheetFuncId.RADIANS]=pg,iE[On.WorksheetFuncId.ROUND]=ag,iE[On.WorksheetFuncId.ROUNDUP]=og,iE[On.WorksheetFuncId.ROUNDDOWN]=ug,iE[On.WorksheetFuncId.EVEN]=lg,iE[On.WorksheetFuncId.SIGN]=dg,iE[On.WorksheetFuncId.PI]=jm,iE[On.WorksheetFuncId.SQRT]=qm,iE[On.WorksheetFuncId.EXP]=Jm,iE[On.WorksheetFuncId.POWER]=Xm,iE[On.WorksheetFuncId.LN]=Ym,iE[On.WorksheetFuncId.LOG10]=Qm,iE[On.WorksheetFuncId.LOG]=zm,iE[On.WorksheetFuncId.SIN]=Zm,iE[On.WorksheetFuncId.COS]=$m,iE[On.WorksheetFuncId.TAN]=eg,iE[On.WorksheetFuncId.ASIN]=tg,iE[On.WorksheetFuncId.ACOS]=rg,iE[On.WorksheetFuncId.ATAN]=ng,iE[On.WorksheetFuncId.ATAN2]=ig,iE[On.WorksheetFuncId.FACT]=vg,iE[On.WorksheetFuncId.LEFT]=Cg,iE[On.WorksheetFuncId.RIGHT]=Sg,iE[On.WorksheetFuncId.MID]=Tg,iE[On.WorksheetFuncId.LEN]=Rg),Ar(Sr.CalcWorksheetFunctions)&&(Ar(Sr["OfficeVSO:3852168_CalcCGAVERAGEIF"])&&(iE[On.WorksheetFuncId.AVERAGEIF]=gv),Ar(Sr["OfficeVSO:3852168_CalcCGCOUNT"])&&(iE[On.WorksheetFuncId.COUNT]=Rv),Ar(Sr["OfficeVSO:3852168_CalcCGCOUNTIF"])&&(iE[On.WorksheetFuncId.COUNTIF]=Nv),Ar(Sr["OfficeVSO:3852168_CalcCGMEDIAN"])&&(iE[On.WorksheetFuncId.MEDIAN]=im),Ar(Sr["OfficeVSO:3852168_CalcCGSUMIF"])&&(iE[On.WorksheetFuncId.SUMIF]=dv),Ar(Sr["OfficeVSO:3852168_CalcCGROWS"])&&(iE[On.WorksheetFuncId.ROWS]=Ng),Ar(Sr["OfficeVSO:3852168_CalcCGCOLUMNS"])&&(iE[On.WorksheetFuncId.COLUMNS]=kg),Ar(Sr["OfficeVSO:3852168_CalcCGINDEX"])&&(iE[On.WorksheetFuncId.INDEX]=jg),Ar(Sr["OfficeVSO:3852168_CalcCGMATCH"])&&(iE[On.WorksheetFuncId.MATCH]=Qg),Ar(Sr["OfficeVSO:3852168_CalcCGHLOOKUP"])&&(iE[On.WorksheetFuncId.HLOOKUP]=Zg),Ar(Sr["OfficeVSO:3852168_CalcCGVLOOKUP"])&&(iE[On.WorksheetFuncId.VLOOKUP]=$g),Ar(Sr["OfficeVSO:3852168_CalcCGLARGE"])&&(iE[On.WorksheetFuncId.LARGE]=jv),Ar(Sr["OfficeVSO:3852168_CalcCGSMALL"])&&(iE[On.WorksheetFuncId.SMALL]=Jv),Ar(Sr["OfficeVSO:3852168_CalcCGPERCENTILE"])&&(iE[On.WorksheetFuncId.PERCENTILE]=Qv,iE[On.WorksheetFuncId.PERCENTILE_INC]=Qv),Ar(Sr["OfficeVSO:3852168_CalcCGPERCENTILE_EXC"])&&(iE[On.WorksheetFuncId.PERCENTILE_EXC]=Zv),Ar(Sr["OfficeVSO:3852168_CalcCGQUARTILE"])&&(iE[On.WorksheetFuncId.QUARTILE]=em,iE[On.WorksheetFuncId.QUARTILE_INC]=em),Ar(Sr["OfficeVSO:3852168_CalcCGQUARTILE_EXC"])&&(iE[On.WorksheetFuncId.QUARTILE_EXC]=rm),Ar(Sr["OfficeVSO:3852168_CalcCGTRIMMEAN"])&&(iE[On.WorksheetFuncId.TRIMMEAN]=am),Ar(Sr["OfficeVSO:3852168_CalcCGTRUE"])&&(iE[On.WorksheetFuncId.TRUE]=Fg),Ar(Sr["OfficeVSO:3852168_CalcCGFALSE"])&&(iE[On.WorksheetFuncId.FALSE]=bg),Ar(Sr["OfficeVSO:3852168_CalcCGNOT"])&&(iE[On.WorksheetFuncId.NOT]=Dg),Ar(Sr["OfficeVSO:3852168_CalcCGNA"])&&(iE[On.WorksheetFuncId.NA]=Mg),Ar(Sr["OfficeVSO:3852168_CalcCGAVERAGEA"])&&(iE[On.WorksheetFuncId.AVERAGEA]=Ev),Ar(Sr["OfficeVSO:3852168_CalcCGMAXA"])&&(iE[On.WorksheetFuncId.MAXA]=Mv),Ar(Sr["OfficeVSO:3852168_CalcCGMINA"])&&(iE[On.WorksheetFuncId.MINA]=_v),Ar(Sr["OfficeVSO:3852168_CalcCGXOR"])&&(iE[On.WorksheetFuncId.XOR]=Bv),Ar(Sr["OfficeVSO:3852168_CalcCGT"])&&(iE[On.WorksheetFuncId.T]=wg),Ar(Sr["OfficeVSO:3852168_CalcCGN"])&&(iE[On.WorksheetFuncId.N]=Ug),Ar(Sr["OfficeVSO:3852168_CalcCGHYPERLINK"])&&(iE[On.WorksheetFuncId.HYPERLINK]=Lg),Ar(Sr["OfficeVSO:3852168_CalcCGAGGREGATE"])&&(iE[On.WorksheetFuncId.AGGREGATE]=Gm),Ar(Sr["OfficeVSO:3852168_CalcCGSUBTOTAL"])&&(iE[On.WorksheetFuncId.SUBTOTAL]=wm),Ar(Sr["OfficeVSO:3852168_CalcCGVAR"])&&(iE[On.WorksheetFuncId.VAR]=Om,iE[On.WorksheetFuncId.VAR_S]=Om),Ar(Sr["OfficeVSO:3852168_CalcCGVARP"])&&(iE[On.WorksheetFuncId.VARP]=Am,iE[On.WorksheetFuncId.VAR_P]=Am),Ar(Sr["OfficeVSO:3852168_CalcCGSTDEV"])&&(iE[On.WorksheetFuncId.STDEV]=Tm,iE[On.WorksheetFuncId.STDEV_S]=Tm),Ar(Sr["OfficeVSO:3852168_CalcCGSTDEVP"])&&(iE[On.WorksheetFuncId.STDEVP]=Rm,iE[On.WorksheetFuncId.STDEV_P]=Rm),Ar(Sr["OfficeVSO:3852168_CalcCGVARA"])&&(iE[On.WorksheetFuncId.VARA]=Nm),Ar(Sr["OfficeVSO:3852168_CalcCGVARPA"])&&(iE[On.WorksheetFuncId.VARPA]=km),Ar(Sr["OfficeVSO:3852168_CalcCGSTDEVA"])&&(iE[On.WorksheetFuncId.STDEVA]=ym),Ar(Sr["OfficeVSO:3852168_CalcCGSTDEVPA"])&&(iE[On.WorksheetFuncId.STDEVPA]=Im),Ar(Sr["OfficeVSO:3852168_CalcCGMODE"])&&(iE[On.WorksheetFuncId.MODE]=Lm,iE[On.WorksheetFuncId.MODE_SNGL]=Lm),Ar(Sr["OfficeVSO:3852168_CalcCGMODE_MULT"])&&(iE[On.WorksheetFuncId.MODE_MULT]=Mm)),Ar(Sr.CalcFieldValueFunction)&&(iE[On.WorksheetFuncId.FIELDVALUE]=yg),Ar(Sr.CalcRecordFunctions)&&(iE[On.WorksheetFuncId.RECORD]=Ig,iE[On.WorksheetFuncId.RECORDTEST]=Og)),iE[e]}function cE(e){return function(t){if("number"==typeof t){var r=sE(t);return null!=r?rE(r):nE(rf([e.getWorksheetFuncName(t)]))}return rE(void 0)}}(oE=aE||(aE={})).DerefOperKind=cl,oE.FuncKind=sl;var lE={},fE=0;function dE(e){var t=lE[e];lE[e]=(void 0===t?0:t)+1,(fE+=1)%100==0&&(k.ULS.traceTag(595858520,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.common.hashUtils.logCollision: "+JSON.stringify(lE)+"."),lE={})}function hE(e){if(null==e)return"";var t,r=$t(e.sheet.document);r===P?t="illegalDocument":t=(null==r.path?"":"p:"+r.path.toLocaleUpperCase()+",")+"n:"+r.name.toLocaleUpperCase();return t+",i:"+e.sheet.index+",r:"+e.range.row+",c:"+e.range.col}var pE=function(e){var t=e^e>>16;return t*=2246822507,t^=t>>13,t*=3266489909,t^=t>>16};function vE(e){var t,r=1;return r=31*(r=31*(r=31*(r=31*r+("number"==typeof(t=e.sheet.index)?pE(t):t.charCodeAt(0)))+pE(e.range.col))+pE(e.range.row))+pE(e.sheet.document.name.length),void 0!==e.sheet.document.path&&(r=31*r+pE(e.sheet.document.path.length)),r}function mE(e,t){return Lt(e,t)}function gE(){return{map:{},keyToHash:vE,keyEquals:mE,nelements:0,add:function(e){var t=this.keyToHash(e);if(dr(this.map[t]))this.map[t]=[e],this.nelements+=1;else{for(var r=this.map[t],n=0;n<r.length;n+=1)if(this.keyEquals(e,r[n]))return;dE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),r.push(e),this.nelements+=1}},contains:function(e){var t=this.keyToHash(e),r=this.map[t];if(dr(r))return!1;for(var n=0;n<r.length;n+=1)if(this.keyEquals(e,r[n]))return!0;return dE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),!1},forEach:function(e){var t=this;Object.keys(this.map).forEach((function(r){t.map[+r].forEach((function(t){e(t)}))}))},size:function(){return this.nelements},remove:function(e){var t=this,r=this.keyToHash(e),n=this.map[r];if(dr(n))return!1;var i=[],a=!1;return n.forEach((function(r){t.keyEquals(e,r)?(t.nelements-=1,a=!0):i.push(r)})),this.map[r]=i,a||dE("object"==typeof e?"Object {"+Object.keys(e)+"}":typeof e),a}}}var EE=function(){function e(e){this.valueCreationFunc=e}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}(),SE=Nn.createResolutionHandler,CE=Nn.createNameFinder,TE={};function RE(e){Ar(Sr.CalcLogStopWatch)&&(TE[e]=Rr(e))}function yE(e){if(Ar(Sr.CalcLogStopWatch)){var t=TE[e];void 0!==t&&t.stop()}}function IE(e,t){switch(t.ref.kind){case Ie.Error:e.errRefs+=1}}function OE(e,t,r,n){return SE((function(i){var a,o;yt(i.sheet)||(n.crossSheetRefs+=1),a=e.sheet.document,o=i.sheet.document,void 0===a&&void 0===o||void 0!==a&&void 0!==o&&Ft(a,o)||(n.crossDocRefs+=1),i.sheet.index!==e.sheet.index&&(n.crossSheetRefs+=1),i.range.rows===1<<20&&(n.columnRefs+=1),16384===i.range.cols&&(n.rowRefs+=1),At(i)&&r.addDependency(i,e,t.maxRangeSize,n)}),(function(e){return IE(n,e)}),(function(e,t){e.kind===Vt.NotImplemented?IE(n,t):n.errRefs+=1}))}function AE(e,t){var r=t[e];return void 0===r&&(r=0),r}function NE(){var e={columnRefs:0,crossDocRefs:0,crossSheetRefs:0,dependents:[],errRefs:0,functionsCount:lr(),largeRanges:0,nameRefs:0,operatorsCount:{},parserErrors:0,rowRefs:0,tableRefs:0,merge:function(t){e.columnRefs+=t.columnRefs,e.crossDocRefs+=t.crossDocRefs,e.crossSheetRefs+=t.crossSheetRefs,e.largeRanges+=t.largeRanges,e.nameRefs+=t.nameRefs,e.parserErrors+=t.parserErrors,e.rowRefs+=t.rowRefs,e.tableRefs+=t.tableRefs,e.errRefs+=t.errRefs,function(e,t){if(RE("calc_ts_merge_sets"),Ar(Sr.CalcHashSet)){var r=gE();e.forEach((function(e){r.add(e)})),t.forEach((function(t){r.contains(t)||e.push(t)}))}else{var n=lr();e.forEach((function(e){n[hE(e)]=!0})),t.forEach((function(t){var r=hE(t);n[r]||(e.push(t),n[r]=!0)}))}yE("calc_ts_merge_sets")}(e.dependents,t.dependents),Object.keys(t.functionsCount).forEach((function(r){var n=e.functionsCount[r];void 0===n&&(n=0),e.functionsCount[r]=n+t.functionsCount[r]})),Object.keys(t.operatorsCount).forEach((function(r){var n=Number(r),i=e.operatorsCount[n];void 0===i&&(i=0),e.operatorsCount[n]=i+t.operatorsCount[n]}))}};return e}function kE(e){var t={_logger:e,_dependencyGraph:lr(),haveDependents:function(e){return void 0!==t._dependencyGraph[hE(e)]},directDependents:function(e){var r=[],n=t._dependencyGraph[hE(e)];return void 0!==n&&n.forEach((function(e){r.push(e)})),r},allDependents:function(e){return t.getDependents(e,!1)},rootDependents:function(e){return t.getDependents(e,!0)},reset:function(){t._dependencyGraph=lr()},add:function(e,r,n){var i=d({},e);i.getCurrentDocumentLoc=function(){return $t(e.getCurrentDocumentLoc())};var a=NE();if(null==n)return a;var o,u,s,c=function(e,t,r,n){return SE(CE((function(i){var a=t.nameRefToSheetGridRange(e,i);return null==a||r.addDependency(a,e,t.maxRangeSize,n),a}),void 0),cr,(function(){}))}(r,i,t,a),l=OE(r,i,t,a),f=[];for(f.push(n.node);f.length>0;){var h=f.pop();if(null!=h)switch(h.kind){case Ne.Literal:break;case Ne.Array:h.nodes.map((function(e){return e.map((function(e){f.push(e)}))}));break;case Ne.App:if("object"==typeof h.head){var p=h.head;switch(p.kind){case Ne.Operator:a.operatorsCount[p.id]=(o=p.id,u=a.operatorsCount,s=void 0,void 0===(s=u[o])&&(s=0),s+1);break;case Ne.Name:a.functionsCount[p.whole]=AE(p.whole,a.functionsCount)+1;break;default:f.push(p)}}h.args.map((function(e){f.push(e)}));break;case Ne.Paren:f.push(h.node);break;case Ne.Name:a.nameRefs+=1,c(void 0,i.resolver.resolveName(r,h.qualifier,h.whole));break;case Ne.CellRef:l(h,i.resolver.resolveCellRef(r,h.qualifier,h.ref));break;case Ne.Bad:a.parserErrors+=1;break;default:return b("calc.calc.recalcMapperImpl",h)}}return a},merge:function(e){t.mergeGraph(e.dependencyGraph())},dependencyGraph:function(){var e=kE(t._logger);return e.mergeGraph(t._dependencyGraph),e._dependencyGraph},mergeGraph:function(e){RE("calc_ts_merge_graph");var r=function(r){var n=t._dependencyGraph[r],i=e[r];void 0===n&&(n=[]);var a=n;if(Ar(Sr.CalcHashSet)){var o=gE();a.forEach((function(e){o.add(e)})),i.forEach((function(e){o.contains(e)||a.push(e)}))}else{var u=lr();a.forEach((function(e){u[hE(e)]=!0})),i.forEach((function(e){u[hE(e)]||a.push(e)}))}t._dependencyGraph[r]=a};for(var n in e)r(n);yE("calc_ts_merge_graph")},addDependency:function(e,r,n,i){if(Nt(e)){var a=hE(e);t.updateDependency(a,r)&&i.dependents.push(e)}else if(Wf(e.range)>n)i.largeRanges+=1;else for(var o=e.range.row;o<e.range.row+e.range.rows;o+=1)for(var u=e.range.col;u<e.range.col+e.range.cols;u+=1){var s=te(e.sheet,H(o,u));t.addDependency(s,r,n,i)}},updateDependency:function(e,r){var n=t._dependencyGraph[e];return void 0===n&&(n=[]),!n.some((function(e){return Lt(e,r)}))&&(n.push(r),t._dependencyGraph[e]=n,!0)},getDependents:function(e,r){if(RE("calc_ts_get_dependents"),Ar(Sr.CalcHashSet)){for(var n=gE(),i=[],a=t.directDependents(e);a.length>0;){if(void 0!==(c=a.shift()))if(!n.contains(c))n.add(c),(l=t.directDependents(c)).length>0&&l.forEach((function(e){a.push(e)})),r&&0!==l.length||i.push(c)}return i}for(var o=lr(),u=[],s=t.directDependents(e);s.length>0;){var c;if(void 0!==(c=s.shift())){var l,f=hE(c);if(!o[f])o[f]=!0,(l=t.directDependents(c)).length>0&&(s=s.concat(l)),r&&0!==l.length||u.push(c)}}return yE("calc_ts_get_dependents"),u},stats:function(){var e=Object.keys(t._dependencyGraph);if(void 0===e||0===e.length)return FE(0,0);var r=e.length,n=0;return e.forEach((function(e){var r=t._dependencyGraph[e];n+=r.length})),FE(r,n)}};return t}function FE(e,t){return{nodes:e,arcs:t}}var bE=Nn.createResolver,DE=Nn.success;function LE(e){return F(e),kE(e)}function ME(e,t,r,n,i,a,o,u,s,c){return{maxRangeSize:e,nameRefs:t,rowRefs:r,columnRefs:n,crossSheetRefs:i,crossDocRefs:a,getCurrentDocumentLoc:o,getCurrentSheetIndex:u,getSheetIndex:s,nameRefToSheetGridRange:c,resolver:bE({getSheetIndex:function(e,t){return DE(s(e,t))},getDocumentLoc:o})}}var _E=Sn.FormulaSource,wE=Sn.sheetGridCell,UE=Sn.gridCell,PE=Sn.documentLoc,GE=Sn.sheetIndex,VE=yn.RefStyle,xE=Nn.ResultKind,BE=Nn.failure;function WE(e,t){return{}}function HE(e,t,r){return{config:e,mathpack:t,formatInfo:r}}function KE(e){var t={globals:e,runtime:function(e){var t=e.config,r=e.mathpack,n={config:t},i=d({config:t},e.formatInfo),a={config:t,mathpack:r},o=cs(n),u=hl(i),s=id(a);return{parser:o,analyzer:u,compiler:s}}(e),cache:lr(),lazyCreateCacheItem:function(e){var r,n=hE(e),i=t.cache[n];return void 0===i&&(i={cell:e,rawValue:r,formula:void 0,compiledFormula:void 0,evalResult:void 0,format:void 0},t.cache[n]=i),i},size:function(){var e=0;for(var r in t.cache)e+=1;return e},clear:function(){t.cache=lr()},cells:function(){var e=Object.keys(t.cache);return void 0===e||0===e.length?[]:e.map((function(e){return t.cache[e].cell}))},getItem:function(e){var r=hE(e);return t.cache[r]},getValue:function(e){var r=t.getItem(e);if(void 0!==r&&null!==r.rawValue)return r.rawValue},getFormula:function(e,r,n){var i=t.getItem(e);if(void 0!==i&&jE(t.runtime,i,r,n)&&qE(i.formula))return i.formula},getFormulaFormat:function(e){var r=t.getItem(e);if(void 0!==r)return r.format},getCompiledFormula:function(e,r){var n=t.getItem(e);if(void 0!==n&&function(e,t,r){if(qE(t.compiledFormula))return!0;if(!jE(e,t,r))return!1;if(void 0!==r&&r)return!1;t.compiledFormula=null;try{var n=e.compiler.compileFormula(t.cell,_E.Cell,t.formula);return n.kind===xE.Success&&(t.compiledFormula=n.value,!0)}catch(e){return k.ULS.traceTag(595968586,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.calc.formulaCache.lazyCompileFormula: Exception "+R(e)),!1}}(t.runtime,n,r)&&qE(n.compiledFormula))return n.compiledFormula},getEvalResult:function(e){var r=t.getItem(e);if(void 0!==r)return r.evalResult},isEqualValue:function(e,r){var n=t.getItem(e);return void 0!==n&&n.rawValue===r},updateCellValue:function(e,r,n,i,a){if(!t.isEqualValue(e,r)){var o=t.lazyCreateCacheItem(e);if(o.rawValue=r,o.formula=void 0,o.compiledFormula=void 0,o.evalResult=void 0,o.format=void 0,null!=n){var u=n.getValue(e);void 0!==u&&r===u&&(o.formula=n.getFormula(e,!0),o.compiledFormula=n.getCompiledFormula(e,!0),o.evalResult=void 0,o.format=o.format)}null!=a&&(o.format=a),null!=i&&i.forEach((function(e){var r=t.getItem(e);void 0!==r&&(r.evalResult=void 0)}))}},updateEvalResult:function(e,r,n){var i=t.lazyCreateCacheItem(e);i.evalResult=r,null!=n&&(i.format=n)},merge:function(e,r){e.cells().forEach((function(n){var i=e.getValue(n);void 0===i||!0!==r&&void 0!==t.getItem(n)||t.updateCellValue(n,i,e)}))},parseCompileNameFormula:function(e,r,n){var i,a=void 0===n?VE.A1:n,o=_E.NameManager;if(void 0!==r)i=t.runtime.parser.parseFormula(a,r,o,e);else{var u=GE(PE(void 0,"Doc"),0),s=UE(0,0);i=t.runtime.parser.parseFormula(a,wE(u,s),o,e)}var l=R(e);if(i.kind!==xE.Success){var f="calc.formulaCache.parseCompileNameFormula: couldn't parse "+l;return k.ULS.traceTag(595969230,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,f),BE(ni(f))}var d=t.runtime.analyzer.checkFormula(r,_E.NameManager,i.value);if(It(d))return t.runtime.compiler.compileFormula(r,o,d);var h="calc.formulaCache.parseCompileNameFormula: formula "+l+" is not well-formed.";return k.ULS.traceTag(595969231,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,h),BE(lf(h))}};return t}function jE(e,t,r,n){if(qE(t.formula))return!0;if(!qE(t.rawValue))return!1;if(void 0!==t.formula&&null===t.formula)return!1;if(void 0!==r&&r)return!1;t.formula=null;var i=t.rawValue;try{var a=e.parser.parseFormula(yn.RefStyle.A1,t.cell,_E.Cell,i);if(a.kind!==xE.Success)return!1;var o=e.analyzer.checkFormula(t.cell,_E.Cell,a.value,n);return!!o.isWellFormed&&(t.formula=o,Ar(Sr.CalcFormatCalculations)&&(t.format=void 0),!0)}catch(e){return k.ULS.traceTag(595968585,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.calc.formulaCache.lazyParseFormula: Exception "+R(e)),!1}}function qE(e){return null!=e}var JE=function(e,t){return{functionId:e,functionName:t}},XE=function(e,t){return{errorType:e,errorName:t}},YE=function(e,t,r,n,i,a,o,u,s,c,l,f,d,h){var p=[];return t.forEach((function(e,t){"string"==typeof e?p.push(XE(t,e)):fr(e)&&p.push(e)})),{worksheetFunctionNames:e,errorTypeNames:p,errorNames:[],trueName:r,falseName:n,rowLetter:i,columnLetter:a,leftBrace:o,rightBrace:u,leftBracket:s,rightBracket:c,decimalSeparator:l,listSeparator:f,columnSeparator:d,rowSeparator:h}},QE=function(e,t,r){return{iformat:e,category:t,decimals:r}},zE=function(e,t){return{sheetId:e,sheetName:t}},ZE={kind:"Blank"},$E=function(e){return{kind:"Error",type:e}},eS=function(e){return{kind:"Rich",fields:e}};function tS(e){return"object"==typeof e?e.kind:typeof e}var rS=function(e,t){return{row:e,column:t}},nS=function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}},iS=function(e,t,r,n,i){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:i}},aS=function(e,t,r,n,i){return void 0===i&&(i="Inferred"),{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:i}};function oS(e,t,r,n){return aS(e,t,r,n,"CellFormula")}function uS(e,t,r){return aS(void 0,e,t,r,"ArrayFormula")}function sS(e,t,r,n){return aS(e,t,r,n,"Value")}var cS=function(e,t,r,n,i){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:i}},lS=function(e,t,r,n){return cS(e,t,void 0,r,n)};function fS(e,t,r,n){return cS(e,void 0,t,r,n)}var dS=function(e,t){return{isSpilled:e,formulaBarText:t}},hS=function(e,t,r){return{range:e,data:t,fromStateId:r}};function pS(e,t){return hS(e,t,void 0)}function vS(e,t){return hS(e,void 0,t)}var mS=function(e,t){return{sheetId:e,usedRange:t}},gS=function(e){return{kind:"NamedValue",value:e}},ES=function(e){return{kind:"NamedFormula",formulaBarText:e}},SS=function(e){return{kind:"NamedRange",range:e}},CS=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},TS=function(e,t){return{name:e,data:t}},RS=function(e,t,r){return{scope:e,objects:t,fromStateId:r}};function yS(e,t){return RS(e,t,void 0)}function IS(e){return RS(e,void 0,void 0)}function OS(e,t){return RS(e,void 0,t)}var AS=function(e,t,r,n,i,a){return void 0===a&&(a="Inferred"),{range:e,formulaBarText:t,value:r,origin:n,viewport:i,kind:a}};function NS(e,t,r,n){return AS(e,t,void 0,r,n,"CellFormula")}function kS(e,t,r,n){return AS(e,t,r,void 0,n,"Value")}function FS(e,t,r,n){return AS(e,t,void 0,r,n,"Inferred")}var bS,DS,LS,MS,_S=function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}},wS=function(e,t,r,n,i){return{isExact:e,iformat:t,hasHyperlink:r,category:n,decimals:i}},US=function(e,t,r){return{formulaBarText:e,value:t,format:r}},PS=function(e,t){return{range:e,data:t}},GS=function(e,t){return{range:e,data:t}},VS=function(e,t,r){return{range:e,task:t,reason:r}},xS=function(e,t,r,n,i,a){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:i,rangeFailures:[]}},BS=function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}},WS=function(e,t,r,n,i,a,o){return{totalEvalTimeMs:e,samplePrecisionRate:t,sampleStatisticsRate:n,rngSeed:r,sampleRecalcEditedStopwatchRate:i,sampleRecalcViewportStopwatchRate:a,sampleCellEvalStopwatchRate:o}};function HS(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]}function KS(e,t){var r=HS(),n=r[0],i=r[1],a=i[0],o=i[1],u=setTimeout(t,Math.max(0,e));return[n,[function(e){clearTimeout(u),a(e)},function(e){clearTimeout(u),o(e)}]]}function jS(e,t,r){var n=KS(e,(function(){return c(t())})),i=n[0],a=n[1],o=a[0],u=a[1],s=!1;function c(e){u(e),s=!0}var l=Promise.resolve().then((function(e){return r(c,(function(){return s}))}));return function(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}(Promise.race([i,l]),o)}function qS(e,t){var r;return new Promise((function(n,i){Promise.resolve(t).then((function t(a){if(void 0!==a){r=a;try{Promise.resolve(e(r)).then(t,i)}catch(e){i(e)}}else n(r)}),i)}))}function JS(e,t){return{setMessageListeners:function(t){e.onmessage=function(e){return t.onMessage(e.data)},e.onmessageerror=function(e){return t.onMessageError(e.data)}},postMessage:e.postMessage.bind(e),close:t.bind(e)}}function XS(e){return null!=e&&(e instanceof Error||"string"==typeof e.name&&"string"==typeof e.message&&(void 0===e.stack||"string"==typeof e.stack))}!function(e){e.FunctionCall="FunctionCall",e.MessageChannel="MessageChannel",e.Dedicated="Dedicated"}(bS||(bS={})),function(e){e.PostCallError="PostCallError",e.PostNotifyError="PostNotifyError",e.PostResultError="PostResultError",e.UnhandledNotifyError="UnhandledNotifyError",e.UnhandledError="UnhandledError"}(DS||(DS={})),function(e){e.App="App",e.Result="Result",e.Close="Close"}(LS||(LS={})),function(e){e[e.Fulfilled=0]="Fulfilled",e[e.Rejected=1]="Rejected"}(MS||(MS={}));var YS,QS={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function zS(e){return[e.name,e.message,e.stack]}function ZS(e){var t,r=e[0],n=e[1],i=e[2],a=QS[r];return null!=a?t=new a(n):(t=new Error(n)).name=r,void 0!==i&&(t.stack=i),t}function $S(e){return XS(e)?[YS.Error,zS(e)]:[YS.Unknown,e]}function eC(e,t,r,n){var i=new Error(e);return i.stack=e+"\n    at "+t+":"+r+":"+n,i}!function(e){e[e.Unknown=0]="Unknown",e[e.Error=1]="Error"}(YS||(YS={}));function tC(e){var t=e.message.indexOf("__START_ERROR__"),r=e.message.indexOf("__END_ERROR__");return t>=0&&r>=0?ZS(JSON.parse(e.message.substring(t+"__START_ERROR__".length,r))):null!=e.error?e.error:eC(e.message,e.filename,e.lineno,e.colno)}function rC(e,t,r,n,i,a){var o={port:t,callbacks:{},lastAppId:-1,modules:{}};function u(){if(null==o)throw new Error("endpoint is closed");return o}function s(e,t,r){if(null!=o){var n=o.callbacks[e];null!=n&&(delete o.callbacks[e],n[t](r))}}function c(e,t,r,n,i){var a;try{a=u()}catch(e){return Promise.reject(e)}var o=a.lastAppId+1,s=[LS.App,o,e,t,r,i],c=KS(n,(function(){f(s,new Error("exceeded timeout; callTimeout = "+n+"ms"))})),l=c[0],d=c[1];a.callbacks[o]=d,a.lastAppId=o;try{a.port.postMessage(s)}catch(e){f(s,e)}return l}function l(e,t,r,n){var i=u(),a=[LS.App,-1,e,t,r,n];try{i.port.postMessage(a)}catch(e){f(a,e)}}function f(e,t){var r=e[1],n=e[5];null!=o&&(r>=0&&s(r,MS.Rejected,t),n?g(r>=0?DS.PostCallError:DS.PostNotifyError,t,!0):(r<0&&g(DS.PostNotifyError,t,!1),c("","",[],Math.max(E.callTimeout,E.initTimeout),!0).catch((function(e){}))))}function d(e){var t=e[1],r=e[2],n=e[3],i=e[4],a=e[5];if(null!=o)if(""!==r||""!==n){var u=Promise.resolve().then((function(e){if(null!=o){var t=r,a=n,u=o.modules[t],s=null!=u?u[a]:void 0;if(null==s)throw new Error("method "+t+"."+a+" has not been exported");return s.apply(u,i)}}));t>=0?u.then((function(e){return h(t,MS.Fulfilled,e,a)}),(function(e){return h(t,MS.Rejected,e,a)})):u.catch((function(e){g(DS.UnhandledNotifyError,function(e,t,r){var n=t+"."+r+".notify: ";if(XS(e))return e.message=n+e.message,null!=e.stack&&(e.stack=n+e.stack),e;var i=new Error(n+e);return i.stack=void 0,i}(e,r,n),!1)}))}else h(t,MS.Fulfilled,void 0,a)}function h(e,t,r,n){if(null!=o){var i=[LS.Result,e,t,$S(r),n];try{o.port.postMessage(i)}catch(e){p(i,e)}}}function p(e,t){var r=e[1],n=e[4];null!=o&&(n?g(DS.PostResultError,t,!0):h(r,MS.Rejected,$S(t),!0))}function v(e){var t=e[1],r=e[2],n=e[3];null!=o&&s(t,r,function(e){return e[0]===YS.Unknown?e[1]:ZS(e[1])}(n))}function m(e){if(void 0===e&&(e=!0),null!=o){var t=o.port,r=o.callbacks;if(o=void 0,e)try{t.postMessage([LS.Close])}catch(e){}var n=new Error((e?"this":"other")+" endpoint closed while waiting for a response");for(var i in r)s(Number(i),MS.Rejected,n);try{t.close()}catch(e){}if(null!=a)try{a(E)}catch(n){var u=null!=n.stack?n.stack:n.message;console.log("calc.worker.createPortEndpoint.close: unhandled error: "+u)}}}function g(e,t,r){if(null!=o){var n=void 0;try{i(E,{kind:e,closing:r,error:t})||(n=[t])}catch(t){n=[t]}if(r&&m(),null!=n){var a=n[0],u=null!=a.stack?a.stack:a.message;console.log("calc.worker.createPortEndpoint.dispatchError: unhandled error: "+u)}}}var E={workerKind:e,initTimeout:r,callTimeout:n,setExports:function(e,t){return u().modules[e]=t},getImports:function(e,t){var r={};return t.forEach((function(t){return r[t]=function(e,t){var r={callTimeout:void 0,isCritical:!1,call:function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=null!=r.callTimeout?r.callTimeout:E.callTimeout;return c(e,t,n,a,r.isCritical)},notify:function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];l(e,t,n,r.isCritical)}};return r}(e,t)})),r},close:m,dispatchError:g};return o.port.setMessageListeners({onMessage:function(e){switch(e[0]){case LS.App:return d(e);case LS.Result:return v(e);case LS.Close:return m(!1);default:return b("calc.worker.createPortEndpoint.onMessage",e)}},onMessageError:function(e){var t=new Error("failed to send "+e[0]+" message");switch(e[0]){case LS.App:return f(e,t);case LS.Result:return p(e,t);case LS.Close:return;default:return b("calc.worker.createPortEndpoint.onMessageError",e)}}}),E}function nC(e,t,r){var n=this,i=null!=t.initTimeout?t.initTimeout:6e4,a=null!=t.callTimeout?t.callTimeout:3e4;return jS(i,(function(){return new Error("exceeded timeout; initTimeout = "+i+"ms")}),(function(o,u){return p(n,void 0,void 0,(function(){function n(e){return function(t,r){return c?null!=e.onError&&(e.onError(t,r),!0):(o(r.error),!0)}}function s(e){return function(t){c&&null!=e.onClosed&&e.onClosed(t)}}var c,l,f;return v(this,(function(o){switch(o.label){case 0:return c=!1,l=rC(e,r.outside,i,a,n(t.outside),s(t.outside)),f=rC(e,r.inside,i,a,n(t.inside),s(t.inside)),u()||null==t.inside.onInit?[3,2]:[4,t.inside.onInit(f)];case 1:o.sent(),o.label=2;case 2:return u()||null==t.outside.onInit?[3,4]:[4,t.outside.onInit(l)];case 3:o.sent(),o.label=4;case 4:return c=!0,[2,l]}}))}))}))}function iC(){return"undefined"!=typeof MessageChannel}var aC=function(){function e(){this.other=void 0}return e.prototype.onMessage=function(e){return D("calc.worker.FunctionCallPort.onMessage: "+("expected onMessage to be set before receiving messages; received "+JSON.stringify(e)))},e.prototype.open=function(e){this.other=e,e.other=this},e.prototype.setMessageListeners=function(e){null!=this.other&&(this.onMessage=e.onMessage)},e.prototype.postMessage=function(e){null!=this.other&&this.other.onMessage(e)},e.prototype.close=function(){if(null!=this.other){var e=this.other;this.other=e.other=void 0,this.onMessage=e.onMessage=function(){}}},e}();var oC,uC;function sC(){if(null==Fn.getCalcAbsUrl()){return k.ULS.traceTag(595907587,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.worker.isDedicatedWorkerSupported: initCalc was not passed calcAbsUrl"),!1}return"undefined"!=typeof Worker}function cC(e){setTimeout((function(){try{e.terminate()}catch(e){}}),100)}function lC(){var e={};for(var t in Sr){var r=Sr[t];null!=r&&(e[r]=Ar(r))}return e}r(8);var fC=((oC={})[bS.FunctionCall]=function(){return!0},oC[bS.MessageChannel]=iC,oC[bS.Dedicated]=sC,oC);function dC(e){return fC[e]()}var hC=((uC={})[bS.FunctionCall]=function(e){return nC(bS.FunctionCall,e,(t=new aC,r=new aC,t.open(r),{outside:t,inside:r}));var t,r},uC[bS.MessageChannel]=function(e){if(!iC())return D("calc.worker.createMessageChannelWorker: expected an execution context where message channel workers are supported");var t=function(){var e=new MessageChannel;return{outside:JS(e.port1,e.port1.close.bind(e.port1)),inside:JS(e.port2,e.port2.close.bind(e.port1))}}();try{return nC(bS.MessageChannel,e,t)}catch(e){try{t.outside.close()}catch(e){}throw e}},uC[bS.Dedicated]=function(e){var t=this,r=e.outside,n=e.inside,i=e.initTimeout,a=e.callTimeout,o=n.scriptName;if(null==o)return D("calc.worker.createDedicatedWorker: expected workerDef.inside.scriptName to be defined");var u=Fn.getCalcAbsUrl();if(!sC()||null==u)return D("calc.worker.createDedicatedWorker: expected a context where dedicated workers are supported");var s=null!=i?i:6e4,l=null!=a?a:3e4;return jS(s,(function(){return new Error("exceeded timeout; initTimeout = "+s+"ms")}),(function(e,n){return yr("calc.worker.createDedicatedWorker (total)",(function(){return p(t,void 0,void 0,(function(){function t(t){return p(this,void 0,void 0,(function(){function i(t,n){return o?null!=r.onError&&(r.onError(t,n),!0):(e(n.error),!0)}function a(e){o&&null!=r.onClosed&&r.onClosed(e)}var o,c,f,d,h;return v(this,(function(e){switch(e.label){case 0:o=!1,e.label=1;case 1:return e.trys.push([1,6,,7]),c=new Worker(t),d=JS(c,(function(){return cC(c)})),f=rC(bS.Dedicated,d,s,l,i,a),c.onerror=function(e){var r;e.preventDefault(),r=null==e.message?new Error("worker.onerror received non-ErrorEvent (worker script fetch probably failed); url = "+t):tC(e),f.dispatchError(DS.UnhandledError,r,!o)},function(e,t){var r={shipAssertTag:function(e,r,n,i){try{t.ULS.shipAssertTag(e,r,n,i)}catch(e){}},assertTag:function(e,r,n,i){try{t.ULS.assertTag(e,r,n,i)}catch(e){}},traceTag:function(e,r,n,i){try{t.ULS.traceTag(e,r,n,i)}catch(e){}},debugTraceTag:function(e,r,n,i){try{t.ULS.debugTraceTag(e,r,n,i)}catch(e){}}};e.setExports("",r)}(f,k),n()?[3,3]:[4,yr("calc.worker.createDedicatedWorker (inside)",(function(){var e=f.getImports("",["init"]).init;return e.callTimeout=s,e.isCritical=!0,e.call({initTimeout:s,callTimeout:l,calcAbsUrl:u,features:lC()})}))];case 2:e.sent(),e.label=3;case 3:return n()||null==r.onInit?[3,5]:[4,r.onInit(f)];case 4:e.sent(),e.label=5;case 5:return o=!0,[2,f];case 6:throw h=e.sent(),null!=f?f.close():null!=c&&cC(c),h;case 7:return[2]}}))}))}var i,a,f,d;return v(this,(function(e){switch(e.label){case 0:n=o+(/\.min\.js$/.test(r=u)?".min.js":".js"),s=r.lastIndexOf("/"),i=r.substring(0,s+1)+n,a="calc.worker.createDedicatedWorker: workerUrl = "+i,k.ULS.traceTag(595907588,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,a),e.label=1;case 1:e.trys.push([1,6,,7]),f=new Blob(['importScripts("'+encodeURI(i)+'");'],{type:"application/javascript"}),d=URL.createObjectURL(f),e.label=2;case 2:return e.trys.push([2,,4,5]),[4,t(d)];case 3:return[2,e.sent()];case 4:return URL.revokeObjectURL(d),[7];case 5:return[3,7];case 6:return e.sent(),k.ULS.traceTag(595881991,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,"calc.worker.createDedicatedWorker: failed to start worker from blob url for "+i+". Attempting with string url instead..."),[2,t(i)];case 7:return[2]}var r,n,s}))}))}))}))},uC);function pC(e,t){return hC[e](t)}function vC(e,t){return p(this,void 0,void 0,(function(){var r,n,i,a,o;return v(this,(function(u){switch(u.label){case 0:r=0,u.label=1;case 1:if(!(r<e.length))return[3,6];if(!dC(n=e[r]))return[3,5];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,pC(n,t)];case 3:return[2,u.sent()];case 4:return i=u.sent(),a=null!=i.stack?i.stack:i.message,o="calc.worker.tryCreateWorker: starting "+n+" worker threw "+a,k.ULS.traceTag(595907598,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,o),[3,5];case 5:return r+=1,[3,1];case 6:return[2,void 0]}}))}))}function mC(){setTimeout((function(){try{self.close()}catch(e){}}),100)}function gC(e,t,r,n){var i=t.initTimeout,a=t.callTimeout,o=t.calcAbsUrl,u=t.features;return p(this,void 0,void 0,(function(){var t,s,c,l,f=this;return v(this,(function(d){switch(d.label){case 0:return function(){if("undefined"==typeof self||null!=self.document)throw new Error("not in a worker execution context")}(),[4,jS(i,(function(){return new Error("exceeded timeout; initTimeout = "+i+"ms")}),(function(e,t){return p(f,void 0,void 0,(function(){function s(t,r){return l?null!=n.onError&&(n.onError(t,r),!0):(e(r.error),!0)}function c(e){l&&null!=n.onClosed&&n.onClosed(e)}var l,f,d,h,p,m;return v(this,(function(e){switch(e.label){case 0:l=!1,e.label=1;case 1:return e.trys.push([1,4,,5]),d=JS(self,mC),f=rC(bS.Dedicated,d,i,a,s,c),h=function(e){var t=e.getImports("",["shipAssertTag","assertTag","traceTag","debugTraceTag"]);return{shipAssertTag:function(e,r,n,i){if(t.shipAssertTag.notify(e,r,n,i),!n)throw new Error("shipAssertTag: "+e+" "+r+" "+i)},assertTag:function(e,r,n,i){if(t.assertTag.notify(e,r,n,i),!n)throw new Error("assertTag: "+e+" "+r+" "+i)},traceTag:function(e,r,n,i){t.traceTag.notify(e,r,n,i)},debugTraceTag:function(e,r,n,i){t.debugTraceTag.notify(e,r,n,i)}}}(f),p=function(e){return!0===u[e]},r.config.initCalc(h,p,o),t()||null==n.onInit?[3,3]:[4,n.onInit(f)];case 2:e.sent(),e.label=3;case 3:return l=!0,[3,5];case 4:throw m=e.sent(),null!=f?f.close():mC(),m;case 5:return[2]}}))}))})).then((function(e){return[MS.Fulfilled,e]}),(function(e){return[MS.Rejected,e]}))];case 1:t=d.sent(),s=t[0],c=t[1],l=[LS.Result,e,s,$S(c),!0];try{self.postMessage(l)}catch(e){throw mC(),e}return[2]}}))}))}var EC={onError:function(e,t){var r=null!=t.error.stack?t.error.stack:t.error.message,n="calc.worker.smokeTestInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:r});k.ULS.traceTag(595908699,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Error,n)},onClosed:function(e){},onInit:function(e){var t=e.getImports("talk",["ping"]);e.setExports("location",Sn),e.setExports("talk",{start:function(e,r,n){return p(this,void 0,void 0,(function(){var i,a=this;return v(this,(function(o){switch(o.label){case 0:return i=Date.now(),[4,qS((function(o){return p(a,void 0,void 0,(function(){return v(this,(function(a){switch(a.label){case 0:return Date.now()>=i+e?[2,void 0]:[4,new Promise((function(e){return setTimeout((function(){return e()}),r)}))];case 1:return a.sent(),t.ping.notify(o,n),[2,o+1]}}))}))}),0)];case 1:return o.sent(),[2]}}))}))},memoryTest:function(e){var t=[],r=0;try{for(;r<e;r+=1){var n=new Uint8Array(1024);n[0]=0,n[1023]=255,t.push(n)}}catch(e){}t=[];var i="calc.worker.smokeTestInsideDef.memoryTest: memory allocated = "+r+"KB";k.ULS.traceTag(595906820,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,i)},ping:function(e,t){if(t&&e%1e3==0){var r="calc.worker.smokeTestInsideDef.ping: n = "+e;k.ULS.traceTag(595907656,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,r)}return e+1},logMessage:function(e,t){if(t){var r="calc.worker.smokeTestInsideDef.logMessage: msg = "+e;k.ULS.traceTag(595714188,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,r)}}})},scriptName:"excelOnlineCalcSmokeTest.worker"},SC={outside:{onError:function(e,t){var r=null!=t.error.stack?t.error.stack:t.error.message,n="calc.worker.smokeTestOutsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:r});k.ULS.traceTag(595910859,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Error,n)},onClosed:function(e){k.ULS.traceTag(595908701,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.worker.smokeTestOutsideDef.onClose")},onInit:function(e){e.setExports("talk",{ping:function(e,t){if(t&&e%1e3==0){var r="calc.worker.smokeTestOutsideDef.ping: n = "+e;k.ULS.traceTag(595907657,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,r)}return e+1}})}},inside:EC},CC=!1,TC=void 0;function RC(){null!=TC&&TC.close(),CC=!1}var yC=Promise.resolve();function IC(e,t,r,n){return void 0===n&&(n=0),Ar(Sr.CalcWebWorkerTest)?(RC(),yC=yC.then((function(i){return function(e,t,r,n){return p(this,void 0,void 0,(function(){var i,a,o,u,s,l,f,d=this;return v(this,(function(h){switch(h.label){case 0:CC=!0,h.label=1;case 1:return h.trys.push([1,8,9,10]),f="calc.worker.runSmokeTest: starting; duration = "+e+"ms, pingInterval = "+t+"ms",k.ULS.traceTag(595908687,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,f),[4,vC([bS.Dedicated,bS.MessageChannel,bS.FunctionCall],SC)];case 2:if(null==(TC=h.sent()))throw new Error("could not create any kind of worker");if(!CC)throw new Error("smoke test canceled during worker creation");return f="calc.worker.runSmokeTest: worker created; outside.workerKind = "+TC.workerKind,k.ULS.traceTag(595907658,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,f),i=TC.getImports("talk",["start","memoryTest","ping","logMessage"]),a=TC.getImports("location",["gridCell"]),[4,i.ping.call(-1,r)];case 3:return o=h.sent(),[4,a.gridCell.call(2,3)];case 4:if(u=h.sent(),0!==o||2!==u.row||3!==u.col)throw new Error("expected 0, 2, 3; got "+o+", "+u.row+", "+u.col);return n>0&&TC.workerKind===bS.Dedicated?[4,i.memoryTest.call(n)]:[3,6];case 5:h.sent(),h.label=6;case 6:return i.start.notify(e,t,r),s=Date.now(),[4,qS((function(n){return p(d,void 0,void 0,(function(){var a;return v(this,(function(o){switch(o.label){case 0:return Date.now()>=s+e?[2,void 0]:n%1e3!=0?[3,3]:(a=Rr("calc.worker.runSmokeTest: ping call roundtrip"),[4,i.ping.call(n,!1)]);case 1:return o.sent(),a.stop(),a=Rr("calc.worker.runSmokeTest: logMessage notify"),[4,i.logMessage.notify("To be, or not to be, that is the question:Whether 'tis nobler in the mind to sufferThe slings and arrows of outrageous fortune,Or to take arms against a sea of troublesAnd by opposing end them. To die—to sleep,No more; and by a sleep to say we endThe heart-ache and the thousand natural shocksThat flesh is heir to: 'tis a consummationDevoutly to be wish'd. To die, to sleep;To sleep, perchance to dream—ay, there's the rub:For in that sleep of death what dreams may come,When we have shuffled off this mortal coil,Must give us pause—there's the respectThat makes calamity of so long life.For who would bear the whips and scorns of time,Th'oppressor's wrong, the proud man's contumely,The pangs of dispriz'd love, the law's delay,The insolence of office, and the spurnsThat patient merit of th'unworthy takes,When he himself might his quietus makeWith a bare bodkin? Who would fardels bear,To grunt and sweat under a weary life,But that the dread of something after death,The undiscovere'd country, from whose bournNo traveller returns, puzzles the will,And makes us rather bear those ills we haveThan fly to others that we know not of?Thus conscience does make cowards of us all,And thus the native hue of resolutionIs sicklied o'er with the pale cast of thought,And enterprises of great pitch and momentWith this regard their currents turn awryAnd lose the name of action.",!1)];case 2:o.sent(),a.stop(),o.label=3;case 3:return[4,new Promise((function(e){return setTimeout((function(){return e()}),t)}))];case 4:return o.sent(),i.ping.notify(n,r),[2,n+1]}}))}))}),0)];case 7:return h.sent(),f="calc.worker.runSmokeTest: success",k.ULS.traceTag(595906821,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Error,f),[3,10];case 8:return l=h.sent(),CC&&(f="calc.worker.runSmokeTest: failure: "+(null!=l.stack?l.stack:l.message),k.ULS.traceTag(595908702,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Error,f)),[3,10];case 9:return RC(),TC=void 0,[7];case 10:return[2]}}))}))}(e,t,r,n)}))):Promise.resolve()}function OC(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return[vr(r,i),mr(n,a)]}function AC(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return[mr(r,i),vr(n,a)]}function NC(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return mr(r,i)<vr(n,a)}function kC(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return r<i&&a>=n?[r,i]:r>=i&&a<n?[a,n]:void 0}function FC(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return r===i&&n===a?0:r>=i&&n<=a?-1:r<=i&&n>=a?1:void 0}var bC,DC=d;function LC(e){var t,r,n,i=d(d({},e),{split:(t=e.split,r=e.top,void 0===n&&(n=10),function(e){if(void 0!==e.split)return e.split;var i=t(e),a=e===r?0:e.depth;return void 0!==a&&a<n&&(e.split=i,i[0][0].depth=a+1,i[1][0].depth=a+1),i})});return function(e){return MC(i,JC(i,i.top,e))}}function MC(e,t){return t===jC||t===KC?t:{setOperations:e,root:t}}function _C(e,t){return t===jC?e:t===KC||e===jC?t:e===KC?e:MC(e.setOperations,wC(e.setOperations,e.root,t.root))}function wC(e,t,r){if(r===jC)return t;if(r===KC)return r;if(t===jC)return r;if(t===KC)return t;if(t.isExact&&r.isExact){var n=function(e,t,r){var n=t.pathKey,i=t.key,a=r.key,o=e.compare(i,a);if(void 0!==o)return o<0?r:t;var u=e.union(i,a);if(void 0!==u){var s=e.compare(u,n);return void 0!==s&&0===s?KC:XC(n,u,!0)}return}(e,t,r);if(void 0!==n)return n}var i=YC(e,t),a=YC(e,r);return HC(wC(e,i.left,a.left),wC(e,i.right,a.right))}function UC(e,t){return e===jC?e:t===jC||e===KC?t:t===KC?e:MC(e.setOperations,PC(e.setOperations,e.root,t.root))}function PC(e,t,r){if(t===jC)return t;if(r===jC)return r;if(t===KC)return r;if(r===KC)return t;if(t.isExact&&r.isExact){var n=function(e,t,r){var n=t.pathKey,i=t.key,a=r.key;if(!e.meets(i,a))return jC;var o=e.compare(i,a);if(void 0!==o)return o<0?t:r;var u=e.intersect(i,a);if(void 0!==u)return XC(n,u,!0);return}(e,t,r);if(void 0!==n)return n}var i=YC(e,t),a=YC(e,r);return HC(PC(e,i.left,a.left),PC(e,i.right,a.right))}function GC(e,t,r){if(t===jC||r===jC)return!1;if(t===KC||r===KC)return!0;if(t.isExact&&r.isExact)return e.meets(t.key,r.key);var n=YC(e,t),i=YC(e,r);return GC(e,n.left,i.left)||GC(e,n.right,i.right)}function VC(e,t){return e===jC||t===jC?e:t===KC?jC:e===KC?MC(t.setOperations,xC(t.setOperations,e,t.root)):MC(e.setOperations,xC(e.setOperations,e.root,t.root))}function xC(e,t,r){if(t===jC)return t;if(r===jC)return t;if(r===KC)return jC;if(t===KC){var n=YC(e,r);return HC(xC(e,KC,n.left),xC(e,KC,n.right))}if(t.isExact&&r.isExact){var i=function(e,t,r){var n=t.pathKey,i=t.key,a=r.key;if(!e.meets(i,a))return t;var o=e.except(i,a);if(void 0!==o)return XC(n,o,!0);return}(e,t,r);if(void 0!==i)return i}var a=YC(e,t),o=YC(e,r);return HC(xC(e,a.left,o.left),xC(e,a.right,o.right))}function BC(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function WC(e,t,r){if(t===r)return 0;if(t===jC)return-1;if(r===jC)return 1;if(t===KC)return r===KC?0:1;if(r===KC)return-1;if(t.isExact&&r.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,t,r);var n=YC(e,t),i=YC(e,r),a=WC(e,n.left,i.left);if(void 0!==a){var o=WC(e,n.right,i.right);if(void 0!==o)return BC(a,o)}}function HC(e,t){return e===jC?t===jC?jC:qC(e,t,void 0,void 0,!1):t===jC?qC(e,t,void 0,void 0,!1):e===KC&&t===KC?KC:qC(e,t,void 0,void 0,!1)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(bC||(bC={}));var KC=bC.Dense,jC=bC.Empty;function qC(e,t,r,n,i){return{key:n,pathKey:r,left:e,right:t,isExact:i}}function JC(e,t,r){if(!e.meets(t,r))return jC;var n=e.compare(t,r);if(void 0!==n)return n<=0?KC:XC(t,r,!0);var i=e.intersect(t,r);return void 0!==i?XC(t,i,!0):XC(t,r,!1)}function XC(e,t,r){return qC(void 0,void 0,e,t,!!r)}function YC(e,t){if(void 0!==t.left)return t;var r=e.split(t.pathKey),n=r[0][0],i=r[1][0],a=HC(JC(e,n,t.key),JC(e,i,t.key));if(a===jC||a===KC)throw new Error("incorrect set operations implementation");var o=a;return DC(t,{left:o.left,right:o.right})}function QC(e){return e===jC||e===KC?0:function e(t){if(void 0===t||t===jC||t===KC)return 0;return e(t.left)+e(t.right)+1}(e.root)}function zC(e,t){return e===jC||function(e,t,r){return function t(n,i){if(i===jC)return!0;if(i===KC)return r(n);if(i.isExact)return r(i.key);var a=YC(e,i),o=e.split(n),u=o[0][0],s=o[1][0];return t(u,a.left)&&t(s,a.right)}(e.top,t)}(e.setOperations,e.root,t)}function ZC(e,t,r){var n=function(e,t,r){var n=Math.pow(t,e),i=1-Math.pow(t/r,e),a=Math.pow(r,e),o=a*n,u=a-n,s=-1/e;return{cdf:1===e?function(e){return(1-n/e)/i}:function(t){return(1-n*Math.pow(t,-e))/i},invCdf:1===e?function(e){return 1/((a-e*u)/o)}:function(e){return Math.pow((a-e*u)/o,s)}}}(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],i=n.cdf(r),a=n.cdf(t+1),o=n.invCdf((i+a)/2),u=Math.min(Math.max(Math.round(o),t+1),r-1);return[[[t,u],n.cdf(u)-n.cdf(t+1)],[[u,r],n.cdf(r)-n.cdf(u)]]}}}function $C(e,t,r,n,i){var a=ZC(e,t,r);return{id:i,split:function(e){return a.split(e)},canSplit:function(e){return a.canSplit(e)},meets:NC,intersect:AC,union:function(e,t){return n=t,i=(r=e)[0],a=r[1],o=n[0],u=n[1],mr(i,o)<=vr(a,u)?OC(e,t):void 0;var r,n,i,a,o,u},except:kC,compare:FC,top:n}}var eT=[{},{}];function tT(e){var t=!0;for(var r in e)if(e.hasOwnProperty(r)){t=!1;break}return t?KC:{isSubspace:!0,bounds:e}}function rT(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:NT(e)+NT(t)}}function nT(e,t){if(t===KC)return t;if(t.isSubspace){var r=!1;for(var n in t.bounds)if(e.hasOwnProperty(n)){r=!0;break}if(!r)return KC}return{productOperations:e,root:t}}var iT,aT={unzip:function(e){var t={},r={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(i===jC)return jC;if(i===KC)continue;t[n]=i.setOperations,r[n]=i.root}return nT(t,tT(r))},combineProduct:function(e,t,r,n){var i={};for(var a in e)if(e.hasOwnProperty(a)){var o=n(e[a],uT(t[a]),uT(r[a]));if(o===jC)return o;if(o===KC)continue;i[a]=o}return i},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},i=0,a=t;i<a.length;i++){var o=a[i];if(e.hasOwnProperty(o)){var u=e[o];n[o]=u}}return n},fromUntypedProduct:function(e,t,r){for(var n={},i=0,a=r;i<a.length;i++){var o=a[i],u=t[o];n[o]=MC(e[o],void 0!==u?u:KC)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=KC}return t}},oT=aT.unzip.bind(aT);function uT(e){return void 0===e?KC:e}function sT(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===KC||e===jC)return e;var n=aT.restrict.apply(aT,m([e.productOperations],t)),i=cT.apply(void 0,m([n,e.root],t));return i===jC?i:nT(n,i)}function cT(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=aT.restrict.apply(aT,m([t.bounds],r));if(t.isSubspace)return tT(i);var a=cT.apply(void 0,m([e,t.left],r));if(a===KC)return KC;var o=cT.apply(void 0,m([e,t.right],r));return ST(e,a,o)}function lT(e,t){if(t===jC)return e;if(t===KC)return t;if(e===jC)return t;if(e===KC)return e;var r=d(d({},e.productOperations),t.productOperations),n=mT(r,e.root,t.root,eT);return n===jC?n:nT(r,n)}function fT(e,t){if(e===jC)return e;if(t===jC)return t;if(e===KC)return t;if(t===KC)return e;var r=d(d({},e.productOperations),t.productOperations),n=gT(r,e.root,t.root,eT);return n===jC?n:nT(r,n)}function dT(e,t){if(e===jC)return e;if(t===jC)return e;if(t===KC)return jC;if(e===KC){var r=ET(t.productOperations,KC,t.root,eT);return r===jC?r:nT(t.productOperations,r)}var n=d(d({},e.productOperations),t.productOperations),i=ET(n,e.root,t.root,eT);return i===jC?i:nT(n,i)}function hT(e,t){return e===t?0:e===jC?-1:t===jC?1:e===KC?t===KC?0:1:t===KC?-1:function e(t,r,n,i){if(r===n)return 0;if(r===jC)return-1;if(n===jC)return 1;if(r===KC)return n===KC?0:1;if(n===KC)return-1;if(r.isSubspace&&n.isSubspace)return TT(t,r.bounds,n.bounds);var a=IT(t,i),o=a[0],u=a[1],s=OT(t,r,o,u),c=s[0],l=s[1],f=OT(t,n,o,u),d=f[0],h=f[1],p=e(t,c,d,o);return void 0===p?void 0:BC(p,e(t,l,h,u))}(d(d({},e.productOperations),t.productOperations),e.root,t.root,eT)}function pT(e,t){return e!==jC&&t!==jC&&(e===KC||t===KC||function e(t,r,n,i){if(r===jC||n===jC)return!1;if(r===KC||n===KC)return!0;if(!function(e,t,r){for(var n in e)if(e.hasOwnProperty(n)){var i=uT(t[n]),a=uT(r[n]);if(!GC(e[n],i,a))return!1}return!0}(t,r.bounds,n.bounds))return!1;if(r.isSubspace&&n.isSubspace)return!0;var a=IT(t,i),o=a[0],u=a[1],s=OT(t,r,o,u),c=s[0],l=s[1],f=OT(t,n,o,u),d=f[0],h=f[1];return e(t,c,d,o)||e(t,l,h,u)}(d(d({},e.productOperations),t.productOperations),e.root,t.root,eT))}function vT(e){return dT(KC,e)}function mT(e,t,r,n){if(r===jC)return t;if(t===jC)return r;if(t===KC)return t;if(r===KC)return r;if(t.isSubspace&&r.isSubspace){var i=CT(e,t,r);if(void 0!==i)return i}return yT(e,t,r,n,mT)}function gT(e,t,r,n){if(t===jC||r===jC)return jC;if(t===KC)return r;if(r===KC)return t;if(t.isSubspace&&r.isSubspace){var i=aT.combineProduct(e,t.bounds,r.bounds,PC);return i===jC?jC:tT(i)}return yT(e,t,r,n,gT)}function ET(e,t,r,n){if(t===jC)return t;if(r===KC)return jC;if(r===jC)return t;if(t===KC)return yT(e,t,r,n,ET);if(t.isSubspace&&r.isSubspace){var i=function(e,t,r){var n,i=TT(e,t.bounds,r.bounds);if(0===i||-1===i)return jC;var a=void 0;for(var o in e)if(e.hasOwnProperty(o)){var u=WC(e[o],uT(t.bounds[o]),uT(r.bounds[o]));if(void 0===u||u>0){if(void 0!==a)return;a=o}}if(void 0!==a){var s=xC(e[a],uT(t.bounds[a]),uT(r.bounds[a]));if(s===jC)return jC;if(s===KC){var c=t.bounds,l=a;c[l];return tT(h(c,["symbol"==typeof l?l:l+""]))}return tT(d(d({},t.bounds),((n={})[a]=s,n)))}return}(e,t,r);if(void 0!==i)return i}return yT(e,t,r,n,ET)}function ST(e,t,r){if(r===jC)return t;if(r===KC)return r;if(t===jC)return r;if(t===KC)return t;if(!t.isSubspace||!r.isSubspace)return rT(t,r,RT(e,t.bounds,r.bounds));var n=CT(e,t,r);return void 0!==n?n:rT(t,r,RT(e,t.bounds,r.bounds))}function CT(e,t,r){var n,i=TT(e,t.bounds,r.bounds);if(void 0!==i)return i<=0?r:t;var a=void 0;for(var o in e){if(e.hasOwnProperty(o))if(0!==WC(e[o],uT(t.bounds[o]),uT(r.bounds[o]))){if(void 0!==a)return;a=o}}if(void 0!==a){var u=wC(e[a],uT(t.bounds[a]),uT(r.bounds[a]));if(u===jC)return jC;if(u===KC){var s=t.bounds,c=a;s[c];return tT(h(s,["symbol"==typeof c?c:c+""]))}return tT(d(d({},t.bounds),((n={})[a]=u,n)))}}function TT(e,t,r){var n=0;for(var i in e)if(e.hasOwnProperty(i)){var a=uT(t[i]),o=uT(r[i]);if(void 0===(n=BC(n,WC(e[i],a,o))))return}return n}function RT(e,t,r){var n=aT.combineProduct(e,t,r,wC);if(n===jC)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function yT(e,t,r,n,i){var a=IT(e,n),o=a[0],u=a[1],s=OT(e,t,o,u),c=s[0],l=s[1],f=OT(e,r,o,u),d=f[0],h=f[1],p=i(e,c,d,o);return p===KC?KC:ST(e,p,i(e,l,h,u))}function IT(e,t){var r,n,i,a,o,u=t[0],s=t[1],c=void 0,l=0;for(var f in e)if(e.hasOwnProperty(f)){var h=s[f],p=e[f];if(void 0===h){c=f,o=p.top;break}if(h>l){var v=uT(u[f]);if(v===jC)throw new Error("the key split can never return empty");var m=p.top;if(v!==KC){if(!v.isExact)throw new Error("the key can always be represented exactly");m=v.key}if(!p.canSplit(m))continue;c=f,l=h,o=m}}if(void 0===c||void 0===o)throw new Error("there has to be at least one dimension");var g=e[c],E=g.split(o),S=E[0],C=S[0],T=S[1],R=E[1],y=R[0],I=R[1];return[[d(d({},u),(r={},r[c]=JC(g,g.top,C),r)),d(d({},s),(n={},n[c]=T,n))],[d(d({},u),(i={},i[c]=JC(g,g.top,y),i)),d(d({},s),(a={},a[c]=I,a))]]}function OT(e,t,r,n){var i=r[0],a=n[0];return[AT(e,t,i),AT(e,t,a)]}function AT(e,t,r){if(r===jC||t===jC)return jC;if(t===KC)return tT(r);var n=TT(e,t.bounds,r);if(void 0!==n&&n<=0)return t;var i=aT.combineProduct(e,t.bounds,r,PC);return i===jC?jC:t.isSubspace?tT(i):ST(e,AT(e,t.left,r),AT(e,t.right,r))}function NT(e){return e.isSubspace?1:e.subspaceCount}function kT(e){return e===jC||e===KC?0:NT(e.root)}!function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(iT||(iT={}));var FT=[iT.AvailableSet,iT.AvailableRead+1],bT=[0,1<<20],DT=[0,16384],LT={availability:$C(1,FT[0]+1,FT[1],FT,"Availability operations, alpha = 1"),row:$C(.2,bT[0]+1,bT[1],bT,"Row operations, alpha = 0.2"),col:$C(.35,DT[0]+1,DT[1],DT,"Col operations, alpha = 0.35")},MT={availability:LC(LT.availability),row:LC(LT.row),col:LC(LT.col)};function _T(e){return oT({row:MT.row([e.row,e.row+e.rows]),col:MT.col([e.col,e.col+e.cols])})}function wT(e){if(e!==jC){var t,r,n=e===KC?void 0:e.root.bounds.row,i=e===KC?void 0:e.root.bounds.col,a=void 0===n?LT.row.top:(t=MC(LT.row,n),r=[],VT(t,(function(e){return r.push(e),!0})),r.reduce(OC)),o=a[0],u=a[1],s=void 0===i?LT.col.top:function(e){var t=[];return xT(e,(function(e){return t.push(e),!0})),t.reduce(OC)}(MC(LT.col,i)),c=s[0];return W(o,c,u-o,s[1]-c)}}var UT=oT({availability:MT.availability([iT.AvailableSet,iT.AvailableSet+1])}),PT=oT({availability:MT.availability([iT.AvailableRead,iT.AvailableRead+1])}),GT=oT({availability:MT.availability([iT.AvailableSet,iT.AvailableRead+1])});function VT(e,t){return e!==KC?zC(e,t):t(LT.row.top)}function xT(e,t){return e!==KC?zC(e,t):t(LT.col.top)}function BT(e,t){return function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=sT.apply(void 0,m([e],r));if(i===jC)return!0;if(i===KC)return t(aT.denseProduct(r));var a=i.productOperations,o=i.root;function u(e){return e.isSubspace?t(aT.fromUntypedProduct(a,e.bounds,r)):u(e.left)&&u(e.right)}return u(o)}(e,(function(e){return VT(e.row,(function(r){var n=r[0],i=r[1];return xT(e.col,(function(e){var r=e[0],a=e[1];return t(W(n,r,i-n,a-r))}))}))}),"row","col")}function WT(e,t){return BT(e,(function(e){return kt(e,t)}))}var HT,KT,jT=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var t=this.getCount()-1;t>0;){var r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;var n=0;for(this.items[0]=t;n<r;){var i=n,a=1+(n<<1),o=2+(n<<1);if(a<=r&&this.cmp(this.items[a],t)<0&&(i=a),o<=r&&this.cmp(this.items[o],i===a?this.items[i]:t)<0&&(i=o),n===i)break;this.items[n]=this.items[i],n=i}return this.items[n]=t,e},e.prototype.getCount=function(){return this.items.length},e.prototype.forEach=function(e){for(var t=0,r=this.items;t<r.length;t++){if(!e(r[t]))return}},e}(),qT=function(){function e(e){this.min=0,this.max=0,this.heap=new jT((function(t,r){var n=t[0],i=t[1],a=r[0],o=r[1],u=e(n,a);return 0!==u?u:i-o}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e}();!function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell"}(HT||(HT={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(KT||(KT={}));var JT,XT={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function YT(e,t){var r;return d(d({},e),((r={})[t]=(e[t]||0)+1,r))}function QT(e,t){switch(t.message){case JT.ChangedCell:return d(d({},e),{changedCellCount:YT(e.changedCellCount,t.cellKind),calculatedCellCount:YT(e.calculatedCellCount,t.cellKind)});case JT.UnchangedCell:return d(d({},e),{calculatedCellCount:YT(e.calculatedCellCount,t.cellKind)});case JT.ContinueComputation:return d(d({},e),{continueCount:e.continueCount+1});case JT.StateTimedOut:return d(d({},e),{stateTimedOut:!0});case JT.EditFinished:return d(d({},e),{editFinishedCount:e.editFinishedCount+1});case JT.RecalcFinished:return d(d({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return b("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}function zT(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor(Math.log2(t))}function ZT(e){switch(typeof e){case"number":return{kind:"n",magnitude:zT(e)};case"string":return{kind:"s"};case"boolean":return{kind:"b"};case"object":switch(e.kind){case j.Error:return{kind:"e",type:(t=e.type,r=dn[t],void 0===r?"error.type:"+t:r)};case j.Rich:return{kind:"r"};case j.Array:return{kind:"a"};case j.Blank:return{kind:"z"};default:return b("calc.calc.precisionValue",e)}}var t,r}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(JT||(JT={}));var $T,eR,tR,rR={samples:[],failures:[]};function nR(e,t){return 0===t.length?e:0===e.length?t:e.concat(t)}!function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.ContinueComputation=2]="ContinueComputation",e[e.ComputeCellValue=3]="ComputeCellValue",e[e.MaybeCollectGarbage=4]="MaybeCollectGarbage",e[e.PrecisionContinueComputation=5]="PrecisionContinueComputation",e[e.PrecisionComputeCellValue=6]="PrecisionComputeCellValue",e[e.RunExperiment=7]="RunExperiment",e[e.TestAdvanceState=8]="TestAdvanceState"}($T||($T={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(eR||(eR={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.PrecisionStatistics="PrecisionStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(tR||(tR={}));var iR=function(){function e(){this.queue=new qT((function(e,t){return e.kind-t.kind})),this.kindToId=[0,0,0,0,0,0,0,0,0],this.onInvalidateMessage=function(e){}}return e.prototype.invalidate=function(e){this.kindToId[e]+=1},e.prototype.isMessageValid=function(e){return e.kindId>=this.kindToId[e.kind]},e.prototype.peek=function(){for(;;){var e=this.queue.peek();if(void 0===e||this.isMessageValid(e))return e;this.onInvalidateMessage(e),this.queue.pop()}},e.prototype.pop=function(){for(;;){var e=this.queue.pop();if(void 0===e||this.isMessageValid(e))return e;this.onInvalidateMessage(e)}},e.prototype.enqueue=function(e,t,r){this.queue.enqueue({kind:e,kindId:this.kindToId[e],stateId:t,message:r})},e.prototype.enqueueRunExperimentMessage=function(e){this.queue.enqueue({kind:$T.RunExperiment,kindId:this.kindToId[$T.RunExperiment],message:e})},e.prototype.push=function(e,t,r){this.queue.push({kind:e,kindId:this.kindToId[e],stateId:t,message:r})},e.prototype.pushRunExperimentMessage=function(e){this.queue.push({kind:$T.RunExperiment,kindId:this.kindToId[$T.RunExperiment],message:e})},e.prototype.getCountUpperBound=function(){return this.queue.getCount()},e}();function aR(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var i=e.slice(0,-1);return t<e.length-1&&(i[t]=e[e.length-1]),i}function oR(e,t,r){return{kind:e,key:t,value:r}}function uR(e,t){return oR(1,e,t)}function sR(e,t){return oR(2,e,t)}function cR(e,t){return oR(3,e,t)}var lR=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,i,a){void 0===a&&(a=2);var o=a>1?Math.ceil(a):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:i,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,n){var i=r.keyCompare(n.key,e);if(1===n.kind)return 0===i?n.value:void 0;if(!(void 0===i||i<0))for(var a=0,o=n.value;a<o.length;a++){var u=t(r,o[a]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:Hr(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var i=mR(this.lattice,this.root,t,n,r);return void 0!==i?i===this.root?this:new e(this.lattice,i,this.count):new e(this.lattice,vR(this.lattice,this.root,uR(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==mR(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return fR(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return fR(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return fR(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return fR(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var n=[],i=this.lattice,a=function(e,r){var o=i.keyCompare(e.key,t);if(void 0===o||o<0)return pr(e,1);if(2===e.kind){for(var u=e.value,s=0;s<u.length;s+=1)if(0===i.keyCompare(u[s].key,t)){if((h=aR(u,s)).length<r){var c=sR(e.key,h);return n.push(c),pr(c,3)}return pr(sR(hR(i,h),h),2)}}else for(u=e.value,s=0;s<u.length;s+=1){var l=a(u[s],i.minChildren),f=l[0],d=l[1];if(3===d){var h;if((h=aR(u,s)).length>=r)return pr(cR(hR(i,h),h),2);c=cR(e.key,h);return n.push(c),pr(c,3)}if(2===d)return pr(cR(e.key,aR(u,s,f)),2)}return pr(e,1)},o=2===this.root.kind?1:2,u=a(this.root,o),s=u[0],c=u[1];if(s===this.root)return this;for(var l=3===c?void 0:s,f=0;f<n.length;f+=1)fR(n[f],(function(e,t){return l=vR(r.lattice,l,uR(e,t)),!0}));return new e(this.lattice,l,this.count-1)},e}();function fR(e,t,r,n){var i=void 0!==r?r:function(){return!0},a=void 0!==n?n:function(){return!0};if(null==e)return!0;var o=function(e){if(!i(e.key))return!0;if(2===e.kind)for(var r=e.value,n=0;n<r.length;n+=1){var u=r[n];if(a(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,n=0;n<r.length;n+=1)if(!o(r[n]))return!1;return!0};return o(e)}function dR(e,t){for(var r=function(e,t){for(var r=0,n=1,i=e.keyDistance(t[0].key,t[1].key),a=2;a<t.length;a+=1)for(var o=0;o<a;o+=1){var u=e.keyDistance(t[o].key,t[a].key);u>i&&(r=o,n=a,i=u)}return pr(r,n)}(e,t),n=r[0],i=r[1],a=t[n].key,o=t[i].key,u=[],s=0;s<t.length;s+=1){var c=t[s];u.push([c,e.keyDistance(a,c.key)-e.keyDistance(o,c.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var l=e.minChildren;l<t.length-e.minChildren&&u[l][1]<0;l+=1);var f=[],d=[];for(s=0;s<l;s+=1)f.push(u[s][0]);for(s=l;s<t.length;s+=1)d.push(u[s][0]);return pr(f,d)}function hR(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function pR(e,t,r){var n=dR(e,r),i=n[0],a=n[1];return pr(oR(t,hR(e,i),i),oR(t,hR(e,a),a))}function vR(e,t,r){if(null==t)return sR(r.key,[r]);var n=function t(n){if(2===n.kind){var i=m(n.value,[r]);if(i.length>e.maxChildren){var a=pR(e,n.kind,i),o=a[0],u=a[1];return pr(sR(o.key,o.value),u)}return pr(sR(e.keyJoin(n.key,r.key),i),void 0)}var s=n.value.slice(),c=function(e,t,r){for(var n=0,i=e.keyDistance(t[0].key,r),a=t[0].value.length,o=1;o<t.length;o+=1){var u=t[o],s=e.keyDistance(u.key,r);(s<i||s===i&&u.value.length<a)&&(n=o,i=s,a=u.value.length)}return n}(e,s,r.key),l=t(s[c]),f=l[0],d=l[1];if(s[c]=f,null!=d&&(s.push(d),s.length>e.maxChildren)){var h=pR(e,n.kind,s),p=h[0];u=h[1];return pr(cR(p.key,p.value),u)}return pr(cR(e.keyJoin(n.key,r.key),s),void 0)}(t),i=n[0],a=n[1];return null!=a?cR(e.keyJoin(i.key,a.key),[i,a]):i}function mR(e,t,r,n,i){if(void 0!==t)return function t(n){if(2!==n.kind)for(i=0;i<n.value.length;i+=1){o=n.value[i];if(e.keyMeets(o.key,r))if(void 0!==(u=t(o)))return cR(n.key,aR(n.value,i,u))}else for(var i=0;i<n.value.length;i+=1){var o,u;if(void 0!==(u=a(o=n.value[i])))return sR(n.key,aR(n.value,i,u))}}(t);function a(t){if(0===e.keyCompare(t.key,r))return void 0!==i&&t.value!==i&&n(t.value)?uR(t.key,i):t}}function gR(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols;return mr(r,o)<vr(r+i,o+s)&&mr(n,u)<vr(n+a,u+c)}function ER(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,u=t.col,s=r+i,c=o+t.rows,l=n+a,f=u+t.cols;return r===o&&s===c&&n===u&&l===f?0:r<=o&&s>=c&&n<=u&&l>=f?1:r>=o&&s<=c&&n>=u&&l<=f?-1:void 0}function SR(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,u=t.col,s=t.rows,c=t.cols;return gr(r-o+.5*(i-s))+gr(n-u+.5*(a-c))}function CR(){return lR.create(Vf,gR,ER,SR)}var TR,RR=function(e,t,r,n){return{isExact:e,iformat:t,category:r,decimals:n}},yR=RR(!0,Es.General,"General",0),IR={fmla:"",source:y.Cell,compiledFmla:void 0},OR={fmla:"",source:y.Range,compiledFmla:void 0};!function(e){e[e.Dirty=0]="Dirty",e[e.Calced=1]="Calced"}(TR||(TR={}));var AR={oper:be,clientFailure:void 0,calcState:TR.Calced};function NR(e,t,r){return e.setValue(t,r,(function(e){return e.source!==r.source||e.fmla!==r.fmla||null==e.compiledFmla!=(null==r.compiledFmla)}))}function kR(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.source===y.Cell?IR:OR;e=e.setValue(t,n)}return!0})),e}var FR={values:CR(),formats:CR(),formulae:CR()},bR={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverValuesNodeCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedValuesNodeCount:0,recalcValuesNodeCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0};var DR=W(0,0,1<<20,16384);var LR,MR=function(){function e(e,t){this.sheet=e,this.formulaCompiler=t,this.oldAvailabilities={},this.availabilityHistorySize=0,this.inFilterMode=!1,this.filterModeAvailable=!1,this.serverContents=this.editedContents=FR,this.recalcValues=this.editedContents.values,this.recalcFailures=jC,this.editedTaint=this.recalcTaint=jC,this.serverAvailability=this.editedAvailability=jC,this.serverUsed=this.editedUsed=DR,this.hiddenRows=this.hiddenAvailability=jC}return e.prototype.cloneServer=function(){var t=new e(this.sheet,this.formulaCompiler);return t.serverContents=this.serverContents,t.serverAvailability=this.serverAvailability,t.serverUsed=this.serverUsed,t},e.prototype.advanceState=function(e){this.editedContents=this.serverContents,this.recalcValues=this.editedContents.values,this.recalcFailures=jC,this.editedTaint=this.recalcTaint=jC,this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=this.editedAvailability=jC,this.serverUsed=this.editedUsed=DR,this.hiddenRows=this.hiddenAvailability=jC,this.inFilterMode=this.filterModeAvailable=!1},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=hT(t,fT(_T(e),PT));return void 0!==r&&r>=0},e.prototype.hasRecalcFailure=function(e){return pT(this.recalcFailures,_T(e))},e.prototype.hasEditedEditTaint=function(e){return pT(this.editedTaint,_T(e))},e.prototype.hasRecalcEditTaint=function(e){return pT(this.recalcTaint,_T(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r,n,i=MT.row(pr(e,t)),a=(r=this.hiddenAvailability)===(n=i)?0:r===jC?-1:n===jC?1:r===KC?n===KC?0:1:n===KC?-1:WC(r.setOperations,r.root,n.root);if(!(void 0!==a&&a>=0))return Xt({kind:jy.HiddenRows});var o=[];return VT(UC(this.hiddenRows,i),(function(e){var t=e[0],r=e[1];return o.push(cf(t,r)),!0})),Jt(o)},e.prototype.setHiddenRows=function(e,t){var r=MT.row(pr(e.row,e.row+e.rows));this.hiddenRows=_C(VC(this.hiddenRows,r),UC(t,r)),this.hiddenAvailability=_C(this.hiddenAvailability,r)},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?Jt(this.inFilterMode):Xt({kind:jy.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){var r=this,n=fT(e,UT);BT(fT(this.editedAvailability,n),(function(e){return r.editedContents.formulae.forEachMeets(e,(function(r,n){return""===n.fmla||kt(Bf(e,r),t)}))}))},e.prototype.promoteServerAvailability=function(e,t){var r=fT(e,UT),n=this.oldAvailabilities[t];if(void 0===n)return!1;var i=hT(n,r);return void 0!==i&&i>=0&&(this.unionAvailability(!0,fT(e,GT)),this.unionTaint(!0,jC),this.unionUsed(!0,wT(e)),!0)},e.prototype.extendServerUnused=function(e){var t=void 0===e?jC:_T(e),r=vT(t),n=this.serverContents,i=n.values,a=n.formats,o=n.formulae;BT(r,(function(e){return i.forEachMeets(e,(function(e,t){return Mf(t.oper)&&void 0===t.clientFailure&&t.calcState===TR.Calced||(i=i.setValue(e,{oper:be,clientFailure:void 0,calcState:TR.Calced})),!0})),a.forEachMeets(e,(function(e,t){return t.isExact===yR.isExact&&t.iformat===yR.iformat||(a=a.setValue(e,yR)),!0})),!0})),BT(r,(function(e){return o=kR(o,e),!0})),this.setContents(!0,{values:i,formats:a,formulae:o});var u=this.serverAvailability;u=lT(u=fT(u,t),fT(r,PT)),this.serverAvailability=this.editedAvailability=u,this.editedTaint=this.recalcTaint=jC;var s,c,l=this.serverUsed;c=e,l=void 0===(s=l)||void 0===c?void 0:Bf(s,c),this.serverUsed=this.editedUsed=l},e.prototype.setRecalcFailure=function(e){this.recalcFailures=lT(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=lT(this.recalcTaint,e)},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this;kt(e,(function(e,n,i){var a=function(e){return Array.isArray(e)}(t)?t[n][i]:t;return r.recalcValues=r.recalcValues.setValue(e,{oper:a,clientFailure:void 0,calcState:TR.Calced}),Ar(Sr["OfficeVSO:3913458_CalcCGChangeDetection"])&&(r.editedContents=d(d({},r.editedContents),{values:r.editedContents.values.setValue(e,{oper:a,clientFailure:void 0,calcState:TR.Dirty})})),!0}))},e.prototype.getRecalcValue=function(e){var t=this.recalcValues.getValue(e);return void 0===t?AR:t},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return void 0===t?AR.oper:t.oper},e.prototype.setEditedFormat=function(e,t){this.editedContents=d(d({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return void 0!==t?t:yR},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return void 0!==t?t:yR},e.prototype.getEditedFormula=function(e){var t=void 0;return this.editedContents.formulae.forEachGe(e,(function(e,r){return 0===r.fmla.length||(t=[e,r],!1)})),t},e.prototype.setContents=function(e,t){e&&(this.serverContents=t),this.editedContents=t,this.recalcValues=this.editedContents.values,this.recalcFailures=jC},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=lT(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?jC:lT(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r,n,i=e?this.serverUsed:this.editedUsed;n=t,i=void 0===(r=i)?n:void 0===n?r:Vf(r,n),e&&(this.serverUsed=i),this.editedUsed=i},e.prototype.setCellContents=function(e,t,r,n,i,a,o,u){var s=this,c=void 0!==u,l=e?this.serverContents:this.editedContents,f=l.values,d=l.formats,h=l.formulae,p=a;void 0!==a&&(BT(t,(function(e){return h=kR(h,e),!0})),""===a&&(p=void 0));var v=r;Mf(r)&&!c&&i===TR.Calced&&(BT(t,(function(e){return f.forEachMeets(e,(function(e,t){return Mf(t.oper)&&t.calcState===i||(f=f.setValue(e,{oper:be,clientFailure:void 0,calcState:i})),!0})),!0})),v=void 0);var m=n;void 0!==n&&n.iformat===yR.iformat&&n.isExact===yR.isExact&&(BT(t,(function(e){return d.forEachMeets(e,(function(e,t){return t.isExact===yR.isExact&&t.iformat===yR.iformat||(d=d.setValue(e,yR)),!0})),!0})),m=void 0),(void 0!==p||void 0!==m||void 0!==v||c)&&WT(t,(function(t){return void 0!==p&&(h=NR(h,t,s.compileFormula(te(s.sheet,t),e,y.Cell,p,o))),void 0!==m&&(d=d.setValue(t,m)),(void 0!==v||c)&&(f=f.setValue(t,{oper:r,clientFailure:u,calcState:i})),!0})),this.setContents(e,{values:f,formats:d,formulae:h}),this.unionAvailability(e,fT(t,GT)),this.unionTaint(e,t),this.unionUsed(e,wT(t))},e.prototype.setRangeFormula=function(e,t,r,n,i,a){var o=e?this.serverContents:this.editedContents,u=o.values,s=o.formats,c=o.formulae;u.forEachLe(t,(function(e,t){return t.calcState!==r&&(u=u.setValue(e,{oper:t.oper,clientFailure:t.clientFailure,calcState:r})),!0}));var l=jC;if(e);else{var f=void 0!==a?Bf(t,a):void 0;void 0!==f&&(kt(f,(function(e){return void 0===u.getValue(e)&&(u=u.setValue(e,{oper:be,clientFailure:void 0,calcState:r})),!0})),l=_T(f))}c=NR(c=kR(c,t),t,this.compileFormula(ee(this.sheet,t),e,y.Range,n,i)),this.setContents(e,{values:u,formats:s,formulae:c}),this.unionAvailability(e,fT(l,GT)),this.unionTaint(e,l),this.unionUsed(e,t)},e.prototype.compileFormula=function(e,t,r,n,i){return i?this.formulaCompiler(e,t,r,n):{fmla:n,source:r,compiledFmla:void 0}},e.prototype.onCellModified=function(e){var t=e?this.serverContents:this.editedContents;this.setContents(e,t),this.unionAvailability(e,jC),this.unionTaint(e,jC),this.unionUsed(e,void 0)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcFailuresSetSubspaceCount:kT(this.recalcFailures),recalcTaintSetSubspaceCount:kT(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:kT(this.editedAvailability),hiddenRowsNodeCount:QC(this.hiddenRows)+QC(this.hiddenAvailability)}},e.prototype.collectGarbage=function(e){var t=jC;for(var r in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(r)){var n=Number(r);if(n>=e){t=lT(t,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function i(e){return pT(fT(_T(e),UT),t)}function a(e,t){return""!==t.fmla&&i(e)}function o(e,t){return!(t.iformat===yR.iformat&&t.isExact===yR.isExact)&&i(e)}function u(e,t){return!(Mf(t.oper)&&t.clientFailure===AR.clientFailure&&t.calcState===AR.calcState)&&i(e)}this.serverContents={formulae:this.serverContents.formulae.filter(a),formats:this.serverContents.formats.filter(o),values:this.serverContents.values.filter(u)},this.editedContents={formulae:this.editedContents.formulae.filter(a),formats:this.editedContents.formats.filter(o),values:this.editedContents.values.filter(u)},this.recalcValues=this.recalcValues.filter(u)},e}();function _R(e,t){e[t]=(e[t]||0)+1}function wR(e,t,r){return e.push(t.join(".")+": expected "+r),!1}function UR(e,t){return function(r,n,i){return fr(r)&&e(r)||wR(n,i,t)}}function PR(e,t,r,n){for(var i=[],a=t(e,i,[n]),o=0,u=i;o<u.length;o++){_R(r,u[o])}return a}function GR(e,t,r,n){var i=n+".<index>";return e.filter((function(e){return PR(e,t,r,i)}))}function VR(e){return function(t,r,n){return!!dr(t)||e(t,r,n)}}function xR(e){return function(t,r,n){if(dr(t))return wR(r,n,"non-null object");var i=n.length;try{var a=!0;for(var o in e)n[i]=o,a=a&&e[o](t[o],r,n);return a}finally{n.length=i}}}function BR(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,i){return e&&i(t,r,n)}),!0)}}function WR(e){return function(t,r,n){if(!Array.isArray(t))return wR(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,i){return t&&e(i,r,n)}),!0)}finally{n.pop()}}}function HR(e){var t="one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,i){if(dr(r))return wR(n,i,"non-null object");var a=i.length;try{var o="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return dr(o)?(i.push("kind"),wR(n,i,t)):o(r,n,i)}finally{i.length=a}}}function KR(e){var t="typeof one of "+JSON.stringify(Object.getOwnPropertyNames(e));return function(r,n,i){var a=e[typeof r];return dr(a)?wR(n,i,t):a(r,n,i)}}function jR(e){return"number"==typeof e&&e>-1/0&&e<1/0}function qR(e){return(0|e)===e||Math.floor(e)===e}function JR(e,t){return void 0===t&&(t="natural < "+e),UR((function(t){return"number"==typeof t&&t>=0&&t<e&&qR(t)}),t)}var XR=UR(jR,"finite number"),YR=UR((function(e){return jR(e)&&qR(e)}),"integer"),QR=JR(1/0,"natural"),zR=UR((function(e){return"string"==typeof e}),"string"),ZR=UR((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),$R=UR((function(e){return"boolean"==typeof e}),"boolean"),ey=UR((function(e){return Array.isArray(e)}),"Array");function ty(e){return UR((function(t){return t===e}),JSON.stringify(e))}function ry(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var ny=UR((function(e){return"string"==typeof e&&ry(e)}),"formula text"),iy=xR({functionId:QR,functionName:ZR}),ay=xR({errorType:QR,errorName:UR((function(e){return"string"==typeof e&&e.length>1&&"#"===e[0]}),"error name")}),oy={General:!0,Number:!0,Currency:!0,Accounting:!0,Date:!0,Time:!0,Percentage:!0,Fraction:!0,Scientific:!0,Text:!0,Special:!0,Custom:!0,MaxCategory:!1},uy=xR({iformat:QR,category:UR((function(e){return"string"==typeof e&&!0===oy[e]}),"NumberFormatCategory"),decimals:QR}),sy=UR((function(e){return"string"==typeof e||jR(e)}),"string or finite number"),cy=xR({sheetId:sy,sheetName:zR}),ly=JR(1<<20),fy=JR(16384),dy=xR({row:ly,column:fy}),hy=BR(dy,xR({lastRow:VR(ly),lastColumn:VR(fy)})),py=BR(hy,xR({sheetId:sy})),vy=xR({kind:ty("Blank")}),my=xR({kind:ty("Error"),type:QR}),gy=KR({number:XR,string:zR,boolean:$R,object:HR({Blank:vy,Error:my})}),Ey=BR(xR({value:gy,iformat:QR,failureReason:VR(zR)}),HR({CellFormula:xR({formulaBarText:ny}),ArrayFormula:xR({formulaBarText:VR(zR)}),Value:xR({formulaBarText:zR}),Inferred:xR({formulaBarText:VR(zR)})})),Sy=xR({range:py,excludeRows:VR(WR(ly)),excludeColumns:VR(WR(fy)),data:VR(Ey),fromStateId:VR(YR)}),Cy=xR({isSpilled:$R,formulaBarText:ny}),Ty=xR({range:py,data:VR(Cy),fromStateId:VR(YR)}),Ry=xR({sheetId:sy,usedRange:VR(hy)}),yy=KR({number:XR,string:zR,boolean:$R,object:HR({Error:my})}),Iy=xR({kind:ty("NamedValue"),value:yy}),Oy=xR({kind:ty("NamedFormula"),formulaBarText:ny}),Ay=xR({kind:ty("NamedRange"),range:py}),Ny=xR({kind:ty("NamedFailure"),failureReason:zR,objectKind:VR(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,i=e;n<i.length;n++){var a=i[n];r[a]=!0}var o="one of "+JSON.stringify(e);return UR((function(e){return"string"==typeof e&&!0===r[e]}),o)}("NamedValue","NamedFormula","NamedRange","NamedTable"))}),ky=xR({name:zR,data:VR(HR({NamedValue:Iy,NamedFormula:Oy,NamedRange:Ay,NamedFailure:Ny}))}),Fy=xR({scope:VR(sy),objects:VR(ey),fromStateId:VR(YR)}),by=xR({value:VR(gy)}),Dy=xR({value:gy}),Ly=BR(xR({range:py,origin:VR(dy),viewport:VR(py)}),HR({CellFormula:xR({formulaBarText:ny,value:VR(gy)}),Value:xR({formulaBarText:zR,value:gy}),Inferred:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,i){return t.reduce((function(e,t){return e&&t(r)(r,n,i)}),e(r,n,i))}}(xR({formulaBarText:zR}),(function(e){return ry(e.formulaBarText)?by:Dy}))})),My=xR({range:py,formulaBarText:UR((function(e){return"string"==typeof e&&(0===e.length||ry(e))}),"empty string or text denoting formula"),origin:VR(dy),viewport:VR(py)}),_y=((LR={number:!0,string:!0,boolean:!0})[j.Error]=!0,LR[j.Array]=!1,LR[j.Rich]=!1,LR),wy=UR((function(e){var t="object"==typeof e?e.kind:typeof e;return("string"==typeof t||"number"==typeof t)&&!0===_y[t]}),"supported WriteOper"),Uy=function(e){return{kind:"NamedValue",value:e}},Py=function(e){return{kind:"NamedFormula",formulaBarText:e}},Gy=function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}},Vy={namesCount:0,scopes:0,allAvailableScopes:0};var xy=function(){function e(e,t){this.names=e,this.allAvailable=t}return e.create=function(t){return new e(qr.create(t),!1)},e.prototype.update=function(t,r){return t!==this.names||r!==this.allAvailable?new e(t,r):this},e.prototype.getEntry=function(e,t){var r=this.names.getEntry(t);return void 0===r?this.allAvailable?Jt(void 0):Xt({kind:jy.NameLoc,name:ie(e,t)}):Jt(!1!==r.value?r:void 0)},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable)},e.prototype.setUndefined=function(){return this.update(this.names,!0)},e.prototype.getStatistics=function(){return{namesCount:this.names.getCount(),scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.allAvailable?this.update(this.names.filter((function(e,t){return!1!==t})),!0):this},e.prototype.clearCompiledFormulas=function(){this.names.forEach((function(e,t){return!1!==t&&t.compiledFmla.reset(),!0}))},e}(),By=function(){function e(e,t,r){this.scope=t,this.compileFormula=r,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=xy.create(e)}return e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1},e.prototype.getStatistics=function(){return this.contents.getStatistics()},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e){var t=this.contents.getEntry(this.scope,e);return Yt(t)?Jt(void 0!==t.value?ie(this.scope,t.value.key):void 0):t},e.prototype.getNameFormula=function(e){var t=this.contents.getEntry(this.scope,e);return Yt(t)?Jt(void 0!==t.value?t.value.value:void 0):t},e.prototype.clearCompiledFormulas=function(){this.contents.clearCompiledFormulas(),this.oldContents!==this.contents&&this.oldContents.clearCompiledFormulas()},e.prototype.setNamedObject=function(e,t,r){this.contents=void 0===r?this.contents.remove(e):this.contents.setValue(e,this.compileFormula(ie(this.scope,e),t,r)),this.isCurrent=this.isChanged=!0},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e){return!this.isChanged&&e===this.oldStateId&&(this.contents=this.oldContents,this.isCurrent=!0,!0)},e}(),Wy=function(){function e(e,t,r,n,i,a,o,u){void 0===i&&(i={}),void 0===a&&(a=[]),this.document=e,this.compileFormula=t,this.compileNamedFormula=r,this.stringCompareCI=n,this.sheets=i,this.sheetPosToId=a,this.sheetNameToId=void 0===o?qr.create(n):o,this.globalNames=void 0===u?new By(n,re(e),this.compileNamedFormula):u}return e.prototype.cloneServer=function(){var t=d({},this.sheets);for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];void 0!==n&&(t[r]=d(d({},n),{grid:n.grid.cloneServer()}))}return new e(this.document,this.compileFormula,this.compileNamedFormula,this.stringCompareCI,t,this.sheetPosToId,this.sheetNameToId,this.globalNames)},e.prototype.setRecalcFailure=function(e,t){var r=this.getSheetById(e);return r.kind===Gt.Failure?r:Jt(r.value.grid.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getSheetById(e);return r.kind===Gt.Failure?r:Jt(r.value.grid.setRecalcEditTaint(t))},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===Gt.Failure?r:Jt(r.value.grid.setEditedAndRecalcValues(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getSheetById(e.sheet.index);return r.kind===Gt.Failure?r:Jt(r.value.grid.setEditedFormat(e.range,t))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===Gt.Failure?n:Jt(n.value.grid.setHiddenRows(t,r))},e.prototype.setInFilterMode=function(e,t){var r=this.getSheetById(e);return r.kind===Gt.Failure?r:Jt(r.value.grid.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,i,a,o,u,s){var c=this.getSheetById(e);return c.kind===Gt.Failure?c:Jt(c.value.grid.setCellContents(t,r,n,i,a,o,u,s))},e.prototype.setRangeFormula=function(e,t,r,n,i,a){var o=this.getSheetById(e.sheet.index);return o.kind===Gt.Failure?o:Jt(o.value.grid.setRangeFormula(t,e.range,r,n,i,void 0!==a&&bt(e.sheet,a.sheet)?a.range:void 0))},e.prototype.setNamedObject=function(e,t,r,n){var i=this.getNameManager(e.index);return i.kind===Gt.Failure?i:Jt(i.value.setNamedObject(t,r,n))},e.prototype.setUndefinedNames=function(e){var t=this.getNameManager(e.index);return t.kind===Gt.Failure?t:Jt(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNameManager(e.index);return r.kind===Gt.Failure?r:Jt(r.value.promoteNamedObjects(t))},e.prototype.setSheetNames=function(t){for(var r,n=[],i={},a=[],o=0;o<t.length;o+=1){var u=t[o],s=u.sheetName,c=u.sheetId;n[o]=c,a.push([s,c]);var l=this.sheets[c];if(void 0===l){var f=x(this.document,c);i[c]={grid:new MR(f,this.compileFormula),names:new By(this.stringCompareCI,f,this.compileNamedFormula),pos:o,name:s}}else i[c]=d(d({},l),{pos:o})}var h=(r=qr.create(this.stringCompareCI)).setValues.apply(r,a);return new e(this.document,this.compileFormula,this.compileNamedFormula,this.stringCompareCI,i,n,h,this.globalNames)},e.prototype.extendServerUnused=function(e,t){var r=this.getSheetById(e);return r.kind===Gt.Failure?r:Jt(r.value.grid.extendServerUnused(t))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getSheetById(e);return n.kind===Gt.Failure?n:Jt(n.value.grid.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t){var r=this.getNameManager(e);if(r.kind===Gt.Failure)return r;var n=r.value.getNameLoc(t);return n.kind,Gt.Failure,n},e.prototype.getNameFormula=function(e){var t=this.getNameManager(e.scope.index);if(t.kind===Gt.Failure)return t;if(void 0===t.value)return Jt(void 0);var r=t.value.getNameFormula(e.name);return r.kind,Gt.Failure,r},e.prototype.getNameManager=function(e){if(void 0===e)return Jt(this.globalNames);var t=this.getSheetById(e);return t.kind===Gt.Failure?t:Jt(t.value.names)},e.prototype.getEditedFormula=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Gt.Failure?t:Jt(t.value.grid.getEditedFormula(e.range))},e.prototype.getEditedFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Gt.Failure?t:Jt(t.value.grid.getEditedFormat(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getSheetById(e);return t.kind===Gt.Failure?t:t.value.grid.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getSheetById(e);return n.kind===Gt.Failure?n:n.value.grid.getHiddenRows(t,r)},e.prototype.getServerFormat=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Gt.Failure?t:Jt(t.value.grid.getServerFormat(e.range))},e.prototype.getRecalcValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Gt.Failure?t:Jt(t.value.grid.getRecalcValue(e.range))},e.prototype.getServerValue=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Gt.Failure?t:Jt(t.value.grid.getServerValue(e.range))},e.prototype.allServerAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Gt.Failure?t:Jt(t.value.grid.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Gt.Failure?t:Jt(t.value.grid.allEditedAvailable(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Gt.Failure?t:Jt(t.value.grid.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Gt.Failure?t:Jt(t.value.grid.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getSheetById(e.sheet.index);return t.kind===Gt.Failure?t:Jt(t.value.grid.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getSheetById(e);return n.kind===Gt.Failure?n:Jt(n.value.grid.forEachEditedNonBlankCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.getSheetByName(e);return t.kind===Gt.Failure||void 0===t.value?t:Jt(t.value.grid.sheet)},e.prototype.getSheetName=function(e){var t=this.getSheetById(e);return t.kind===Gt.Failure?t:Jt(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getSheetById(e);return t.kind===Gt.Failure?t:Jt(t.value.grid.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){var t=this.getSheetById(e.index);if(!Yt(t))return t;var r=this.getSheetById(e.index2);if(!Yt(r))return r;for(var n=vr(t.value.pos,r.value.pos),i=mr(t.value.pos,r.value.pos),a=[],o=n;o<=i;o+=1){var u=this.sheetPosToId[o];if(void 0===u)return this.unavailableFailure({kind:jy.SheetRange,sheets:e});a.push(u)}return Jt(a)},e.prototype.onCellModified=function(e){this.forEachSheet((function(t){return t.grid.onCellModified(e)}))},e.prototype.collectGarbage=function(e){this.forEachSheet((function(t){t.grid.collectGarbage(e),t.names.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheet((function(t){t.grid.advanceState(e),t.names.advanceState(e)})),this.globalNames.advanceState(e)},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e){e.grid.clearCompiledFormulas(),e.names.clearCompiledFormulas()})),this.globalNames.clearCompiledFormulas()},e.prototype.getGridStatistics=function(){var e=bR;return this.forEachSheet((function(t){return r=e,n=t.grid.getStatistics(),e={serverFormulaeNodeCount:r.serverFormulaeNodeCount+n.serverFormulaeNodeCount,serverFormatsNodeCount:r.serverFormatsNodeCount+n.serverFormatsNodeCount,serverValuesNodeCount:r.serverValuesNodeCount+n.serverValuesNodeCount,editedFormulaeNodeCount:r.editedFormulaeNodeCount+n.editedFormulaeNodeCount,editedFormatsNodeCount:r.editedFormatsNodeCount+n.editedFormatsNodeCount,editedValuesNodeCount:r.editedValuesNodeCount+n.editedValuesNodeCount,recalcValuesNodeCount:r.recalcValuesNodeCount+n.recalcValuesNodeCount,recalcFailuresSetSubspaceCount:r.recalcFailuresSetSubspaceCount+n.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:r.recalcTaintSetSubspaceCount+n.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:r.availabilitySetSubspaceCount+n.availabilitySetSubspaceCount,availabilityHistorySize:r.availabilityHistorySize+n.availabilityHistorySize,hiddenRowsNodeCount:r.hiddenRowsNodeCount+n.hiddenRowsNodeCount};var r,n})),e},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheet((function(t){return r=e,n=t.names.getStatistics(),e={namesCount:r.namesCount+n.namesCount,scopes:r.scopes+n.scopes,allAvailableScopes:r.allAvailableScopes+n.allAvailableScopes};var r,n})),e},e.prototype.getAvailableCells=function(){var e=[];for(var t in this.sheets){var r=this.sheets[t];if(void 0!==r){var n=x(this.document,parseInt(t,10));e.push({sheetIdx:n,availableCells:r.grid.getServerAvailability()})}}return e},e.prototype.forEachSheet=function(e){for(var t in this.sheets){if(this.sheets.hasOwnProperty(t))e(this.sheets[t])}},e.prototype.getSheetById=function(e){var t=this.sheets[e];return void 0!==t?Jt(t):this.unavailableFailure({kind:jy.SheetId,document:this.document,sheetId:e})},e.prototype.getSheetByName=function(e){var t=this.sheetNameToId.getValue(e);return void 0===t?Jt(void 0):this.getSheetById(t)},e.prototype.unavailableFailure=function(e){return Xt(e)},e}(),Hy=H(0,0);function Ky(e,t){var r=[],n=br(Fr((function(){})),(function(){}),{vArray:function(e){e.nodes.forEach((function(e){return e.forEach((function(e){return kr(e,n)}))}))},vApp:function(t){if(t.head.kind===Ne.Operator)r.push(function(e){if(e===ot.Isect)return" ";if(e===ot.Union)return",";var t=st[e];return void 0===t?"op:"+e:t}(t.head.id));else if(t.head.kind===Ne.Name){var i=e.getWorksheetFuncId(t.head.whole);null!=i&&r.push(vn(i))}for(var a=0,o=t.args;a<o.length;a++){kr(o[a],n)}},vParen:function(e){kr(e.node,n)}});return kr(t.node,n),r}var jy,qy=oe([],[],J.None,Q.Exact),Jy=function(){function e(e,t,r,n,i,a,o,u,s){this.refStyle=t,this.onNameFailure=r,this.onRangeFailure=n,this.onUnavailableObject=i,this.onSetCellValue=a,this.onSetCellValues=o,this.schedulerInfo=u,this.maxDereferenceCells=s,this.iformats=[],this.worksheetFuncOverrides={},this.mathpack=Al,this.interruptToken=[sf.Continue],this.setDynamicPrecs=function(){},this.loadObjects=function(){return!1},this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.setLocaleInfo(e)}return e.prototype.reconfigure=function(e,t){this.schedulerInfo=e,this.maxDereferenceCells=t},e.prototype.setLocaleInfo=function(e){this.stringCompareCI=e.stringCompareCI,this.config=Qr(e),this.parser=cs(this),this.analyzer=hl(this),this.compiler=id(this),this.evaluator=Bp(this)},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.stringCompareCI(t,r.name)?G(e,t):r},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getNameLoc=function(e,t){var r=this.getDocument(e.document);if(r.kind===Gt.Failure)return Xt(Qy([r.reason]));var n=r.value.getNameLoc(e.index,t);return n.kind===Gt.Failure?Xt(Qy([n.reason])):n},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===Gt.Failure)return Xt(Qy([t.reason]));if(!t.value)return Xt(Qy([{kind:jy.GridRange,range:e}]));var r=this.getEditedFormat(e);if(r.kind===Gt.Failure)return Xt(Qy([r.reason]));var n=this.resolveIformat(r.value);return void 0===n.category||void 0===n.decimals?Xt(Qy([{kind:jy.NumberFormat,iformat:n.iformat}])):Jt({iformat:n.iformat,category:n.category,decimals:n.decimals})},e.prototype.getNameFormula=function(e){var t=this.getDocument(e.scope.document);if(t.kind===Gt.Failure)return Xt(Qy([t.reason]));var r=t.value.getNameFormula(e);if(r.kind===Gt.Failure)return Xt(Qy([r.reason]));var n=void 0===r.value?void 0:r.value.compiledFmla.getValue();return void 0===n?Jt(void 0):Yt(n)?n:Xt(function(e){return{kind:af.PreviousNameFailure,name:e}}(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);return t.kind===Gt.Failure?Xt(Qy([t.reason])):void 0===t.value||void 0===t.value[1].compiledFmla?Jt(void 0):t.value[1].compiledFmla.getValue()},e.prototype.getKnownFormat=function(e){var t=this.iformats[e];return void 0===t?Xt(Qy([{kind:jy.NumberFormat,iformat:e}])):Jt({iformat:e,category:t.category,decimals:t.decimals})},e.prototype.setCellValue=function(e,t,r){var n=Ar(Sr["OfficeVSO:3913458_CalcCGChangeDetection"])?this.hasRecalcValueChanged(e,t):Jt(!0);if(n.kind===Gt.Failure)return this.onUnavailableObject(n.reason);var i=this.setEditedAndRecalcValues(e,t);if(i.kind===Gt.Failure)return this.onUnavailableObject(i.reason);var a=this.propagateEditTaint(e,r);if(a.kind===Gt.Failure)return this.onUnavailableObject(a.reason);this.onSetCellValue(e,t,r,a.value,this.evalParams,n.value)},e.prototype.setCellValues=function(e,t,r){var n=this.setEditedAndRecalcValues(e,t);if(n.kind===Gt.Failure)return this.onUnavailableObject(n.reason);var i=this.propagateEditTaint(e,r);if(i.kind===Gt.Failure)return this.onUnavailableObject(i.reason);this.onSetCellValues(e,t,r,i.value,this.evalParams)},e.prototype.getFirstOrderFunc=function(e){if("number"==typeof e){if(0!=(Tt(e).staticPrecs&(J.Time|J.Calc)))return Xt(Qy([{kind:jy.VolatileFunction,name:vn(e)}]));if(void 0!==this.worksheetFuncOverrides[e])return Jt(this.worksheetFuncOverrides[e]);var t=sE(e);return null!=t?Jt(t):Xt(Qt([vn(e)]))}return Xt(Qt(["UDF "+R(e)]))},e.prototype.getSheetRangeIndexes=function(e){var t=this.getSheetRangeIds(e);return t.kind===Gt.Failure?Xt(Qy([t.reason])):Jt(t.value)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,_T(e.range));if(n.kind===Gt.Failure)return this.onUnavailableObject(n.reason);var i=this.setEditedAndRecalcValues(e,be);if(i.kind===Gt.Failure)return this.onUnavailableObject(i.reason);var a=this.propagateEditTaint(e,r);if(a.kind===Gt.Failure)return this.onUnavailableObject(a.reason);this.onRangeFailure(e,t,r,a.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===Gt.Failure?Xt(Qy([t.reason])):t},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===Gt.Failure)return Xt(Qy([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===Gt.Failure?Xt(Qy([n.reason])):void 0===n.value?n:Jt(n.value.index)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===Gt.Failure)return Xt(Qy([n.reason]));var i=n.value.getHiddenRows(e.index,t,r);return i.kind===Gt.Failure?Xt(Qy([i.reason])):i},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===Gt.Failure)return Xt(Qy([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===Gt.Failure?Xt(Qy([r.reason])):r},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var i=t();return Array.isArray(i)?i:Tf((function(){return r.withEvalParams(e,i.resume)}))}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t){var r=this;return this.withEvalParams({computeKind:e,computeCell:t},(function(){return r.evaluator.evalCells([t])}))},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===Gt.Failure?r:(this.document=r.value.setSheetNames(t),Jt(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e)},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e)},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Gt.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,i=e.document,a=this.getDocument(i);return a.kind===Gt.Failure?a:a.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():bR},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():Vy},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e)},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Gt.Failure?t:t.value.getEditedFormula(e)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Gt.Failure?t:t.value.getEditedFormat(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Gt.Failure?t:t.value.getServerFormat(e)},e.prototype.getRecalcValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Gt.Failure?t:t.value.getRecalcValue(e)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Gt.Failure?t:t.value.getServerValue(e)},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,i=this.getDocument(r.document);return i.kind===Gt.Failure?i:i.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===Gt.Failure?r:r.value.extendServerUnused(e.index,t)},e.prototype.setCellContents=function(e,t,r,n,i,a,o,u){var s=e.sheet,c=e.set,l=this.getDocument(s.document);return l.kind===Gt.Failure?l:l.value.setCellContents(s.index,t,c,r,n,i,a,o,u)},e.prototype.setRangeFormula=function(e,t,r,n,i,a){var o=this.getDocument(e.sheet.document);return o.kind===Gt.Failure?o:o.value.setRangeFormula(e,t,r,n,i,a)},e.prototype.setNamedObject=function(e,t,r,n){var i=this.getDocument(e.document);return i.kind===Gt.Failure?i:i.value.setNamedObject(e,t,r,n)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===Gt.Failure?t:t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===Gt.Failure?r:r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[]),e.forEach((function(e){r.iformats[e.iformat]=e}))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===Gt.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===Gt.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveIformat=function(e){if(e.isExact&&(void 0===e.category||void 0===e.decimals)){var t=this.iformats[e.iformat];void 0!==t&&(e.category=t.category,e.decimals=t.decimals)}return e},e.prototype.inferCellFormat=function(e){var t=this.getEditedFormat(e);if(t.kind===Gt.Failure)return t;if("General"!==this.resolveIformat(t.value).category)return Jt(void 0);var r=this.getEditedFormula(e);if(r.kind===Gt.Failure)return r;if(void 0===r.value||void 0===r.value[1].compiledFmla)return Jt(void 0);var n=r.value,i=n[0],a=n[1],o=a.source,u=a.fmla,s=ee(e.sheet,i),c=this.parser.parseFormula(this.refStyle,s.range,o,u),l=this.checkFormula(s,o,c,"infer-format-cell");if(l.kind!==Gt.Success)return Jt(void 0);var f=l.value,d=this.analyzer.findBestFormat(te(e.sheet,e.range),f);if(!Yt(d))return Jt(void 0);var h=d.value,p=h.category,v=h.iformat,m=h.decimals,g=this.iformats[v],E=void 0!==g&&p===g.category&&m===g.decimals;return this.setEditedFormat(e,{isExact:E,iformat:v,category:p,decimals:m})},e.prototype.anonymizeFormula=function(e,t,r){var n=this.parser.parseFormula(this.refStyle,e,t,r);return n.kind!==Gt.Success?[R(r),[]]:[R(n.value),Ky(this.config.localeInfo,n.value)]},e.prototype.compileFmla=function(e,t,r,n){var i=this;return{fmla:n,source:r,compiledFmla:new EE((function(){var a=i.parser.parseFormula(i.refStyle,e.range,r,n),o=i.checkFormula(e,r,a,t?"server-cell-formula":"edit-cell-formula"),u=i.compileFormula(e,r,o);if(Yt(u))return u;var s=Xt(Qy([{kind:jy.CellFormula,reason:u.reason}]));return i.setCellFailure(e,u.reason,qy),s}))}},e.prototype.compileFormula=function(e,t,r){if(r.kind!==Gt.Success)return r;var n=this.compiler.compileFormula(e,t,r.value);return n.kind!==Gt.Success?n:Jt(hf(e,t,n.value))},e.prototype.compileNamedObject=function(e,t,r){var n=this,i=t?"server-named-formula":"edit-named-formula";switch(r.kind){case"NamedFormula":return{obj:r,compiledFmla:new EE((function(){var t=r.formulaBarText,a=n.parser.parseFormula(n.refStyle,Hy,y.NameManager,t),o=n.checkFormula(void 0,y.NameManager,a,i),u=n.compileNamedFormula(o);return Yt(u)?u:(n.onNameFailure(e,u.reason,n.evalParams),Xt(void 0))}))};case"NamedValue":return{obj:r,compiledFmla:new EE((function(){var t;if("object"==typeof r.value&&r.value.kind===j.Range){L("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",yt(r.value.sheets)&&1===r.value.ranges.length);var a=r.value.sheets,o=n.getDocument(a.document);if(!Yt(o))return n.onUnavailableObject(o.reason),Xt(void 0);var u=o.value.getSheetName(a.index);if(!Yt(u))return n.onUnavailableObject(u.reason),Xt(void 0);var s=r.value.ranges[0];t=Je(nt(Ke(He(Ve(Oe.Abs,s.row),Ve(Oe.Abs,s.col)),He(Ve(Oe.Abs,s.row+s.rows-1),Ve(Oe.Abs,s.col+s.cols-1))),Ue(u.value,we(a.document.name,a.document.path))),[])}else t=Je(ze(r.value,!0),[]);var c=n.checkFormula(void 0,y.NameManager,Jt(t),i),l=n.compileNamedFormula(c);return Yt(l)?l:(n.onNameFailure(e,l.reason,n.evalParams),Xt(void 0))}))};case"NamedFailure":return{obj:r,compiledFmla:new EE((function(){var t=Qy([{kind:jy.ClientFailure,reason:r.failureReason}]);return n.onNameFailure(e,t,n.evalParams),Xt(void 0)}))};default:return b("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},e.prototype.compileNamedFormula=function(e){return e.kind!==Gt.Success?e:this.compiler.compileFormula(void 0,y.NameManager,e.value)},e.prototype.checkFormula=function(e,t,r,n){if(!Yt(r))return r;var i=this.analyzer.checkFormula(e,t,r.value,n);return It(i)?Jt(i):Xt(lf("calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+R(r.value)))},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&Ft(this.documentLoc,e)?Jt(this.document):this.unavailableFailure({kind:jy.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new Wy(e,this.compileFmla.bind(this),this.compileNamedObject.bind(this),this.stringCompareCI)),this.getDocument(e)},e.prototype.unavailableFailure=function(e){return Xt(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=new Array(e.rows);return kt(e,(function(i,a,o){var u=r.tryGetCellValue(i,t);return void 0!==u&&((void 0!==n[a]?n[a]:n[a]=new Array(e.cols))[o]=u,!0)}))?n:void 0},e.prototype.tryGetCellValue=function(e,t){var r=te(t,e),n=this.getRecalcValue(r);if(n.kind!==Gt.Failure){var i=n.value,a=i.oper,o=i.clientFailure;if(i.calcState!==TR.Calced){if(void 0!==o){var u={kind:jy.ClientFailure,reason:o};return void this.setCellFailure(r,Qy([u]),qy)}var s=this.getEditedFormula(r);if(s.kind===Gt.Failure)return void this.onUnavailableObject(s.reason);if(void 0===s.value)return void this.setCellFailure(r,Qy([{kind:jy.CellMissingFormula}]),qy);var c=s.value,l=c[0],f=c[1];return void 0===f.compiledFmla?void this.onUnavailableObject({kind:jy.CellEvaluatingValue}):f.compiledFmla.getValue().kind===Gt.Success?df(te(t,Mt(l))):void 0}return ff(a)}this.onUnavailableObject(n.reason)},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===Gt.Failure)return Xt(Qy([n.reason]));if(!n.value)return Xt(Qy([{kind:jy.GridRange,range:r}]));var i=t.hasRecalcFailure(r);if(i.kind===Gt.Failure)return Xt(Qy([i.reason]));if(i.value)return Xt(Sf(r));if(Wf(r.range)>t.maxDereferenceCells)return Xt(Qy([{kind:jy.GridRangeSize,range:r}]));var a=e(r.range,r.sheet);return void 0===a?Xt(Sf(r)):Jt(a)}},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===Gt.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===Gt.Failure||void 0===r.value?r:Jt(ee(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===Gt.Failure?t:t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Gt.Failure?t:t.value.allEditedAvailable(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Gt.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Gt.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===Gt.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===Gt.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===Gt.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.hasRecalcValueChanged=function(e,t){var r=this.hasRecalcFailure(e);if(r.kind===Gt.Failure||r.value)return r;var n=this.getRecalcValue(e);return n.kind===Gt.Failure?n:Jt(void 0!==n.value.clientFailure||!qt(n.value.oper,t,!1))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===Gt.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===Gt.Failure)return r;if(r.value)return Jt(KT.EditedCell);for(var n=0,i=t.cells;n<i.length;n++){var a=i[n],o=this.hasRecalcEditTaint(a);if(o.kind===Gt.Failure)return o;if(o.value){var u=this.setRecalcEditTaint(e.sheet,_T(e.range));return u.kind===Gt.Failure?u:Jt(KT.DependentCell)}}return t.bound===Q.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===HT.EditedCell?Jt(KT.IndependentCell):Jt(KT.UnknownNonEditedCell)},e.prototype.setEditedAndRecalcValues=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===Gt.Failure?r:r.value.setEditedAndRecalcValues(e,t)},e}(),Xy=function(e,t){return(e<<t|e>>>32-t)>>>0},Yy=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-Xy(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^Xy(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}();!function(e){e.DocumentLoc="DocumentLoc",e.SheetRange="SheetRange",e.SheetId="SheetId",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.HiddenRows="HiddenRows",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.PrecisionIncorrect="PrecisionIncorrect",e.PrecisionUnknown="PrecisionUnknown"}(jy||(jy={}));var Qy=nf,zy=function(){function e(e,t,r){var n=this;void 0===r&&(r={}),this.queue=new iR,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.docs=new Jy(e,t,this.onNameFailure.bind(this),this.onRangeFailure.bind(this),this.logUnavailableObject.bind(this),this.onSetCellValue.bind(this),this.onSetCellValues.bind(this),r,void 0!==r.maxDereferenceCells?r.maxDereferenceCells:32768),this.reconfigure(r),this.queue.onInvalidateMessage=function(e){if(e.kind===$T.ContinueComputation||e.kind===$T.PrecisionContinueComputation){var t=e.message.computeMsg;t.stateId>=n.stateId&&n.queue.isMessageValid(t)&&n.queue.push(t.kind,t.stateId,t.message)}}}return e.prototype.reconfigure=function(e){this.config=e,this.rng=new Yy(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,void 0!==e.maxDereferenceCells?e.maxDereferenceCells:32768)},e.prototype.onNameFailure=function(e,t,r){r.computeKind!==HT.PrecisionTest&&this.outputMessageLog.push({kind:tR.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,i){var a=i,o=a.computeKind,u=a.computeCell;if(o!==HT.PrecisionTest)this.outputMessageLog.push({kind:tR.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t});else if(bt(e.sheet,u.sheet)&&gR(e.range,u.range)){var s={samples:[],failures:[t]};this.outputMessageLog.push({kind:tR.PrecisionStatistics,stateId:this.stateId,stats:s})}},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.logUnavailableObject=function(e){var t=Qy([e]);this.outputMessageLog.push({kind:tR.UnhandledFailure,stateId:this.stateId,reason:t})},e.prototype.onSetCellValue=function(e,t,r,n,i,a){var o=i,u=o.computeKind,s=o.computeCell;if(u===HT.PrecisionTest)return this.setPrecisionResult(s,e,t,r);var c=void 0,l=this.docs.getEditedFormat(e);if(l.kind===Gt.Failure)return this.logUnavailableObject(l.reason);var f=this.docs.getServerFormat(e);if(f.kind===Gt.Failure)return this.logUnavailableObject(f.reason);if(l.value!==f.value&&(c=this.docs.resolveIformat(l.value)),!Ar(Sr["OfficeVSO:3913458_CalcCGChangeDetection"])){var d=this.docs.allServerAvailable(e);if(d.kind===Gt.Failure)return this.logUnavailableObject(d.reason);var h=void 0;if(d.value){var p=this.docs.getServerValue(e);if(p.kind===Gt.Failure)return this.logUnavailableObject(p.reason);h=p.value}a=void 0===h||!qt(h,t,!0)}a||void 0!==c?(this.outputMessageLog.push({kind:tR.RecalcStatistics,message:JT.ChangedCell,stateId:this.stateId,cellKind:n}),n!==KT.EditedCell&&n!==KT.DependentCell||this.outputMessageLog.push({kind:tR.CellWrite,stateId:this.stateId,cellKind:n,cell:e,value:t,format:c})):this.outputMessageLog.push({kind:tR.RecalcStatistics,message:JT.UnchangedCell,stateId:this.stateId,cellKind:n})},e.prototype.onSetCellValues=function(e,t,r,n,i){var a=this,o=i,u=o.computeKind,s=o.computeCell;u!==HT.PrecisionTest?n!==KT.EditedCell&&n!==KT.DependentCell||this.outputMessageLog.push({kind:tR.RangeWrite,stateId:this.stateId,cellKind:n,range:e,values:t}):kt(e.range,(function(n,i,o){return a.setPrecisionResult(s,te(e.sheet,n),t[i][o],r),!0}))},e.prototype.setPrecisionResult=function(e,t,r,n){var i=this.docs.allServerAvailable(t);if(i.kind===Gt.Failure)return this.logUnavailableObject(i.reason);if(Lt(e,t)){var a=this.docs.getEditedFormula(t);if(a.kind===Gt.Failure)return this.logUnavailableObject(a.reason);if(void 0===a.value)return this.logUnavailableObject({kind:jy.CellMissingFormula});var o=a.value,u=o[0],s=o[1],c=s.source,l=s.fmla;if(!i.value)return this.logUnavailableObject({kind:jy.GridRange,range:t});var f=this.docs.getServerValue(t);if(f.kind===Gt.Failure)return this.logUnavailableObject(f.reason);var d={samples:[this.precisionResult(r,f.value,u,c,l)],failures:[]};this.outputMessageLog.push({kind:tR.PrecisionStatistics,stateId:this.stateId,stats:d})}else if(i.value){var h=this.docs.getServerValue(t);if(h.kind===Gt.Failure)return this.logUnavailableObject(h.reason);qt(r,h.value,!0)||this.docs.setCellFailure(t,Qy([{kind:jy.PrecisionIncorrect}]),n)}else this.docs.setCellFailure(t,Qy([{kind:jy.PrecisionUnknown}]),n)},e.prototype.precisionResult=function(e,t,r,n,i){var a=ZT(t),o=this.docs.anonymizeFormula(r,n,i),u=o[0],s=o[1];if(qt(e,t,!0))return{expected:a,formula:u,functions:s};var c=ZT(e);return"number"==typeof t&&"number"==typeof e?{expected:a,sampled:c,relMagnitude:zT(0===t?e:(e-t)/t),formula:u,functions:s}:{expected:a,sampled:c,formula:u,functions:s}},e.prototype.handleSetCellContents=function(e,t){var r=this,n=t.cells,i=t.isFormula,a=t.fmla,o=t.value,u=t.format,s=t.clientFailure,c=t.viewport,l=void 0!==s,f=!l&&(void 0!==i?i:void 0!==a&&ry(a)),d=Ar(Sr["OfficeVSO:3913458_CalcCGChangeDetection"])&&!e&&f?be:o,h=l||f||void 0===a?TR.Dirty:TR.Calced,p=this.docs.setCellContents(n,e,d,u,h,a,f,s);if(p.kind===Gt.Failure)return this.logUnavailableObject(p.reason);if(this.docs.onCellModified(e),e)(f||void 0===a)&&WT(n.set,(function(e){return r.shouldSample(r.config.samplePrecisionRate)&&r.computeCellValue(te(n.sheet,e),HT.PrecisionTest),!0}));else{f&&WT(n.set,(function(e){var t=te(n.sheet,e),i=r.docs.inferCellFormat(t);return i.kind===Gt.Failure&&r.logUnavailableObject(i.reason),r.computeCellValue(t,HT.EditedCell),!0}));var v=this.scheduleDependents(n,c);if(v.kind===Gt.Failure)return this.logUnavailableObject(v.reason);this.computeFinished()}},e.prototype.handleSetRangeFormula=function(e,t){var r=t.range,n=t.fmla,i=t.viewport,a=ry(n);L("calc.calc.PartialWorkbook: handleSetRangeFormula",""===n&&!e||a);var o=a?TR.Dirty:TR.Calced,u=this.docs.setRangeFormula(r,e,o,n,a,i);if(u.kind===Gt.Failure)return this.logUnavailableObject(u.reason);if(this.docs.onCellModified(e),!e){a&&this.computeCellValue(d(d({},r),{range:Mt(r.range)}),HT.EditedCell);var s={sheet:r.sheet,set:_T(r.range)},c=this.scheduleDependents(s,i);if(c.kind===Gt.Failure)return this.logUnavailableObject(c.reason);this.computeFinished()}},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerInfo.totalTimeMs;if(void 0===t)return e();var r,n=Cr();try{r=e()}finally{this.stateEvalTime+=mr(1,Cr()-n),this.stateEvalTime>=t&&(this.queue.invalidate($T.ComputeCellValue),this.queue.invalidate($T.PrecisionComputeCellValue),this.queue.invalidate($T.ContinueComputation),this.queue.invalidate($T.PrecisionContinueComputation),this.outputMessageLog.push({kind:tR.RecalcStatistics,stateId:this.stateId,message:JT.StateTimedOut}),r=[])}return r},e.prototype.handleComputeCellValue=function(e){var t,r,n,i=this,a=e.kind,o=e.kindId,u=e.stateId,s=e.message;if(s.finished)return null===(t=s.stopwatch)||void 0===t||t.stop(),void this.outputMessageLog.push({kind:tR.RecalcStatistics,message:JT.EditFinished,stateId:this.stateId});var c=this.shouldSample(this.config.sampleCellEvalStopwatchRate)?Rr("calc.calc.PartialWorkbook: cell eval"):void 0,l={kind:a,kindId:o,stateId:u,message:s},f=s.cell;a===$T.PrecisionComputeCellValue&&this.docs.onCellModified(!0);var d=this.docs.getRecalcValue(f);if(d.kind===Gt.Failure)return this.logUnavailableObject(d.reason);if(d.value.calcState!==TR.Calced){var h=this.docs.getEditedFormula(f);if(h.kind===Gt.Failure)return this.logUnavailableObject(h.reason);if(void 0!==h.value){var p=this.withEvalTiming((function(){return i.docs.evaluate(s.computeKind,f)}));if(Array.isArray(p))return null===(r=c)||void 0===r||r.stop(),void(null===(n=s.stopwatch)||void 0===n||n.stop());this.continueComputation(p.resume,l,c)}}},e.prototype.handleContinueComputation=function(e){var t,r,n=e.message,i=n.resume,a=n.computeMsg,o=n.stopwatch,u=a.message;this.outputMessageLog.push({kind:tR.RecalcStatistics,stateId:this.stateId,message:JT.ContinueComputation});var s=this.withEvalTiming(i);if(Array.isArray(s))return null===(t=o)||void 0===t||t.stop(),void(null===(r=u.stopwatch)||void 0===r||r.stop());this.continueComputation(s.resume,a,o)},e.prototype.handlePromoteCellContents=function(e){var t=e.cells,r=e.range,n=e.fromStateId,i=this.docs.promoteServerAvailability(t,n);if(i.kind===Gt.Failure)return this.logUnavailableObject(i.reason);this.docs.onCellModified(!0),i.value||this.outputMessageLog.push({kind:tR.UpdateRequest,stateId:this.stateId,range:r})},e.prototype.setCellContents=function(e,t,r,n,i,a,o,u,s){this.queue.enqueue(e,t,{kind:eR.SetCellContents,cells:r,isFormula:n,fmla:i,value:a,format:o,clientFailure:u,viewport:s})},e.prototype.writeCellContents=function(e,t,r,n,i,a,o){void 0===a&&(a=0);var u=RR(!0,a);this.setCellContents($T.ServerUpdate,e,t,i,r,n,u,o,void 0)},e.prototype.editCellContents=function(e,t,r,n,i,a,o){void 0===n&&(n=be),void 0===a&&(a=Mt(t.range));var u=d(d({},t),{set:_T(t.range)});this.setCellContents($T.ClientEdit,e,u,i,r,n,void 0,void 0,o)},e.prototype.setArrayFormula=function(e,t,r,n,i){this.queue.enqueue(e,t,{kind:eR.SetRangeFormula,range:r,fmla:n,viewport:i})},e.prototype.writeArrayFormula=function(e,t,r,n){void 0===n&&(n=!1),this.setArrayFormula($T.ServerUpdate,e,t,r,void 0)},e.prototype.editArrayFormula=function(e,t,r,n){this.setArrayFormula($T.ClientEdit,e,t,r,n)},e.prototype.promoteCellContents=function(e,t,r,n){this.queue.enqueue($T.ServerUpdate,e,{kind:eR.PromoteCellContents,cells:r,fromStateId:n,range:t})},e.prototype.computeCellValue=function(e,t){var r=t===HT.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?Rr("calc.calc.PartialWorkbook: recalc edited"):void 0;this.queue.enqueue(t===HT.PrecisionTest?$T.PrecisionComputeCellValue:$T.ComputeCellValue,this.stateId,{finished:!1,cell:e,computeKind:t,stopwatch:r})},e.prototype.continueComputation=function(e,t,r){this.queue.enqueue(t.kind===$T.PrecisionComputeCellValue?$T.PrecisionContinueComputation:$T.ContinueComputation,this.stateId,{resume:e,computeMsg:t,stopwatch:r})},e.prototype.computeFinished=function(){var e=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?Rr("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.queue.enqueue($T.ComputeCellValue,this.stateId,{finished:!0,stopwatch:e})},e.prototype.testAdvanceState=function(e){this.queue.enqueue($T.TestAdvanceState,e,{})},e.prototype.step=function(){var e=this.queue.pop();if(void 0===e)return{queueEmpty:!0,messages:[]};this.trySetStateId(e)&&this.handleMessage(e);var t=this.queue.peek();e.kind>=$T.ClientEdit&&e.kind<$T.MaybeCollectGarbage&&(void 0===t||t.kind>=$T.MaybeCollectGarbage)&&this.outputMessageLog.push({kind:tR.RecalcStatistics,message:JT.RecalcFinished,stateId:this.stateId});var r=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:0===this.queue.getCountUpperBound(),messages:r}},e.prototype.trySetStateId=function(e){var t=this;if(e.kind===$T.MaybeCollectGarbage)return!0;if(e.kind===$T.RunExperiment)return!0;if(e.stateId<this.stateId)return!1;if(e.kind===$T.ClientEdit&&(this.queue.invalidate($T.ContinueComputation),this.queue.invalidate($T.PrecisionContinueComputation),this.queue.invalidate($T.PrecisionComputeCellValue),this.stateEvalTime=0),e.stateId>this.stateId){if(this.stateId!==-1/0&&this.shouldSample(this.config.sampleStatisticsRate)&&this.outputMessageLog.push({kind:tR.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics()}),2===this.stateChanges&&void 0!==this.config.experimentDefinitions){var r=this.config.experimentDefinitions;this.docs.forEachDocument((function(e){for(var n=e.cloneServer(),i=0,a=r.experiments;i<a.length;i++){var o=a[i];o.setContext(n),t.queue.enqueueRunExperimentMessage({budget:r.budget,experiment:o})}}))}var n=this.stateId;this.stateId=e.stateId,this.docs.advanceState(n),this.outputMessageLog.push({kind:tR.StateAdvanced,stateId:this.stateId}),this.queue.invalidate($T.ComputeCellValue),this.queue.invalidate($T.PrecisionComputeCellValue),this.queue.invalidate($T.ContinueComputation),this.queue.invalidate($T.PrecisionContinueComputation),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.queue.enqueue($T.MaybeCollectGarbage,this.stateId,{})}return!0},e.prototype.handleMessage=function(e){switch(e.kind){case $T.ServerUpdate:case $T.ClientEdit:switch(e.message.kind){case eR.SetCellContents:return this.handleSetCellContents(e.kind===$T.ServerUpdate,e.message);case eR.SetRangeFormula:return this.handleSetRangeFormula(e.kind===$T.ServerUpdate,e.message);case eR.PromoteCellContents:return this.handlePromoteCellContents(e.message);case eR.SetRefStyle:return this.handleSetRefStyle(e.message.refStyle);case eR.SetSheetNames:return this.handleSetSheetNames(e.message.document,e.message.sheetNames);case eR.SetLocaleInfo:return this.handleSetLocaleInfo(e.message.localeInfo);case eR.SetNumberFormats:return this.handleSetNumberFormats(e.message.numberFormats,e.message.merge);case eR.ExtendUnusedRange:return this.handleExtendUnusedRange(e.message.range);case eR.WriteNamedObject:return this.handleWriteNamedObject(e.message.scope,e.message.name,e.message.obj);case eR.WriteUndefinedNames:return this.handleWriteUndefinedNames(e.message.scope);case eR.PromoteNamedObjects:return this.handlePromoteNamedObjects(e.message.scope,e.message.fromStateId);case eR.WriteHiddenRows:return this.handleWriteHiddenRows(e.message.rows);case eR.WriteInFilterMode:return this.handleWriteInFilterMode(e.message.mode);default:return b("calc.calc.partialWorkbook.handleMessage",e.message)}case $T.ContinueComputation:return this.handleContinueComputation(e);case $T.ComputeCellValue:return this.handleComputeCellValue(e);case $T.MaybeCollectGarbage:return this.maybeCollectGarbage();case $T.PrecisionContinueComputation:return this.handleContinueComputation(e);case $T.PrecisionComputeCellValue:return this.handleComputeCellValue(e);case $T.RunExperiment:return this.handleRunExperiment(e.message);case $T.TestAdvanceState:return;default:return b("calc.calc.partialWorkbook.handleMessage",e)}},e.prototype.setSheetNames=function(e,t,r){this.queue.enqueue($T.ServerUpdate,r,{kind:eR.SetSheetNames,document:e,sheetNames:t})},e.prototype.handleRunExperiment=function(e){if(e.experiment.done)this.outputMessageLog.push({kind:tR.ExperimentRunResult,logMessage:e.experiment.resultLogMessage});else{var t=Cr();e.experiment.step(),Cr()-t<e.budget&&this.queue.pushRunExperimentMessage(e)}},e.prototype.handleSetSheetNames=function(e,t){var r=this.docs.setSheetNames(e,t);r.kind===Gt.Failure&&this.logUnavailableObject(r.reason),this.queue.invalidate($T.ComputeCellValue),this.queue.invalidate($T.PrecisionComputeCellValue),this.queue.invalidate($T.ContinueComputation),this.queue.invalidate($T.PrecisionContinueComputation)},e.prototype.clearCompiledFormulas=function(){this.docs.clearCompiledFormulas(),this.queue.invalidate($T.ComputeCellValue),this.queue.invalidate($T.PrecisionComputeCellValue),this.queue.invalidate($T.ContinueComputation),this.queue.invalidate($T.PrecisionContinueComputation)},e.prototype.setRefStyle=function(e,t){this.queue.enqueue($T.ServerUpdate,t,{kind:eR.SetRefStyle,refStyle:e})},e.prototype.handleSetRefStyle=function(e){this.docs.refStyle!==e&&(this.docs.refStyle=e,this.clearCompiledFormulas())},e.prototype.setLocaleInfo=function(e,t){this.queue.enqueue($T.ServerUpdate,t,{kind:eR.SetLocaleInfo,localeInfo:e})},e.prototype.handleSetLocaleInfo=function(e){this.docs.setLocaleInfo(e),this.clearCompiledFormulas()},e.prototype.setNumberFormats=function(e,t,r){this.queue.enqueue($T.ServerUpdate,r,{kind:eR.SetNumberFormats,numberFormats:e,merge:t})},e.prototype.handleSetNumberFormats=function(e,t){this.docs.setNumberFormats(e,t)},e.prototype.writeNamedObject=function(e,t,r,n){this.queue.enqueue($T.ServerUpdate,e,{kind:eR.WriteNamedObject,scope:t,name:r,obj:n})},e.prototype.handleWriteNamedObject=function(e,t,r){var n=this.docs.setNamedObject(e,t,!0,r);if(n.kind===Gt.Failure)return this.logUnavailableObject(n.reason)},e.prototype.writeUndefinedNames=function(e,t){this.queue.enqueue($T.ServerUpdate,e,{kind:eR.WriteUndefinedNames,scope:t})},e.prototype.handleWriteUndefinedNames=function(e){var t=this.docs.setUndefinedNames(e);if(t.kind===Gt.Failure)return this.logUnavailableObject(t.reason)},e.prototype.promoteNamedObjects=function(e,t,r){this.queue.enqueue($T.ServerUpdate,e,{kind:eR.PromoteNamedObjects,scope:t,fromStateId:r})},e.prototype.handlePromoteNamedObjects=function(e,t){var r=this.docs.promoteNamedObjects(e,t);if(r.kind===Gt.Failure)return this.logUnavailableObject(r.reason);r.value||this.outputMessageLog.push({kind:tR.UpdateNamesRequest,stateId:this.stateId,scope:e})},e.prototype.extendUnusedRange=function(e,t){this.queue.enqueue($T.ServerUpdate,t,{kind:eR.ExtendUnusedRange,range:e})},e.prototype.handleExtendUnusedRange=function(e){var t=this.docs.extendServerUnused(e.sheet,e.range);if(t.kind===Gt.Failure)return this.logUnavailableObject(t.reason);this.docs.onCellModified(!0)},e.prototype.writeHiddenRows=function(e,t){this.queue.enqueue($T.ServerUpdate,e,{kind:eR.WriteHiddenRows,rows:t})},e.prototype.handleWriteHiddenRows=function(e){var t=this.docs.writeHiddenRows(e.sheet,e.range,e.hidden);if(t.kind===Gt.Failure)return this.logUnavailableObject(t.reason)},e.prototype.writeInFilterMode=function(e,t){this.queue.enqueue($T.ServerUpdate,e,{kind:eR.WriteInFilterMode,mode:t})},e.prototype.handleWriteInFilterMode=function(e){var t=this.docs.writeInFilterMode(e.sheet,e.inFilterMode);if(t.kind===Gt.Failure)return this.logUnavailableObject(t.reason)},e.prototype.getStatistics=function(){return{queueSize:this.queue.getCountUpperBound(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.maybeCollectGarbage=function(){if(!(this.stateChangesSinceLastGC<17)){var e=this.stateId-17;this.docs.collectGarbage(e),this.outputMessageLog.push({kind:tR.GarbageCollected,minStateIdKept:e}),this.stateChangesSinceLastGC=0}},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.scheduleDependents=function(e,t){var r=this,n=function(t,n){var i=n;return bt(t,e.sheet)&&(i=fT(i,vT(e.set))),r.docs.forEachEditedNonBlankCellInSet(t,i,(function(e){var n=te(t,e),i=r.docs.getEditedFormula(n);return i.kind===Gt.Failure?(r.logUnavailableObject(i.reason),!0):(void 0!==i.value&&void 0!==i.value[1].compiledFmla&&r.computeCellValue(n,HT.DependentCell),!0)}))};return void 0!==t?n(t.sheet,_T(t.range)):n(e.sheet,KC)},e}();function Zy(e){return new Promise((function(t){return setTimeout(t,e)}))}function $y(e,t){var r=t&&t.timeThreshold||10,n=t&&t.costThreshold||1,i=t&&t.macrotaskDelay||0,a={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},o=HS(),u=o[0],s=o[1],c=s[0],l=s[1];var f=!0;var d=Zy(i),h=Cr();return function t(){if(!f||!function(){try{for(var t=0;t<n;){a.iterations+=1;var r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return l(e),!1}}())return c();var o=Cr();o-h<r?(Promise.resolve().then(t),a.microtaskContinues+=1):(d.then((function(){d=Zy(i),h=Cr(),a.macrotaskTotalDelay+=h-o,t()})),a.macrotaskContinues+=1)}(),{promise:u,stop:function(){f=!1},stats:a}}function eI(e,t){var r=Er("en-US"),n=function(e,t,r){var n=mn().slice();return GR(t,iy,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),gn(e,n)}(r,e.worksheetFunctionNames,t),i=n.getWorksheetFuncId,a=n.getWorksheetFuncName,o=function(e,t){var r=dn.slice();return GR(e,ay,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t);return d(d({},e),{parseNumber:an(e.decimalSeparator),formatNumber:on(e.decimalSeparator),getWorksheetFuncId:i,getWorksheetFuncName:a,isNumeral:un,getOrdinal:sn,getNumeral:cn,isIdentStart:ln,isIdentContinue:fn,stringCompareCI:r,errorNames:o})}function tI(e,t){return dr(t)?{index:e,length:1}:{index:e,length:gr(t-e)+1}}function rI(e,t){var r=tI(t.row,t.lastRow),n=r.index,i=r.length,a=tI(t.column,t.lastColumn),o=a.index,u=a.length;return ee(x(e,t.sheetId),W(n,o,i,u))}function nI(e,t){var r=t.sheetId,n=t.usedRange;return fr(n)?rI(e,d({sheetId:r},n)):{sheet:x(e,r),range:void 0}}function iI(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=oT({row:t}),i=oT({col:r}),a=lT(n,i);return dT(_T(e),a)}(e.range,t,r)}}function aI(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function oI(e){return Nt(e)?iS(e.sheet.index,e.range.row,e.range.col):iS(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function uI(e,t,r,n){var i=jC;if(dr(n))return i;for(var a=0;a<n.length;a+=1){var o=n[a];if(e<=o&&o<e+t){for(var u=1;a+u<n.length&&n[a+u]===o+u;)u+=1;a+=u-1,i=_C(i,r(pr(o,o+u)))}}return i}function sI(e){if("object"!=typeof e)return e;switch(e.kind){case"Blank":return be;case"Error":return ue(e.type);default:return}}function cI(e,t){if(!dr(t)){switch(t.kind){case"NamedValue":return"object"!=typeof t.value?Uy(t.value):"Error"===t.value.kind?Uy(ue(t.value.type)):b("calc.calc.namedObjectDataToNamedObject: NamedValue",t.value.kind);case"NamedFormula":return Py(t.formulaBarText);case"NamedRange":var r=rI(e,t.range);return Uy(Te(r.sheet,r.range));case"NamedFailure":return Gy(t.failureReason,dr(t.objectKind)?void 0:t.objectKind)}return b("calc.calc.namedObjectDataToNamedObject: kind",t)}}function lI(e,t){if(t.kind===af.NotImplemented)for(var r=0,n=t.features;r<n.length;r++){var i=n[r];_R(e,af.NotImplemented+" "+i)}else if(t.kind===af.Unavailable)for(var a=0,o=t.objects;a<o.length;a++){var u=o[a],s=[af.Unavailable];if("string"==typeof u.kind&&u.kind in jy){var c=u;switch(s.push(c.kind),c.kind){case jy.SheetId:s.push(c.sheetId);break;case jy.NameLoc:s.push(void 0===c.name.scope.index?"global":"sheet");break;case jy.ClientFailure:s.push(c.reason);break;case jy.VolatileFunction:s.push(c.name)}}else s.push(JSON.stringify(u));_R(e,s.join(" "))}else _R(e,t.kind)}var fI,dI=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.arrayDeltas=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.isRecalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==KT.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this.dependentRangeDeltas).push.apply(e,t)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.isRecalcFinished=this.isRecalcFinished||e},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(BS(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.arrayDeltas.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,this.arrayDeltas),this.editedRangeDeltas=[],this.arrayDeltas=[]),this.dependentRangeDeltas.length>0&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[]),this.dependentRangeDeltas=[]),this.isRecalcFinished&&(this.onRecalcResults(xS(this.currentOutputStateId,"Dependents",!0,[],[])),this.isRecalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r){for(var n=0;n<Math.max(t.length,r.length);n+=10)this.onRecalcResults(xS(this.currentOutputStateId,e,!1,t.slice(n,n+10).filter((function(e){return"object"!=typeof e.data.value})),r.slice(n,n+10)))},e}(),hI=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.document=G(void 0,""),this.localeInfo=En(),this.refStyle=Re.A1,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.recalcStatistics=XT,this.precisionStatistics=rR,this.nameFailures=[],this.rangeFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.setConfig({}),this.dataModel=new zy(this.localeInfo,this.refStyle,this.config)}return e.prototype.setInputStateId=function(e){var t=e-this.currentInputStateId;return t<0?(this.logInputStateIdDecrease(),!1):(0!==t&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;return this.clearAsyncResumeRecalc(),this.recalcLoop=$y((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs}),this.recalcLoop.promise.finally((function(){e.recalcLoop=void 0}))},e.prototype.processRecalcResults=function(e){for(var t,r,n=new dI(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),i=0,a=e;i<a.length;i++){var o=a[i];if(o.kind!==tR.GarbageCollected)if(o.kind!==tR.ExperimentRunResult){if(this.setOutputStateId(o.stateId))switch(n.setOutputStateId(o.stateId),o.kind){case tR.CellWrite:var u=o.cell,s=o.value,c=o.format,l=o.cellKind,f=u.sheet,d=u.range,h=this.cellWriteToRangeDelta(f.index,d.row,d.col,s,c,"messages.<index>.value");fr(h)&&n.pushCellWrite(l,h);break;case tR.RangeWrite:var p=o.range,v=o.values;f=p.sheet,d=p.range;n.pushRangeWrite.apply(n,this.rangeWriteToRangeDeltas(f.index,d,v,"messages.<index>.values"));break;case tR.NameFailure:this.nameFailures.push(o);break;case tR.RangeFailure:this.rangeFailures.push(o);break;case tR.UnhandledFailure:this.unhandledFailures.push(o);break;case tR.UpdateRequest:n.pushUpdateRequest(oI(o.range));break;case tR.UpdateNamesRequest:n.pushUpdateNameRequest(o.scope);break;case tR.RecalcStatistics:n.pushRecalcFinished(o.message===JT.RecalcFinished),this.recalcStatistics=QT(this.recalcStatistics,o);break;case tR.PrecisionStatistics:this.precisionStatistics=(t=this.precisionStatistics,r=o.stats,{samples:nR(t.samples,r.samples),failures:nR(t.failures,r.failures)});break;case tR.WorkbookStatistics:this.logWorkbookStats(o.stateId,o.stats);break;case tR.StateAdvanced:break;default:return b("calc.calc.RecalcServiceImpl.processRecalcResults",o)}}else this.logExperimentRunResult(o.logMessage);else this.onGC(o.minStateIdKept)}n.flush()},e.prototype.logExperimentRunResult=function(e){k.ULS.traceTag(594409422,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.calc.RecalcServiceImpl.ExperimentRunResult: "+e)},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",c.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",c.TraceLevel.Info),this.logGenFailureStats(r,595194338,"unhandled",c.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var i={},a=0,o=e;a<o.length;a++){lI(i,o[a].reason)}var u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(i);k.ULS.traceTag(t,c.LogCategory.msoulscat_ES_EWAJS,n,u),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var i=this;if(0!==e.length){for(var a={},o=0,u=e;o<u.length;o++){var s=u[o],l=s.reason,f=s.cellKind;lI(a[f]||(a[f]={}),l)}Object.getOwnPropertyNames(a).sort().forEach((function(e){var o=a[e],u="calc.calc.RecalcService: recalc "+r+" failures; stateId = "+i.currentOutputStateId+", cell kind = "+e+", stats = "+JSON.stringify(o);k.ULS.traceTag(t,c.LogCategory.msoulscat_ES_EWAJS,n,u)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r].reason;if(i.kind===af.JavaScriptError){var a="calc.calc.RecalcService: recalc "+t+" JavaScript error: "+(null!=i.error.stack?i.error.stack:i.error.message);k.ULS.traceTag(595658721,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,a)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var i="calc.calc.RecalcService: ignored "+r+" data; "+("stateId = "+t+", stats = "+JSON.stringify(n));k.ULS.traceTag(e,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,i)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0){var e="calc.calc.RecalcService: recalc statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify(this.recalcStatistics));k.ULS.traceTag(595654593,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,e),this.recalcStatistics=XT}},e.prototype.logPrecisionStats=function(){if(0!==this.precisionStatistics.samples.length||0!==this.precisionStatistics.failures.length){var e=this.precisionStatistics,t=e.samples,r=e.failures,n={};r.forEach((function(e){return lI(n,e)}));var i="calc.calc.RecalcService: precision statistics; "+("stateId = "+this.currentOutputStateId+", stats = "+JSON.stringify({samples:t,failures:n}));k.ULS.traceTag(595645023,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,i),this.precisionStatistics=rR}},e.prototype.logWorkbookStats=function(e,t){var r="calc.calc.RecalcService: workbook statistics; "+("stateId = "+e+", stats = "+JSON.stringify(t));k.ULS.traceTag(595359882,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,r)},e.prototype.logInputStateIdDecrease=function(){_R(this.ignoredInputStats,"stateId went backwards")},e.prototype.logOutputStateIdDecrease=function(){_R(this.ignoredOutputStats,"stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats(),this.logPrecisionStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,i,a){if(PR(n,wy,this.ignoredOutputStats,a)){var o=function(e){if("object"!=typeof e)return e;switch(e.kind){case j.Error:return $E(e.type);default:return}}(n),u=function(e){if(void 0!==e)return wS(e.isExact,e.iformat,!1,e.category,e.decimals)}(i);return fr(void 0)||fr(o)||fr(u)?PS(iS(e,t,r),US(void 0,o,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n){for(var i=n+".<index>.<index>",a=t.row,o=t.col,u=t.rows,s=t.cols,c=[],l=0;l<u;l+=1)for(var f=0;f<s;f+=1){var d=this.cellWriteToRangeDelta(e,a+l,o+f,r[l][f],void 0,i);fr(d)&&c.push(d)}return c},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.refStyle=e?Re.A1:Re.R1C1,this.dataModel.setRefStyle(this.refStyle,this.currentInputStateId)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.localeInfo=eI(e,this.ignoredInputStats),this.dataModel.setLocaleInfo(this.localeInfo,this.currentInputStateId)},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(GR(e,uy,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.setSheetNames=function(e){this.updateSheetNames(this.currentInputStateId,e)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e)&&(this.clearAsyncResumeRecalc(),this.dataModel.setSheetNames(this.document,GR(t,cy,this.ignoredInputStats,"sheetNames"),e))},e.prototype.updateNamedObjects=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=GR(t,Fy,this.ignoredInputStats,"namedObjectsUpdates");r<n.length;r++){var i=n[r],a=i.scope,o=i.objects,u=i.fromStateId,s=ne(this.document,fr(a)?a:void 0);if(fr(o))for(var c=0,l=GR(o,ky,this.ignoredInputStats,"namedObjectsUpdates.<index>.objects");c<l.length;c++){var f=l[c],d=f.name,h=f.data;this.dataModel.writeNamedObject(e,s,d,cI(this.document,h))}else fr(u)?this.dataModel.promoteNamedObjects(e,s,u):this.dataModel.writeUndefinedNames(e,s)}}},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=GR(t,Ry,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var i=n[r];this.dataModel.extendUnusedRange(nI(this.document,i),e)}}},e.prototype.updateRanges=function(e,t){var r,n;if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var i=0,a=GR(t,Sy,this.ignoredInputStats,"rangeUpdates");i<a.length;i++){var o=a[i],u=o.range,s=o.excludeRows,c=o.excludeColumns,l=o.data,f=o.fromStateId,d=rI(this.document,u),h=d.range,p=uI(h.row,h.rows,MT.row,s),v=iI(d,p,uI(h.col,h.cols,MT.col,c)),m=fr(l)?sI(l.value):be;if(void 0!==m){if(fr(l)){var g=l.iformat,E="ArrayFormula"===l.kind?void 0:null!=(r=l.formulaBarText)?r:void 0,S=null!=(n=l.failureReason)?n:void 0;if("Inferred"===l.kind)this.dataModel.writeCellContents(e,v,E,m,void 0,g,S);else{var C="CellFormula"===l.kind;this.dataModel.writeCellContents(e,v,E,m,C,g,S)}}else dr(f)?this.dataModel.writeCellContents(e,v,"",be,!1,0,void 0):this.dataModel.promoteCellContents(e,d,v,f);this.dataModel.writeHiddenRows(e,aI(d,p))}}}},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=GR(t,Ty,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var i=n[r],a=i.range,o=i.data,u=i.fromStateId,s=rI(this.document,a);if(fr(o)){var c=o.formulaBarText,l=o.isSpilled;this.dataModel.writeArrayFormula(e,s,c,l)}else fr(u)}}},e.prototype.editRangeFormulas=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=GR(t,Ly,this.ignoredInputStats,"rangeFormulaEdits");r<n.length;r++){var i=n[r],a=i.kind,o=i.range,u=i.formulaBarText,s=i.value,c=i.origin,l=i.viewport,f=rI(this.document,o);if(Nt(f)){var d=fr(c)?H(c.row,c.column):void 0,h=fr(l)?rI(this.document,l):void 0,p=void 0;if(fr(s)){if(void 0===(p=sI(s)))continue}else p=void 0;var v="CellFormula"===a||"Value"!==a&&void 0;this.dataModel.editCellContents(e,f,u,p,v,d,h)}else _R(this.ignoredInputStats,"rangeFormulaEdits.<index>.range: expected single cell")}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e)){this.clearAsyncResumeRecalc();for(var r=0,n=GR(t,My,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var i=n[r],a=i.range,o=i.formulaBarText,u=i.viewport,s=rI(this.document,a),c=fr(u)?rI(this.document,u):void 0;this.dataModel.editArrayFormula(e,s,o,c)}}},e.prototype.setConfig=function(e){var t,r,n,i,a,o,u;this.config={yieldIntervalMs:10,totalTimeMs:(t=e.totalEvalTimeMs,null!=t?t:1e4),samplePrecisionRate:(r=e.samplePrecisionRate,null!=r?r:.001),sampleStatisticsRate:(n=e.sampleStatisticsRate,null!=n?n:.1),sampleCellEvalStopwatchRate:(i=e.sampleCellEvalStopwatchRate,null!=i?i:.01),sampleRecalcEditedStopwatchRate:(a=e.sampleRecalcEditedStopwatchRate,null!=a?a:1),sampleRecalcViewportStopwatchRate:(o=e.sampleRecalcViewportStopwatchRate,null!=o?o:1),rngSeed:(u=e.rngSeed,null!=u?u:1e3*Date.now())}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new zy(this.localeInfo,this.refStyle,this.config),this.recalcStatistics=XT,this.precisionStatistics=rR,this.nameFailures=[],this.rangeFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=-1/0},e.prototype.testAdvanceState=function(e){this.setInputStateId(e)&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.testDelay=function(e){return p(this,void 0,void 0,(function(){return v(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){return setTimeout(t,e)}))];case 1:return t.sent(),[2]}}))}))},e}();function pI(){return{onError:function(e,t){var r=null!=t.error.stack?t.error.stack:t.error.message,n="calc.calc.recalcServiceInsideDef.onError: "+JSON.stringify({kind:t.kind,closing:t.closing,message:r});k.ULS.traceTag(595658753,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,n)},onInit:function(e){var t=e.getImports("client",["onRecalcResults","onUpdateRequest","onGC"]),r=t.onRecalcResults,n=t.onUpdateRequest,i=t.onGC;e.setExports("service",new hI(r.notify,n.notify,i.notify))},scriptName:"excelOnlineRecalcService.worker"}}!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(fI||(fI={}));var vI=function(e){return void 0===e&&(e=fI.Thread),p(this,void 0,void 0,(function(){var t,r,n,i,a,o,u;return v(this,(function(s){switch(s.label){case 0:return t=!1,r={outside:{onError:function(e,r){var n=null!=r.error.stack?r.error.stack:r.error.message,i="calc.calc.recalcServiceOutsideDef.onError: "+JSON.stringify({kind:r.kind,closing:r.closing,message:n});k.ULS.traceTag(595658719,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,i),r.closing&&(t=!0)},onClosed:function(e){var r="calc.calc.recalcServiceOutsideDef.onClosed: recalc service closed "+(t?"because of an error":"normally");k.ULS.traceTag(595658720,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Warning,r)}},inside:pI()},[4,vC(e===fI.Thread?[bS.Dedicated]:e===fI.Local?[bS.FunctionCall]:[bS.Dedicated,bS.FunctionCall],r)];case 1:if(null==(n=s.sent()))throw new Error("could not create recalc service worker");return i="calc.calc.createRecalcService: worker created; outside.workerKind = "+n.workerKind,k.ULS.traceTag(595731987,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,i),a=-1/0,o={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){a=e}},n.setExports("client",o),u=n.getImports("service",["setA1ReferenceStyle","setLocale","setNumberFormats","setSheetNames","updateSheetNames","updateUnusedCells","updateNamedObjects","updateRanges","updateArrays","editRangeFormulas","editArrayFormulas","resumeRecalc","reconfigure","clearCache","testAdvanceState","testDelay"]),[2,{setOnRecalcResults:function(e){o.onRecalcResults=e},setOnUpdateRequest:function(e){o.onUpdateRequest=e},setA1ReferenceStyle:function(e){t||u.setA1ReferenceStyle.notify(e)},setLocale:function(e){t||u.setLocale.notify(e)},setNumberFormats:function(e,r){t||u.setNumberFormats.notify(e,r)},setSheetNames:function(e){t||u.setSheetNames.notify(e)},updateSheetNames:function(e,r){t||u.updateSheetNames.notify(e,r)},updateNamedObjects:function(e,r){t||u.updateNamedObjects.notify(e,r)},setUsedRanges:function(e,t){},updateUnusedCells:function(e,r){t||u.updateUnusedCells.notify(e,r)},updateRanges:function(e,r){t||u.updateRanges.notify(e,r)},updateArrays:function(e,r){t||u.updateArrays.notify(e,r)},editRangeFormulas:function(e,r){t||u.editRangeFormulas.notify(e,r)},editArrayFormulas:function(e,r){t||u.editArrayFormulas.notify(e,r)},resumeRecalc:function(){t||u.resumeRecalc.notify()},reconfigure:function(e){t||u.reconfigure.notify(e)},clearCache:function(){t||u.clearCache.notify()},testAdvanceState:function(e){t||u.testAdvanceState.notify(e)},testResumeRecalc:function(){return t?Promise.resolve():u.resumeRecalc.call()},testCrash:function(){return u.testDelay.isCritical=!0,u.testDelay.callTimeout=0,u.testDelay.call(100)},close:function(){n.close()},stateIdAvailable:function(e){return e>=a}}]}}))}))};r.d(t,"packageVersion",(function(){return"10.16.1"})),r.d(t,"location",(function(){return Sn})),r.d(t,"formula",(function(){return yn})),r.d(t,"value",(function(){return Tn})),r.d(t,"signature",(function(){return On})),r.d(t,"util",(function(){return Nn})),r.d(t,"config",(function(){return Fn})),r.d(t,"parse",(function(){return n})),r.d(t,"analyze",(function(){return i})),r.d(t,"runtime",(function(){return a})),r.d(t,"calc",(function(){return s})),r.d(t,"funcs",(function(){return u})),r.d(t,"worker",(function(){return o}))}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map